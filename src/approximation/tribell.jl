# Bell triangle element with 18 DOFs

function set𝝭!(ap::Element{:TriBell},x::Node)
    v₁ = ap.𝓒[1]
    v₂ = ap.𝓒[7]
    v₃ = ap.𝓒[13]
    x₁ = v₁.x
    y₁ = v₁.y
    x₂ = v₂.x
    y₂ = v₂.y
    x₃ = v₃.x
    y₃ = v₃.y
    D₁₁ = y₃-y₂
    D₂₁ = y₁-y₃
    D₃₁ = y₂-y₁
    D₁₂ = x₂-x₃
    D₂₂ = x₃-x₁
    D₃₂ = x₁-x₂
    e₁₂ = (D₁₁*D₂₁+D₁₂*D₂₂)/(D₂₁*D₂₁+D₂₂*D₂₂)
    e₂₁ = (D₂₁*D₁₁+D₂₂*D₁₂)/(D₁₁*D₁₁+D₁₂*D₁₂)
    e₁₃ = (D₁₁*D₃₁+D₁₂*D₃₂)/(D₃₁*D₃₁+D₃₂*D₃₂)
    e₃₁ = (D₃₁*D₁₁+D₃₂*D₁₂)/(D₁₁*D₁₁+D₁₂*D₁₂)
    e₂₃ = (D₂₁*D₃₁+D₂₂*D₃₂)/(D₃₁*D₃₁+D₃₂*D₃₂)
    e₃₂ = (D₃₁*D₂₁+D₃₂*D₂₂)/(D₂₁*D₂₁+D₂₂*D₂₂)
    ξ₁ = 1-x.ξ-x.η
    ξ₂ = x.ξ
    ξ₃ = x.η
    xₛ = ξ₁*x₁+ξ₂*x₂+ξ₃*x₃
    yₛ = ξ₁*y₁+ξ₂*y₂+ξ₃*y₃
    # println(yₛ-x.y)
    𝝭 = x[:𝝭]
    𝝭[1] = ξ₁^3*(10-15*ξ₁+6*ξ₁^2)-30*(e₁₂*ξ₃+e₁₃*ξ₂)*ξ₁^2*ξ₂*ξ₃
    𝝭[2] = ξ₁^3*(4-3*ξ₁)*(xₛ-x₁)+(15*(x₁-x₃)*e₁₂+3*(x₂-x₃))*ξ₁^2*ξ₂*ξ₃^2+(15*(x₁-x₂)*e₁₃+3*(x₃-x₂))*ξ₁^2*ξ₂^2*ξ₃
    𝝭[3] = ξ₁^3*(4-3*ξ₁)*(yₛ-y₁)+(15*(y₁-y₃)*e₁₂+3*(y₂-y₃))*ξ₁^2*ξ₂*ξ₃^2+(15*(y₁-y₂)*e₁₃+3*(y₃-y₂))*ξ₁^2*ξ₂^2*ξ₃
    𝝭[7] = ξ₂^3*(10-15*ξ₂+6*ξ₂^2)-30*(e₂₁*ξ₃+e₂₃*ξ₁)*ξ₂^2*ξ₁*ξ₃
    𝝭[8] = ξ₂^3*(4-3*ξ₂)*(xₛ-x₂)+(15*(x₂-x₁)*e₂₃+3*(x₃-x₁))*ξ₂^2*ξ₃*ξ₁^2+(15*(x₂-x₃)*e₂₁+3*(x₁-x₃))*ξ₂^2*ξ₃^2*ξ₁
    𝝭[9] = ξ₂^3*(4-3*ξ₂)*(yₛ-y₂)+(15*(y₂-y₁)*e₂₃+3*(y₃-y₁))*ξ₂^2*ξ₃*ξ₁^2+(15*(y₂-y₃)*e₂₁+3*(y₁-y₃))*ξ₂^2*ξ₃^2*ξ₁
    𝝭[13] = ξ₃^3*(10-15*ξ₃+6*ξ₃^2)-30*(e₃₁*ξ₂+e₃₂*ξ₁)*ξ₃^2*ξ₁*ξ₂
    𝝭[14] = ξ₃^3*(4-3*ξ₃)*(xₛ-x₃)+(15*(x₃-x₂)*e₃₁+3*(x₁-x₂))*ξ₃^2*ξ₁*ξ₂^2+(15*(x₃-x₁)*e₃₂+3*(x₂-x₁))*ξ₃^2*ξ₁^2*ξ₂
    𝝭[15] = ξ₃^3*(4-3*ξ₃)*(yₛ-y₃)+(15*(y₃-y₂)*e₃₁+3*(y₁-y₂))*ξ₃^2*ξ₁*ξ₂^2+(15*(y₃-y₁)*e₃₂+3*(y₂-y₁))*ξ₃^2*ξ₁^2*ξ₂
end