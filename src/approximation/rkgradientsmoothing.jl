
struct RKGradientSmoothing{ğ‘,ğ‘ ,ğœ™,T}<:AbstractReproducingKernel{ğ‘ ,ğœ™,T}
    ğ“’::Tuple{Int,Int,Vector{Node{(:ğ¼,),1}}}
    ğ“–::Tuple{Int,Int,Vector{Node{(:ğ‘”,:ğº,:ğ¶,:ğ‘ ),4}}}
    ğ“–Ë¢::Tuple{Int,Int,Vector{Node{(:ğ‘”,:ğº,:ğ¶,:ğ‘ ),4}}}
end

function Base.getproperty(a::RKGradientSmoothing,s::Symbol)
    if sâˆˆ(:ğ“’,:ğ“–,:ğ“–Ë¢)
        ğ“ =  getfield(a,s)
        return (ğ“[3][ğ“[1]+i] for i in 1:ğ“[2])
    else
        ğ“– = getfield(a,:ğ“–)
        Î¾ = ğ“–[3][ğ“–[1]+1]
        return getproperty(Î¾,s)
    end
end

getğ‘›ğ’‘(    ::RKGradientSmoothing{:Linear1D}) = 1
getğ’‘(     ::RKGradientSmoothing{:Linear1D},::Any) = (1.0,)
getâˆ‚ğ’‘âˆ‚Î¾(  ::RKGradientSmoothing{:Linear1D},::Any) = (0.0,)
getâˆ‚Â²ğ’‘âˆ‚Î¾Â²(::RKGradientSmoothing{:Linear1D},::Any) = (0.0,)

getğ‘›ğ’‘(    ::RKGradientSmoothing{:Quadratic1D}) = 2
getğ’‘(     ::RKGradientSmoothing{:Quadratic1D},Î¾::Float64) = (1.0,0.5*(1.0-Î¾))
getâˆ‚ğ’‘âˆ‚Î¾(  ::RKGradientSmoothing{:Quadratic1D},::Any) = (0.0,1.0)
getâˆ‚Â²ğ’‘âˆ‚Î¾Â²(::RKGradientSmoothing{:Quadratic1D},::Any) = (0.0,0.0)

getğ‘›ğ’‘(    ::RKGradientSmoothing{:Cubic1D}) = 3
getğ’‘(     ::RKGradientSmoothing{:Cubic1D},Î¾::Float64) = (1.0,0.5*(1.0-Î¾),0.25*(1.0-Î¾)^2)
getâˆ‚ğ’‘âˆ‚Î¾(  ::RKGradientSmoothing{:Cubic1D},Î¾::Float64) = (0.,1.0,(1.0-Î¾))
getâˆ‚Â²ğ’‘âˆ‚Î¾Â²(::RKGradientSmoothing{:Cubic1D},Î¾::Float64) = (0.,0.0,2.0)

getğ‘›ğ’‘(    ::RKGradientSmoothing{:Quartic1D}) = 4
getğ’‘(     ::RKGradientSmoothing{:Quartic1D},Î¾::Float64) = (1.0,0.5*(1.0-Î¾),0.25*(1.0-Î¾)^2,0.125*(1.0-Î¾)^3)
getâˆ‚ğ’‘âˆ‚Î¾(  ::RKGradientSmoothing{:Quartic1D},Î¾::Float64) = (0.,1.0,(1.0-Î¾),0.75*(1.0-Î¾)^2)
getâˆ‚Â²ğ’‘âˆ‚Î¾Â²(::RKGradientSmoothing{:Quartic1D},Î¾::Float64) = (0.,0.0,2.0,3.0*(1.0-Î¾))

getğ‘›ğ’‘(  ::RKGradientSmoothing{:Linear2D}) = 1
getğ’‘(   ::RKGradientSmoothing{:Linear2D},::Any,::Any) = (1.,)
getâˆ‚ğ’‘âˆ‚Î¾(::RKGradientSmoothing{:Linear2D},::Any,::Any) = (0.,)
getâˆ‚ğ’‘âˆ‚Î·(::RKGradientSmoothing{:Linear2D},::Any,::Any) = (0.,)

getğ‘›ğ’‘(     ::RKGradientSmoothing{:Quadratic2D}) = 3
getğ’‘(      ::RKGradientSmoothing{:Quadratic2D},Î¾::Float64,Î·::Float64) = (1.,Î¾,Î·)
getâˆ‚ğ’‘âˆ‚Î¾(   ::RKGradientSmoothing{:Quadratic2D},::Any,::Any) = (0.,1.,0.)
getâˆ‚ğ’‘âˆ‚Î·(   ::RKGradientSmoothing{:Quadratic2D},::Any,::Any) = (0.,0.,1.)
getâˆ‚Â²ğ’‘âˆ‚Î¾Â²( ::RKGradientSmoothing{:Quadratic2D},::Any,::Any) = (0.,0.,0.)
getâˆ‚Â²ğ’‘âˆ‚Î¾âˆ‚Î·(::RKGradientSmoothing{:Quadratic2D},::Any,::Any) = (0.,0.,0.)
getâˆ‚Â²ğ’‘âˆ‚Î·Â²( ::RKGradientSmoothing{:Quadratic2D},::Any,::Any) = (0.,0.,0.)

getğ‘›ğ’‘(  ::RKGradientSmoothing{:Cubic2D}) = 6
getğ’‘(   ::RKGradientSmoothing{:Cubic2D},Î¾::Float64,Î·::Float64) = (1.,Î¾,Î·,Î¾^2,Î¾*Î·,Î·^2)
getâˆ‚ğ’‘âˆ‚Î¾(::RKGradientSmoothing{:Cubic2D},Î¾::Float64,Î·::Float64) = (0.,1.,0.,2.0*Î¾,Î·,0.)
getâˆ‚ğ’‘âˆ‚Î·(::RKGradientSmoothing{:Cubic2D},Î¾::Float64,Î·::Float64) = (0.,0.,1.,0.,Î¾,2.0*Î·)

getğ‘›ğ’‘(  ::RKGradientSmoothing{:Quartic2D}) = 10
getğ’‘(   ::RKGradientSmoothing{:Quartic2D},Î¾::Float64,Î·::Float64) = (1.,Î¾,Î·,Î¾^2,Î¾*Î·,Î·^2,Î¾^3,Î¾^2*Î·,Î¾*Î·^2,Î·^3)
getâˆ‚ğ’‘âˆ‚Î¾(::RKGradientSmoothing{:Quartic2D},Î¾::Float64,Î·::Float64) = (0.,1.,0.,2.0*Î¾,Î·,0.,3.0*Î¾^2,2.0*Î¾*Î·,Î·^2,0.)
getâˆ‚ğ’‘âˆ‚Î·(::RKGradientSmoothing{:Quartic2D},Î¾::Float64,Î·::Float64) = (0.,0.,1.,0.,Î¾,2.0*Î·,0.,Î¾^2,2.0*Î¾*Î·,3.0*Î·^2)

for ğ’‘ in (:(:Linear1D),:(:Quadratic1D),:(:Cubic1D),:(:Quartic1D))
    @eval begin
        getğ’‘(  ap::RKGradientSmoothing{$ğ’‘},x::Node) = getğ’‘(ap,x.Î¾)
        getâˆ‡ğ’‘( ap::RKGradientSmoothing{$ğ’‘},x::Node) = getğ’‘(ap,x.Î¾),getâˆ‚ğ’‘âˆ‚Î¾(ap,x.Î¾)
        getâˆ‡Â²ğ’‘(ap::RKGradientSmoothing{$ğ’‘},x::Node) = getğ’‘(ap,x.Î¾),getâˆ‚ğ’‘âˆ‚Î¾(ap,x.Î¾),getâˆ‚Â²ğ’‘âˆ‚Î¾Â²(ap,x.Î¾)
    end
end

for ğ’‘ in (:(:Linear2D),:(:Quadratic2D),:(:Cubic2D),:(:Quartic2D))
    @eval begin
        getğ’‘(  ap::RKGradientSmoothing{$ğ’‘},x::Node) = getğ’‘(ap,x.Î¾,x.Î·)
        getâˆ‡ğ’‘( ap::RKGradientSmoothing{$ğ’‘},x::Node) = getğ’‘(ap,x.Î¾,x.Î·),getâˆ‚ğ’‘âˆ‚Î¾(ap,x.Î¾,x.Î·),getâˆ‚ğ’‘âˆ‚Î·(ap,x.Î¾,x.Î·)
        getâˆ‡Â²ğ’‘(ap::RKGradientSmoothing{$ğ’‘},x::Node) = getğ’‘(ap,x.Î¾,x.Î·),getâˆ‚ğ’‘âˆ‚Î¾(ap,x.Î¾,x.Î·),getâˆ‚ğ’‘âˆ‚Î·(ap,x.Î¾,x.Î·),getâˆ‚Â²ğ’‘âˆ‚Î¾Â²(ap,x.Î¾,x.Î·),getâˆ‚Â²ğ’‘âˆ‚Î¾âˆ‚Î·(ap,x.Î¾,x.Î·),getâˆ‚Â²ğ’‘âˆ‚Î·Â²(ap,x.Î¾,x.Î·)
    end
end

function calğ— !(ap::RKGradientSmoothing{:Linear1D,ğ‘ ,ğœ™,:Seg2}) where {ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = getğ— (ap,:âˆ‡Ìƒ)
    ğ¿ = ap.ğ¿
    ğ—šâ»Â¹[1] =  1.0/ğ¿
    return ğ—šâ»Â¹
end

function calğ— !(ap::RKGradientSmoothing{:Quadratic1D,ğ‘ ,ğœ™,:Seg2}) where {ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = getğ— (ap,:âˆ‡Ìƒ)
    ğ¿ = ap.ğ¿
    ğ—šâ»Â¹[1] =  4.0/ğ¿
    ğ—šâ»Â¹[2] = -6.0/ğ¿
    ğ—šâ»Â¹[3] = 12.0/ğ¿
    return ğ—šâ»Â¹
end

function calğ— !(ap::RKGradientSmoothing{:Cubic1D,ğ‘ ,ğœ™,:Seg2}) where {ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = getğ— (ap,:âˆ‡Ìƒ)
    ğ¿ = ap.ğ¿
    ğ—šâ»Â¹[1] =    9.0/ğ¿
    ğ—šâ»Â¹[2] =  -36.0/ğ¿
    ğ—šâ»Â¹[3] =  192.0/ğ¿
    ğ—šâ»Â¹[4] =   30.0/ğ¿
    ğ—šâ»Â¹[5] = -180.0/ğ¿
    ğ—šâ»Â¹[6] =  180.0/ğ¿
    return ğ—šâ»Â¹
end

function calğ— !(ap::RKGradientSmoothing{:Linear2D,ğ‘ ,ğœ™,:Tri3}) where {ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = getğ— (ap,:âˆ‡Ìƒ)
    ğ´ = ap.ğ´
    ğ—šâ»Â¹[1] = 1.0/ğ´
    return ğ—šâ»Â¹
end

function calğ— !(ap::RKGradientSmoothing{:Quadratic2D,ğ‘ ,ğœ™,:Tri3}) where {ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = getğ— (ap,:âˆ‡Ìƒ)
    ğ´ = ap.ğ´
    ğ—šâ»Â¹[1] =   9.0/ğ´
    ğ—šâ»Â¹[2] = -12.0/ğ´
    ğ—šâ»Â¹[3] =  24.0/ğ´
    ğ—šâ»Â¹[4] = -12.0/ğ´
    ğ—šâ»Â¹[5] =  12.0/ğ´
    ğ—šâ»Â¹[6] =  24.0/ğ´
    return ğ—šâ»Â¹
end

function calğ— !(ap::RKGradientSmoothing{:Cubic2D,ğ‘ ,ğœ™,:Tri3}) where {ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = getğ— (ap,:âˆ‡Ìƒ)
    ğ´ = ap.ğ´
    ğ—šâ»Â¹[1] =   36.0/ğ´
    ğ—šâ»Â¹[2] = -120.0/ğ´
    ğ—šâ»Â¹[3] =  600.0/ğ´
    ğ—šâ»Â¹[4] = -120.0/ğ´
    ğ—šâ»Â¹[5] =  300.0/ğ´
    ğ—šâ»Â¹[6] =  600.0/ğ´
    ğ—šâ»Â¹[7] =   90.0/ğ´
    ğ—šâ»Â¹[8] = -540.0/ğ´
    ğ—šâ»Â¹[9] = -180.0/ğ´
    ğ—šâ»Â¹[10] =  540.0/ğ´
    ğ—šâ»Â¹[11] =  180.0/ğ´
    ğ—šâ»Â¹[12] = -720.0/ğ´
    ğ—šâ»Â¹[13] = -720.0/ğ´
    ğ—šâ»Â¹[14] =  540.0/ğ´
    ğ—šâ»Â¹[15] = 1440.0/ğ´
    ğ—šâ»Â¹[16] =   90.0/ğ´
    ğ—šâ»Â¹[17] = -180.0/ğ´
    ğ—šâ»Â¹[18] = -540.0/ğ´
    ğ—šâ»Â¹[19] =   90.0/ğ´
    ğ—šâ»Â¹[20] =  540.0/ğ´
    ğ—šâ»Â¹[21] =  540.0/ğ´
    return ğ—šâ»Â¹
end

function setâˆ‡ğ­!(ap::RKGradientSmoothing{ğ’‘,ğ‘ ,ğœ™,:Seg2}) where {ğ’‘,ğ‘ ,ğœ™}
    ğ“’ = ap.ğ“’
    ğ“– = ap.ğ“–
    ğ“–Ë¢ = ap.ğ“–Ë¢
    for Î¾Ì‚ in ğ“–
        ğ’’Ì‚ = getğ’‘(ap,Î¾Ì‚)
        ğ—šâ»Â¹ = calğ— !(ap)
        ğ’’Ì‚áµ€ğ—šâ»Â¹ = ğ’’Ì‚*ğ—šâ»Â¹
        âˆ‚ğ­âˆ‚x = Î¾Ì‚[:âˆ‚ğ­âˆ‚x]
        for i in 1:length(ğ“’)
            âˆ‚ğ­âˆ‚x[i] = 0.0
        end
        for Î¾ in ğ“–Ë¢
            w = Î¾.w/2
            wáµ‡ = Î¾.wáµ‡
            Dâ‚ = Î¾.Dâ‚
            ğ­ = Î¾[:ğ­]
            ğ’’, âˆ‚ğ’’âˆ‚Î¾ = getâˆ‡ğ’‘(ap,Î¾)
            Wâ‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹*ğ’’*Dâ‚*wáµ‡ + ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î¾*nâ‚*w
            for i in 1:length(ğ“’)
                âˆ‚ğ­âˆ‚x[i] += ğ­[i]*Wâ‚
            end
        end
    end
end

function setâˆ‡ğ­!(ap::RKGradientSmoothing{ğ’‘,ğ‘ ,ğœ™,:Tri3}) where {ğ’‘,ğ‘ ,ğœ™}
    ğ“’ = ap.ğ“’
    ğ“– = ap.ğ“–
    ğ“–Ë¢ = ap.ğ“–Ë¢
    Dâ‚â‚ = ap.Dâ‚â‚
    Dâ‚‚â‚ = ap.Dâ‚‚â‚
    Dâ‚â‚‚ = ap.Dâ‚â‚‚
    Dâ‚‚â‚‚ = ap.Dâ‚‚â‚‚
    for Î¾Ì‚ in ğ“–
        ğ’’Ì‚ = getğ’‘(ap,Î¾Ì‚)
        ğ—šâ»Â¹ = calğ— !(ap)
        ğ’’Ì‚áµ€ğ—šâ»Â¹ = ğ’’Ì‚*ğ—šâ»Â¹
        âˆ‚ğ­âˆ‚x = Î¾Ì‚[:âˆ‚ğ­âˆ‚x]
        âˆ‚ğ­âˆ‚y = Î¾Ì‚[:âˆ‚ğ­âˆ‚y]
        for i in 1:length(ğ“’)
            âˆ‚ğ­âˆ‚x[i] = 0.0
            âˆ‚ğ­âˆ‚y[i] = 0.0
        end
        for Î¾ in ğ“–Ë¢
            w = Î¾.w
            wáµ‡ = Î¾.wáµ‡
            ğ­ = Î¾[:ğ­]
            ğ’’, âˆ‚ğ’’âˆ‚Î¾, âˆ‚ğ’’âˆ‚Î· = getâˆ‡ğ’‘(ap,Î¾)
            ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’ =  ğ’’Ì‚áµ€ğ—šâ»Â¹*ğ’’
            ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾ = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î¾
            ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î· = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î·
            Dâ‚ = Î¾.Dâ‚
            Dâ‚‚ = Î¾.Dâ‚‚
            bâ‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*Dâ‚â‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*Dâ‚‚â‚
            bâ‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*Dâ‚â‚‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*Dâ‚‚â‚‚
            Wâ‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*Dâ‚*wáµ‡ + bâ‚*w/2
            Wâ‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*Dâ‚‚*wáµ‡ + bâ‚‚*w/2
            for i in 1:length(ğ“’)
                âˆ‚ğ­âˆ‚x[i] += ğ­[i]*Wâ‚
                âˆ‚ğ­âˆ‚y[i] += ğ­[i]*Wâ‚‚
            end
        end
    end
end

struct RK2ndGradientSmoothing{ğ‘,ğ‘ ,ğœ™,T}<:AbstractReproducingKernel{ğ‘ ,ğœ™,T}
    ğ“’::Tuple{Int,Int,Vector{Node{(:ğ¼,),1}}}
    ğ“–::Tuple{Int,Int,Vector{Node{(:ğ‘”,:ğº,:ğ¶,:ğ‘ ),4}}}
    ğ“–Ë¢::Tuple{Int,Int,Vector{Node{(:ğ‘”,:ğº,:ğ¶,:ğ‘ ),4}}}
    ğ“–Ê·::Tuple{Int,Int,Vector{Node{(:ğ‘”,:ğº,:ğ¶,:ğ‘ ),4}}}
    ğ“–á¶¿::Tuple{Int,Int,Vector{Node{(:ğ‘”,:ğº,:ğ¶,:ğ‘ ),4}}}
    ğ“–á¶œ::Tuple{Int,Int,Vector{Node{(:ğ‘”,:ğº,:ğ¶,:ğ‘ ),4}}}
end

getğ‘›ğ’‘â‚‚(::ReproducingKernel{:Quadratic2D}) = 1
getğ’‘â‚‚(::ReproducingKernel{:Quadratic2D},::Any) = (1.,)
getâˆ‚ğ’‘â‚‚âˆ‚Î¾(::ReproducingKernel{:Quadratic2D},::Any) = (0.,)
getâˆ‚ğ’‘â‚‚âˆ‚Î·(::ReproducingKernel{:Quadratic2D},::Any) = (0.,)
getâˆ‚Â²ğ’‘â‚‚âˆ‚Î¾Â²(::ReproducingKernel{:Quadratic2D},::Any) = (0.,)
getâˆ‚Â²ğ’‘â‚‚âˆ‚Î¾âˆ‚Î·(::ReproducingKernel{:Quadratic2D},::Any) = (0.,)

getğ‘›ğ’‘â‚‚(::ReproducingKernel{:Cubic2D}) = 3
getğ’‘â‚‚(ap::ReproducingKernel{:Cubic2D},Î¾::Node) = getğ’‘â‚‚(ap,Î¾.Î¾,Î¾.Î·)
getğ’‘â‚‚(ap::ReproducingKernel{:Cubic2D},Î¾::NTuple{3,Float64}) = getğ’‘â‚‚(ap,Î¾[1],Î¾[2])
getğ’‘â‚‚(::ReproducingKernel{:Cubic2D},Î¾::Float64,Î·::Float64) = (1.,Î¾,Î·)
getâˆ‚ğ’‘â‚‚âˆ‚Î¾(ap::ReproducingKernel{:Cubic2D},Î¾::Any) = (0.,1.,0.)
getâˆ‚ğ’‘â‚‚âˆ‚Î·(ap::ReproducingKernel{:Cubic2D},Î¾::Any) = (0.,0.,1.)
getâˆ‚Â²ğ’‘â‚‚âˆ‚Î¾Â²(ap::ReproducingKernel{:Cubic2D},Î¾::Any) = (0.,0.,0.)
getâˆ‚Â²ğ’‘â‚‚âˆ‚Î¾âˆ‚Î·(ap::ReproducingKernel{:Cubic2D},Î¾::Any) = (0.,0.,0.)
getâˆ‚Â²ğ’‘â‚‚âˆ‚Î·Â²(ap::ReproducingKernel{:Cubic2D},Î¾::Any) = (0.,0.,0.)

getğ‘›ğ’‘â‚‚(::ReproducingKernel{:Quartic2D}) = 6
getğ’‘â‚‚(ap::ReproducingKernel{:Quartic2D},Î¾::Node) = getğ’‘â‚‚(ap,Î¾.Î¾,Î¾.Î·)
getğ’‘â‚‚(ap::ReproducingKernel{:Quartic2D},Î¾::NTuple{3,Float64}) = getğ’‘â‚‚(ap,Î¾[1],Î¾[2])
getğ’‘â‚‚(::ReproducingKernel{:Quartic2D},Î¾::Float64,Î·::Float64) = (1.,Î¾,Î·,Î¾^2,Î¾*Î·,Î·^2)
getâˆ‚ğ’‘â‚‚âˆ‚Î¾(ap::ReproducingKernel{:Quartic2D},Î¾::Node) = getâˆ‚ğ’‘â‚‚âˆ‚Î¾(ap,Î¾.Î¾,Î¾.Î·)
getâˆ‚ğ’‘â‚‚âˆ‚Î¾(ap::ReproducingKernel{:Quartic2D},Î¾::Float64,Î·::Float64) = (0.,1.,0.,2.0*Î¾,Î·,0.)
getâˆ‚ğ’‘â‚‚âˆ‚Î·(ap::ReproducingKernel{:Quartic2D},Î¾::Node) = getâˆ‚ğ’‘â‚‚âˆ‚Î·(ap,Î¾.Î¾,Î¾.Î·)
getâˆ‚ğ’‘â‚‚âˆ‚Î·(ap::ReproducingKernel{:Quartic2D},Î¾::Float64,Î·::Float64) = (0.,0.,1.,0.,Î¾,2.0*Î·)
getâˆ‚Â²ğ’‘â‚‚âˆ‚Î¾Â²(ap::ReproducingKernel{:Quartic2D},Î¾::Any) = (0.,0.,0.,2.,0.,0.)
getâˆ‚Â²ğ’‘â‚‚âˆ‚Î¾âˆ‚Î·(ap::ReproducingKernel{:Quartic2D},Î¾::Any) = (0.,0.,0.,0.,1.,0.)
getâˆ‚Â²ğ’‘â‚‚âˆ‚Î·Â²(ap::ReproducingKernel{:Quartic2D},Î¾::Any) = (0.,0.,0.,0.,0.,2.)
function calğ—šâ‚‚!(ap::ReproducingKernel{:Quadratic2D,ğ‘ ,ğœ™,:Tri3}) where {ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = getğ—š(ap,:âˆ‡ÌƒÂ²)
    ğ´ = ap.ğ“–[1].ğ´
    ğ—šâ»Â¹[1] = 1.0/ğ´
    return ğ—šâ»Â¹
end

function calğ—šâ‚‚!(ap::ReproducingKernel{:Cubic2D,ğ‘ ,ğœ™,:Tri3}) where {ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = getğ—š(ap,:âˆ‡ÌƒÂ²)
    ğ´ = ap.ğ“–[1].ğ´
    ğ—šâ»Â¹[1] =   9.0/ğ´
    ğ—šâ»Â¹[2] = -12.0/ğ´
    ğ—šâ»Â¹[3] =  24.0/ğ´
    ğ—šâ»Â¹[4] = -12.0/ğ´
    ğ—šâ»Â¹[5] =  12.0/ğ´
    ğ—šâ»Â¹[6] =  24.0/ğ´
    return ğ—šâ»Â¹
end

function calâˆ‡ğ—šâ‚‚!(ap::ReproducingKernel{:Cubic2D,ğ‘ ,ğœ™,:Tri3}) where {ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = getğ—š(ap,:âˆ‡ÌƒÂ²)
    ğ—šâ»Â¹âˆ‚Î¾ = getğ—š(ap,:âˆ‚âˆ‡ÌƒÂ²âˆ‚Î¾)
    ğ—šâ»Â¹âˆ‚Î· = getğ—š(ap,:âˆ‚âˆ‡ÌƒÂ²âˆ‚Î·)
    ğ´ = ap.ğ“–[1].ğ´
    ğ—šâ»Â¹[1] =   9.0/ğ´
    ğ—šâ»Â¹[2] = -12.0/ğ´
    ğ—šâ»Â¹[3] =  24.0/ğ´
    ğ—šâ»Â¹[4] = -12.0/ğ´
    ğ—šâ»Â¹[5] =  12.0/ğ´
    ğ—šâ»Â¹[6] =  24.0/ğ´

    ğ—šâ»Â¹âˆ‚Î¾[1] =   9.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[2] = -12.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[3] =  24.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[4] = -12.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[5] =  12.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[6] =  24.0/ğ´

    ğ—šâ»Â¹âˆ‚Î·[1] =   9.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[2] = -12.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[3] =  24.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[4] = -12.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[5] =  12.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[6] =  24.0/ğ´

    return ğ—šâ»Â¹,ğ—šâ»Â¹âˆ‚Î¾,ğ—šâ»Â¹âˆ‚Î·
end

function calğ—šâ‚‚!(ap::ReproducingKernel{:Quartic2D,ğ‘ ,ğœ™,:Tri3}) where {ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = getğ—š(ap,:âˆ‡ÌƒÂ²)
    ğ´ = ap.ğ“–[1].ğ´
    ğ—šâ»Â¹[1] =   36.0/ğ´
    ğ—šâ»Â¹[2] = -120.0/ğ´
    ğ—šâ»Â¹[3] =  600.0/ğ´
    ğ—šâ»Â¹[4] = -120.0/ğ´
    ğ—šâ»Â¹[5] =  300.0/ğ´
    ğ—šâ»Â¹[6] =  600.0/ğ´
    ğ—šâ»Â¹[7] =   90.0/ğ´
    ğ—šâ»Â¹[8] = -540.0/ğ´
    ğ—šâ»Â¹[9] = -180.0/ğ´
    ğ—šâ»Â¹[10] =  540.0/ğ´
    ğ—šâ»Â¹[11] =  180.0/ğ´
    ğ—šâ»Â¹[12] = -720.0/ğ´
    ğ—šâ»Â¹[13] = -720.0/ğ´
    ğ—šâ»Â¹[14] =  540.0/ğ´
    ğ—šâ»Â¹[15] = 1440.0/ğ´
    ğ—šâ»Â¹[16] =   90.0/ğ´
    ğ—šâ»Â¹[17] = -180.0/ğ´
    ğ—šâ»Â¹[18] = -540.0/ğ´
    ğ—šâ»Â¹[19] =   90.0/ğ´
    ğ—šâ»Â¹[20] =  540.0/ğ´
    ğ—šâ»Â¹[21] =  540.0/ğ´
    return ğ—šâ»Â¹
end

function calâˆ‡ğ—šâ‚‚!(ap::ReproducingKernel{:Quartic2D,ğ‘ ,ğœ™,:Tri3}) where {ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = getğ—š(ap,:âˆ‡ÌƒÂ²)
    ğ—šâ»Â¹âˆ‚Î¾ = getğ—š(ap,:âˆ‚âˆ‡ÌƒÂ²âˆ‚Î¾)
    ğ—šâ»Â¹âˆ‚Î· = getğ—š(ap,:âˆ‚âˆ‡ÌƒÂ²âˆ‚Î·)
    ğ´ = ap.ğ“–[1].ğ´
    ğ—šâ»Â¹[1] =   36.0/ğ´
    ğ—šâ»Â¹[2] = -120.0/ğ´
    ğ—šâ»Â¹[3] =  600.0/ğ´
    ğ—šâ»Â¹[4] = -120.0/ğ´
    ğ—šâ»Â¹[5] =  300.0/ğ´
    ğ—šâ»Â¹[6] =  600.0/ğ´
    ğ—šâ»Â¹[7] =   90.0/ğ´
    ğ—šâ»Â¹[8] = -540.0/ğ´
    ğ—šâ»Â¹[9] = -180.0/ğ´
    ğ—šâ»Â¹[10] =  540.0/ğ´
    ğ—šâ»Â¹[11] =  180.0/ğ´
    ğ—šâ»Â¹[12] = -720.0/ğ´
    ğ—šâ»Â¹[13] = -720.0/ğ´
    ğ—šâ»Â¹[14] =  540.0/ğ´
    ğ—šâ»Â¹[15] = 1440.0/ğ´
    ğ—šâ»Â¹[16] =   90.0/ğ´
    ğ—šâ»Â¹[17] = -180.0/ğ´
    ğ—šâ»Â¹[18] = -540.0/ğ´
    ğ—šâ»Â¹[19] =   90.0/ğ´
    ğ—šâ»Â¹[20] =  540.0/ğ´
    ğ—šâ»Â¹[21] =  540.0/ğ´

    ğ—šâ»Â¹âˆ‚Î¾[1] =   36.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[2] = -120.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[3] =  600.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[4] = -120.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[5] =  300.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[6] =  600.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[7] =   90.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[8] = -540.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[9] = -180.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[10] =  540.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[11] =  180.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[12] = -720.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[13] = -720.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[14] =  540.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[15] = 1440.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[16] =   90.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[17] = -180.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[18] = -540.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[19] =   90.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[20] =  540.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[21] =  540.0/ğ´

    ğ—šâ»Â¹âˆ‚Î·[1] =   36.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[2] = -120.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[3] =  600.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[4] = -120.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[5] =  300.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[6] =  600.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[7] =   90.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[8] = -540.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[9] = -180.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[10] =  540.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[11] =  180.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[12] = -720.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[13] = -720.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[14] =  540.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[15] = 1440.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[16] =   90.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[17] = -180.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[18] = -540.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[19] =   90.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[20] =  540.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[21] =  540.0/ğ´

    return ğ—šâ»Â¹,ğ—šâ»Â¹âˆ‚Î¾,ğ—šâ»Â¹âˆ‚Î·
end
function setâˆ‡ÌƒÂ²ğ­!(gp::ReproducingKernel{ğ’‘,ğ‘ ,ğœ™,:Tri3},ap::ReproducingKernel{ğ’‘,ğ‘ ,ğœ™,:Tri3}) where {ğ’‘,ğ‘ ,ğœ™}
    ğ“’ = gp.ğ“’
    ğ“– = gp.ğ“–
    ğ´ = ğ“–[1].ğ´
    nâ‚â‚ = ap.ğ“–[1].Dâ‚â‚;nâ‚‚â‚ = ap.ğ“–[1].Dâ‚‚â‚;nâ‚ƒâ‚ = ap.ğ“–[1].Dâ‚ƒâ‚
    nâ‚â‚‚ = ap.ğ“–[1].Dâ‚â‚‚;nâ‚‚â‚‚ = ap.ğ“–[1].Dâ‚‚â‚‚;nâ‚ƒâ‚‚ = ap.ğ“–[1].Dâ‚ƒâ‚‚
    sâ‚â‚ = -nâ‚â‚‚;sâ‚‚â‚ = -nâ‚‚â‚‚;sâ‚ƒâ‚ = -nâ‚ƒâ‚‚
    sâ‚â‚‚ =  nâ‚â‚;sâ‚‚â‚‚ =  nâ‚‚â‚;sâ‚ƒâ‚‚ =  nâ‚ƒâ‚
    ğ¿â‚Â² = nâ‚â‚^2+nâ‚â‚‚^2
    ğ¿â‚‚Â² = nâ‚‚â‚^2+nâ‚‚â‚‚^2
    ğ¿â‚ƒÂ² = nâ‚ƒâ‚^2+nâ‚ƒâ‚‚^2
    for Î¾Ì‚ in ğ“–
        ğ’’Ì‚ = getğ’‘â‚‚(gp,Î¾Ì‚)
        ğ—šâ»Â¹ = calğ—šâ‚‚!(gp)
        ğ’’Ì‚áµ€ğ—šâ»Â¹ = ğ’’Ì‚*ğ—šâ»Â¹

        âˆ‚Â²ğ­âˆ‚xÂ² = Î¾Ì‚[:âˆ‚Â²ğ­âˆ‚xÂ²]
        âˆ‚Â²ğ­âˆ‚xâˆ‚y = Î¾Ì‚[:âˆ‚Â²ğ­âˆ‚xâˆ‚y]
        âˆ‚Â²ğ­âˆ‚yÂ² = Î¾Ì‚[:âˆ‚Â²ğ­âˆ‚yÂ²]
        for i in 1:length(ğ“’)
            âˆ‚Â²ğ­âˆ‚xÂ²[i] = 0.0
            âˆ‚Â²ğ­âˆ‚xâˆ‚y[i] = 0.0
            âˆ‚Â²ğ­âˆ‚yÂ²[i] = 0.0
        end
        for Î¾ in ap.ğ“–
            w = Î¾.w
            wáµ‡ = Î¾.wáµ‡
            ğ­ = Î¾[:ğ­]
            âˆ‚ğ­âˆ‚x = Î¾[:âˆ‚ğ­âˆ‚x]
            âˆ‚ğ­âˆ‚y = Î¾[:âˆ‚ğ­âˆ‚y]
            ğ’’, âˆ‚ğ’’âˆ‚Î¾, âˆ‚ğ’’âˆ‚Î·, âˆ‚Â²ğ’’âˆ‚Î¾Â², âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·, âˆ‚Â²ğ’’âˆ‚Î·Â² = getâˆ‡Â²ğ’‘â‚‚(ap,Î¾)

            ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’ =  ğ’’Ì‚áµ€ğ—šâ»Â¹*ğ’’
            ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾ = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î¾
            ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î· = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î·
            ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â² = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚Â²ğ’’âˆ‚Î¾Â²
            ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î· = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·
            ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â² = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚Â²ğ’’âˆ‚Î·Â²

            qâ‚â‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚*nâ‚â‚ + 2*ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*nâ‚â‚*nâ‚‚â‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚*nâ‚‚â‚
            qâ‚â‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚*nâ‚â‚‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*(nâ‚â‚*nâ‚‚â‚‚+nâ‚â‚‚*nâ‚‚â‚) + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚*nâ‚‚â‚‚
            qâ‚‚â‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚‚*nâ‚â‚‚ + 2*ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*nâ‚â‚‚*nâ‚‚â‚‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚‚*nâ‚‚â‚‚

            qâ‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚
            qâ‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚‚

            qâ‚nâ‚ = 0.0;qâ‚‚nâ‚‚ = 0.0;qâ‚nâ‚‚ = 0.0;qâ‚‚nâ‚ = 0.0
            mnâ‚â‚nâ‚ = 0.0;mnâ‚â‚nâ‚‚ = 0.0;mnâ‚â‚‚nâ‚ = 0.0;mnâ‚â‚‚nâ‚‚ = 0.0;mnâ‚‚â‚‚nâ‚ = 0.0;mnâ‚‚â‚‚nâ‚‚ = 0.0
            msâ‚â‚ = 0.0;msâ‚â‚‚ = 0.0;msâ‚‚â‚‚ = 0.0
            Î”msâ‚â‚ = 0.0;Î”msâ‚â‚‚ = 0.0;Î”msâ‚‚â‚‚ = 0.0
            if Î¾.Î¾ == 0.0
                qâ‚nâ‚ += qâ‚*nâ‚â‚
                qâ‚nâ‚‚ += qâ‚*nâ‚â‚‚
                qâ‚‚nâ‚ += qâ‚‚*nâ‚â‚
                qâ‚‚nâ‚‚ += qâ‚‚*nâ‚â‚‚
                mnâ‚â‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚*nâ‚â‚/ğ¿â‚Â²
                mnâ‚â‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚*nâ‚â‚‚/ğ¿â‚Â²
                mnâ‚â‚‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚‚*nâ‚â‚/ğ¿â‚Â²
                mnâ‚â‚‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚‚*nâ‚â‚‚/ğ¿â‚Â²
                mnâ‚‚â‚‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚â‚‚*nâ‚â‚‚*nâ‚â‚/ğ¿â‚Â²
                mnâ‚‚â‚‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚â‚‚*nâ‚â‚‚*nâ‚â‚‚/ğ¿â‚Â²
                msâ‚â‚ += (qâ‚*sâ‚â‚+qâ‚‚*sâ‚â‚‚)*nâ‚â‚*sâ‚â‚/ğ¿â‚Â²
                msâ‚â‚‚ += (qâ‚*sâ‚â‚+qâ‚‚*sâ‚â‚‚)*0.5*(nâ‚â‚*sâ‚â‚‚+nâ‚â‚‚*sâ‚â‚)/ğ¿â‚Â²
                msâ‚‚â‚‚ += (qâ‚*sâ‚â‚+qâ‚‚*sâ‚â‚‚)*nâ‚â‚‚*sâ‚â‚‚/ğ¿â‚Â²
            end
            if  Î¾.Î· == 0.0
                qâ‚nâ‚ += qâ‚*nâ‚‚â‚
                qâ‚nâ‚‚ += qâ‚*nâ‚‚â‚‚
                qâ‚‚nâ‚ += qâ‚‚*nâ‚‚â‚
                qâ‚‚nâ‚‚ += qâ‚‚*nâ‚‚â‚‚
                mnâ‚â‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚*nâ‚‚â‚/ğ¿â‚‚Â²
                mnâ‚â‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚*nâ‚‚â‚‚/ğ¿â‚‚Â²
                mnâ‚â‚‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚‚*nâ‚‚â‚/ğ¿â‚‚Â²
                mnâ‚â‚‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚‚*nâ‚‚â‚‚/ğ¿â‚‚Â²
                mnâ‚‚â‚‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚â‚‚*nâ‚‚â‚‚*nâ‚‚â‚/ğ¿â‚‚Â²
                mnâ‚‚â‚‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚â‚‚*nâ‚‚â‚‚*nâ‚‚â‚‚/ğ¿â‚‚Â²
                msâ‚â‚ += (qâ‚*sâ‚‚â‚+qâ‚‚*sâ‚‚â‚‚)*nâ‚‚â‚*sâ‚‚â‚/ğ¿â‚‚Â²
                msâ‚â‚‚ += (qâ‚*sâ‚‚â‚+qâ‚‚*sâ‚‚â‚‚)*0.5*(nâ‚‚â‚*sâ‚‚â‚‚+nâ‚‚â‚‚*sâ‚‚â‚)/ğ¿â‚‚Â²
                msâ‚‚â‚‚ += (qâ‚*sâ‚‚â‚+qâ‚‚*sâ‚‚â‚‚)*nâ‚‚â‚‚*sâ‚‚â‚‚/ğ¿â‚‚Â²
            end
            if Î¾.Î¾+Î¾.Î· â‰ˆ 1.0
                qâ‚nâ‚ += qâ‚*nâ‚ƒâ‚
                qâ‚nâ‚‚ += qâ‚*nâ‚ƒâ‚‚
                qâ‚‚nâ‚ += qâ‚‚*nâ‚ƒâ‚
                qâ‚‚nâ‚‚ += qâ‚‚*nâ‚ƒâ‚‚
                mnâ‚â‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚*nâ‚ƒâ‚/ğ¿â‚ƒÂ²
                mnâ‚â‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚*nâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                mnâ‚â‚‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚/ğ¿â‚ƒÂ²
                mnâ‚â‚‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                mnâ‚‚â‚‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚/ğ¿â‚ƒÂ²
                mnâ‚‚â‚‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                msâ‚â‚ += (qâ‚*sâ‚ƒâ‚+qâ‚‚*sâ‚ƒâ‚‚)*nâ‚ƒâ‚*sâ‚ƒâ‚/ğ¿â‚ƒÂ²
                msâ‚â‚‚ += (qâ‚*sâ‚ƒâ‚+qâ‚‚*sâ‚ƒâ‚‚)*0.5*(nâ‚ƒâ‚*sâ‚ƒâ‚‚+nâ‚ƒâ‚‚*sâ‚ƒâ‚)/ğ¿â‚ƒÂ²
                msâ‚‚â‚‚ += (qâ‚*sâ‚ƒâ‚+qâ‚‚*sâ‚ƒâ‚‚)*nâ‚ƒâ‚‚*sâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
            end
            if Î¾.Î¾ == 1.0
                Î”msâ‚â‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*(nâ‚‚â‚*sâ‚‚â‚/ğ¿â‚‚Â²-nâ‚ƒâ‚*sâ‚ƒâ‚/ğ¿â‚ƒÂ²)
                Î”msâ‚‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*(nâ‚‚â‚‚*sâ‚‚â‚‚/ğ¿â‚‚Â²-nâ‚ƒâ‚‚*sâ‚ƒâ‚‚/ğ¿â‚ƒÂ²)
                Î”msâ‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*0.5*((nâ‚‚â‚*sâ‚‚â‚‚+nâ‚‚â‚‚*sâ‚‚â‚)/ğ¿â‚‚Â²-(nâ‚ƒâ‚*sâ‚ƒâ‚‚+nâ‚ƒâ‚‚*sâ‚ƒâ‚)/ğ¿â‚ƒÂ²)
            end
            if Î¾.Î· == 1.0
                Î”msâ‚â‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*(nâ‚ƒâ‚*sâ‚ƒâ‚/ğ¿â‚ƒÂ²-nâ‚â‚*sâ‚â‚/ğ¿â‚Â²)
                Î”msâ‚‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*(nâ‚ƒâ‚‚*sâ‚ƒâ‚‚/ğ¿â‚ƒÂ²-nâ‚â‚‚*sâ‚â‚‚/ğ¿â‚Â²)
                Î”msâ‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*0.5*((nâ‚ƒâ‚*sâ‚ƒâ‚‚+nâ‚ƒâ‚‚*sâ‚ƒâ‚)/ğ¿â‚ƒÂ²-(nâ‚â‚*sâ‚â‚‚+nâ‚â‚‚*sâ‚â‚)/ğ¿â‚Â²)
            end
            if Î¾.Î¾+Î¾.Î· â‰ˆ 0.0
                Î”msâ‚â‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*(nâ‚â‚*sâ‚â‚/ğ¿â‚Â²-nâ‚‚â‚*sâ‚‚â‚/ğ¿â‚‚Â²)
                Î”msâ‚‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*(nâ‚â‚‚*sâ‚â‚‚/ğ¿â‚Â²-nâ‚‚â‚‚*sâ‚‚â‚‚/ğ¿â‚‚Â²)
                Î”msâ‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*0.5*((nâ‚â‚*sâ‚â‚‚+nâ‚â‚‚*sâ‚â‚)/ğ¿â‚Â²-(nâ‚‚â‚*sâ‚‚â‚‚+nâ‚‚â‚‚*sâ‚‚â‚)/ğ¿â‚‚Â²)
            end

            Wâ‚â‚â‚ = mnâ‚â‚nâ‚*wáµ‡
            Wâ‚â‚â‚‚ = mnâ‚â‚nâ‚‚*wáµ‡
            Wâ‚â‚‚â‚ = mnâ‚â‚‚nâ‚*wáµ‡
            Wâ‚â‚‚â‚‚ = mnâ‚â‚‚nâ‚‚*wáµ‡
            Wâ‚‚â‚‚â‚ = mnâ‚‚â‚‚nâ‚*wáµ‡
            Wâ‚‚â‚‚â‚‚ = mnâ‚‚â‚‚nâ‚‚*wáµ‡
            Wâ‚â‚ = (qâ‚â‚*w + 2*(qâ‚nâ‚+msâ‚â‚)*wáµ‡)/4/ğ´ + Î”msâ‚â‚
            Wâ‚â‚‚ = (qâ‚â‚‚*w + (qâ‚nâ‚‚+qâ‚‚nâ‚+2*msâ‚â‚‚)*wáµ‡)/4/ğ´ + Î”msâ‚â‚‚
            Wâ‚‚â‚‚ = (qâ‚‚â‚‚*w + 2*(qâ‚‚nâ‚‚+msâ‚‚â‚‚)*wáµ‡)/4/ğ´ + Î”msâ‚‚â‚‚
            for i in 1:length(ğ“’)
                âˆ‚Â²ğ­âˆ‚xÂ²[i] += ğ­[i]*Wâ‚â‚ + âˆ‚ğ­âˆ‚x[i]*Wâ‚â‚â‚ + âˆ‚ğ­âˆ‚y[i]*Wâ‚â‚â‚‚
                âˆ‚Â²ğ­âˆ‚xâˆ‚y[i] += ğ­[i]*Wâ‚â‚‚ + âˆ‚ğ­âˆ‚x[i]*Wâ‚â‚‚â‚ + âˆ‚ğ­âˆ‚y[i]*Wâ‚â‚‚â‚‚
                âˆ‚Â²ğ­âˆ‚yÂ²[i] += ğ­[i]*Wâ‚‚â‚‚ + âˆ‚ğ­âˆ‚x[i]*Wâ‚‚â‚‚â‚ + âˆ‚ğ­âˆ‚y[i]*Wâ‚‚â‚‚â‚‚
            end
        end
    end
end

function setâˆ‡âˆ‡ÌƒÂ²ğ­!(gp::ReproducingKernel{ğ’‘,ğ‘ ,ğœ™,:Tri3},ap::ReproducingKernel{ğ’‘,ğ‘ ,ğœ™,:Tri3}) where {ğ’‘,ğ‘ ,ğœ™}
    xâ‚ = ap.ğ“’[1].x;yâ‚ = ap.ğ“’[1].y
    xâ‚‚ = ap.ğ“’[2].x;yâ‚‚ = ap.ğ“’[2].y
    xâ‚ƒ = ap.ğ“’[3].x;yâ‚ƒ = ap.ğ“’[3].y
    ğ´ = getğ´(ap)
    nâ‚â‚ = yâ‚ƒ-yâ‚‚;nâ‚‚â‚ = yâ‚-yâ‚ƒ;nâ‚ƒâ‚ = yâ‚‚-yâ‚
    nâ‚â‚‚ = xâ‚‚-xâ‚ƒ;nâ‚‚â‚‚ = xâ‚ƒ-xâ‚;nâ‚ƒâ‚‚ = xâ‚-xâ‚‚
    sâ‚â‚ = -nâ‚â‚‚;sâ‚‚â‚ = -nâ‚‚â‚‚;sâ‚ƒâ‚ = -nâ‚ƒâ‚‚
    sâ‚â‚‚ =  nâ‚â‚;sâ‚‚â‚‚ =  nâ‚‚â‚;sâ‚ƒâ‚‚ =  nâ‚ƒâ‚
    ğ¿â‚Â² = nâ‚â‚^2+nâ‚â‚‚^2
    ğ¿â‚‚Â² = nâ‚‚â‚^2+nâ‚‚â‚‚^2
    ğ¿â‚ƒÂ² = nâ‚ƒâ‚^2+nâ‚ƒâ‚‚^2
    ğ“’ = gp.ğ“’
    ğ“– = gp.ğ“–
    for Î¾Ì‚ in ğ“–
        ğ’’Ì‚,âˆ‚ğ’’Ì‚âˆ‚Î¾,âˆ‚ğ’’Ì‚âˆ‚Î· = getâˆ‡ğ’‘â‚‚(gp,Î¾Ì‚)
        ğ—šâ»Â¹,ğ—šâ»Â¹âˆ‚Î¾,ğ—šâ»Â¹âˆ‚Î· = calâˆ‡ğ—šâ‚‚!(gp)
        ğ’’Ì‚áµ€ğ—šâ»Â¹ = ğ’’Ì‚*ğ—šâ»Â¹
        âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹ = âˆ‚ğ’’Ì‚âˆ‚Î¾*ğ—šâ»Â¹âˆ‚Î¾
        âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹ = âˆ‚ğ’’Ì‚âˆ‚Î·*ğ—šâ»Â¹âˆ‚Î·

        âˆ‚Â²ğ­âˆ‚xÂ² = Î¾Ì‚[:âˆ‚Â²ğ­âˆ‚xÂ²]
        âˆ‚Â²ğ­âˆ‚xâˆ‚y = Î¾Ì‚[:âˆ‚Â²ğ­âˆ‚xâˆ‚y]
        âˆ‚Â²ğ­âˆ‚yÂ² = Î¾Ì‚[:âˆ‚Â²ğ­âˆ‚yÂ²]
        âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚x = Î¾Ì‚[:âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚x]
        âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚y = Î¾Ì‚[:âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚y]
        âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚x = Î¾Ì‚[:âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚x]
        âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚y = Î¾Ì‚[:âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚y]
        âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚x = Î¾Ì‚[:âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚x]
        âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚y = Î¾Ì‚[:âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚y]
        for i in 1:length(ğ“’)
            âˆ‚Â²ğ­âˆ‚xÂ²[i] = 0.0
            âˆ‚Â²ğ­âˆ‚xâˆ‚y[i] = 0.0
            âˆ‚Â²ğ­âˆ‚yÂ²[i] = 0.0
            âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚x[i] = 0.0
            âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚y[i] = 0.0
            âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚x[i] = 0.0
            âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚y[i] = 0.0
            âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚x[i] = 0.0
            âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚y[i] = 0.0
        end

        for Î¾ in ap.ğ“–
            w = Î¾.w
            wáµ‡ = Î¾.wáµ‡
            ğ­ = Î¾[:ğ­]
            âˆ‚ğ­âˆ‚x = Î¾[:âˆ‚ğ­âˆ‚x]
            âˆ‚ğ­âˆ‚y = Î¾[:âˆ‚ğ­âˆ‚y]
            ğ’’, âˆ‚ğ’’âˆ‚Î¾, âˆ‚ğ’’âˆ‚Î·, âˆ‚Â²ğ’’âˆ‚Î¾Â², âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·, âˆ‚Â²ğ’’âˆ‚Î·Â² = getâˆ‡Â²ğ’‘â‚‚(ap,Î¾)

            ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’ =  ğ’’Ì‚áµ€ğ—šâ»Â¹*ğ’’
            ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾ = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î¾
            ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î· = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î·
            ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â² = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚Â²ğ’’âˆ‚Î¾Â²
            ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î· = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·
            ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â² = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚Â²ğ’’âˆ‚Î·Â²

            âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹ğ’’ =  âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹*ğ’’
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹ğ’’ =  âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹*ğ’’
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾ = âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î¾
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾ = âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î¾
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î· = âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î·
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î· = âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î·
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â² = âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹*âˆ‚Â²ğ’’âˆ‚Î¾Â²
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â² = âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹*âˆ‚Â²ğ’’âˆ‚Î¾Â²
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î· = âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹*âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î· = âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹*âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â² = âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹*âˆ‚Â²ğ’’âˆ‚Î·Â²
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â² = âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹*âˆ‚Â²ğ’’âˆ‚Î·Â²

            âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’ = -(âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹ğ’’*nâ‚â‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹ğ’’*nâ‚‚â‚)/2/ğ´
            âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’ = -(âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹ğ’’*nâ‚â‚‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹ğ’’*nâ‚‚â‚‚)/2/ğ´
            âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾ = -(âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚‚â‚)/2/ğ´
            âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾ = -(âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚‚â‚‚)/2/ğ´
            âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î· = -(âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚â‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚)/2/ğ´
            âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î· = -(âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚â‚‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚‚)/2/ğ´
            âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²  = -(âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚‚â‚)/2/ğ´
            âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²  = -(âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚‚â‚‚)/2/ğ´
            âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î· = -(âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*nâ‚â‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*nâ‚‚â‚)/2/ğ´
            âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î· = -(âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*nâ‚â‚‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*nâ‚‚â‚‚)/2/ğ´
            âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²  = -(âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚â‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚)/2/ğ´
            âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²  = -(âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚â‚‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚‚)/2/ğ´

            qâ‚â‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚*nâ‚â‚ + 2*ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*nâ‚â‚*nâ‚‚â‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚*nâ‚‚â‚
            âˆ‚qâ‚â‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚*nâ‚â‚ + 2*âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*nâ‚â‚*nâ‚‚â‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚*nâ‚‚â‚
            âˆ‚qâ‚â‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚*nâ‚â‚ + 2*âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*nâ‚â‚*nâ‚‚â‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚*nâ‚‚â‚

            qâ‚â‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚*nâ‚â‚‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*(nâ‚â‚*nâ‚‚â‚‚+nâ‚â‚‚*nâ‚‚â‚) + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚*nâ‚‚â‚‚
            âˆ‚qâ‚â‚‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚*nâ‚â‚‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*(nâ‚â‚*nâ‚‚â‚‚+nâ‚â‚‚*nâ‚‚â‚) + âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚*nâ‚‚â‚‚
            âˆ‚qâ‚â‚‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚*nâ‚â‚‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*(nâ‚â‚*nâ‚‚â‚‚+nâ‚â‚‚*nâ‚‚â‚) + âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚*nâ‚‚â‚‚

            qâ‚‚â‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚‚*nâ‚â‚‚ + 2*ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*nâ‚â‚‚*nâ‚‚â‚‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚‚*nâ‚‚â‚‚
            âˆ‚qâ‚‚â‚‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚‚*nâ‚â‚‚ + 2*âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*nâ‚â‚‚*nâ‚‚â‚‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚‚*nâ‚‚â‚‚
            âˆ‚qâ‚‚â‚‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚‚*nâ‚â‚‚ + 2*âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*nâ‚â‚‚*nâ‚‚â‚‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚‚*nâ‚‚â‚‚

            qâ‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚
            âˆ‚qâ‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚
            âˆ‚qâ‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚
            qâ‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚‚
            âˆ‚qâ‚‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚‚
            âˆ‚qâ‚‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚‚

            qâ‚nâ‚ = 0.0;qâ‚‚nâ‚‚ = 0.0;qâ‚nâ‚‚ = 0.0;qâ‚‚nâ‚ = 0.0
            âˆ‚qâ‚âˆ‚xnâ‚ = 0.0;âˆ‚qâ‚‚âˆ‚xnâ‚‚ = 0.0;âˆ‚qâ‚âˆ‚xnâ‚‚ = 0.0;âˆ‚qâ‚‚âˆ‚xnâ‚ = 0.0
            âˆ‚qâ‚âˆ‚ynâ‚ = 0.0;âˆ‚qâ‚‚âˆ‚ynâ‚‚ = 0.0;âˆ‚qâ‚âˆ‚ynâ‚‚ = 0.0;âˆ‚qâ‚‚âˆ‚ynâ‚ = 0.0
            mnâ‚â‚nâ‚ = 0.0;mnâ‚â‚nâ‚‚ = 0.0;mnâ‚â‚‚nâ‚ = 0.0;mnâ‚â‚‚nâ‚‚ = 0.0;mnâ‚‚â‚‚nâ‚ = 0.0;mnâ‚‚â‚‚nâ‚‚ = 0.0
            âˆ‚mnâ‚â‚âˆ‚xnâ‚ = 0.0;âˆ‚mnâ‚â‚âˆ‚xnâ‚‚ = 0.0;âˆ‚mnâ‚â‚‚âˆ‚xnâ‚ = 0.0;âˆ‚mnâ‚â‚‚âˆ‚xnâ‚‚ = 0.0;âˆ‚mnâ‚‚â‚‚âˆ‚xnâ‚ = 0.0;âˆ‚mnâ‚‚â‚‚âˆ‚xnâ‚‚ = 0.0
            âˆ‚mnâ‚â‚âˆ‚ynâ‚ = 0.0;âˆ‚mnâ‚â‚âˆ‚ynâ‚‚ = 0.0;âˆ‚mnâ‚â‚‚âˆ‚ynâ‚ = 0.0;âˆ‚mnâ‚â‚‚âˆ‚ynâ‚‚ = 0.0;âˆ‚mnâ‚‚â‚‚âˆ‚ynâ‚ = 0.0;âˆ‚mnâ‚‚â‚‚âˆ‚ynâ‚‚ = 0.0
            msâ‚â‚ = 0.0;msâ‚â‚‚ = 0.0;msâ‚‚â‚‚ = 0.0
            âˆ‚msâ‚â‚âˆ‚x = 0.0;âˆ‚msâ‚â‚‚âˆ‚x = 0.0;âˆ‚msâ‚‚â‚‚âˆ‚x = 0.0
            âˆ‚msâ‚â‚âˆ‚y = 0.0;âˆ‚msâ‚â‚‚âˆ‚y = 0.0;âˆ‚msâ‚‚â‚‚âˆ‚y = 0.0
            Î”msâ‚â‚ = 0.0;Î”msâ‚â‚‚ = 0.0;Î”msâ‚‚â‚‚ = 0.0
            Î”âˆ‚msâ‚â‚âˆ‚x = 0.0;Î”âˆ‚msâ‚â‚‚âˆ‚x = 0.0;Î”âˆ‚msâ‚‚â‚‚âˆ‚x = 0.0
            Î”âˆ‚msâ‚â‚âˆ‚y = 0.0;Î”âˆ‚msâ‚â‚‚âˆ‚y = 0.0;Î”âˆ‚msâ‚‚â‚‚âˆ‚y = 0.0
            if Î¾.Î¾ == 0.0
                qâ‚nâ‚ += qâ‚*nâ‚â‚
                qâ‚nâ‚‚ += qâ‚*nâ‚â‚‚
                qâ‚‚nâ‚ += qâ‚‚*nâ‚â‚
                qâ‚‚nâ‚‚ += qâ‚‚*nâ‚â‚‚
                mnâ‚â‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚*nâ‚â‚/ğ¿â‚Â²
                mnâ‚â‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚*nâ‚â‚‚/ğ¿â‚Â²
                mnâ‚â‚‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚‚*nâ‚â‚/ğ¿â‚Â²
                mnâ‚â‚‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚‚*nâ‚â‚‚/ğ¿â‚Â²
                mnâ‚‚â‚‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚â‚‚*nâ‚â‚‚*nâ‚â‚/ğ¿â‚Â²
                mnâ‚‚â‚‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚â‚‚*nâ‚â‚‚*nâ‚â‚‚/ğ¿â‚Â²
                msâ‚â‚ += (qâ‚*sâ‚â‚+qâ‚‚*sâ‚â‚‚)*nâ‚â‚*sâ‚â‚/ğ¿â‚Â²
                msâ‚â‚‚ += (qâ‚*sâ‚â‚+qâ‚‚*sâ‚â‚‚)*0.5*(nâ‚â‚*sâ‚â‚‚+nâ‚â‚‚*sâ‚â‚)/ğ¿â‚Â²
                msâ‚‚â‚‚ += (qâ‚*sâ‚â‚+qâ‚‚*sâ‚â‚‚)*nâ‚â‚‚*sâ‚â‚‚/ğ¿â‚Â²

                âˆ‚qâ‚âˆ‚xnâ‚ += âˆ‚qâ‚âˆ‚x*nâ‚â‚
                âˆ‚qâ‚âˆ‚ynâ‚ += âˆ‚qâ‚âˆ‚y*nâ‚â‚
                âˆ‚qâ‚âˆ‚xnâ‚‚ += âˆ‚qâ‚âˆ‚x*nâ‚â‚‚
                âˆ‚qâ‚âˆ‚ynâ‚‚ += âˆ‚qâ‚âˆ‚y*nâ‚â‚‚
                âˆ‚qâ‚‚âˆ‚xnâ‚ += âˆ‚qâ‚‚âˆ‚x*nâ‚â‚
                âˆ‚qâ‚‚âˆ‚ynâ‚ += âˆ‚qâ‚‚âˆ‚y*nâ‚â‚
                âˆ‚qâ‚‚âˆ‚xnâ‚‚ += âˆ‚qâ‚‚âˆ‚x*nâ‚â‚‚
                âˆ‚qâ‚‚âˆ‚ynâ‚‚ += âˆ‚qâ‚‚âˆ‚y*nâ‚â‚‚
                âˆ‚mnâ‚â‚âˆ‚xnâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚*nâ‚â‚/ğ¿â‚Â²
                âˆ‚mnâ‚â‚âˆ‚ynâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚*nâ‚â‚/ğ¿â‚Â²
                âˆ‚mnâ‚â‚âˆ‚xnâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚*nâ‚â‚‚/ğ¿â‚Â²
                âˆ‚mnâ‚â‚âˆ‚ynâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚*nâ‚â‚‚/ğ¿â‚Â²
                âˆ‚mnâ‚â‚‚âˆ‚xnâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚‚*nâ‚â‚/ğ¿â‚Â²
                âˆ‚mnâ‚â‚‚âˆ‚ynâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚‚*nâ‚â‚/ğ¿â‚Â²
                âˆ‚mnâ‚â‚‚âˆ‚xnâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚‚*nâ‚â‚‚/ğ¿â‚Â²
                âˆ‚mnâ‚â‚‚âˆ‚ynâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚‚*nâ‚â‚‚/ğ¿â‚Â²
                âˆ‚mnâ‚‚â‚‚âˆ‚xnâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚â‚‚*nâ‚â‚‚*nâ‚â‚/ğ¿â‚Â²
                âˆ‚mnâ‚‚â‚‚âˆ‚ynâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚â‚‚*nâ‚â‚‚*nâ‚â‚/ğ¿â‚Â²
                âˆ‚mnâ‚‚â‚‚âˆ‚xnâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚â‚‚*nâ‚â‚‚*nâ‚â‚‚/ğ¿â‚Â²
                âˆ‚mnâ‚‚â‚‚âˆ‚ynâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚â‚‚*nâ‚â‚‚*nâ‚â‚‚/ğ¿â‚Â²
                âˆ‚msâ‚â‚âˆ‚x += (âˆ‚qâ‚âˆ‚x*sâ‚â‚+âˆ‚qâ‚‚âˆ‚x*sâ‚â‚‚)*nâ‚â‚*sâ‚â‚/ğ¿â‚Â²
                âˆ‚msâ‚â‚âˆ‚y += (âˆ‚qâ‚âˆ‚y*sâ‚â‚+âˆ‚qâ‚‚âˆ‚y*sâ‚â‚‚)*nâ‚â‚*sâ‚â‚/ğ¿â‚Â²
                âˆ‚msâ‚â‚‚âˆ‚x += (âˆ‚qâ‚âˆ‚x*sâ‚â‚+âˆ‚qâ‚‚âˆ‚x*sâ‚â‚‚)*0.5*(nâ‚â‚*sâ‚â‚‚+nâ‚â‚‚*sâ‚â‚)/ğ¿â‚Â²
                âˆ‚msâ‚â‚‚âˆ‚y += (âˆ‚qâ‚âˆ‚y*sâ‚â‚+âˆ‚qâ‚‚âˆ‚y*sâ‚â‚‚)*0.5*(nâ‚â‚*sâ‚â‚‚+nâ‚â‚‚*sâ‚â‚)/ğ¿â‚Â²
                âˆ‚msâ‚‚â‚‚âˆ‚x += (âˆ‚qâ‚âˆ‚x*sâ‚â‚+âˆ‚qâ‚‚âˆ‚x*sâ‚â‚‚)*nâ‚â‚‚*sâ‚â‚‚/ğ¿â‚Â²
                âˆ‚msâ‚‚â‚‚âˆ‚y += (âˆ‚qâ‚âˆ‚y*sâ‚â‚+âˆ‚qâ‚‚âˆ‚y*sâ‚â‚‚)*nâ‚â‚‚*sâ‚â‚‚/ğ¿â‚Â²
                if Î¾.Î· == 0.0
                    Î”msâ‚â‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*(nâ‚â‚*sâ‚â‚/ğ¿â‚Â²-nâ‚‚â‚*sâ‚‚â‚/ğ¿â‚‚Â²)
                    Î”msâ‚‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*(nâ‚â‚‚*sâ‚â‚‚/ğ¿â‚Â²-nâ‚‚â‚‚*sâ‚‚â‚‚/ğ¿â‚‚Â²)
                    Î”msâ‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*0.5*((nâ‚â‚*sâ‚â‚‚+nâ‚â‚‚*sâ‚â‚)/ğ¿â‚Â²-(nâ‚‚â‚*sâ‚‚â‚‚+nâ‚‚â‚‚*sâ‚‚â‚)/ğ¿â‚‚Â²)

                    Î”âˆ‚msâ‚â‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*(nâ‚â‚*sâ‚â‚/ğ¿â‚Â²-nâ‚‚â‚*sâ‚‚â‚/ğ¿â‚‚Â²)
                    Î”âˆ‚msâ‚â‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*(nâ‚â‚*sâ‚â‚/ğ¿â‚Â²-nâ‚‚â‚*sâ‚‚â‚/ğ¿â‚‚Â²)
                    Î”âˆ‚msâ‚‚â‚‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*(nâ‚â‚‚*sâ‚â‚‚/ğ¿â‚Â²-nâ‚‚â‚‚*sâ‚‚â‚‚/ğ¿â‚‚Â²)
                    Î”âˆ‚msâ‚‚â‚‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*(nâ‚â‚‚*sâ‚â‚‚/ğ¿â‚Â²-nâ‚‚â‚‚*sâ‚‚â‚‚/ğ¿â‚‚Â²)
                    Î”âˆ‚msâ‚â‚‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*0.5*((nâ‚â‚*sâ‚â‚‚+nâ‚â‚‚*sâ‚â‚)/ğ¿â‚Â²-(nâ‚‚â‚*sâ‚‚â‚‚+nâ‚‚â‚‚*sâ‚‚â‚)/ğ¿â‚‚Â²)
                    Î”âˆ‚msâ‚â‚‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*0.5*((nâ‚â‚*sâ‚â‚‚+nâ‚â‚‚*sâ‚â‚)/ğ¿â‚Â²-(nâ‚‚â‚*sâ‚‚â‚‚+nâ‚‚â‚‚*sâ‚‚â‚)/ğ¿â‚‚Â²)
                end
            end
            if  Î¾.Î· == 0.0
                qâ‚nâ‚ += qâ‚*nâ‚‚â‚
                qâ‚nâ‚‚ += qâ‚*nâ‚‚â‚‚
                qâ‚‚nâ‚ += qâ‚‚*nâ‚‚â‚
                qâ‚‚nâ‚‚ += qâ‚‚*nâ‚‚â‚‚
                mnâ‚â‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚*nâ‚‚â‚/ğ¿â‚‚Â²
                mnâ‚â‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚*nâ‚‚â‚‚/ğ¿â‚‚Â²
                mnâ‚â‚‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚‚*nâ‚‚â‚/ğ¿â‚‚Â²
                mnâ‚â‚‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚‚*nâ‚‚â‚‚/ğ¿â‚‚Â²
                mnâ‚‚â‚‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚â‚‚*nâ‚‚â‚‚*nâ‚‚â‚/ğ¿â‚‚Â²
                mnâ‚‚â‚‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚â‚‚*nâ‚‚â‚‚*nâ‚‚â‚‚/ğ¿â‚‚Â²
                msâ‚â‚ += (qâ‚*sâ‚‚â‚+qâ‚‚*sâ‚‚â‚‚)*nâ‚‚â‚*sâ‚‚â‚/ğ¿â‚‚Â²
                msâ‚â‚‚ += (qâ‚*sâ‚‚â‚+qâ‚‚*sâ‚‚â‚‚)*0.5*(nâ‚‚â‚*sâ‚‚â‚‚+nâ‚‚â‚‚*sâ‚‚â‚)/ğ¿â‚‚Â²
                msâ‚‚â‚‚ += (qâ‚*sâ‚‚â‚+qâ‚‚*sâ‚‚â‚‚)*nâ‚‚â‚‚*sâ‚‚â‚‚/ğ¿â‚‚Â²

                âˆ‚qâ‚âˆ‚xnâ‚ += âˆ‚qâ‚âˆ‚x*nâ‚‚â‚
                âˆ‚qâ‚âˆ‚ynâ‚ += âˆ‚qâ‚âˆ‚y*nâ‚‚â‚
                âˆ‚qâ‚âˆ‚xnâ‚‚ += âˆ‚qâ‚âˆ‚x*nâ‚‚â‚‚
                âˆ‚qâ‚âˆ‚ynâ‚‚ += âˆ‚qâ‚âˆ‚y*nâ‚‚â‚‚
                âˆ‚qâ‚‚âˆ‚xnâ‚ += âˆ‚qâ‚‚âˆ‚x*nâ‚‚â‚
                âˆ‚qâ‚‚âˆ‚ynâ‚ += âˆ‚qâ‚‚âˆ‚y*nâ‚‚â‚
                âˆ‚qâ‚‚âˆ‚xnâ‚‚ += âˆ‚qâ‚‚âˆ‚x*nâ‚‚â‚‚
                âˆ‚qâ‚‚âˆ‚ynâ‚‚ += âˆ‚qâ‚‚âˆ‚y*nâ‚‚â‚‚
                âˆ‚mnâ‚â‚âˆ‚xnâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚*nâ‚‚â‚/ğ¿â‚‚Â²
                âˆ‚mnâ‚â‚âˆ‚ynâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚*nâ‚‚â‚/ğ¿â‚‚Â²
                âˆ‚mnâ‚â‚âˆ‚xnâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚*nâ‚‚â‚‚/ğ¿â‚‚Â²
                âˆ‚mnâ‚â‚âˆ‚ynâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚*nâ‚‚â‚‚/ğ¿â‚‚Â²
                âˆ‚mnâ‚â‚‚âˆ‚xnâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚‚*nâ‚‚â‚/ğ¿â‚‚Â²
                âˆ‚mnâ‚â‚‚âˆ‚ynâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚‚*nâ‚‚â‚/ğ¿â‚‚Â²
                âˆ‚mnâ‚â‚‚âˆ‚xnâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚‚*nâ‚‚â‚‚/ğ¿â‚‚Â²
                âˆ‚mnâ‚â‚‚âˆ‚ynâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚‚*nâ‚‚â‚‚/ğ¿â‚‚Â²
                âˆ‚mnâ‚‚â‚‚âˆ‚xnâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚‚â‚‚*nâ‚‚â‚‚*nâ‚‚â‚/ğ¿â‚‚Â²
                âˆ‚mnâ‚‚â‚‚âˆ‚ynâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚‚â‚‚*nâ‚‚â‚‚*nâ‚‚â‚/ğ¿â‚‚Â²
                âˆ‚mnâ‚‚â‚‚âˆ‚xnâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚‚â‚‚*nâ‚‚â‚‚*nâ‚‚â‚‚/ğ¿â‚‚Â²
                âˆ‚mnâ‚‚â‚‚âˆ‚ynâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚‚â‚‚*nâ‚‚â‚‚*nâ‚‚â‚‚/ğ¿â‚‚Â²
                âˆ‚msâ‚â‚âˆ‚x += (âˆ‚qâ‚âˆ‚x*sâ‚‚â‚+âˆ‚qâ‚‚âˆ‚x*sâ‚‚â‚‚)*nâ‚‚â‚*sâ‚‚â‚/ğ¿â‚‚Â²
                âˆ‚msâ‚â‚âˆ‚y += (âˆ‚qâ‚âˆ‚y*sâ‚‚â‚+âˆ‚qâ‚‚âˆ‚y*sâ‚‚â‚‚)*nâ‚‚â‚*sâ‚‚â‚/ğ¿â‚‚Â²
                âˆ‚msâ‚â‚‚âˆ‚x += (âˆ‚qâ‚âˆ‚x*sâ‚‚â‚+âˆ‚qâ‚‚âˆ‚x*sâ‚‚â‚‚)*0.5*(nâ‚‚â‚*sâ‚‚â‚‚+nâ‚‚â‚‚*sâ‚‚â‚)/ğ¿â‚‚Â²
                âˆ‚msâ‚â‚‚âˆ‚y += (âˆ‚qâ‚âˆ‚y*sâ‚‚â‚+âˆ‚qâ‚‚âˆ‚y*sâ‚‚â‚‚)*0.5*(nâ‚‚â‚*sâ‚‚â‚‚+nâ‚‚â‚‚*sâ‚‚â‚)/ğ¿â‚‚Â²
                âˆ‚msâ‚‚â‚‚âˆ‚x += (âˆ‚qâ‚âˆ‚x*sâ‚‚â‚+âˆ‚qâ‚‚âˆ‚x*sâ‚‚â‚‚)*nâ‚‚â‚‚*sâ‚‚â‚‚/ğ¿â‚‚Â²
                âˆ‚msâ‚‚â‚‚âˆ‚y += (âˆ‚qâ‚âˆ‚y*sâ‚‚â‚+âˆ‚qâ‚‚âˆ‚y*sâ‚‚â‚‚)*nâ‚‚â‚‚*sâ‚‚â‚‚/ğ¿â‚‚Â²

                if Î¾.Î¾+Î¾.Î· â‰ˆ 1.0
                    Î”msâ‚â‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*(nâ‚‚â‚*sâ‚‚â‚/ğ¿â‚‚Â²-nâ‚ƒâ‚*sâ‚ƒâ‚/ğ¿â‚ƒÂ²)
                    Î”msâ‚‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*(nâ‚‚â‚‚*sâ‚‚â‚‚/ğ¿â‚‚Â²-nâ‚ƒâ‚‚*sâ‚ƒâ‚‚/ğ¿â‚ƒÂ²)
                    Î”msâ‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*0.5*((nâ‚‚â‚*sâ‚‚â‚‚+nâ‚‚â‚‚*sâ‚‚â‚)/ğ¿â‚‚Â²-(nâ‚ƒâ‚*sâ‚ƒâ‚‚+nâ‚ƒâ‚‚*sâ‚ƒâ‚)/ğ¿â‚ƒÂ²)

                    Î”âˆ‚msâ‚â‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*(nâ‚‚â‚*sâ‚‚â‚/ğ¿â‚‚Â²-nâ‚ƒâ‚*sâ‚ƒâ‚/ğ¿â‚ƒÂ²)
                    Î”âˆ‚msâ‚â‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*(nâ‚‚â‚*sâ‚‚â‚/ğ¿â‚‚Â²-nâ‚ƒâ‚*sâ‚ƒâ‚/ğ¿â‚ƒÂ²)
                    Î”âˆ‚msâ‚‚â‚‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*(nâ‚‚â‚‚*sâ‚‚â‚‚/ğ¿â‚‚Â²-nâ‚ƒâ‚‚*sâ‚ƒâ‚‚/ğ¿â‚ƒÂ²)
                    Î”âˆ‚msâ‚‚â‚‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*(nâ‚‚â‚‚*sâ‚‚â‚‚/ğ¿â‚‚Â²-nâ‚ƒâ‚‚*sâ‚ƒâ‚‚/ğ¿â‚ƒÂ²)
                    Î”âˆ‚msâ‚â‚‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*0.5*((nâ‚‚â‚*sâ‚‚â‚‚+nâ‚‚â‚‚*sâ‚‚â‚)/ğ¿â‚‚Â²-(nâ‚ƒâ‚*sâ‚ƒâ‚‚+nâ‚ƒâ‚‚*sâ‚ƒâ‚)/ğ¿â‚ƒÂ²)
                    Î”âˆ‚msâ‚â‚‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*0.5*((nâ‚‚â‚*sâ‚‚â‚‚+nâ‚‚â‚‚*sâ‚‚â‚)/ğ¿â‚‚Â²-(nâ‚ƒâ‚*sâ‚ƒâ‚‚+nâ‚ƒâ‚‚*sâ‚ƒâ‚)/ğ¿â‚ƒÂ²)
                end
            end
            if Î¾.Î¾+Î¾.Î· â‰ˆ 1.0
                qâ‚nâ‚ += qâ‚*nâ‚ƒâ‚
                qâ‚nâ‚‚ += qâ‚*nâ‚ƒâ‚‚
                qâ‚‚nâ‚ += qâ‚‚*nâ‚ƒâ‚
                qâ‚‚nâ‚‚ += qâ‚‚*nâ‚ƒâ‚‚
                mnâ‚â‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚*nâ‚ƒâ‚/ğ¿â‚ƒÂ²
                mnâ‚â‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚*nâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                mnâ‚â‚‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚/ğ¿â‚ƒÂ²
                mnâ‚â‚‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                mnâ‚‚â‚‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚/ğ¿â‚ƒÂ²
                mnâ‚‚â‚‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                msâ‚â‚ += (qâ‚*sâ‚ƒâ‚+qâ‚‚*sâ‚ƒâ‚‚)*nâ‚ƒâ‚*sâ‚ƒâ‚/ğ¿â‚ƒÂ²
                msâ‚â‚‚ += (qâ‚*sâ‚ƒâ‚+qâ‚‚*sâ‚ƒâ‚‚)*0.5*(nâ‚ƒâ‚*sâ‚ƒâ‚‚+nâ‚ƒâ‚‚*sâ‚ƒâ‚)/ğ¿â‚ƒÂ²
                msâ‚‚â‚‚ += (qâ‚*sâ‚ƒâ‚+qâ‚‚*sâ‚ƒâ‚‚)*nâ‚ƒâ‚‚*sâ‚ƒâ‚‚/ğ¿â‚ƒÂ²

                âˆ‚qâ‚âˆ‚xnâ‚ += âˆ‚qâ‚âˆ‚x*nâ‚ƒâ‚
                âˆ‚qâ‚âˆ‚ynâ‚ += âˆ‚qâ‚âˆ‚y*nâ‚ƒâ‚
                âˆ‚qâ‚âˆ‚xnâ‚‚ += âˆ‚qâ‚âˆ‚x*nâ‚ƒâ‚‚
                âˆ‚qâ‚âˆ‚ynâ‚‚ += âˆ‚qâ‚âˆ‚y*nâ‚ƒâ‚‚
                âˆ‚qâ‚‚âˆ‚xnâ‚ += âˆ‚qâ‚‚âˆ‚x*nâ‚ƒâ‚
                âˆ‚qâ‚‚âˆ‚ynâ‚ += âˆ‚qâ‚‚âˆ‚y*nâ‚ƒâ‚
                âˆ‚qâ‚‚âˆ‚xnâ‚‚ += âˆ‚qâ‚‚âˆ‚x*nâ‚ƒâ‚‚
                âˆ‚qâ‚‚âˆ‚ynâ‚‚ += âˆ‚qâ‚‚âˆ‚y*nâ‚ƒâ‚‚
                âˆ‚mnâ‚â‚âˆ‚xnâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚*nâ‚ƒâ‚/ğ¿â‚ƒÂ²
                âˆ‚mnâ‚â‚âˆ‚ynâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚*nâ‚ƒâ‚/ğ¿â‚ƒÂ²
                âˆ‚mnâ‚â‚âˆ‚xnâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚*nâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                âˆ‚mnâ‚â‚âˆ‚ynâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚*nâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                âˆ‚mnâ‚â‚‚âˆ‚xnâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚/ğ¿â‚ƒÂ²
                âˆ‚mnâ‚â‚‚âˆ‚ynâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚/ğ¿â‚ƒÂ²
                âˆ‚mnâ‚â‚‚âˆ‚xnâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                âˆ‚mnâ‚â‚‚âˆ‚ynâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                âˆ‚mnâ‚‚â‚‚âˆ‚xnâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚/ğ¿â‚ƒÂ²
                âˆ‚mnâ‚‚â‚‚âˆ‚ynâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚/ğ¿â‚ƒÂ²
                âˆ‚mnâ‚‚â‚‚âˆ‚xnâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                âˆ‚mnâ‚‚â‚‚âˆ‚ynâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                âˆ‚msâ‚â‚âˆ‚x += (âˆ‚qâ‚âˆ‚x*sâ‚ƒâ‚+âˆ‚qâ‚‚âˆ‚x*sâ‚ƒâ‚‚)*nâ‚ƒâ‚*sâ‚ƒâ‚/ğ¿â‚ƒÂ²
                âˆ‚msâ‚â‚âˆ‚y += (âˆ‚qâ‚âˆ‚y*sâ‚ƒâ‚+âˆ‚qâ‚‚âˆ‚y*sâ‚ƒâ‚‚)*nâ‚ƒâ‚*sâ‚ƒâ‚/ğ¿â‚ƒÂ²
                âˆ‚msâ‚â‚‚âˆ‚x += (âˆ‚qâ‚âˆ‚x*sâ‚ƒâ‚+âˆ‚qâ‚‚âˆ‚x*sâ‚ƒâ‚‚)*0.5*(nâ‚ƒâ‚*sâ‚ƒâ‚‚+nâ‚ƒâ‚‚*sâ‚ƒâ‚)/ğ¿â‚ƒÂ²
                âˆ‚msâ‚â‚‚âˆ‚y += (âˆ‚qâ‚âˆ‚y*sâ‚ƒâ‚+âˆ‚qâ‚‚âˆ‚y*sâ‚ƒâ‚‚)*0.5*(nâ‚ƒâ‚*sâ‚ƒâ‚‚+nâ‚ƒâ‚‚*sâ‚ƒâ‚)/ğ¿â‚ƒÂ²
                âˆ‚msâ‚‚â‚‚âˆ‚x += (âˆ‚qâ‚âˆ‚x*sâ‚ƒâ‚+âˆ‚qâ‚‚âˆ‚x*sâ‚ƒâ‚‚)*nâ‚ƒâ‚‚*sâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                âˆ‚msâ‚‚â‚‚âˆ‚y += (âˆ‚qâ‚âˆ‚y*sâ‚ƒâ‚+âˆ‚qâ‚‚âˆ‚y*sâ‚ƒâ‚‚)*nâ‚ƒâ‚‚*sâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                if Î¾.Î¾ == 0.0
                    Î”msâ‚â‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*(nâ‚ƒâ‚*sâ‚ƒâ‚/ğ¿â‚ƒÂ²-nâ‚â‚*sâ‚â‚/ğ¿â‚Â²)
                    Î”msâ‚‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*(nâ‚ƒâ‚‚*sâ‚ƒâ‚‚/ğ¿â‚ƒÂ²-nâ‚â‚‚*sâ‚â‚‚/ğ¿â‚Â²)
                    Î”msâ‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*0.5*((nâ‚ƒâ‚*sâ‚ƒâ‚‚+nâ‚ƒâ‚‚*sâ‚ƒâ‚)/ğ¿â‚ƒÂ²-(nâ‚â‚*sâ‚â‚‚+nâ‚â‚‚*sâ‚â‚)/ğ¿â‚Â²)

                    Î”âˆ‚msâ‚â‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*(nâ‚ƒâ‚*sâ‚ƒâ‚/ğ¿â‚ƒÂ²-nâ‚â‚*sâ‚â‚/ğ¿â‚Â²)
                    Î”âˆ‚msâ‚â‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*(nâ‚ƒâ‚*sâ‚ƒâ‚/ğ¿â‚ƒÂ²-nâ‚â‚*sâ‚â‚/ğ¿â‚Â²)
                    Î”âˆ‚msâ‚‚â‚‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*(nâ‚ƒâ‚‚*sâ‚ƒâ‚‚/ğ¿â‚ƒÂ²-nâ‚â‚‚*sâ‚â‚‚/ğ¿â‚Â²)
                    Î”âˆ‚msâ‚‚â‚‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*(nâ‚ƒâ‚‚*sâ‚ƒâ‚‚/ğ¿â‚ƒÂ²-nâ‚â‚‚*sâ‚â‚‚/ğ¿â‚Â²)
                    Î”âˆ‚msâ‚â‚‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*0.5*((nâ‚ƒâ‚*sâ‚ƒâ‚‚+nâ‚ƒâ‚‚*sâ‚ƒâ‚)/ğ¿â‚ƒÂ²-(nâ‚â‚*sâ‚â‚‚+nâ‚â‚‚*sâ‚â‚)/ğ¿â‚Â²)
                    Î”âˆ‚msâ‚â‚‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*0.5*((nâ‚ƒâ‚*sâ‚ƒâ‚‚+nâ‚ƒâ‚‚*sâ‚ƒâ‚)/ğ¿â‚ƒÂ²-(nâ‚â‚*sâ‚â‚‚+nâ‚â‚‚*sâ‚â‚)/ğ¿â‚Â²)
                end
            end

            Wâ‚â‚â‚ = mnâ‚â‚nâ‚*wáµ‡
            Wâ‚â‚â‚‚ = mnâ‚â‚nâ‚‚*wáµ‡
            Wâ‚â‚‚â‚ = mnâ‚â‚‚nâ‚*wáµ‡
            Wâ‚â‚‚â‚‚ = mnâ‚â‚‚nâ‚‚*wáµ‡
            Wâ‚‚â‚‚â‚ = mnâ‚‚â‚‚nâ‚*wáµ‡
            Wâ‚‚â‚‚â‚‚ = mnâ‚‚â‚‚nâ‚‚*wáµ‡
            Wâ‚â‚ = (qâ‚â‚*w + 2*(qâ‚nâ‚+msâ‚â‚)*wáµ‡)/4/ğ´ + Î”msâ‚â‚
            Wâ‚â‚‚ = (qâ‚â‚‚*w + (qâ‚nâ‚‚+qâ‚‚nâ‚+2*msâ‚â‚‚)*wáµ‡)/4/ğ´ + Î”msâ‚â‚‚
            Wâ‚‚â‚‚ = (qâ‚‚â‚‚*w + 2*(qâ‚‚nâ‚‚+msâ‚‚â‚‚)*wáµ‡)/4/ğ´ + Î”msâ‚‚â‚‚

            âˆ‚Wâ‚â‚â‚âˆ‚x = âˆ‚mnâ‚â‚âˆ‚xnâ‚*wáµ‡
            âˆ‚Wâ‚â‚â‚âˆ‚y = âˆ‚mnâ‚â‚âˆ‚ynâ‚*wáµ‡
            âˆ‚Wâ‚â‚â‚‚âˆ‚x = âˆ‚mnâ‚â‚âˆ‚xnâ‚‚*wáµ‡
            âˆ‚Wâ‚â‚â‚‚âˆ‚y = âˆ‚mnâ‚â‚âˆ‚ynâ‚‚*wáµ‡
            âˆ‚Wâ‚â‚‚â‚âˆ‚x = âˆ‚mnâ‚â‚‚âˆ‚xnâ‚*wáµ‡
            âˆ‚Wâ‚â‚‚â‚âˆ‚y = âˆ‚mnâ‚â‚‚âˆ‚ynâ‚*wáµ‡
            âˆ‚Wâ‚â‚‚â‚‚âˆ‚x = âˆ‚mnâ‚â‚‚âˆ‚xnâ‚‚*wáµ‡
            âˆ‚Wâ‚â‚‚â‚‚âˆ‚y = âˆ‚mnâ‚â‚‚âˆ‚ynâ‚‚*wáµ‡
            âˆ‚Wâ‚‚â‚‚â‚âˆ‚x = âˆ‚mnâ‚‚â‚‚âˆ‚xnâ‚*wáµ‡
            âˆ‚Wâ‚‚â‚‚â‚âˆ‚y = âˆ‚mnâ‚‚â‚‚âˆ‚ynâ‚*wáµ‡
            âˆ‚Wâ‚‚â‚‚â‚‚âˆ‚x = âˆ‚mnâ‚‚â‚‚âˆ‚xnâ‚‚*wáµ‡
            âˆ‚Wâ‚‚â‚‚â‚‚âˆ‚y = âˆ‚mnâ‚‚â‚‚âˆ‚ynâ‚‚*wáµ‡
            âˆ‚Wâ‚â‚âˆ‚x = (âˆ‚qâ‚â‚âˆ‚x*w + 2*(âˆ‚qâ‚âˆ‚xnâ‚+âˆ‚msâ‚â‚âˆ‚x)*wáµ‡)/4/ğ´ + Î”âˆ‚msâ‚â‚âˆ‚x
            âˆ‚Wâ‚â‚âˆ‚y = (âˆ‚qâ‚â‚âˆ‚y*w + 2*(âˆ‚qâ‚âˆ‚ynâ‚+âˆ‚msâ‚â‚âˆ‚y)*wáµ‡)/4/ğ´ + Î”âˆ‚msâ‚â‚âˆ‚y
            âˆ‚Wâ‚â‚‚âˆ‚x = (âˆ‚qâ‚â‚‚âˆ‚x*w + (âˆ‚qâ‚âˆ‚xnâ‚‚+âˆ‚qâ‚‚âˆ‚xnâ‚+2*âˆ‚msâ‚â‚‚âˆ‚x)*wáµ‡)/4/ğ´ + Î”âˆ‚msâ‚â‚‚âˆ‚x
            âˆ‚Wâ‚â‚‚âˆ‚y = (âˆ‚qâ‚â‚‚âˆ‚y*w + (âˆ‚qâ‚âˆ‚ynâ‚‚+âˆ‚qâ‚‚âˆ‚ynâ‚+2*âˆ‚msâ‚â‚‚âˆ‚y)*wáµ‡)/4/ğ´ + Î”âˆ‚msâ‚â‚‚âˆ‚y
            âˆ‚Wâ‚‚â‚‚âˆ‚x = (âˆ‚qâ‚‚â‚‚âˆ‚x*w + 2*(âˆ‚qâ‚‚âˆ‚xnâ‚‚+âˆ‚msâ‚‚â‚‚âˆ‚x)*wáµ‡)/4/ğ´ + Î”âˆ‚msâ‚‚â‚‚âˆ‚x
            âˆ‚Wâ‚‚â‚‚âˆ‚y = (âˆ‚qâ‚‚â‚‚âˆ‚y*w + 2*(âˆ‚qâ‚‚âˆ‚ynâ‚‚+âˆ‚msâ‚‚â‚‚âˆ‚y)*wáµ‡)/4/ğ´ + Î”âˆ‚msâ‚‚â‚‚âˆ‚y
            for i in 1:length(ğ“’)
                âˆ‚Â²ğ­âˆ‚xÂ²[i] += ğ­[i]*Wâ‚â‚ + âˆ‚ğ­âˆ‚x[i]*Wâ‚â‚â‚ + âˆ‚ğ­âˆ‚y[i]*Wâ‚â‚â‚‚
                âˆ‚Â²ğ­âˆ‚xâˆ‚y[i] += ğ­[i]*Wâ‚â‚‚ + âˆ‚ğ­âˆ‚x[i]*Wâ‚â‚‚â‚ + âˆ‚ğ­âˆ‚y[i]*Wâ‚â‚‚â‚‚
                âˆ‚Â²ğ­âˆ‚yÂ²[i] += ğ­[i]*Wâ‚‚â‚‚ + âˆ‚ğ­âˆ‚x[i]*Wâ‚‚â‚‚â‚ + âˆ‚ğ­âˆ‚y[i]*Wâ‚‚â‚‚â‚‚
                âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚x[i] += ğ­[i]*âˆ‚Wâ‚â‚âˆ‚x + âˆ‚ğ­âˆ‚x[i]*âˆ‚Wâ‚â‚â‚âˆ‚x + âˆ‚ğ­âˆ‚y[i]*âˆ‚Wâ‚â‚â‚‚âˆ‚x
                âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚y[i] += ğ­[i]*âˆ‚Wâ‚â‚âˆ‚y + âˆ‚ğ­âˆ‚x[i]*âˆ‚Wâ‚â‚â‚âˆ‚y + âˆ‚ğ­âˆ‚y[i]*âˆ‚Wâ‚â‚â‚‚âˆ‚y
                âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚x[i] += ğ­[i]*âˆ‚Wâ‚â‚‚âˆ‚x + âˆ‚ğ­âˆ‚x[i]*âˆ‚Wâ‚â‚‚â‚âˆ‚x + âˆ‚ğ­âˆ‚y[i]*âˆ‚Wâ‚â‚‚â‚‚âˆ‚x
                âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚y[i] += ğ­[i]*âˆ‚Wâ‚â‚‚âˆ‚y + âˆ‚ğ­âˆ‚x[i]*âˆ‚Wâ‚â‚‚â‚âˆ‚y + âˆ‚ğ­âˆ‚y[i]*âˆ‚Wâ‚â‚‚â‚‚âˆ‚y
                âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚x[i] += ğ­[i]*âˆ‚Wâ‚‚â‚‚âˆ‚x + âˆ‚ğ­âˆ‚x[i]*âˆ‚Wâ‚‚â‚‚â‚âˆ‚x + âˆ‚ğ­âˆ‚y[i]*âˆ‚Wâ‚‚â‚‚â‚‚âˆ‚x
                âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚y[i] += ğ­[i]*âˆ‚Wâ‚‚â‚‚âˆ‚y + âˆ‚ğ­âˆ‚x[i]*âˆ‚Wâ‚‚â‚‚â‚âˆ‚y + âˆ‚ğ­âˆ‚y[i]*âˆ‚Wâ‚‚â‚‚â‚‚âˆ‚y
            end
        end
    end
end

function setâˆ‡Ì„ğ­!(ap::ReproducingKernel{ğ’‘,ğ‘ ,ğœ™,:Seg2}) where {ğ’‘,ğ‘ ,ğœ™}
    ğ“’ = ap.ğ“’
    ğ“– = ap.ğ“–
    for Î¾Ì‚ in ğ“–
        ğ’’Ì‚ = getğ’‘â‚(ap,Î¾Ì‚)
        ğ—šâ»Â¹ = calğ—š!(ap)
        ğ’’Ì‚áµ€ğ—šâ»Â¹ = ğ’’Ì‚*ğ—šâ»Â¹
        âˆ‚ğ­âˆ‚x = Î¾Ì‚[:âˆ‚ğ­âˆ‚x_]
        fill!(âˆ‚ğ­âˆ‚x,0.0)
        for Î¾ in ap.ğ“–
            w = Î¾.w
            n = Î¾.nâ‚
            ğ­ = Î¾[:ğ­]
            ğ’’ = getğ’‘â‚(ap,Î¾)
            Wâ‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹*ğ’’*n*w
            for i in 1:length(ğ“’)
                âˆ‚ğ­âˆ‚x[i] += ğ­[i]*Wâ‚
            end
        end
    end
end

function setâˆ‡Ì„ğ­!(ap::ReproducingKernel{ğ’‘,ğ‘ ,ğœ™,:Tri3}) where {ğ’‘,ğ‘ ,ğœ™}
    ğ“’ = ap.ğ“’
    ğ“– = ap.ğ“–
    for Î¾Ì‚ in ğ“–
        ğ’’Ì‚ = getğ’‘â‚(ap,Î¾Ì‚)
        ğ—šâ»Â¹ = calğ—š!(ap)
        ğ’’Ì‚áµ€ğ—šâ»Â¹ = ğ’’Ì‚*ğ—šâ»Â¹
        âˆ‚ğ­âˆ‚x = Î¾Ì‚[:âˆ‚ğ­âˆ‚x_]
        âˆ‚ğ­âˆ‚y = Î¾Ì‚[:âˆ‚ğ­âˆ‚y_]
        for i in 1:length(ğ“’)
            âˆ‚ğ­âˆ‚x[i] = 0.0
            âˆ‚ğ­âˆ‚y[i] = 0.0
        end
        for Î¾ in ap.ğ“–
            w = Î¾.w
            nâ‚ = Î¾.nâ‚
            nâ‚‚ = Î¾.nâ‚‚
            ğ­ = Î¾[:ğ­]
            ğ’’ = getğ’‘â‚(ap,Î¾)
            ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’ = ğ’’Ì‚áµ€ğ—šâ»Â¹*ğ’’
            Wâ‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚*w
            Wâ‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚*w
            for i in 1:length(ğ“’)
                âˆ‚ğ­âˆ‚x[i] += ğ­[i]*Wâ‚
                âˆ‚ğ­âˆ‚y[i] += ğ­[i]*Wâ‚‚
            end
        end
    end
end

function setâˆ‡âˆ‡Ì„Â²ğ­!(ap::ReproducingKernel{ğ’‘,ğ‘ ,ğœ™,:Tri3};Î“áµ::Union{ReproducingKernel{ğ’‘,ğ‘ ,ğœ™,:Tri3},Nothing}=nothing,Î“á¶¿::Union{ReproducingKernel{ğ’‘,ğ‘ ,ğœ™,:Tri3},Nothing}=nothing,Î“á´¾::Vector{ReproducingKernel{ğ’‘,ğ‘ ,ğœ™,:Tri3}}=[]) where {ğ’‘,ğ‘ ,ğœ™}
    xâ‚ = ap.ğ“’[1].x;yâ‚ = ap.ğ“’[1].y
    xâ‚‚ = ap.ğ“’[2].x;yâ‚‚ = ap.ğ“’[2].y
    xâ‚ƒ = ap.ğ“’[3].x;yâ‚ƒ = ap.ğ“’[3].y
    ğ´ = getğ´(ap)
    nâ‚â‚ = yâ‚ƒ-yâ‚‚;nâ‚‚â‚ = yâ‚-yâ‚ƒ;nâ‚ƒâ‚ = yâ‚‚-yâ‚
    nâ‚â‚‚ = xâ‚‚-xâ‚ƒ;nâ‚‚â‚‚ = xâ‚ƒ-xâ‚;nâ‚ƒâ‚‚ = xâ‚-xâ‚‚
    ğ“’ = ap.ğ“’
    ğ“– = ap.ğ“–
    for Î¾Ì‚ in ğ“–
        ğ’’Ì‚,âˆ‚ğ’’Ì‚âˆ‚Î¾,âˆ‚ğ’’Ì‚âˆ‚Î· = getâˆ‡ğ’‘â‚‚(ap,Î¾Ì‚)
        ğ—šâ»Â¹,ğ—šâ»Â¹âˆ‚Î¾,ğ—šâ»Â¹âˆ‚Î· = calâˆ‡ğ—šâ‚‚!(ap)
        ğ’’Ì‚áµ€ğ—šâ»Â¹ = ğ’’Ì‚*ğ—šâ»Â¹
        âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹ = âˆ‚ğ’’Ì‚âˆ‚Î¾*ğ—šâ»Â¹âˆ‚Î¾
        âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹ = âˆ‚ğ’’Ì‚âˆ‚Î·*ğ—šâ»Â¹âˆ‚Î·

        âˆ‚Â²ğ­âˆ‚xÂ² = Î¾Ì‚[:âˆ‚Â²ğ­âˆ‚xÂ²_]
        âˆ‚Â²ğ­âˆ‚xâˆ‚y = Î¾Ì‚[:âˆ‚Â²ğ­âˆ‚xâˆ‚y_]
        âˆ‚Â²ğ­âˆ‚yÂ² = Î¾Ì‚[:âˆ‚Â²ğ­âˆ‚yÂ²_]
        âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚x = Î¾Ì‚[:âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚x_]
        âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚y = Î¾Ì‚[:âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚y_]
        âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚x = Î¾Ì‚[:âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚x_]
        âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚y = Î¾Ì‚[:âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚y_]
        âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚x = Î¾Ì‚[:âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚x_]
        âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚y = Î¾Ì‚[:âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚y_]
        for i in 1:length(ğ“’)
            âˆ‚Â²ğ­âˆ‚xÂ²[i] = 0.0
            âˆ‚Â²ğ­âˆ‚xâˆ‚y[i] = 0.0
            âˆ‚Â²ğ­âˆ‚yÂ²[i] = 0.0
            âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚x[i] = 0.0
            âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚y[i] = 0.0
            âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚x[i] = 0.0
            âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚y[i] = 0.0
            âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚x[i] = 0.0
            âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚y[i] = 0.0
        end
        if Î“áµ â‰  nothing
            for Î¾ in Î“áµ.ğ“–
                ğ‘¤ = Î¾.ğ‘¤
                nâ‚ = Î¾.nâ‚
                nâ‚‚ = Î¾.nâ‚‚
                sâ‚ = -nâ‚‚
                sâ‚‚ = nâ‚
                ğ­ = Î¾[:ğ­]
                ğ’’, âˆ‚ğ’’âˆ‚Î¾, âˆ‚ğ’’âˆ‚Î· = getâˆ‡Â²ğ’‘â‚‚(Î“áµ,Î¾)

                ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’ =  ğ’’Ì‚áµ€ğ—šâ»Â¹*ğ’’
                ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾ = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î¾
                ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î· = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î·

                âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹ğ’’ =  âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹*ğ’’
                âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹ğ’’ =  âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹*ğ’’
                âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾ = âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î¾
                âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾ = âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î¾
                âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î· = âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î·
                âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î· = âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î·

                âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾ = -(âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚‚â‚)/2/ğ´
                âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾ = -(âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚‚â‚‚)/2/ğ´
                âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î· = -(âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚â‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚)/2/ğ´
                âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î· = -(âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚â‚‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚‚)/2/ğ´

                qâ‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚
                âˆ‚qâ‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚
                âˆ‚qâ‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚
                qâ‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚‚
                âˆ‚qâ‚‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚‚
                âˆ‚qâ‚‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚‚

                qâ‚nâ‚ = qâ‚*nâ‚
                qâ‚nâ‚‚ = qâ‚*nâ‚‚
                qâ‚‚nâ‚ = qâ‚‚*nâ‚
                qâ‚‚nâ‚‚ = qâ‚‚*nâ‚‚
                msâ‚â‚ = (qâ‚*sâ‚+qâ‚‚*sâ‚‚)*nâ‚*sâ‚
                msâ‚â‚‚ = (qâ‚*sâ‚+qâ‚‚*sâ‚‚)*0.5*(nâ‚*sâ‚‚+nâ‚‚*sâ‚)
                msâ‚‚â‚‚ = (qâ‚*sâ‚+qâ‚‚*sâ‚‚)*nâ‚‚*sâ‚‚

                âˆ‚qâ‚âˆ‚xnâ‚ = âˆ‚qâ‚âˆ‚x*nâ‚
                âˆ‚qâ‚âˆ‚ynâ‚ = âˆ‚qâ‚âˆ‚y*nâ‚
                âˆ‚qâ‚âˆ‚xnâ‚‚ = âˆ‚qâ‚âˆ‚x*nâ‚‚
                âˆ‚qâ‚âˆ‚ynâ‚‚ = âˆ‚qâ‚âˆ‚y*nâ‚‚
                âˆ‚qâ‚‚âˆ‚xnâ‚ = âˆ‚qâ‚‚âˆ‚x*nâ‚
                âˆ‚qâ‚‚âˆ‚ynâ‚ = âˆ‚qâ‚‚âˆ‚y*nâ‚
                âˆ‚qâ‚‚âˆ‚xnâ‚‚ = âˆ‚qâ‚‚âˆ‚x*nâ‚‚
                âˆ‚qâ‚‚âˆ‚ynâ‚‚ = âˆ‚qâ‚‚âˆ‚y*nâ‚‚
                âˆ‚msâ‚â‚âˆ‚x = (âˆ‚qâ‚âˆ‚x*sâ‚+âˆ‚qâ‚‚âˆ‚x*sâ‚‚)*nâ‚*sâ‚
                âˆ‚msâ‚â‚âˆ‚y = (âˆ‚qâ‚âˆ‚y*sâ‚+âˆ‚qâ‚‚âˆ‚y*sâ‚‚)*nâ‚*sâ‚
                âˆ‚msâ‚â‚‚âˆ‚x = (âˆ‚qâ‚âˆ‚x*sâ‚+âˆ‚qâ‚‚âˆ‚x*sâ‚‚)*0.5*(nâ‚*sâ‚‚+nâ‚‚*sâ‚)
                âˆ‚msâ‚â‚‚âˆ‚y = (âˆ‚qâ‚âˆ‚y*sâ‚+âˆ‚qâ‚‚âˆ‚y*sâ‚‚)*0.5*(nâ‚*sâ‚‚+nâ‚‚*sâ‚)
                âˆ‚msâ‚‚â‚‚âˆ‚x = (âˆ‚qâ‚âˆ‚x*sâ‚+âˆ‚qâ‚‚âˆ‚x*sâ‚‚)*nâ‚‚*sâ‚‚
                âˆ‚msâ‚‚â‚‚âˆ‚y = (âˆ‚qâ‚âˆ‚y*sâ‚+âˆ‚qâ‚‚âˆ‚y*sâ‚‚)*nâ‚‚*sâ‚‚

                Wâ‚â‚ = (qâ‚nâ‚+msâ‚â‚)*ğ‘¤/2/ğ´
                Wâ‚â‚‚ = (qâ‚nâ‚‚+qâ‚‚nâ‚+2*msâ‚â‚‚)*ğ‘¤/4/ğ´
                Wâ‚‚â‚‚ = (qâ‚‚nâ‚‚+msâ‚‚â‚‚)*ğ‘¤/2/ğ´
                âˆ‚Wâ‚â‚âˆ‚x = (âˆ‚qâ‚âˆ‚xnâ‚+âˆ‚msâ‚â‚âˆ‚x)*ğ‘¤/2/ğ´
                âˆ‚Wâ‚â‚âˆ‚y = (âˆ‚qâ‚âˆ‚ynâ‚+âˆ‚msâ‚â‚âˆ‚y)*ğ‘¤/2/ğ´
                âˆ‚Wâ‚â‚‚âˆ‚x = (âˆ‚qâ‚âˆ‚xnâ‚‚+âˆ‚qâ‚‚âˆ‚xnâ‚+2*âˆ‚msâ‚â‚‚âˆ‚x)*ğ‘¤/4/ğ´
                âˆ‚Wâ‚â‚‚âˆ‚y = (âˆ‚qâ‚âˆ‚ynâ‚‚+âˆ‚qâ‚‚âˆ‚ynâ‚+2*âˆ‚msâ‚â‚‚âˆ‚y)*ğ‘¤/4/ğ´
                âˆ‚Wâ‚‚â‚‚âˆ‚x = (âˆ‚qâ‚‚âˆ‚xnâ‚‚+âˆ‚msâ‚‚â‚‚âˆ‚x)*ğ‘¤/2/ğ´
                âˆ‚Wâ‚‚â‚‚âˆ‚y = (âˆ‚qâ‚‚âˆ‚ynâ‚‚+âˆ‚msâ‚‚â‚‚âˆ‚y)*ğ‘¤/2/ğ´
                for i in 1:length(ğ“’)
                    âˆ‚Â²ğ­âˆ‚xÂ²[i] += ğ­[i]*Wâ‚â‚
                    âˆ‚Â²ğ­âˆ‚xâˆ‚y[i] += ğ­[i]*Wâ‚â‚‚
                    âˆ‚Â²ğ­âˆ‚yÂ²[i] += ğ­[i]*Wâ‚‚â‚‚
                    âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚x[i] += ğ­[i]*âˆ‚Wâ‚â‚âˆ‚x
                    âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚y[i] += ğ­[i]*âˆ‚Wâ‚â‚âˆ‚y
                    âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚x[i] += ğ­[i]*âˆ‚Wâ‚â‚‚âˆ‚x
                    âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚y[i] += ğ­[i]*âˆ‚Wâ‚â‚‚âˆ‚y
                    âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚x[i] += ğ­[i]*âˆ‚Wâ‚‚â‚‚âˆ‚x
                    âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚y[i] += ğ­[i]*âˆ‚Wâ‚‚â‚‚âˆ‚y
                end
            end
        end

        if Î“á¶¿ â‰  nothing
            for Î¾ in Î“á¶¿.ğ“–
                ğ‘¤ = Î¾.ğ‘¤
                nâ‚ = Î¾.nâ‚
                nâ‚‚ = Î¾.nâ‚‚
                sâ‚ = Î¾.sâ‚
                sâ‚‚ = Î¾.sâ‚‚
                âˆ‚ğ­âˆ‚x = Î¾[:âˆ‚ğ­âˆ‚x]
                âˆ‚ğ­âˆ‚y = Î¾[:âˆ‚ğ­âˆ‚y]
                ğ’’ = getğ’‘â‚‚(Î“á¶¿,Î¾)

                ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’ =  ğ’’Ì‚áµ€ğ—šâ»Â¹*ğ’’
                âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹ğ’’ =  âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹*ğ’’
                âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹ğ’’ =  âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹*ğ’’

                âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’ = -(âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹ğ’’*nâ‚â‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹ğ’’*nâ‚‚â‚)/2/ğ´
                âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’ = -(âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹ğ’’*nâ‚â‚‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹ğ’’*nâ‚‚â‚‚)/2/ğ´

                mnâ‚â‚nâ‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚*nâ‚*nâ‚
                mnâ‚â‚nâ‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚*nâ‚*nâ‚‚
                mnâ‚â‚‚nâ‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚*nâ‚‚*nâ‚
                mnâ‚â‚‚nâ‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚*nâ‚‚*nâ‚‚
                mnâ‚‚â‚‚nâ‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚*nâ‚‚*nâ‚
                mnâ‚‚â‚‚nâ‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚*nâ‚‚*nâ‚‚

                âˆ‚mnâ‚â‚âˆ‚xnâ‚ = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚*nâ‚*nâ‚
                âˆ‚mnâ‚â‚âˆ‚ynâ‚ = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚*nâ‚*nâ‚
                âˆ‚mnâ‚â‚âˆ‚xnâ‚‚ = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚*nâ‚*nâ‚‚
                âˆ‚mnâ‚â‚âˆ‚ynâ‚‚ = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚*nâ‚*nâ‚‚
                âˆ‚mnâ‚â‚‚âˆ‚xnâ‚ = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚*nâ‚‚*nâ‚
                âˆ‚mnâ‚â‚‚âˆ‚ynâ‚ = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚*nâ‚‚*nâ‚
                âˆ‚mnâ‚â‚‚âˆ‚xnâ‚‚ = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚*nâ‚‚*nâ‚‚
                âˆ‚mnâ‚â‚‚âˆ‚ynâ‚‚ = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚*nâ‚‚*nâ‚‚
                âˆ‚mnâ‚‚â‚‚âˆ‚xnâ‚ = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚‚*nâ‚‚*nâ‚
                âˆ‚mnâ‚‚â‚‚âˆ‚ynâ‚ = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚‚*nâ‚‚*nâ‚
                âˆ‚mnâ‚‚â‚‚âˆ‚xnâ‚‚ = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚‚*nâ‚‚*nâ‚‚
                âˆ‚mnâ‚‚â‚‚âˆ‚ynâ‚‚ = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚‚*nâ‚‚*nâ‚‚

                Wâ‚â‚â‚ = mnâ‚â‚nâ‚*ğ‘¤
                Wâ‚â‚â‚‚ = mnâ‚â‚nâ‚‚*ğ‘¤
                Wâ‚â‚‚â‚ = mnâ‚â‚‚nâ‚*ğ‘¤
                Wâ‚â‚‚â‚‚ = mnâ‚â‚‚nâ‚‚*ğ‘¤
                Wâ‚‚â‚‚â‚ = mnâ‚‚â‚‚nâ‚*ğ‘¤
                Wâ‚‚â‚‚â‚‚ = mnâ‚‚â‚‚nâ‚‚*ğ‘¤

                âˆ‚Wâ‚â‚â‚âˆ‚x = âˆ‚mnâ‚â‚âˆ‚xnâ‚*ğ‘¤
                âˆ‚Wâ‚â‚â‚âˆ‚y = âˆ‚mnâ‚â‚âˆ‚ynâ‚*ğ‘¤
                âˆ‚Wâ‚â‚â‚‚âˆ‚x = âˆ‚mnâ‚â‚âˆ‚xnâ‚‚*ğ‘¤
                âˆ‚Wâ‚â‚â‚‚âˆ‚y = âˆ‚mnâ‚â‚âˆ‚ynâ‚‚*ğ‘¤
                âˆ‚Wâ‚â‚‚â‚âˆ‚x = âˆ‚mnâ‚â‚‚âˆ‚xnâ‚*ğ‘¤
                âˆ‚Wâ‚â‚‚â‚âˆ‚y = âˆ‚mnâ‚â‚‚âˆ‚ynâ‚*ğ‘¤
                âˆ‚Wâ‚â‚‚â‚‚âˆ‚x = âˆ‚mnâ‚â‚‚âˆ‚xnâ‚‚*ğ‘¤
                âˆ‚Wâ‚â‚‚â‚‚âˆ‚y = âˆ‚mnâ‚â‚‚âˆ‚ynâ‚‚*ğ‘¤
                âˆ‚Wâ‚‚â‚‚â‚âˆ‚x = âˆ‚mnâ‚‚â‚‚âˆ‚xnâ‚*ğ‘¤
                âˆ‚Wâ‚‚â‚‚â‚âˆ‚y = âˆ‚mnâ‚‚â‚‚âˆ‚ynâ‚*ğ‘¤
                âˆ‚Wâ‚‚â‚‚â‚‚âˆ‚x = âˆ‚mnâ‚‚â‚‚âˆ‚xnâ‚‚*ğ‘¤
                âˆ‚Wâ‚‚â‚‚â‚‚âˆ‚y = âˆ‚mnâ‚‚â‚‚âˆ‚ynâ‚‚*ğ‘¤
                for i in 1:length(ğ“’)
                    âˆ‚Â²ğ­âˆ‚xÂ²[i] += âˆ‚ğ­âˆ‚x[i]*Wâ‚â‚â‚ + âˆ‚ğ­âˆ‚y[i]*Wâ‚â‚â‚‚
                    âˆ‚Â²ğ­âˆ‚xâˆ‚y[i] += âˆ‚ğ­âˆ‚x[i]*Wâ‚â‚‚â‚ + âˆ‚ğ­âˆ‚y[i]*Wâ‚â‚‚â‚‚
                    âˆ‚Â²ğ­âˆ‚yÂ²[i] += âˆ‚ğ­âˆ‚x[i]*Wâ‚‚â‚‚â‚ + âˆ‚ğ­âˆ‚y[i]*Wâ‚‚â‚‚â‚‚
                    âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚x[i] += âˆ‚ğ­âˆ‚x[i]*âˆ‚Wâ‚â‚â‚âˆ‚x + âˆ‚ğ­âˆ‚y[i]*âˆ‚Wâ‚â‚â‚‚âˆ‚x
                    âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚y[i] += âˆ‚ğ­âˆ‚x[i]*âˆ‚Wâ‚â‚â‚âˆ‚y + âˆ‚ğ­âˆ‚y[i]*âˆ‚Wâ‚â‚â‚‚âˆ‚y
                    âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚x[i] += âˆ‚ğ­âˆ‚x[i]*âˆ‚Wâ‚â‚‚â‚âˆ‚x + âˆ‚ğ­âˆ‚y[i]*âˆ‚Wâ‚â‚‚â‚‚âˆ‚x
                    âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚y[i] += âˆ‚ğ­âˆ‚x[i]*âˆ‚Wâ‚â‚‚â‚âˆ‚y + âˆ‚ğ­âˆ‚y[i]*âˆ‚Wâ‚â‚‚â‚‚âˆ‚y
                    âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚x[i] += âˆ‚ğ­âˆ‚x[i]*âˆ‚Wâ‚‚â‚‚â‚âˆ‚x + âˆ‚ğ­âˆ‚y[i]*âˆ‚Wâ‚‚â‚‚â‚‚âˆ‚x
                    âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚y[i] += âˆ‚ğ­âˆ‚x[i]*âˆ‚Wâ‚‚â‚‚â‚âˆ‚y + âˆ‚ğ­âˆ‚y[i]*âˆ‚Wâ‚‚â‚‚â‚‚âˆ‚y
                end
            end
        end

        for a in Î“á´¾
            if apâˆ©a â‰  nothing
                Î¾ = a.ğ“–[1]
                Î”nâ‚sâ‚ = Î¾.Î”nâ‚sâ‚
                Î”nâ‚sâ‚‚nâ‚‚sâ‚ = Î¾.Î”nâ‚sâ‚‚nâ‚‚sâ‚
                Î”nâ‚‚sâ‚‚ = Î¾.Î”nâ‚‚sâ‚‚

                ğ­ = Î¾[:ğ­]
                ğ’’ = getğ’‘â‚‚(a,Î¾)

                ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’ =  ğ’’Ì‚áµ€ğ—šâ»Â¹*ğ’’
                âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹ğ’’ =  âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹*ğ’’
                âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹ğ’’ =  âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹*ğ’’

                âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’ = -(âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹ğ’’*nâ‚â‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹ğ’’*nâ‚‚â‚)/2/ğ´
                âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’ = -(âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹ğ’’*nâ‚â‚‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹ğ’’*nâ‚‚â‚‚)/2/ğ´

                Î”msâ‚â‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*Î”nâ‚sâ‚
                Î”msâ‚‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*Î”nâ‚‚sâ‚‚
                Î”msâ‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*Î”nâ‚sâ‚‚nâ‚‚sâ‚/2

                Î”âˆ‚msâ‚â‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*Î”nâ‚sâ‚
                Î”âˆ‚msâ‚â‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*Î”nâ‚sâ‚
                Î”âˆ‚msâ‚‚â‚‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*Î”nâ‚‚sâ‚‚
                Î”âˆ‚msâ‚‚â‚‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*Î”nâ‚‚sâ‚‚
                Î”âˆ‚msâ‚â‚‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*Î”nâ‚sâ‚‚nâ‚‚sâ‚/2
                Î”âˆ‚msâ‚â‚‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*Î”nâ‚sâ‚‚nâ‚‚sâ‚/2

                for i in 1:length(ğ“’)
                    âˆ‚Â²ğ­âˆ‚xÂ²[i] += ğ­[i]*Î”msâ‚â‚
                    âˆ‚Â²ğ­âˆ‚xâˆ‚y[i] += ğ­[i]*Î”msâ‚â‚‚
                    âˆ‚Â²ğ­âˆ‚yÂ²[i] += ğ­[i]*Î”msâ‚‚â‚‚
                    âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚x[i] += ğ­[i]*Î”âˆ‚msâ‚â‚âˆ‚x
                    âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚y[i] += ğ­[i]*Î”âˆ‚msâ‚â‚âˆ‚y
                    âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚x[i] += ğ­[i]*Î”âˆ‚msâ‚â‚‚âˆ‚x
                    âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚y[i] += ğ­[i]*Î”âˆ‚msâ‚â‚‚âˆ‚y
                    âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚x[i] += ğ­[i]*Î”âˆ‚msâ‚‚â‚‚âˆ‚x
                    âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚y[i] += ğ­[i]*Î”âˆ‚msâ‚‚â‚‚âˆ‚y
                end
            end
        end
    end
end

function setâˆ‡Ì„Â²ğ­!(ap::ReproducingKernel{ğ’‘,ğ‘ ,ğœ™,:Tri3};Î“áµ::Vector{ReproducingKernel{ğ’‘,ğ‘ ,ğœ™,:Tri3}}=[],Î“á¶¿::Vector{ReproducingKernel{ğ’‘,ğ‘ ,ğœ™,:Tri3}}=[],Î“á´¾::Vector{ReproducingKernel{ğ’‘,ğ‘ ,ğœ™,:Tri3}}=[]) where {ğ’‘,ğ‘ ,ğœ™}
    xâ‚ = ap.ğ“’[1].x;yâ‚ = ap.ğ“’[1].y
    xâ‚‚ = ap.ğ“’[2].x;yâ‚‚ = ap.ğ“’[2].y
    xâ‚ƒ = ap.ğ“’[3].x;yâ‚ƒ = ap.ğ“’[3].y
    ğ´ = getğ´(ap)
    nâ‚â‚ = yâ‚ƒ-yâ‚‚;nâ‚‚â‚ = yâ‚-yâ‚ƒ;nâ‚ƒâ‚ = yâ‚‚-yâ‚
    nâ‚â‚‚ = xâ‚‚-xâ‚ƒ;nâ‚‚â‚‚ = xâ‚ƒ-xâ‚;nâ‚ƒâ‚‚ = xâ‚-xâ‚‚
    sâ‚â‚ = -nâ‚â‚‚;sâ‚‚â‚ = -nâ‚‚â‚‚;sâ‚ƒâ‚ = -nâ‚ƒâ‚‚
    sâ‚â‚‚ =  nâ‚â‚;sâ‚‚â‚‚ =  nâ‚‚â‚;sâ‚ƒâ‚‚ =  nâ‚ƒâ‚
    ğ“’ = ap.ğ“’
    ğ“– = ap.ğ“–
    for Î¾Ì‚ in ğ“–
        ğ’’Ì‚ = getğ’‘â‚‚(ap,Î¾Ì‚)
        ğ—šâ»Â¹ = calğ—šâ‚‚!(ap)
        ğ’’Ì‚áµ€ğ—šâ»Â¹ = ğ’’Ì‚*ğ—šâ»Â¹

        âˆ‚Â²ğ­âˆ‚xÂ² = Î¾Ì‚[:âˆ‚Â²ğ­âˆ‚xÂ²_]
        âˆ‚Â²ğ­âˆ‚xâˆ‚y = Î¾Ì‚[:âˆ‚Â²ğ­âˆ‚xâˆ‚y_]
        âˆ‚Â²ğ­âˆ‚yÂ² = Î¾Ì‚[:âˆ‚Â²ğ­âˆ‚yÂ²_]
        for i in 1:length(ğ“’)
            âˆ‚Â²ğ­âˆ‚xÂ²[i] = 0.0
            âˆ‚Â²ğ­âˆ‚xâˆ‚y[i] = 0.0
            âˆ‚Â²ğ­âˆ‚yÂ²[i] = 0.0
        end
        for a in Î“áµ
            if apâˆ©a â‰  nothing
                for Î¾ in a.ğ“–
                    ğ‘¤ = Î¾.ğ‘¤
                    nâ‚ = Î¾.nâ‚
                    nâ‚‚ = Î¾.nâ‚‚
                    sâ‚ = -nâ‚‚
                    sâ‚‚ = nâ‚
                    ğ­ = Î¾[:ğ­]
                    ğ’’, âˆ‚ğ’’âˆ‚Î¾, âˆ‚ğ’’âˆ‚Î· = getâˆ‡Â²ğ’‘â‚‚(a,Î¾)

                    ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾ = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î¾
                    ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î· = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î·

                    qâ‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚
                    qâ‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚‚

                    qâ‚nâ‚ = qâ‚*nâ‚
                    qâ‚nâ‚‚ = qâ‚*nâ‚‚
                    qâ‚‚nâ‚ = qâ‚‚*nâ‚
                    qâ‚‚nâ‚‚ = qâ‚‚*nâ‚‚
                    msâ‚â‚ = (qâ‚*sâ‚+qâ‚‚*sâ‚‚)*nâ‚*sâ‚
                    msâ‚â‚‚ = (qâ‚*sâ‚+qâ‚‚*sâ‚‚)*0.5*(nâ‚*sâ‚‚+nâ‚‚*sâ‚)
                    msâ‚‚â‚‚ = (qâ‚*sâ‚+qâ‚‚*sâ‚‚)*nâ‚‚*sâ‚‚

                    Wâ‚â‚ = (qâ‚nâ‚+msâ‚â‚)*ğ‘¤/2/ğ´
                    Wâ‚â‚‚ = (qâ‚nâ‚‚+qâ‚‚nâ‚+2*msâ‚â‚‚)*ğ‘¤/4/ğ´
                    Wâ‚‚â‚‚ = (qâ‚‚nâ‚‚+msâ‚‚â‚‚)*ğ‘¤/2/ğ´
                    for i in 1:length(ğ“’)
                        âˆ‚Â²ğ­âˆ‚xÂ²[i] += ğ­[i]*Wâ‚â‚
                        âˆ‚Â²ğ­âˆ‚xâˆ‚y[i] += ğ­[i]*Wâ‚â‚‚
                        âˆ‚Â²ğ­âˆ‚yÂ²[i] += ğ­[i]*Wâ‚‚â‚‚
                    end
                end
            end
        end

        for b in Î“á¶¿
            if apâˆ©b â‰  nothing
                for Î¾ in b.ğ“–
                    ğ‘¤ = Î¾.ğ‘¤
                    nâ‚ = Î¾.nâ‚
                    nâ‚‚ = Î¾.nâ‚‚
                    sâ‚ = -nâ‚‚
                    sâ‚‚ = nâ‚
                    âˆ‚ğ­âˆ‚x = Î¾[:âˆ‚ğ­âˆ‚x]
                    âˆ‚ğ­âˆ‚y = Î¾[:âˆ‚ğ­âˆ‚y]
                    ğ’’ = getğ’‘â‚‚(b,Î¾)

                    ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’ =  ğ’’Ì‚áµ€ğ—šâ»Â¹*ğ’’

                    mnâ‚â‚nâ‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚*nâ‚*nâ‚
                    mnâ‚â‚nâ‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚*nâ‚*nâ‚‚
                    mnâ‚â‚‚nâ‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚*nâ‚‚*nâ‚
                    mnâ‚â‚‚nâ‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚*nâ‚‚*nâ‚‚
                    mnâ‚‚â‚‚nâ‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚*nâ‚‚*nâ‚
                    mnâ‚‚â‚‚nâ‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚*nâ‚‚*nâ‚‚

                    Wâ‚â‚â‚ = mnâ‚â‚nâ‚*ğ‘¤
                    Wâ‚â‚â‚‚ = mnâ‚â‚nâ‚‚*ğ‘¤
                    Wâ‚â‚‚â‚ = mnâ‚â‚‚nâ‚*ğ‘¤
                    Wâ‚â‚‚â‚‚ = mnâ‚â‚‚nâ‚‚*ğ‘¤
                    Wâ‚‚â‚‚â‚ = mnâ‚‚â‚‚nâ‚*ğ‘¤
                    Wâ‚‚â‚‚â‚‚ = mnâ‚‚â‚‚nâ‚‚*ğ‘¤

                    for i in 1:length(ğ“’)
                        âˆ‚Â²ğ­âˆ‚xÂ²[i] += âˆ‚ğ­âˆ‚x[i]*Wâ‚â‚â‚ + âˆ‚ğ­âˆ‚y[i]*Wâ‚â‚â‚‚
                        âˆ‚Â²ğ­âˆ‚xâˆ‚y[i] += âˆ‚ğ­âˆ‚x[i]*Wâ‚â‚‚â‚ + âˆ‚ğ­âˆ‚y[i]*Wâ‚â‚‚â‚‚
                        âˆ‚Â²ğ­âˆ‚yÂ²[i] += âˆ‚ğ­âˆ‚x[i]*Wâ‚‚â‚‚â‚ + âˆ‚ğ­âˆ‚y[i]*Wâ‚‚â‚‚â‚‚
                    end
                end
            end
        end

        for c in Î“á´¾
            if apâˆ©c â‰  nothing
                Î¾ = c.ğ“–[1]
                Î”nâ‚sâ‚ = Î¾.Î”nâ‚sâ‚
                Î”nâ‚sâ‚‚nâ‚‚sâ‚ = Î¾.Î”nâ‚sâ‚‚nâ‚‚sâ‚
                Î”nâ‚‚sâ‚‚ = Î¾.Î”nâ‚‚sâ‚‚

                ğ­ = Î¾[:ğ­]
                ğ’’ = getğ’‘â‚‚(c,Î¾)

                ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’ =  ğ’’Ì‚áµ€ğ—šâ»Â¹*ğ’’

                Î”msâ‚â‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*Î”nâ‚sâ‚
                Î”msâ‚‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*Î”nâ‚‚sâ‚‚
                Î”msâ‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*Î”nâ‚sâ‚‚nâ‚‚sâ‚/2

                for i in 1:length(ğ“’)
                    âˆ‚Â²ğ­âˆ‚xÂ²[i] += ğ­[i]*Î”msâ‚â‚
                    âˆ‚Â²ğ­âˆ‚xâˆ‚y[i] += ğ­[i]*Î”msâ‚â‚‚
                    âˆ‚Â²ğ­âˆ‚yÂ²[i] += ğ­[i]*Î”msâ‚‚â‚‚
                end
            end
        end
    end
end