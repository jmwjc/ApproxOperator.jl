
struct ReproducingKernel{ğ‘,ğ‘ ,ğœ™}<:AbstractReproducingKernel{ğ‘ ,ğœ™}
    ğ“’::Vector{ğ‘¿áµ¢}
    ğ“–::Vector{ğ‘¿â‚›}
end

getğ‘›ğ’‘(    ::ReproducingKernel{:Linear1D}) = 2
getğ’‘(     ::ReproducingKernel{:Linear1D},x::NTuple{3,Float64}) = (1.,x[1])
getâˆ‚ğ’‘âˆ‚x(  ::ReproducingKernel{:Linear1D},x::NTuple{3,Float64}) = (0.,1.)
getâˆ‚Â²ğ’‘âˆ‚xÂ²(::ReproducingKernel{:Linear1D},x::NTuple{3,Float64}) = (0.,0.)

getğ‘›ğ’‘(    ::ReproducingKernel{:Quadratic1D}) = 3
getğ’‘(     ::ReproducingKernel{:Quadratic1D},x::NTuple{3,Float64}) = (1.,x[1],x[1]^2)
getâˆ‚ğ’‘âˆ‚x(  ::ReproducingKernel{:Quadratic1D},x::NTuple{3,Float64}) = (0.,1.,2*x[1])
getâˆ‚Â²ğ’‘âˆ‚xÂ²(::ReproducingKernel{:Quadratic1D},x::NTuple{3,Float64}) = (0.,0.,2.)
getâˆ‚Â³ğ’‘âˆ‚xÂ³(::ReproducingKernel{:Quadratic1D},x::NTuple{3,Float64}) = (0.,0.,0.)

getğ‘›ğ’‘(    ::ReproducingKernel{:Cubic1D}) = 4
getğ’‘(     ::ReproducingKernel{:Cubic1D},x::NTuple{3,Float64}) = (1.,x[1],x[1]^2,x[1]^3)
getâˆ‚ğ’‘âˆ‚x(  ::ReproducingKernel{:Cubic1D},x::NTuple{3,Float64}) = (0.,1.,2*x[1],3*x[1]^2)
getâˆ‚Â²ğ’‘âˆ‚xÂ²(::ReproducingKernel{:Cubic1D},x::NTuple{3,Float64}) = (0.,0.,2.,6*x[1])
getâˆ‚Â³ğ’‘âˆ‚xÂ³(::ReproducingKernel{:Cubic1D},x::NTuple{3,Float64}) = (0.,0.,0.,6.)

getğ‘›ğ’‘(  ::ReproducingKernel{:Linear2D}) = 3
getğ’‘(   ::ReproducingKernel{:Linear2D},x::NTuple{3,Float64}) = (1.,x[1],x[2])
getâˆ‚ğ’‘âˆ‚x(::ReproducingKernel{:Linear2D},x::NTuple{3,Float64}) = (0.,1.,0.)
getâˆ‚ğ’‘âˆ‚y(::ReproducingKernel{:Linear2D},x::NTuple{3,Float64}) = (0.,0.,1.)

getğ‘›ğ’‘(      ::ReproducingKernel{:Quadratic2D}) = 6
getğ’‘(       ::ReproducingKernel{:Quadratic2D},x::NTuple{3,Float64}) = (1.,x[1],x[2],x[1]^2,x[1]*x[2],x[2]^2)
getâˆ‚ğ’‘âˆ‚x(    ::ReproducingKernel{:Quadratic2D},x::NTuple{3,Float64}) = (0.,1.,0.,2*x[1],x[2],0.)
getâˆ‚ğ’‘âˆ‚y(    ::ReproducingKernel{:Quadratic2D},x::NTuple{3,Float64}) = (0.,0.,1.,0.,x[1],2*x[2])
getâˆ‚Â²ğ’‘âˆ‚xÂ²(  ::ReproducingKernel{:Quadratic2D},x::NTuple{3,Float64}) = (0.,0.,0.,2.,0.,0.)
getâˆ‚Â²ğ’‘âˆ‚xâˆ‚y( ::ReproducingKernel{:Quadratic2D},x::NTuple{3,Float64}) = (0.,0.,0.,0.,1.,0.)
getâˆ‚Â²ğ’‘âˆ‚yÂ²(  ::ReproducingKernel{:Quadratic2D},x::NTuple{3,Float64}) = (0.,0.,0.,0.,0.,2.)
getâˆ‚Â³ğ’‘âˆ‚xÂ³(  ::ReproducingKernel{:Quadratic2D},x::NTuple{3,Float64}) = (0.,0.,0.,0.,0.,0.)
getâˆ‚Â³ğ’‘âˆ‚xÂ²âˆ‚y(::ReproducingKernel{:Quadratic2D},x::NTuple{3,Float64}) = (0.,0.,0.,0.,0.,0.)
getâˆ‚Â³ğ’‘âˆ‚xâˆ‚yÂ²(::ReproducingKernel{:Quadratic2D},x::NTuple{3,Float64}) = (0.,0.,0.,0.,0.,0.)
getâˆ‚Â³ğ’‘âˆ‚yÂ³(  ::ReproducingKernel{:Quadratic2D},x::NTuple{3,Float64}) = (0.,0.,0.,0.,0.,0.)

getğ‘›ğ’‘(::ReproducingKernel{:Cubic2D}) = 10
getğ’‘(::ReproducingKernel{:Cubic2D},x::NTuple{3,Float64}) =
(
    1., x[1], x[2], x[1]^2, x[1]*x[2], x[2]^2, x[1]^3, x[1]^2*x[2], x[1]*x[2]^2, x[2]^3
)
getâˆ‚ğ’‘âˆ‚x(::ReproducingKernel{:Cubic2D},x::NTuple{3,Float64}) =
(
    0., 1., 0., 2*x[1], x[2], 0., 3*x[1]^2, 2*x[1]*x[2], x[2]^2, 0.
)
getâˆ‚ğ’‘âˆ‚y(::ReproducingKernel{:Cubic2D},x::NTuple{3,Float64}) =
(
    0., 0., 1., 0., x[1], 2*x[2], 0., x[1]^2, 2*x[1]*x[2], 3*x[2]^2
)
getâˆ‚Â²ğ’‘âˆ‚xÂ²(::ReproducingKernel{:Cubic2D},x::NTuple{3,Float64}) =
(
    0., 0., 0., 2., 0., 0., 6*x[1], 2*x[2], 0., 0.
)
getâˆ‚Â²ğ’‘âˆ‚xâˆ‚y(::ReproducingKernel{:Cubic2D},x::NTuple{3,Float64}) =
(
    0., 0., 0., 0., 1., 0., 0., 2*x[1], 2*x[2], 0.
)
getâˆ‚Â²ğ’‘âˆ‚yÂ²(::ReproducingKernel{:Cubic2D},x::NTuple{3,Float64}) =
(
    0., 0., 0., 0., 0., 2., 0., 0., 2*x[1], 6*x[2]
)
getâˆ‚Â³ğ’‘âˆ‚xÂ³(::ReproducingKernel{:Cubic2D},x::NTuple{3,Float64}) =
(
    0., 0., 0., 0., 0., 0., 6., 0., 0., 0.
)
getâˆ‚Â³ğ’‘âˆ‚xÂ²âˆ‚y(::ReproducingKernel{:Cubic2D},x::NTuple{3,Float64}) =
(
    0., 0., 0., 0., 0., 0., 0., 2., 0., 0.
)
getâˆ‚Â³ğ’‘âˆ‚xâˆ‚yÂ²(::ReproducingKernel{:Cubic2D},x::NTuple{3,Float64}) =
(
    0., 0., 0., 0., 0., 0., 0., 0., 2., 0.
)
getâˆ‚Â³ğ’‘âˆ‚yÂ³(::ReproducingKernel{:Cubic2D},x::NTuple{3,Float64}) =
(
    0., 0., 0., 0., 0., 0., 0., 0., 0., 6.
)

getğ‘›ğ’‘(::ReproducingKernel{:Quartic2D}) = 15
getğ’‘(::ReproducingKernel{:Quartic2D},x::NTuple{3,Float64}) =
(
    1., x[1], x[2], x[1]^2, x[1]*x[2], x[2]^2, x[1]^3, x[1]^2*x[2], x[1]*x[2]^2, x[2]^3, x[1]^4, x[1]^3*x[2], x[1]^2*x[2]^2, x[1]*x[2]^3, x[2]^4
)
getâˆ‚ğ’‘âˆ‚x(::ReproducingKernel{:Quartic2D},x::NTuple{3,Float64}) =
(
    0., 1., 0., 2*x[1], x[2], 0., 3*x[1]^2, 2*x[1]*x[2], x[2]^2, 0., 4.0*x[1]^3, 3.0*x[1]^2*x[2], 2.0*x[1]*x[2]^2, x[2]^3, 0.0
)
getâˆ‚ğ’‘âˆ‚y(::ReproducingKernel{:Quartic2D},x::NTuple{3,Float64}) =
(
    0., 0., 1., 0., x[1], 2*x[2], 0., x[1]^2, 2*x[1]*x[2], 3*x[2]^2, 0.0, x[1]^3, 2.0*x[1]^2*x[2], 3.0*x[1]*x[2]^2, 4.0*x[2]^3
)
getâˆ‚Â²ğ’‘âˆ‚xÂ²(::ReproducingKernel{:Quartic2D},x::NTuple{3,Float64}) =
(
    0., 0., 0., 2., 0., 0., 6*x[1], 2*x[2], 0., 0., 12.0*x[1]^2, 6.0*x[1]*x[2], 2.0*x[2]^2, 0.0, 0.0
)
getâˆ‚Â²ğ’‘âˆ‚xâˆ‚y(::ReproducingKernel{:Quartic2D},x::NTuple{3,Float64}) =
(
    0., 0., 0., 0., 1., 0., 0., 2*x[1], 2*x[2], 0., 0.0, 3.0*x[1]^2, 4.0*x[1]*x[2], 3.0*x[2]^2, 0.0
)
getâˆ‚Â²ğ’‘âˆ‚yÂ²(::ReproducingKernel{:Quartic2D},x::NTuple{3,Float64}) =
(
    0., 0., 0., 0., 0., 2., 0., 0., 2*x[1], 6*x[2], 0.0, 0.0, 2.0*x[1]^2, 6.0*x[1]*x[2], 12.0*x[2]^2
)
getâˆ‚Â³ğ’‘âˆ‚xÂ³(::ReproducingKernel{:Quartic2D},x::NTuple{3,Float64}) =
(
    0., 0., 0., 0., 0., 0., 6., 0., 0., 0., 24.0*x[1], 6.0*x[2], 0.0, 0.0, 0.0
)
getâˆ‚Â³ğ’‘âˆ‚xÂ²âˆ‚y(::ReproducingKernel{:Quartic2D},x::NTuple{3,Float64}) =
(
    0., 0., 0., 0., 0., 0., 0., 2., 0., 0., 0., 6.0*x[1], 4.0*x[2], 0., 0.
)
getâˆ‚Â³ğ’‘âˆ‚xâˆ‚yÂ²(::ReproducingKernel{:Quartic2D},x::NTuple{3,Float64}) =
(
    0., 0., 0., 0., 0., 0., 0., 0., 2., 0., 0., 0., 4.0*x[1], 6.0*x[2],0.
)
getâˆ‚Â³ğ’‘âˆ‚yÂ³(::ReproducingKernel{:Quartic2D},x::NTuple{3,Float64}) =
(
    0., 0., 0., 0., 0., 0., 0., 0., 0., 6., 0., 0., 0., 6.0*x[1], 24.0*x[2]
)

function calğ— !(ap::AbstractReproducingKernel,x::Node)
    ğ“’ = ap.ğ“’
    ğ—  = getğ— (ap,:ğ— )
    n = getğ‘›ğ’‘(ap)
    for xáµ¢ in ğ“’
        Î”x = x - xáµ¢
        ğ’‘ = getğ’‘(ap,Î”x)
        ğœ™ = getğœ™(ap,xáµ¢,Î”x)
        for I in 1:n
            for J in 1:I
                ğ— [I,J] += ğœ™*ğ’‘[I]*ğ’‘[J]
            end
        end
    end
    cholesky!(ğ— )
    inverse!(ğ— )
    UUáµ€!(ğ— )
    return ğ— 
end

function getğ— (ap::AbstractReproducingKernel,s::Symbol)
    n = getğ‘›ğ’‘(ap)
    data = getfield(getfield(ap,:ğ“–)[3][1],:data)
    fill!(data[s][2],0.)
    return SymMat(n,data[s][2])
end

function setğ­!(ap::AbstractReproducingKernel,ğ’™::Node)
    ğ“’ = ap.ğ“’
    ğ­ = ğ’™[:ğ­]
    ğ’‘â‚€áµ€ğ— â»Â¹ = calğ— !(ap,ğ’™)
    for (i,ğ’™áµ¢) in enumerate(ğ“’)
        Î”ğ’™ = ğ’™ - ğ’™áµ¢
        ğ’‘= getğ’‘(ap,Î”ğ’™)
        ğœ™ = getğœ™(ap,ğ’™áµ¢,Î”ğ’™)
        ğ­[i] = ğ’‘â‚€áµ€ğ— â»Â¹*ğ’‘*ğœ™
    end
end

for ğ’‘ in (:(:Linear1D),:(:Quadratic1D),:(:Cubic1D),:(:Quartic1D))
    @eval begin
        getâˆ‡ğ’‘( ap::ReproducingKernel{$ğ’‘},x::Any) = getğ’‘(ap,x), getâˆ‚ğ’‘âˆ‚x(ap,x)
        getâˆ‡Â²ğ’‘(ap::ReproducingKernel{$ğ’‘},x::Any) = getğ’‘(ap,x), getâˆ‚ğ’‘âˆ‚x(ap,x), getâˆ‚Â²ğ’‘âˆ‚xÂ²(ap,x)
        getâˆ‡Â³ğ’‘(ap::ReproducingKernel{$ğ’‘},x::Any) = getğ’‘(ap,x), getâˆ‚ğ’‘âˆ‚x(ap,x), getâˆ‚Â²ğ’‘âˆ‚xÂ²(ap,x), getâˆ‚Â³ğ’‘âˆ‚xÂ³(ap,x)

        function calâˆ‡ğ— !(ap::ReproducingKernel{$ğ’‘},x::Node)
            ğ“’ = ap.ğ“’
            ğ—  = getğ— (ap,:ğ— )
            âˆ‚ğ— âˆ‚x = getğ— (ap,:âˆ‚ğ— âˆ‚x)
            n = getğ‘›ğ’‘(ap)
            for xáµ¢ in ğ“’
                Î”x = x - xáµ¢
                ğ’‘, âˆ‚ğ’‘âˆ‚x = getâˆ‡ğ’‘(ap,Î”x)
                ğœ™, âˆ‚ğœ™âˆ‚x = getâˆ‡ğœ™(ap,xáµ¢,Î”x)
                for I in 1:n
                    for J in 1:I
                        ğ— [I,J] += ğœ™*ğ’‘[I]*ğ’‘[J]
                        âˆ‚ğ— âˆ‚x[I,J] += âˆ‚ğœ™âˆ‚x*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J]
                    end
                end
            end
            cholesky!(ğ— )
            U = inverse!(ğ— )
            âˆ‚ğ— â»Â¹âˆ‚x = - UUáµ€AUUáµ€!(âˆ‚ğ— âˆ‚x,U)
            ğ— â»Â¹ = UUáµ€!(U)
            return ğ— â»Â¹, âˆ‚ğ— â»Â¹âˆ‚x
        end

        function setâˆ‡ğ­!(ap::ReproducingKernel{$ğ’‘},ğ’™::Node)
            ğ“’ = ap.ğ“’
            ğ­ = ğ’™[:ğ­]
            âˆ‚ğ­âˆ‚x = ğ’™[:âˆ‚ğ­âˆ‚x]
            ğ’‘â‚€áµ€ğ— â»Â¹, ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚x = calâˆ‡ğ— !(ap,ğ’™)
            for (i,ğ’™áµ¢) in enumerate(ğ“’)
                Î”ğ’™ = ğ’™ - ğ’™áµ¢
                ğ’‘, âˆ‚ğ’‘âˆ‚x = getâˆ‡ğ’‘(ap,Î”ğ’™)
                ğœ™, âˆ‚ğœ™âˆ‚x = getâˆ‡ğœ™(ap,ğ’™áµ¢,Î”ğ’™)
                ğ­[i] = ğ’‘â‚€áµ€ğ— â»Â¹*ğ’‘*ğœ™
                âˆ‚ğ­âˆ‚x[i] = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚x*ğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚ğ’‘âˆ‚x*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹*ğ’‘*âˆ‚ğœ™âˆ‚x
            end
        end
    end
end

for ğ’‘ in (:(:Linear2D),:(:Quadratic2D),:(:Cubic2D))
    @eval begin
        getâˆ‡ğ’‘( ap::ReproducingKernel{$ğ’‘},x::Any) = getğ’‘(ap,x),getâˆ‚ğ’‘âˆ‚x(ap,x),getâˆ‚ğ’‘âˆ‚y(ap,x)
        getâˆ‡Â²ğ’‘(ap::ReproducingKernel{$ğ’‘},x::Any) = getğ’‘(ap,x),getâˆ‚ğ’‘âˆ‚x(ap,x),getâˆ‚ğ’‘âˆ‚y(ap,x),getâˆ‚Â²ğ’‘âˆ‚xÂ²(ap,x),getâˆ‚Â²ğ’‘âˆ‚xâˆ‚y(ap,x),getâˆ‚Â²ğ’‘âˆ‚yÂ²(ap,x)
        getâˆ‡Â³ğ’‘(ap::ReproducingKernel{$ğ’‘},x::Any) = getğ’‘(ap,x),getâˆ‚ğ’‘âˆ‚x(ap,x),getâˆ‚ğ’‘âˆ‚y(ap,x),getâˆ‚Â²ğ’‘âˆ‚xÂ²(ap,x),getâˆ‚Â²ğ’‘âˆ‚xâˆ‚y(ap,x),getâˆ‚Â²ğ’‘âˆ‚yÂ²(ap,x),getâˆ‚Â³ğ’‘âˆ‚xÂ³(ap,x),getâˆ‚Â³ğ’‘âˆ‚xÂ²âˆ‚y(ap,x),getâˆ‚Â³ğ’‘âˆ‚xâˆ‚yÂ²(ap,x),getâˆ‚Â³ğ’‘âˆ‚yÂ³(ap,x)

        function calâˆ‡ğ— !(ap::ReproducingKernel{$ğ’‘},x::Node)
            ğ“’ = ap.ğ“’
            ğ—  = getğ— (ap,:ğ— )
            âˆ‚ğ— âˆ‚x = getğ— (ap,:âˆ‚ğ— âˆ‚x)
            âˆ‚ğ— âˆ‚y = getğ— (ap,:âˆ‚ğ— âˆ‚y)
            n = getğ‘›ğ’‘(ap)
            for xáµ¢ in ğ“’
                Î”x = x - xáµ¢
                ğ’‘, âˆ‚ğ’‘âˆ‚x, âˆ‚ğ’‘âˆ‚y = getâˆ‡ğ’‘(ap,Î”x)
                ğœ™, âˆ‚ğœ™âˆ‚x, âˆ‚ğœ™âˆ‚y = getâˆ‡ğœ™(ap,xáµ¢,Î”x)
                for I in 1:n
                    for J in 1:I
                        ğ— [I,J] += ğœ™*ğ’‘[I]*ğ’‘[J]
                        âˆ‚ğ— âˆ‚x[I,J] += âˆ‚ğœ™âˆ‚x*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J]
                        âˆ‚ğ— âˆ‚y[I,J] += âˆ‚ğœ™âˆ‚y*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J]
                    end
                end
            end
            cholesky!(ğ— )
            U = inverse!(ğ— )
            âˆ‚ğ— â»Â¹âˆ‚x = - UUáµ€AUUáµ€!(âˆ‚ğ— âˆ‚x,U)
            âˆ‚ğ— â»Â¹âˆ‚y = - UUáµ€AUUáµ€!(âˆ‚ğ— âˆ‚y,U)
            ğ— â»Â¹ = UUáµ€!(U)
            return ğ— â»Â¹, âˆ‚ğ— â»Â¹âˆ‚x, âˆ‚ğ— â»Â¹âˆ‚y
        end

        function setâˆ‡ğ­!(ap::ReproducingKernel{$ğ’‘},ğ’™::Node)
            ğ“’ = ap.ğ“’
            ğ­ = ğ’™[:ğ­]
            âˆ‚ğ­âˆ‚x = ğ’™[:âˆ‚ğ­âˆ‚x]
            âˆ‚ğ­âˆ‚y = ğ’™[:âˆ‚ğ­âˆ‚y]
            ğ’‘â‚€áµ€ğ— â»Â¹, ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚x, ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚y = calâˆ‡ğ— !(ap,ğ’™)
            for (i,ğ’™áµ¢) in enumerate(ğ“’)
                Î”ğ’™ = ğ’™ - ğ’™áµ¢
                ğ’‘, âˆ‚ğ’‘âˆ‚x, âˆ‚ğ’‘âˆ‚y = getâˆ‡ğ’‘(ap,Î”ğ’™)
                ğœ™, âˆ‚ğœ™âˆ‚x, âˆ‚ğœ™âˆ‚y = getâˆ‡ğœ™(ap,ğ’™áµ¢,Î”ğ’™)
                ğ­[i] = ğ’‘â‚€áµ€ğ— â»Â¹*ğ’‘*ğœ™
                âˆ‚ğ­âˆ‚x[i] = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚x*ğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚ğ’‘âˆ‚x*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹*ğ’‘*âˆ‚ğœ™âˆ‚x
                âˆ‚ğ­âˆ‚y[i] = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚y*ğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚ğ’‘âˆ‚y*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹*ğ’‘*âˆ‚ğœ™âˆ‚y
            end
        end

        function calâˆ‡Â²ğ— !(ap::ReproducingKernel{$ğ’‘},x::Node)
            ğ“’ = ap.ğ“’
            ğ—  = getğ— (ap,:ğ— )
            âˆ‚ğ— âˆ‚x = getğ— (ap,:âˆ‚ğ— âˆ‚x)
            âˆ‚ğ— âˆ‚y = getğ— (ap,:âˆ‚ğ— âˆ‚y)
            âˆ‚Â²ğ— âˆ‚xÂ² = getğ— (ap,:âˆ‚Â²ğ— âˆ‚xÂ²)
            âˆ‚Â²ğ— âˆ‚yÂ² = getğ— (ap,:âˆ‚Â²ğ— âˆ‚yÂ²)
            âˆ‚Â²ğ— âˆ‚xâˆ‚y = getğ— (ap,:âˆ‚Â²ğ— âˆ‚xâˆ‚y)
            n = getğ‘›ğ’‘(ap)
            for xáµ¢ in ğ“’
                Î”x = x - xáµ¢
                ğ’‘, âˆ‚ğ’‘âˆ‚x, âˆ‚ğ’‘âˆ‚y, âˆ‚Â²ğ’‘âˆ‚xÂ², âˆ‚Â²ğ’‘âˆ‚xâˆ‚y, âˆ‚Â²ğ’‘âˆ‚yÂ² = getâˆ‡Â²ğ’‘(ap,Î”x)
                ğœ™, âˆ‚ğœ™âˆ‚x, âˆ‚ğœ™âˆ‚y, âˆ‚Â²ğœ™âˆ‚xÂ², âˆ‚Â²ğœ™âˆ‚xâˆ‚y, âˆ‚Â²ğœ™âˆ‚yÂ² = getâˆ‡Â²ğœ™(ap,xáµ¢,Î”x)
                for I in 1:n
                    for J in 1:I
                        ğ— [I,J] += ğœ™*ğ’‘[I]*ğ’‘[J]
                        âˆ‚ğ— âˆ‚x[I,J] += âˆ‚ğœ™âˆ‚x*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J]
                        âˆ‚ğ— âˆ‚y[I,J] += âˆ‚ğœ™âˆ‚y*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J]
                        âˆ‚Â²ğ— âˆ‚xÂ²[I,J] += âˆ‚Â²ğœ™âˆ‚xÂ²*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚xÂ²[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚xÂ²[J] + 2.0*âˆ‚ğœ™âˆ‚x*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + 2.0*âˆ‚ğœ™âˆ‚x*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J] + 2.0*ğœ™*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚ğ’‘âˆ‚x[J]
                        âˆ‚Â²ğ— âˆ‚yÂ²[I,J] += âˆ‚Â²ğœ™âˆ‚yÂ²*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚yÂ²[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚yÂ²[J] + 2.0*âˆ‚ğœ™âˆ‚y*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + 2.0*âˆ‚ğœ™âˆ‚y*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J] + 2.0*ğœ™*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚ğ’‘âˆ‚y[J]
                        âˆ‚Â²ğ— âˆ‚xâˆ‚y[I,J] += âˆ‚Â²ğœ™âˆ‚xâˆ‚y*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[J] + âˆ‚ğœ™âˆ‚x*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + âˆ‚ğœ™âˆ‚y*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + âˆ‚ğœ™âˆ‚x*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J] + âˆ‚ğœ™âˆ‚y*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J] + ğœ™*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚ğ’‘âˆ‚y[J] + ğœ™*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚ğ’‘âˆ‚x[J]
                    end
                end
            end
            cholesky!(ğ— )
            U = inverse!(ğ— )
            Uáµ€âˆ‚ğ— âˆ‚xU = Uáµ€AU!(âˆ‚ğ— âˆ‚x,U)
            Uáµ€âˆ‚ğ— âˆ‚yU = Uáµ€AU!(âˆ‚ğ— âˆ‚y,U)
            Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U = Uáµ€AU!(âˆ‚Â²ğ— âˆ‚xÂ²,U)
            Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U = Uáµ€AU!(âˆ‚Â²ğ— âˆ‚yÂ²,U)
            Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU = Uáµ€AU!(âˆ‚Â²ğ— âˆ‚xâˆ‚y,U)
            for i in 1:n
                for j in 1:i
                    for k in 1:n
                        Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U[i,j] -= 2*Uáµ€âˆ‚ğ— âˆ‚xU[i,k]*Uáµ€âˆ‚ğ— âˆ‚xU[k,j]
                        Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U[i,j] -= 2*Uáµ€âˆ‚ğ— âˆ‚yU[i,k]*Uáµ€âˆ‚ğ— âˆ‚yU[k,j]
                        Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU[i,j] -= Uáµ€âˆ‚ğ— âˆ‚xU[i,k]*Uáµ€âˆ‚ğ— âˆ‚yU[k,j] + Uáµ€âˆ‚ğ— âˆ‚yU[i,k]*Uáµ€âˆ‚ğ— âˆ‚xU[k,j]
                    end
                end
            end
    
            âˆ‚Â²ğ— â»Â¹âˆ‚xÂ² = - UAUáµ€!(Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U,U)
            âˆ‚Â²ğ— â»Â¹âˆ‚yÂ² = - UAUáµ€!(Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U,U)
            âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚y = - UAUáµ€!(Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU,U)
            âˆ‚ğ— â»Â¹âˆ‚x = - UAUáµ€!(Uáµ€âˆ‚ğ— âˆ‚xU,U)
            âˆ‚ğ— â»Â¹âˆ‚y = - UAUáµ€!(Uáµ€âˆ‚ğ— âˆ‚yU,U)
            ğ— â»Â¹ = UUáµ€!(U)
            return ğ— â»Â¹, âˆ‚ğ— â»Â¹âˆ‚x, âˆ‚ğ— â»Â¹âˆ‚y, âˆ‚Â²ğ— â»Â¹âˆ‚xÂ², âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚y, âˆ‚Â²ğ— â»Â¹âˆ‚yÂ²
        end

        function calâˆ‡Â³ğ— !(ap::ReproducingKernel{$ğ’‘},x::Node)
            ğ“’ = ap.ğ“’
            ğ—  = getğ— (ap,:ğ— )
            âˆ‚ğ— âˆ‚x = getğ— (ap,:âˆ‚ğ— âˆ‚x)
            âˆ‚ğ— âˆ‚y = getğ— (ap,:âˆ‚ğ— âˆ‚y)
            âˆ‚Â²ğ— âˆ‚xÂ² = getğ— (ap,:âˆ‚Â²ğ— âˆ‚xÂ²)
            âˆ‚Â²ğ— âˆ‚xâˆ‚y = getğ— (ap,:âˆ‚Â²ğ— âˆ‚xâˆ‚y)
            âˆ‚Â²ğ— âˆ‚yÂ² = getğ— (ap,:âˆ‚Â²ğ— âˆ‚yÂ²)
            âˆ‚Â³ğ— âˆ‚xÂ³ = getğ— (ap,:âˆ‚Â³ğ— âˆ‚xÂ³)
            âˆ‚Â³ğ— âˆ‚xÂ²âˆ‚y = getğ— (ap,:âˆ‚Â³ğ— âˆ‚xÂ²âˆ‚y)
            âˆ‚Â³ğ— âˆ‚xâˆ‚yÂ² = getğ— (ap,:âˆ‚Â³ğ— âˆ‚xâˆ‚yÂ²)
            âˆ‚Â³ğ— âˆ‚yÂ³ = getğ— (ap,:âˆ‚Â³ğ— âˆ‚yÂ³)
            n = getğ‘›ğ’‘(ap)
            for xáµ¢ in ğ“’
                Î”x = x - xáµ¢
                ğ’‘, âˆ‚ğ’‘âˆ‚x, âˆ‚ğ’‘âˆ‚y, âˆ‚Â²ğ’‘âˆ‚xÂ², âˆ‚Â²ğ’‘âˆ‚xâˆ‚y, âˆ‚Â²ğ’‘âˆ‚yÂ², âˆ‚Â³ğ’‘âˆ‚xÂ³, âˆ‚Â³ğ’‘âˆ‚xÂ²âˆ‚y, âˆ‚Â³ğ’‘âˆ‚xâˆ‚yÂ², âˆ‚Â³ğ’‘âˆ‚yÂ³ = getâˆ‡Â³ğ’‘(ap,Î”x)
                ğœ™, âˆ‚ğœ™âˆ‚x, âˆ‚ğœ™âˆ‚y, âˆ‚Â²ğœ™âˆ‚xÂ², âˆ‚Â²ğœ™âˆ‚xâˆ‚y, âˆ‚Â²ğœ™âˆ‚yÂ², âˆ‚Â³ğœ™âˆ‚xÂ³, âˆ‚Â³ğœ™âˆ‚xÂ²âˆ‚y, âˆ‚Â³ğœ™âˆ‚xâˆ‚yÂ², âˆ‚Â³ğœ™âˆ‚yÂ³ = getâˆ‡Â³ğœ™(ap,xáµ¢,Î”x)
                for I in 1:n
                    for J in I:n
                        ğ— [I,J] += ğœ™*ğ’‘[I]*ğ’‘[J]
                        âˆ‚ğ— âˆ‚x[I,J] += âˆ‚ğœ™âˆ‚x*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J]
                        âˆ‚ğ— âˆ‚y[I,J] += âˆ‚ğœ™âˆ‚y*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J]

                        âˆ‚Â²ğ— âˆ‚xÂ²[I,J] += âˆ‚Â²ğœ™âˆ‚xÂ²*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚xÂ²[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚xÂ²[J] + 2.0*âˆ‚ğœ™âˆ‚x*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + 2.0*âˆ‚ğœ™âˆ‚x*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J] + 2.0*ğœ™*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚ğ’‘âˆ‚x[J]

                        âˆ‚Â²ğ— âˆ‚xâˆ‚y[I,J] += âˆ‚Â²ğœ™âˆ‚xâˆ‚y*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[J] + âˆ‚ğœ™âˆ‚x*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + âˆ‚ğœ™âˆ‚y*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + âˆ‚ğœ™âˆ‚x*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J] + âˆ‚ğœ™âˆ‚y*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J] + ğœ™*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚ğ’‘âˆ‚y[J] + ğœ™*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚ğ’‘âˆ‚x[J]

                        âˆ‚Â²ğ— âˆ‚yÂ²[I,J] += âˆ‚Â²ğœ™âˆ‚yÂ²*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚yÂ²[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚yÂ²[J] + 2.0*âˆ‚ğœ™âˆ‚y*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + 2.0*âˆ‚ğœ™âˆ‚y*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J] + 2.0*ğœ™*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚ğ’‘âˆ‚y[J]

                        âˆ‚Â³ğ— âˆ‚xÂ³[I,J] += âˆ‚Â³ğœ™âˆ‚xÂ³*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â³ğ’‘âˆ‚xÂ³[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â³ğ’‘âˆ‚xÂ³[J] + 3.0*âˆ‚Â²ğœ™âˆ‚xÂ²*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + 3.0*âˆ‚ğœ™âˆ‚x*âˆ‚Â²ğ’‘âˆ‚xÂ²[I]*ğ’‘[J] + 3.0*âˆ‚Â²ğœ™âˆ‚xÂ²*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J] + 3.0*âˆ‚ğœ™âˆ‚x*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚xÂ²[J] + 3.0*ğœ™*âˆ‚Â²ğ’‘âˆ‚xÂ²[I]*âˆ‚ğ’‘âˆ‚x[J] + 3.0*ğœ™*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚Â²ğ’‘âˆ‚xÂ²[J] + 6.0*âˆ‚ğœ™âˆ‚x*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚ğ’‘âˆ‚x[J]

                        âˆ‚Â³ğ— âˆ‚xÂ²âˆ‚y[I,J] += âˆ‚Â³ğœ™âˆ‚xÂ²âˆ‚y*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â³ğ’‘âˆ‚xÂ²âˆ‚y[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â³ğ’‘âˆ‚xÂ²âˆ‚y[J] + 2.0*âˆ‚Â²ğœ™âˆ‚xâˆ‚y*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + âˆ‚Â²ğœ™âˆ‚xÂ²*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + 2.0*âˆ‚ğœ™âˆ‚x*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[I]*ğ’‘[J] + âˆ‚ğœ™âˆ‚y*âˆ‚Â²ğ’‘âˆ‚xÂ²[I]*ğ’‘[J] + 2.0*âˆ‚Â²ğœ™âˆ‚xâˆ‚y*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J] + âˆ‚Â²ğœ™âˆ‚xÂ²*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J] + 2.0*âˆ‚ğœ™âˆ‚x*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[J] + âˆ‚ğœ™âˆ‚y*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚xÂ²[J] + 2.0*ğœ™*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[I]*âˆ‚ğ’‘âˆ‚x[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚xÂ²[I]*âˆ‚ğ’‘âˆ‚y[J] + 2.0*ğœ™*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[J] + ğœ™*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚Â²ğ’‘âˆ‚xÂ²[J] + 2.0*âˆ‚ğœ™âˆ‚y*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚ğ’‘âˆ‚x[J] + 2.0*âˆ‚ğœ™âˆ‚x*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚ğ’‘âˆ‚x[J] + 2.0*âˆ‚ğœ™âˆ‚x*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚ğ’‘âˆ‚y[J]

                        âˆ‚Â³ğ— âˆ‚xâˆ‚yÂ²[I,J] += âˆ‚Â³ğœ™âˆ‚xâˆ‚yÂ²*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â³ğ’‘âˆ‚xâˆ‚yÂ²[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â³ğ’‘âˆ‚xâˆ‚yÂ²[J] + 2.0*âˆ‚Â²ğœ™âˆ‚xâˆ‚y*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + âˆ‚Â²ğœ™âˆ‚yÂ²*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + 2.0*âˆ‚ğœ™âˆ‚y*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[I]*ğ’‘[J] + âˆ‚ğœ™âˆ‚x*âˆ‚Â²ğ’‘âˆ‚yÂ²[I]*ğ’‘[J] + 2.0*âˆ‚Â²ğœ™âˆ‚xâˆ‚y*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J] + âˆ‚Â²ğœ™âˆ‚yÂ²*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J] + 2.0*âˆ‚ğœ™âˆ‚y*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[J] + âˆ‚ğœ™âˆ‚x*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚yÂ²[J] + 2.0*ğœ™*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[I]*âˆ‚ğ’‘âˆ‚y[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚yÂ²[I]*âˆ‚ğ’‘âˆ‚x[J] + 2.0*ğœ™*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[J] + ğœ™*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚Â²ğ’‘âˆ‚yÂ²[J] + 2.0*âˆ‚ğœ™âˆ‚x*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚ğ’‘âˆ‚y[J] + 2.0*âˆ‚ğœ™âˆ‚y*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚ğ’‘âˆ‚y[J] + 2.0*âˆ‚ğœ™âˆ‚y*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚ğ’‘âˆ‚x[J]

                        âˆ‚Â³ğ— âˆ‚yÂ³[I,J] += âˆ‚Â³ğœ™âˆ‚yÂ³*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â³ğ’‘âˆ‚yÂ³[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â³ğ’‘âˆ‚yÂ³[J] + 3.0*âˆ‚Â²ğœ™âˆ‚yÂ²*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + 3.0*âˆ‚ğœ™âˆ‚y*âˆ‚Â²ğ’‘âˆ‚yÂ²[I]*ğ’‘[J] + 3.0*âˆ‚Â²ğœ™âˆ‚yÂ²*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J] + 3.0*âˆ‚ğœ™âˆ‚y*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚yÂ²[J] + 3.0*ğœ™*âˆ‚Â²ğ’‘âˆ‚yÂ²[I]*âˆ‚ğ’‘âˆ‚y[J] + 3.0*ğœ™*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚Â²ğ’‘âˆ‚yÂ²[J] + 6.0*âˆ‚ğœ™âˆ‚y*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚ğ’‘âˆ‚y[J]
                    end
                end
            end
            cholesky!(ğ— )
            U = inverse!(ğ— )
            Uáµ€âˆ‚ğ— âˆ‚xU = Uáµ€AU!(âˆ‚ğ— âˆ‚x,U)
            Uáµ€âˆ‚ğ— âˆ‚yU = Uáµ€AU!(âˆ‚ğ— âˆ‚y,U)
            Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U = Uáµ€AU!(âˆ‚Â²ğ— âˆ‚xÂ²,U)
            Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U = Uáµ€AU!(âˆ‚Â²ğ— âˆ‚yÂ²,U)
            Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU = Uáµ€AU!(âˆ‚Â²ğ— âˆ‚xâˆ‚y,U)
            Uáµ€âˆ‚Â³ğ— âˆ‚xÂ³U = Uáµ€AU!(âˆ‚Â³ğ— âˆ‚xÂ³,U)
            Uáµ€âˆ‚Â³ğ— âˆ‚xÂ²âˆ‚yU = Uáµ€AU!(âˆ‚Â³ğ— âˆ‚xÂ²âˆ‚y,U)
            Uáµ€âˆ‚Â³ğ— âˆ‚xâˆ‚yÂ²U = Uáµ€AU!(âˆ‚Â³ğ— âˆ‚xâˆ‚yÂ²,U)
            Uáµ€âˆ‚Â³ğ— âˆ‚yÂ³U = Uáµ€AU!(âˆ‚Â³ğ— âˆ‚yÂ³,U)

            for i in 1:n
                for j in 1:i
                    for k in 1:n
                        Uáµ€âˆ‚Â³ğ— âˆ‚xÂ³U[i,j] -= 3*Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U[i,k]*Uáµ€âˆ‚ğ— âˆ‚xU[k,j]
                        Uáµ€âˆ‚Â³ğ— âˆ‚xÂ²âˆ‚yU[i,j] -= 2*Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU[i,k]*Uáµ€âˆ‚ğ— âˆ‚xU[k,j]+Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U[i,k]*Uáµ€âˆ‚ğ— âˆ‚yU[k,j]
                        Uáµ€âˆ‚Â³ğ— âˆ‚xâˆ‚yÂ²U[i,j] -= 2*Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU[i,k]*Uáµ€âˆ‚ğ— âˆ‚yU[k,j]+Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U[i,k]*Uáµ€âˆ‚ğ— âˆ‚xU[k,j]
                        Uáµ€âˆ‚Â³ğ— âˆ‚yÂ³U[i,j] -= 3*Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U[i,k]*Uáµ€âˆ‚ğ— âˆ‚yU[k,j]
                    end
                end
                for j in 1:i
                    for k in 1:n
                        Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U[i,j] -= 2*Uáµ€âˆ‚ğ— âˆ‚xU[i,k]*Uáµ€âˆ‚ğ— âˆ‚xU[k,j]
                        Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U[i,j] -= 2*Uáµ€âˆ‚ğ— âˆ‚yU[i,k]*Uáµ€âˆ‚ğ— âˆ‚yU[k,j]
                        Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU[i,j] -= Uáµ€âˆ‚ğ— âˆ‚xU[i,k]*Uáµ€âˆ‚ğ— âˆ‚yU[k,j] + Uáµ€âˆ‚ğ— âˆ‚yU[i,k]*Uáµ€âˆ‚ğ— âˆ‚xU[k,j]
                    end
                end
            end
            for i in 1:n
                for j in 1:i
                    for k in 1:n
                        Uáµ€âˆ‚Â³ğ— âˆ‚xÂ³U[i,j] -= 3*Uáµ€âˆ‚ğ— âˆ‚xU[i,k]*Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U[k,j]
                        Uáµ€âˆ‚Â³ğ— âˆ‚xÂ²âˆ‚yU[i,j] -= 2*Uáµ€âˆ‚ğ— âˆ‚xU[i,k]*Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU[k,j]+Uáµ€âˆ‚ğ— âˆ‚yU[i,k]*Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U[k,j]
                        Uáµ€âˆ‚Â³ğ— âˆ‚xâˆ‚yÂ²U[i,j] -= 2*Uáµ€âˆ‚ğ— âˆ‚yU[i,k]*Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU[k,j]+Uáµ€âˆ‚ğ— âˆ‚xU[i,k]*Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U[k,j]
                        Uáµ€âˆ‚Â³ğ— âˆ‚yÂ³U[i,j] -= 3*Uáµ€âˆ‚ğ— âˆ‚yU[i,k]*Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U[k,j]
                    end
                end
            end

            âˆ‚Â³ğ— â»Â¹âˆ‚xÂ³ = - UAUáµ€!(Uáµ€âˆ‚Â³ğ— âˆ‚xÂ³U,U)
            âˆ‚Â³ğ— â»Â¹âˆ‚xÂ²âˆ‚y = - UAUáµ€!(Uáµ€âˆ‚Â³ğ— âˆ‚xÂ²âˆ‚yU,U)
            âˆ‚Â³ğ— â»Â¹âˆ‚xâˆ‚yÂ² = - UAUáµ€!(Uáµ€âˆ‚Â³ğ— âˆ‚xâˆ‚yÂ²U,U)
            âˆ‚Â³ğ— â»Â¹âˆ‚yÂ³ = - UAUáµ€!(Uáµ€âˆ‚Â³ğ— âˆ‚yÂ³U,U)
            âˆ‚Â²ğ— â»Â¹âˆ‚xÂ² = - UAUáµ€!(Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U,U)
            âˆ‚Â²ğ— â»Â¹âˆ‚yÂ² = - UAUáµ€!(Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U,U)
            âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚y = - UAUáµ€!(Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU,U)
            âˆ‚ğ— â»Â¹âˆ‚x = - UAUáµ€!(Uáµ€âˆ‚ğ— âˆ‚xU,U)
            âˆ‚ğ— â»Â¹âˆ‚y = - UAUáµ€!(Uáµ€âˆ‚ğ— âˆ‚yU,U)
            ğ— â»Â¹ = UUáµ€!(U)

            return ğ— â»Â¹, âˆ‚ğ— â»Â¹âˆ‚x, âˆ‚ğ— â»Â¹âˆ‚y, âˆ‚Â²ğ— â»Â¹âˆ‚xÂ², âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚y, âˆ‚Â²ğ— â»Â¹âˆ‚yÂ², âˆ‚Â³ğ— â»Â¹âˆ‚xÂ³, âˆ‚Â³ğ— â»Â¹âˆ‚xÂ²âˆ‚y, âˆ‚Â³ğ— â»Â¹âˆ‚xâˆ‚yÂ², âˆ‚Â³ğ— â»Â¹âˆ‚yÂ³
        end

        function setâˆ‡Â²ğ­!(ap::ReproducingKernel{$ğ’‘},ğ’™::Node)
            ğ“’ = ap.ğ“’
            ğ­ = ğ’™[:ğ­]
            âˆ‚ğ­âˆ‚x = ğ’™[:âˆ‚ğ­âˆ‚x]
            âˆ‚ğ­âˆ‚y = ğ’™[:âˆ‚ğ­âˆ‚y]
            âˆ‚Â²ğ­âˆ‚xÂ² = ğ’™[:âˆ‚Â²ğ­âˆ‚xÂ²]
            âˆ‚Â²ğ­âˆ‚yÂ² = ğ’™[:âˆ‚Â²ğ­âˆ‚yÂ²]
            âˆ‚Â²ğ­âˆ‚xâˆ‚y = ğ’™[:âˆ‚Â²ğ­âˆ‚xâˆ‚y]
            ğ’‘â‚€áµ€ğ— â»Â¹, ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚x, ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚y, ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xÂ², ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚y, ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚yÂ² = calâˆ‡Â²ğ— !(ap,ğ’™)
            for (i,ğ’™áµ¢) in enumerate(ğ“’)
                Î”ğ’™ = ğ’™ - ğ’™áµ¢
                ğ’‘, âˆ‚ğ’‘âˆ‚x, âˆ‚ğ’‘âˆ‚y, âˆ‚Â²ğ’‘âˆ‚xÂ², âˆ‚Â²ğ’‘âˆ‚xâˆ‚y, âˆ‚Â²ğ’‘âˆ‚yÂ² = getâˆ‡Â²ğ’‘(ap,Î”ğ’™)
                ğœ™, âˆ‚ğœ™âˆ‚x, âˆ‚ğœ™âˆ‚y, âˆ‚Â²ğœ™âˆ‚xÂ², âˆ‚Â²ğœ™âˆ‚xâˆ‚y, âˆ‚Â²ğœ™âˆ‚yÂ² = getâˆ‡Â²ğœ™(ap,ğ’™áµ¢,Î”ğ’™)
                ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘ = ğ’‘â‚€áµ€ğ— â»Â¹*ğ’‘
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xğ’‘ = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚x*ğ’‘
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yğ’‘ = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚y*ğ’‘
                ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚x = ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚ğ’‘âˆ‚x
                ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚y = ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚ğ’‘âˆ‚y
                ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xÂ²ğ’‘ = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xÂ²*ğ’‘
                ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚yÂ²ğ’‘ = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚yÂ²*ğ’‘
                ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚xÂ² = ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚Â²ğ’‘âˆ‚xÂ²
                ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚yÂ² = ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚Â²ğ’‘âˆ‚yÂ²
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xâˆ‚ğ’‘âˆ‚x = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚x*âˆ‚ğ’‘âˆ‚x
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yâˆ‚ğ’‘âˆ‚y = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚y*âˆ‚ğ’‘âˆ‚y
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xâˆ‚ğ’‘âˆ‚y = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚x*âˆ‚ğ’‘âˆ‚y
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yâˆ‚ğ’‘âˆ‚x = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚y*âˆ‚ğ’‘âˆ‚x
                ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚yğ’‘ = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚y*ğ’‘
                ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚xâˆ‚y = ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y

                ğ­[i] = ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*ğœ™
                âˆ‚ğ­âˆ‚x[i] = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚x*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*âˆ‚ğœ™âˆ‚x
                âˆ‚ğ­âˆ‚y[i] = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚y*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*âˆ‚ğœ™âˆ‚y

                âˆ‚Â²ğ­âˆ‚xÂ²[i] = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xÂ²ğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚xÂ²*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*âˆ‚Â²ğœ™âˆ‚xÂ² + 2.0*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xâˆ‚ğ’‘âˆ‚x*ğœ™ + 2.0*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xğ’‘*âˆ‚ğœ™âˆ‚x + 2.0*ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚x*âˆ‚ğœ™âˆ‚x

                âˆ‚Â²ğ­âˆ‚yÂ²[i] = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚yÂ²ğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚yÂ²*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*âˆ‚Â²ğœ™âˆ‚yÂ² + 2.0*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yâˆ‚ğ’‘âˆ‚y*ğœ™ + 2.0*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yğ’‘*âˆ‚ğœ™âˆ‚y + 2.0*ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚y*âˆ‚ğœ™âˆ‚y

                âˆ‚Â²ğ­âˆ‚xâˆ‚y[i] = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚yğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚xâˆ‚y*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*âˆ‚Â²ğœ™âˆ‚xâˆ‚y + ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xâˆ‚ğ’‘âˆ‚y*ğœ™ + ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yâˆ‚ğ’‘âˆ‚x*ğœ™ + ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xğ’‘*âˆ‚ğœ™âˆ‚y + ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yğ’‘*âˆ‚ğœ™âˆ‚x + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚x*âˆ‚ğœ™âˆ‚y +ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚y*âˆ‚ğœ™âˆ‚x
            end
        end

        function setâˆ‡Â³ğ­!(ap::ReproducingKernel{$ğ’‘},ğ’™::Node)
            ğ“’ = ap.ğ“’
            ğ­ = ğ’™[:ğ­]
            âˆ‚ğ­âˆ‚x = ğ’™[:âˆ‚ğ­âˆ‚x]
            âˆ‚ğ­âˆ‚y = ğ’™[:âˆ‚ğ­âˆ‚y]
            âˆ‚Â²ğ­âˆ‚xÂ² = ğ’™[:âˆ‚Â²ğ­âˆ‚xÂ²]
            âˆ‚Â²ğ­âˆ‚yÂ² = ğ’™[:âˆ‚Â²ğ­âˆ‚yÂ²]
            âˆ‚Â²ğ­âˆ‚xâˆ‚y = ğ’™[:âˆ‚Â²ğ­âˆ‚xâˆ‚y]
            âˆ‚Â³ğ­âˆ‚xÂ³ = ğ’™[:âˆ‚Â³ğ­âˆ‚xÂ³]
            âˆ‚Â³ğ­âˆ‚xÂ²âˆ‚y = ğ’™[:âˆ‚Â³ğ­âˆ‚xÂ²âˆ‚y]
            âˆ‚Â³ğ­âˆ‚xâˆ‚yÂ² = ğ’™[:âˆ‚Â³ğ­âˆ‚xâˆ‚yÂ²]
            âˆ‚Â³ğ­âˆ‚yÂ³ = ğ’™[:âˆ‚Â³ğ­âˆ‚yÂ³]
            ğ’‘â‚€áµ€ğ— â»Â¹, ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚x, ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚y, ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xÂ², ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚y, ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚yÂ², ğ’‘â‚€áµ€âˆ‚Â³ğ— â»Â¹âˆ‚xÂ³, ğ’‘â‚€áµ€âˆ‚Â³ğ— â»Â¹âˆ‚xÂ²âˆ‚y, ğ’‘â‚€áµ€âˆ‚Â³ğ— â»Â¹âˆ‚xâˆ‚yÂ², ğ’‘â‚€áµ€âˆ‚Â³ğ— â»Â¹âˆ‚yÂ³ = calâˆ‡Â³ğ— !(ap,ğ’™)
            for (i,ğ’™áµ¢) in enumerate(ğ“’)
                Î”ğ’™ = ğ’™ - ğ’™áµ¢
                ğ’‘, âˆ‚ğ’‘âˆ‚x, âˆ‚ğ’‘âˆ‚y, âˆ‚Â²ğ’‘âˆ‚xÂ², âˆ‚Â²ğ’‘âˆ‚xâˆ‚y, âˆ‚Â²ğ’‘âˆ‚yÂ², âˆ‚Â³ğ’‘âˆ‚xÂ³, âˆ‚Â³ğ’‘âˆ‚xÂ²âˆ‚y, âˆ‚Â³ğ’‘âˆ‚xâˆ‚yÂ², âˆ‚Â³ğ’‘âˆ‚yÂ³ = getâˆ‡Â³ğ’‘(ap,Î”ğ’™)
                ğœ™, âˆ‚ğœ™âˆ‚x, âˆ‚ğœ™âˆ‚y, âˆ‚Â²ğœ™âˆ‚xÂ², âˆ‚Â²ğœ™âˆ‚xâˆ‚y, âˆ‚Â²ğœ™âˆ‚yÂ², âˆ‚Â³ğœ™âˆ‚xÂ³, âˆ‚Â³ğœ™âˆ‚xÂ²âˆ‚y, âˆ‚Â³ğœ™âˆ‚xâˆ‚yÂ², âˆ‚Â³ğœ™âˆ‚yÂ³ = getâˆ‡Â³ğœ™(ap,ğ’™áµ¢,Î”ğ’™)
                ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘ = ğ’‘â‚€áµ€ğ— â»Â¹*ğ’‘
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xğ’‘ = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚x*ğ’‘
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yğ’‘ = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚y*ğ’‘
                ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚x = ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚ğ’‘âˆ‚x
                ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚y = ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚ğ’‘âˆ‚y
                ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xÂ²ğ’‘ = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xÂ²*ğ’‘
                ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚yğ’‘ = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚y*ğ’‘
                ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚yÂ²ğ’‘ = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚yÂ²*ğ’‘
                ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚xÂ² = ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚Â²ğ’‘âˆ‚xÂ²
                ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚xâˆ‚y = ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y
                ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚yÂ² = ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚Â²ğ’‘âˆ‚yÂ²
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xâˆ‚ğ’‘âˆ‚x = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚x*âˆ‚ğ’‘âˆ‚x
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xâˆ‚ğ’‘âˆ‚y = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚x*âˆ‚ğ’‘âˆ‚y
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yâˆ‚ğ’‘âˆ‚x = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚y*âˆ‚ğ’‘âˆ‚x
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yâˆ‚ğ’‘âˆ‚y = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚y*âˆ‚ğ’‘âˆ‚y
                ğ’‘â‚€áµ€âˆ‚Â³ğ— â»Â¹âˆ‚xÂ³ğ’‘ = ğ’‘â‚€áµ€âˆ‚Â³ğ— â»Â¹âˆ‚xÂ³*ğ’‘
                ğ’‘â‚€áµ€âˆ‚Â³ğ— â»Â¹âˆ‚xÂ²âˆ‚yğ’‘ = ğ’‘â‚€áµ€âˆ‚Â³ğ— â»Â¹âˆ‚xÂ²âˆ‚y*ğ’‘
                ğ’‘â‚€áµ€âˆ‚Â³ğ— â»Â¹âˆ‚xâˆ‚yÂ²ğ’‘ = ğ’‘â‚€áµ€âˆ‚Â³ğ— â»Â¹âˆ‚xâˆ‚yÂ²*ğ’‘
                ğ’‘â‚€áµ€âˆ‚Â³ğ— â»Â¹âˆ‚yÂ³ğ’‘ = ğ’‘â‚€áµ€âˆ‚Â³ğ— â»Â¹âˆ‚yÂ³*ğ’‘
                ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â³ğ’‘âˆ‚xÂ³ = ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚Â³ğ’‘âˆ‚xÂ³
                ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â³ğ’‘âˆ‚xÂ²âˆ‚y = ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚Â³ğ’‘âˆ‚xÂ²âˆ‚y
                ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â³ğ’‘âˆ‚xâˆ‚yÂ² = ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚Â³ğ’‘âˆ‚xâˆ‚yÂ²
                ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â³ğ’‘âˆ‚yÂ³ = ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚Â³ğ’‘âˆ‚yÂ³
                ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xÂ²âˆ‚ğ’‘âˆ‚x = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xÂ²*âˆ‚ğ’‘âˆ‚x
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xâˆ‚Â²ğ’‘âˆ‚xÂ² = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚x*âˆ‚Â²ğ’‘âˆ‚xÂ²
                ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xÂ²âˆ‚ğ’‘âˆ‚y = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xÂ²*âˆ‚ğ’‘âˆ‚y
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yâˆ‚Â²ğ’‘âˆ‚xÂ² = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚y*âˆ‚Â²ğ’‘âˆ‚xÂ²
                ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚yâˆ‚ğ’‘âˆ‚x = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚y*âˆ‚ğ’‘âˆ‚x
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xâˆ‚Â²ğ’‘âˆ‚xâˆ‚y = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚x*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y
                ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚yÂ²âˆ‚ğ’‘âˆ‚x = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚yÂ²*âˆ‚ğ’‘âˆ‚x
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xâˆ‚Â²ğ’‘âˆ‚yÂ² = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚x*âˆ‚Â²ğ’‘âˆ‚yÂ²
                ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚yâˆ‚ğ’‘âˆ‚y = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚y*âˆ‚ğ’‘âˆ‚y
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yâˆ‚Â²ğ’‘âˆ‚xâˆ‚y = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚y*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y
                ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚yÂ²âˆ‚ğ’‘âˆ‚y = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚yÂ²*âˆ‚ğ’‘âˆ‚y
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yâˆ‚Â²ğ’‘âˆ‚yÂ² = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚y*âˆ‚Â²ğ’‘âˆ‚yÂ²

                ğ­[i] = ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*ğœ™
                âˆ‚ğ­âˆ‚x[i] = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚x*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*âˆ‚ğœ™âˆ‚x
                âˆ‚ğ­âˆ‚y[i] = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚y*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*âˆ‚ğœ™âˆ‚y

                âˆ‚Â²ğ­âˆ‚xÂ²[i] = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xÂ²ğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚xÂ²*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*âˆ‚Â²ğœ™âˆ‚xÂ² + 2.0*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xâˆ‚ğ’‘âˆ‚x*ğœ™ + 2.0*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xğ’‘*âˆ‚ğœ™âˆ‚x + 2.0*ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚x*âˆ‚ğœ™âˆ‚x

                âˆ‚Â²ğ­âˆ‚yÂ²[i] = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚yÂ²ğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚yÂ²*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*âˆ‚Â²ğœ™âˆ‚yÂ² + 2.0*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yâˆ‚ğ’‘âˆ‚y*ğœ™ + 2.0*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yğ’‘*âˆ‚ğœ™âˆ‚y + 2.0*ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚y*âˆ‚ğœ™âˆ‚y

                âˆ‚Â²ğ­âˆ‚xâˆ‚y[i] = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚yğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚xâˆ‚y*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*âˆ‚Â²ğœ™âˆ‚xâˆ‚y + ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xâˆ‚ğ’‘âˆ‚y*ğœ™ + ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yâˆ‚ğ’‘âˆ‚x*ğœ™ + ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xğ’‘*âˆ‚ğœ™âˆ‚y + ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yğ’‘*âˆ‚ğœ™âˆ‚x + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚x*âˆ‚ğœ™âˆ‚y +ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚y*âˆ‚ğœ™âˆ‚x

                âˆ‚Â³ğ­âˆ‚xÂ³[i] = ğ’‘â‚€áµ€âˆ‚Â³ğ— â»Â¹âˆ‚xÂ³ğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â³ğ’‘âˆ‚xÂ³*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*âˆ‚Â³ğœ™âˆ‚xÂ³ + 3*ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xÂ²âˆ‚ğ’‘âˆ‚x*ğœ™  + 3*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xâˆ‚Â²ğ’‘âˆ‚xÂ²*ğœ™ + 3*ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xÂ²ğ’‘*âˆ‚ğœ™âˆ‚x + 3*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xğ’‘*âˆ‚Â²ğœ™âˆ‚xÂ² + 3*ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚xÂ²*âˆ‚ğœ™âˆ‚x + 3*ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚x*âˆ‚Â²ğœ™âˆ‚xÂ² + 6*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xâˆ‚ğ’‘âˆ‚x*âˆ‚ğœ™âˆ‚x

                âˆ‚Â³ğ­âˆ‚xÂ²âˆ‚y[i] = ğ’‘â‚€áµ€âˆ‚Â³ğ— â»Â¹âˆ‚xÂ²âˆ‚yğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â³ğ’‘âˆ‚xÂ²âˆ‚y*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*âˆ‚Â³ğœ™âˆ‚xÂ²âˆ‚y + 2*ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚yâˆ‚ğ’‘âˆ‚x*ğœ™ + ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xÂ²âˆ‚ğ’‘âˆ‚y*ğœ™ + 2*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xâˆ‚Â²ğ’‘âˆ‚xâˆ‚y*ğœ™ + ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yâˆ‚Â²ğ’‘âˆ‚xÂ²*ğœ™ + 2*ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚yğ’‘*âˆ‚ğœ™âˆ‚x + ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xÂ²ğ’‘*âˆ‚ğœ™âˆ‚y + 2*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xğ’‘*âˆ‚Â²ğœ™âˆ‚xâˆ‚y + ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yğ’‘*âˆ‚Â²ğœ™âˆ‚xÂ² + 2*ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚xâˆ‚y*âˆ‚ğœ™âˆ‚x + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚xÂ²*âˆ‚ğœ™âˆ‚y + 2*ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚x*âˆ‚Â²ğœ™âˆ‚xâˆ‚y + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚y*âˆ‚Â²ğœ™âˆ‚xÂ² + 2*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yâˆ‚ğ’‘âˆ‚x*âˆ‚ğœ™âˆ‚x + 2*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xâˆ‚ğ’‘âˆ‚y*âˆ‚ğœ™âˆ‚x + 2*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xâˆ‚ğ’‘âˆ‚x*âˆ‚ğœ™âˆ‚y

                âˆ‚Â³ğ­âˆ‚xâˆ‚yÂ²[i] = ğ’‘â‚€áµ€âˆ‚Â³ğ— â»Â¹âˆ‚xâˆ‚yÂ²ğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â³ğ’‘âˆ‚xâˆ‚yÂ²*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*âˆ‚Â³ğœ™âˆ‚xâˆ‚yÂ² + 2*ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚yâˆ‚ğ’‘âˆ‚y*ğœ™ + ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚yÂ²âˆ‚ğ’‘âˆ‚x*ğœ™ + 2*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yâˆ‚Â²ğ’‘âˆ‚xâˆ‚y*ğœ™ + ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xâˆ‚Â²ğ’‘âˆ‚yÂ²*ğœ™ + 2*ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚yğ’‘*âˆ‚ğœ™âˆ‚y + ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚yÂ²ğ’‘*âˆ‚ğœ™âˆ‚x + 2*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yğ’‘*âˆ‚Â²ğœ™âˆ‚xâˆ‚y + ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xğ’‘*âˆ‚Â²ğœ™âˆ‚yÂ² + 2*ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚xâˆ‚y*âˆ‚ğœ™âˆ‚y + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚yÂ²*âˆ‚ğœ™âˆ‚x + 2*ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚y*âˆ‚Â²ğœ™âˆ‚xâˆ‚y + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚x*âˆ‚Â²ğœ™âˆ‚yÂ² + 2*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xâˆ‚ğ’‘âˆ‚y*âˆ‚ğœ™âˆ‚y + 2*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yâˆ‚ğ’‘âˆ‚x*âˆ‚ğœ™âˆ‚y + 2*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yâˆ‚ğ’‘âˆ‚y*âˆ‚ğœ™âˆ‚x

                âˆ‚Â³ğ­âˆ‚yÂ³[i] = ğ’‘â‚€áµ€âˆ‚Â³ğ— â»Â¹âˆ‚yÂ³ğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â³ğ’‘âˆ‚yÂ³*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*âˆ‚Â³ğœ™âˆ‚yÂ³ + 3*ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚yÂ²âˆ‚ğ’‘âˆ‚y*ğœ™  + 3*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yâˆ‚Â²ğ’‘âˆ‚yÂ²*ğœ™ + 3*ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚yÂ²ğ’‘*âˆ‚ğœ™âˆ‚y + 3*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yğ’‘*âˆ‚Â²ğœ™âˆ‚yÂ² + 3*ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚yÂ²*âˆ‚ğœ™âˆ‚y + 3*ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚y*âˆ‚Â²ğœ™âˆ‚yÂ² + 6*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yâˆ‚ğ’‘âˆ‚y*âˆ‚ğœ™âˆ‚y
            end
        end
    end
end

for ğ’‘ in (:(:Linear3D),:(:Quadratic3D),:(:Cubic3D))
    @eval begin
        getâˆ‡ğ’‘(ap::ReproducingKernel{$ğ’‘},x::Any) = getğ’‘(ap,x),getâˆ‚ğ’‘âˆ‚x(ap,x),getâˆ‚ğ’‘âˆ‚y(ap,x),getâˆ‚ğ’‘âˆ‚z(ap,x)

        function calâˆ‡ğ— !(ap::ReproducingKernel{$ğ’‘},x::Node)
            ğ“’ = ap.ğ“’
            ğ—  = getğ— (ap,:ğ— )
            âˆ‚ğ— âˆ‚x = getğ— (ap,:âˆ‚ğ— âˆ‚x)
            âˆ‚ğ— âˆ‚y = getğ— (ap,:âˆ‚ğ— âˆ‚y)
            âˆ‚ğ— âˆ‚z = getğ— (ap,:âˆ‚ğ— âˆ‚z)
            n = getğ‘›ğ’‘(ap)
            for xáµ¢ in ğ“’
                Î”x = x - xáµ¢
                ğ’‘, âˆ‚ğ’‘âˆ‚x, âˆ‚ğ’‘âˆ‚y, âˆ‚ğ’‘âˆ‚z = getâˆ‡ğ’‘(ap,Î”x)
                ğœ™, âˆ‚ğœ™âˆ‚x, âˆ‚ğœ™âˆ‚y, âˆ‚ğœ™âˆ‚z = getâˆ‡ğœ™(ap,xáµ¢,Î”x)
                for I in 1:n
                    for J in 1:I
                        ğ— [I,J] += ğœ™*ğ’‘[I]*ğ’‘[J]
                        âˆ‚ğ— âˆ‚x[I,J] += âˆ‚ğœ™âˆ‚x*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J]
                        âˆ‚ğ— âˆ‚y[I,J] += âˆ‚ğœ™âˆ‚y*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J]
                        âˆ‚ğ— âˆ‚z[I,J] += âˆ‚ğœ™âˆ‚z*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚z[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚z[J]
                    end
                end
            end
            cholesky!(ğ— )
            U = inverse!(ğ— )
            âˆ‚ğ— â»Â¹âˆ‚x = - UUáµ€AUUáµ€!(âˆ‚ğ— âˆ‚x,U)
            âˆ‚ğ— â»Â¹âˆ‚y = - UUáµ€AUUáµ€!(âˆ‚ğ— âˆ‚y,U)
            âˆ‚ğ— â»Â¹âˆ‚z = - UUáµ€AUUáµ€!(âˆ‚ğ— âˆ‚z,U)
            ğ— â»Â¹ = UUáµ€!(U)
            return ğ— â»Â¹, âˆ‚ğ— â»Â¹âˆ‚x, âˆ‚ğ— â»Â¹âˆ‚y, âˆ‚ğ— â»Â¹âˆ‚z
        end

        function setâˆ‡ğ­!(ap::ReproducingKernel{$ğ’‘},ğ’™::Node)
            ğ“’ = ap.ğ“’
            ğ­ = ğ’™[:ğ­]
            âˆ‚ğ­âˆ‚x = ğ’™[:âˆ‚ğ­âˆ‚x]
            âˆ‚ğ­âˆ‚y = ğ’™[:âˆ‚ğ­âˆ‚y]
            âˆ‚ğ­âˆ‚z = ğ’™[:âˆ‚ğ­âˆ‚z]
            ğ’‘â‚€áµ€ğ— â»Â¹, ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚x, ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚y, ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚z= calâˆ‡ğ— !(ap,ğ’™)
            for (i,ğ’™áµ¢) in enumerate(ğ“’)
                Î”ğ’™ = ğ’™ - ğ’™áµ¢
                ğ’‘, âˆ‚ğ’‘âˆ‚x, âˆ‚ğ’‘âˆ‚y, âˆ‚ğ’‘âˆ‚z = getâˆ‡ğ’‘(ap,Î”ğ’™)
                ğœ™, âˆ‚ğœ™âˆ‚x, âˆ‚ğœ™âˆ‚y, âˆ‚ğœ™âˆ‚z = getâˆ‡ğœ™(ap,ğ’™áµ¢,Î”ğ’™)
                ğ­[i] = ğ’‘â‚€áµ€ğ— â»Â¹*ğ’‘*ğœ™
                âˆ‚ğ­âˆ‚x[i] = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚x*ğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚ğ’‘âˆ‚x*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹*ğ’‘*âˆ‚ğœ™âˆ‚x
                âˆ‚ğ­âˆ‚y[i] = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚y*ğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚ğ’‘âˆ‚y*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹*ğ’‘*âˆ‚ğœ™âˆ‚y
                âˆ‚ğ­âˆ‚z[i] = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚z*ğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚ğ’‘âˆ‚z*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹*ğ’‘*âˆ‚ğœ™âˆ‚z
            end
        end

        function calâˆ‡Â²ğ— !(ap::ReproducingKernel{$ğ’‘},x::Node)
            ğ“’ = ap.ğ“’
            ğ—  = getğ— (ap,:ğ— )
            âˆ‚ğ— âˆ‚x = getğ— (ap,:âˆ‚ğ— âˆ‚x)
            âˆ‚ğ— âˆ‚y = getğ— (ap,:âˆ‚ğ— âˆ‚y)
            âˆ‚ğ— âˆ‚z = getğ— (ap,:âˆ‚ğ— âˆ‚z)
            âˆ‚Â²ğ— âˆ‚xÂ² = getğ— (ap,:âˆ‚Â²ğ— âˆ‚xÂ²)
            âˆ‚Â²ğ— âˆ‚yÂ² = getğ— (ap,:âˆ‚Â²ğ— âˆ‚yÂ²)
            âˆ‚Â²ğ— âˆ‚zÂ² = getğ— (ap,:âˆ‚Â²ğ— âˆ‚zÂ²)
            âˆ‚Â²ğ— âˆ‚xâˆ‚y = getğ— (ap,:âˆ‚Â²ğ— âˆ‚xâˆ‚y)
            âˆ‚Â²ğ— âˆ‚xâˆ‚z = getğ— (ap,:âˆ‚Â²ğ— âˆ‚xâˆ‚z)
            âˆ‚Â²ğ— âˆ‚yâˆ‚z = getğ— (ap,:âˆ‚Â²ğ— âˆ‚yâˆ‚z)
            n = getğ‘›ğ’‘(ap)
            for xáµ¢ in ğ“’
                Î”x = x - xáµ¢
                ğ’‘, âˆ‚ğ’‘âˆ‚x, âˆ‚ğ’‘âˆ‚y, âˆ‚Â²ğ’‘âˆ‚xÂ², âˆ‚Â²ğ’‘âˆ‚xâˆ‚y, âˆ‚Â²ğ’‘âˆ‚yÂ², âˆ‚ğ’‘âˆ‚z, âˆ‚Â²ğ’‘âˆ‚xâˆ‚z, âˆ‚Â²ğ’‘âˆ‚yâˆ‚z, âˆ‚Â²ğ’‘âˆ‚zÂ² = getâˆ‡Â²ğ’‘(ap,Î”x)
                ğœ™, âˆ‚ğœ™âˆ‚x, âˆ‚ğœ™âˆ‚y, âˆ‚Â²ğœ™âˆ‚xÂ², âˆ‚Â²ğœ™âˆ‚xâˆ‚y, âˆ‚Â²ğœ™âˆ‚yÂ², âˆ‚ğœ™âˆ‚z, âˆ‚Â²ğœ™âˆ‚xâˆ‚z, âˆ‚Â²ğœ™âˆ‚yâˆ‚z, âˆ‚Â²ğœ™âˆ‚zÂ² = getâˆ‡Â²ğœ™(ap,xáµ¢,Î”x)
                for I in 1:n
                    for J in 1:I
                        ğ— [I,J] += ğœ™*ğ’‘[I]*ğ’‘[J]
                        âˆ‚ğ— âˆ‚x[I,J] += âˆ‚ğœ™âˆ‚x*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J]
                        âˆ‚ğ— âˆ‚y[I,J] += âˆ‚ğœ™âˆ‚y*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J]
                        âˆ‚ğ— âˆ‚z[I,J] += âˆ‚ğœ™âˆ‚z*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚z[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚z[J]

                        âˆ‚Â²ğ— âˆ‚xÂ²[I,J] += âˆ‚Â²ğœ™âˆ‚xÂ²*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚xÂ²[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚xÂ²[J] + 2.0*âˆ‚ğœ™âˆ‚x*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + 2.0*âˆ‚ğœ™âˆ‚x*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J] + 2.0*ğœ™*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚ğ’‘âˆ‚x[J]

                        âˆ‚Â²ğ— âˆ‚yÂ²[I,J] += âˆ‚Â²ğœ™âˆ‚yÂ²*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚yÂ²[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚yÂ²[J] + 2.0*âˆ‚ğœ™âˆ‚y*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + 2.0*âˆ‚ğœ™âˆ‚y*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J] + 2.0*ğœ™*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚ğ’‘âˆ‚y[J]

                        âˆ‚Â²ğ— âˆ‚zÂ²[I,J] += âˆ‚Â²ğœ™âˆ‚zÂ²*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚zÂ²[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚zÂ²[J] + 2.0*âˆ‚ğœ™âˆ‚z*âˆ‚ğ’‘âˆ‚z[I]*ğ’‘[J] + 2.0*âˆ‚ğœ™âˆ‚z*ğ’‘[I]*âˆ‚ğ’‘âˆ‚z[J] + 2.0*ğœ™*âˆ‚ğ’‘âˆ‚z[I]*âˆ‚ğ’‘âˆ‚z[J]

                        âˆ‚Â²ğ— âˆ‚xâˆ‚y[I,J] += âˆ‚Â²ğœ™âˆ‚xâˆ‚y*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[J] + âˆ‚ğœ™âˆ‚x*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + âˆ‚ğœ™âˆ‚y*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + âˆ‚ğœ™âˆ‚x*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J] + âˆ‚ğœ™âˆ‚y*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J] + ğœ™*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚ğ’‘âˆ‚y[J] + ğœ™*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚ğ’‘âˆ‚x[J]

                        âˆ‚Â²ğ— âˆ‚xâˆ‚z[I,J] += âˆ‚Â²ğœ™âˆ‚xâˆ‚z*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚xâˆ‚z[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚xâˆ‚z[J] + âˆ‚ğœ™âˆ‚x*âˆ‚ğ’‘âˆ‚z[I]*ğ’‘[J] + âˆ‚ğœ™âˆ‚z*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + âˆ‚ğœ™âˆ‚x*ğ’‘[I]*âˆ‚ğ’‘âˆ‚z[J] + âˆ‚ğœ™âˆ‚z*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J] + ğœ™*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚ğ’‘âˆ‚z[J] + ğœ™*âˆ‚ğ’‘âˆ‚z[I]*âˆ‚ğ’‘âˆ‚x[J]

                        âˆ‚Â²ğ— âˆ‚yâˆ‚z[I,J] += âˆ‚Â²ğœ™âˆ‚yâˆ‚z*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚yâˆ‚z[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚yâˆ‚z[J] + âˆ‚ğœ™âˆ‚y*âˆ‚ğ’‘âˆ‚z[I]*ğ’‘[J] + âˆ‚ğœ™âˆ‚z*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + âˆ‚ğœ™âˆ‚y*ğ’‘[I]*âˆ‚ğ’‘âˆ‚z[J] + âˆ‚ğœ™âˆ‚z*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J] + ğœ™*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚ğ’‘âˆ‚z[J] + ğœ™*âˆ‚ğ’‘âˆ‚z[I]*âˆ‚ğ’‘âˆ‚y[J]
                    end
                end
            end
            cholesky!(ğ— )
            U = inverse!(ğ— )
            Uáµ€âˆ‚ğ— âˆ‚xU = Uáµ€AU!(âˆ‚ğ— âˆ‚x,U)
            Uáµ€âˆ‚ğ— âˆ‚yU = Uáµ€AU!(âˆ‚ğ— âˆ‚y,U)
            Uáµ€âˆ‚ğ— âˆ‚zU = Uáµ€AU!(âˆ‚ğ— âˆ‚z,U)
            Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U = Uáµ€AU!(âˆ‚Â²ğ— âˆ‚xÂ²,U)
            Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U = Uáµ€AU!(âˆ‚Â²ğ— âˆ‚yÂ²,U)
            Uáµ€âˆ‚Â²ğ— âˆ‚zÂ²U = Uáµ€AU!(âˆ‚Â²ğ— âˆ‚zÂ²,U)
            Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU = Uáµ€AU!(âˆ‚Â²ğ— âˆ‚xâˆ‚y,U)
            Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚zU = Uáµ€AU!(âˆ‚Â²ğ— âˆ‚xâˆ‚z,U)
            Uáµ€âˆ‚Â²ğ— âˆ‚yâˆ‚zU = Uáµ€AU!(âˆ‚Â²ğ— âˆ‚yâˆ‚z,U)
            for i in 1:n
                for j in 1:i
                    for k in 1:n
                        Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U[i,j] -= 2*Uáµ€âˆ‚ğ— âˆ‚xU[i,k]*Uáµ€âˆ‚ğ— âˆ‚xU[k,j]
                        Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U[i,j] -= 2*Uáµ€âˆ‚ğ— âˆ‚yU[i,k]*Uáµ€âˆ‚ğ— âˆ‚yU[k,j]
                        Uáµ€âˆ‚Â²ğ— âˆ‚zÂ²U[i,j] -= 2*Uáµ€âˆ‚ğ— âˆ‚zU[i,k]*Uáµ€âˆ‚ğ— âˆ‚zU[k,j]
                        Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU[i,j] -= Uáµ€âˆ‚ğ— âˆ‚xU[i,k]*Uáµ€âˆ‚ğ— âˆ‚yU[k,j] + Uáµ€âˆ‚ğ— âˆ‚yU[i,k]*Uáµ€âˆ‚ğ— âˆ‚xU[k,j]
                        Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚zU[i,j] -= Uáµ€âˆ‚ğ— âˆ‚xU[i,k]*Uáµ€âˆ‚ğ— âˆ‚zU[k,j] + Uáµ€âˆ‚ğ— âˆ‚zU[i,k]*Uáµ€âˆ‚ğ— âˆ‚xU[k,j]
                        Uáµ€âˆ‚Â²ğ— âˆ‚yâˆ‚zU[i,j] -= Uáµ€âˆ‚ğ— âˆ‚yU[i,k]*Uáµ€âˆ‚ğ— âˆ‚zU[k,j] + Uáµ€âˆ‚ğ— âˆ‚zU[i,k]*Uáµ€âˆ‚ğ— âˆ‚yU[k,j]
                    end
                end
            end

            âˆ‚Â²ğ— â»Â¹âˆ‚xÂ² = - UAUáµ€!(Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U,U)
            âˆ‚Â²ğ— â»Â¹âˆ‚yÂ² = - UAUáµ€!(Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U,U)
            âˆ‚Â²ğ— â»Â¹âˆ‚zÂ² = - UAUáµ€!(Uáµ€âˆ‚Â²ğ— âˆ‚zÂ²U,U)
            âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚y = - UAUáµ€!(Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU,U)
            âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚z = - UAUáµ€!(Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚zU,U)
            âˆ‚Â²ğ— â»Â¹âˆ‚yâˆ‚z = - UAUáµ€!(Uáµ€âˆ‚Â²ğ— âˆ‚yâˆ‚zU,U)
            âˆ‚ğ— â»Â¹âˆ‚x = - UAUáµ€!(Uáµ€âˆ‚ğ— âˆ‚xU,U)
            âˆ‚ğ— â»Â¹âˆ‚y = - UAUáµ€!(Uáµ€âˆ‚ğ— âˆ‚yU,U)
            âˆ‚ğ— â»Â¹âˆ‚z = - UAUáµ€!(Uáµ€âˆ‚ğ— âˆ‚zU,U)
            ğ— â»Â¹ = UUáµ€!(U)
            return ğ— â»Â¹, âˆ‚ğ— â»Â¹âˆ‚x, âˆ‚ğ— â»Â¹âˆ‚y, âˆ‚Â²ğ— â»Â¹âˆ‚xÂ², âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚y, âˆ‚Â²ğ— â»Â¹âˆ‚yÂ², âˆ‚ğ— â»Â¹âˆ‚z, âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚z, âˆ‚Â²ğ— â»Â¹âˆ‚yâˆ‚z, âˆ‚Â²ğ— â»Â¹âˆ‚zÂ²
        end

        function setâˆ‡Â²ğ­!(ap::ReproducingKernel{$ğ’‘},ğ’™::Node)
            ğ“’ = ap.ğ“’
            ğ­ = ğ’™[:ğ­]
            âˆ‚ğ­âˆ‚x = ğ’™[:âˆ‚ğ­âˆ‚x]
            âˆ‚ğ­âˆ‚y = ğ’™[:âˆ‚ğ­âˆ‚y]
            âˆ‚ğ­âˆ‚z = ğ’™[:âˆ‚ğ­âˆ‚z]
            âˆ‚Â²ğ­âˆ‚xÂ² = ğ’™[:âˆ‚Â²ğ­âˆ‚xÂ²]
            âˆ‚Â²ğ­âˆ‚yÂ² = ğ’™[:âˆ‚Â²ğ­âˆ‚yÂ²]
            âˆ‚Â²ğ­âˆ‚zÂ² = ğ’™[:âˆ‚Â²ğ­âˆ‚zÂ²]
            âˆ‚Â²ğ­âˆ‚xâˆ‚y = ğ’™[:âˆ‚Â²ğ­âˆ‚xâˆ‚y]
            âˆ‚Â²ğ­âˆ‚xâˆ‚z = ğ’™[:âˆ‚Â²ğ­âˆ‚xâˆ‚z]
            âˆ‚Â²ğ­âˆ‚yâˆ‚z = ğ’™[:âˆ‚Â²ğ­âˆ‚yâˆ‚z]
            ğ’‘â‚€áµ€ğ— â»Â¹, ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚x, ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚y, ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xÂ², ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚y, ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚yÂ², ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚z, ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚z, ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚yâˆ‚z, ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚zÂ² = calâˆ‡Â²ğ— !(ap,ğ’™)
            for (i,ğ’™áµ¢) in enumerate(ğ“’)
                Î”ğ’™ = ğ’™ - ğ’™áµ¢
                ğ’‘, âˆ‚ğ’‘âˆ‚x, âˆ‚ğ’‘âˆ‚y, âˆ‚Â²ğ’‘âˆ‚xÂ², âˆ‚Â²ğ’‘âˆ‚xâˆ‚y, âˆ‚Â²ğ’‘âˆ‚yÂ², âˆ‚ğ’‘âˆ‚z, âˆ‚Â²ğ’‘âˆ‚xâˆ‚z, âˆ‚Â²ğ’‘âˆ‚yâˆ‚z, âˆ‚Â²ğ’‘âˆ‚zÂ² = getâˆ‡Â²ğ’‘(ap,Î”ğ’™)
                ğœ™, âˆ‚ğœ™âˆ‚x, âˆ‚ğœ™âˆ‚y, âˆ‚Â²ğœ™âˆ‚xÂ², âˆ‚Â²ğœ™âˆ‚xâˆ‚y, âˆ‚Â²ğœ™âˆ‚yÂ², âˆ‚ğœ™âˆ‚z, âˆ‚Â²ğœ™âˆ‚xâˆ‚z, âˆ‚Â²ğœ™âˆ‚yâˆ‚z, âˆ‚Â²ğœ™âˆ‚zÂ² = getâˆ‡Â²ğœ™(ap,ğ’™áµ¢,Î”ğ’™)
                ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘ = ğ’‘â‚€áµ€ğ— â»Â¹*ğ’‘
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xğ’‘ = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚x*ğ’‘
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yğ’‘ = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚y*ğ’‘
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚zğ’‘ = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚z*ğ’‘
                ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚x = ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚ğ’‘âˆ‚x
                ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚y = ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚ğ’‘âˆ‚y
                ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚z = ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚ğ’‘âˆ‚z
                ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xÂ²ğ’‘ = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xÂ²*ğ’‘
                ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚yÂ²ğ’‘ = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚yÂ²*ğ’‘
                ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚zÂ²ğ’‘ = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚zÂ²*ğ’‘
                ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚xÂ² = ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚Â²ğ’‘âˆ‚xÂ²
                ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚yÂ² = ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚Â²ğ’‘âˆ‚yÂ²
                ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚zÂ² = ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚Â²ğ’‘âˆ‚zÂ²
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xâˆ‚ğ’‘âˆ‚x = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚x*âˆ‚ğ’‘âˆ‚x
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yâˆ‚ğ’‘âˆ‚y = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚y*âˆ‚ğ’‘âˆ‚y
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚zâˆ‚ğ’‘âˆ‚z = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚z*âˆ‚ğ’‘âˆ‚z
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xâˆ‚ğ’‘âˆ‚y = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚x*âˆ‚ğ’‘âˆ‚y
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yâˆ‚ğ’‘âˆ‚x = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚y*âˆ‚ğ’‘âˆ‚x
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xâˆ‚ğ’‘âˆ‚z = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚x*âˆ‚ğ’‘âˆ‚z
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚zâˆ‚ğ’‘âˆ‚x = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚z*âˆ‚ğ’‘âˆ‚x
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yâˆ‚ğ’‘âˆ‚z = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚y*âˆ‚ğ’‘âˆ‚z
                ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚zâˆ‚ğ’‘âˆ‚y = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚z*âˆ‚ğ’‘âˆ‚y
                ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚yğ’‘ = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚y*ğ’‘
                ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚zğ’‘ = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚z*ğ’‘
                ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚yâˆ‚zğ’‘ = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚yâˆ‚z*ğ’‘
                ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚xâˆ‚y = ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y
                ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚xâˆ‚z = ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚Â²ğ’‘âˆ‚xâˆ‚z
                ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚yâˆ‚z = ğ’‘â‚€áµ€ğ— â»Â¹*âˆ‚Â²ğ’‘âˆ‚yâˆ‚z

                ğ­[i] = ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*ğœ™
                âˆ‚ğ­âˆ‚x[i] = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚x*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*âˆ‚ğœ™âˆ‚x
                âˆ‚ğ­âˆ‚y[i] = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚y*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*âˆ‚ğœ™âˆ‚y
                âˆ‚ğ­âˆ‚z[i] = ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚zğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚z*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*âˆ‚ğœ™âˆ‚z

                âˆ‚Â²ğ­âˆ‚xÂ²[i] = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xÂ²ğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚xÂ²*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*âˆ‚Â²ğœ™âˆ‚xÂ² + 2.0*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xâˆ‚ğ’‘âˆ‚x*ğœ™ + 2.0*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xğ’‘*âˆ‚ğœ™âˆ‚x + 2.0*ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚x*âˆ‚ğœ™âˆ‚x

                âˆ‚Â²ğ­âˆ‚yÂ²[i] = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚yÂ²ğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚yÂ²*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*âˆ‚Â²ğœ™âˆ‚yÂ² + 2.0*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yâˆ‚ğ’‘âˆ‚y*ğœ™ + 2.0*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yğ’‘*âˆ‚ğœ™âˆ‚y + 2.0*ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚y*âˆ‚ğœ™âˆ‚y

                âˆ‚Â²ğ­âˆ‚zÂ²[i] = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚zÂ²ğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚zÂ²*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*âˆ‚Â²ğœ™âˆ‚zÂ² + 2.0*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚zâˆ‚ğ’‘âˆ‚z*ğœ™ + 2.0*ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚zğ’‘*âˆ‚ğœ™âˆ‚z + 2.0*ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚z*âˆ‚ğœ™âˆ‚z

                âˆ‚Â²ğ­âˆ‚xâˆ‚y[i] = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚yğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚xâˆ‚y*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*âˆ‚Â²ğœ™âˆ‚xâˆ‚y + ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xâˆ‚ğ’‘âˆ‚y*ğœ™ + ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yâˆ‚ğ’‘âˆ‚x*ğœ™ + ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xğ’‘*âˆ‚ğœ™âˆ‚y + ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yğ’‘*âˆ‚ğœ™âˆ‚x + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚x*âˆ‚ğœ™âˆ‚y +ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚y*âˆ‚ğœ™âˆ‚x

                âˆ‚Â²ğ­âˆ‚xâˆ‚z[i] = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚zğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚xâˆ‚z*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*âˆ‚Â²ğœ™âˆ‚xâˆ‚z + ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xâˆ‚ğ’‘âˆ‚z*ğœ™ + ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚zâˆ‚ğ’‘âˆ‚x*ğœ™ + ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚xğ’‘*âˆ‚ğœ™âˆ‚z + ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚zğ’‘*âˆ‚ğœ™âˆ‚x + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚x*âˆ‚ğœ™âˆ‚z +ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚z*âˆ‚ğœ™âˆ‚x

                âˆ‚Â²ğ­âˆ‚yâˆ‚z[i] = ğ’‘â‚€áµ€âˆ‚Â²ğ— â»Â¹âˆ‚yâˆ‚zğ’‘*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚Â²ğ’‘âˆ‚yâˆ‚z*ğœ™ + ğ’‘â‚€áµ€ğ— â»Â¹ğ’‘*âˆ‚Â²ğœ™âˆ‚yâˆ‚z + ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yâˆ‚ğ’‘âˆ‚z*ğœ™ + ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚zâˆ‚ğ’‘âˆ‚y*ğœ™ + ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚yğ’‘*âˆ‚ğœ™âˆ‚z + ğ’‘â‚€áµ€âˆ‚ğ— â»Â¹âˆ‚zğ’‘*âˆ‚ğœ™âˆ‚y + ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚y*âˆ‚ğœ™âˆ‚z +ğ’‘â‚€áµ€ğ— â»Â¹âˆ‚ğ’‘âˆ‚z*âˆ‚ğœ™âˆ‚y
            end
        end
    end
end

# function setâˆ‡Ì‚Â³ğ­!(ap::ReproducingKernel,ğ’™::Node)
#     ğ“’ = ap.ğ“’
#     ğ­ = ğ’™[:ğ­]
#     âˆ‚ğ­âˆ‚x = ğ’™[:âˆ‚ğ­âˆ‚x]
#     âˆ‚ğ­âˆ‚y = ğ’™[:âˆ‚ğ­âˆ‚y]
#     âˆ‚Â²ğ­âˆ‚xÂ² = ğ’™[:âˆ‚Â²ğ­âˆ‚xÂ²]
#     âˆ‚Â²ğ­âˆ‚yÂ² = ğ’™[:âˆ‚Â²ğ­âˆ‚yÂ²]
#     âˆ‚Â²ğ­âˆ‚xâˆ‚y = ğ’™[:âˆ‚Â²ğ­âˆ‚xâˆ‚y]
#     âˆ‚Â³ğ­âˆ‚xÂ³ = ğ’™[:âˆ‚Â³ğ­âˆ‚xÂ³]
#     âˆ‚Â³ğ­âˆ‚xÂ²âˆ‚y = ğ’™[:âˆ‚Â³ğ­âˆ‚xÂ²âˆ‚y]
#     âˆ‚Â³ğ­âˆ‚xâˆ‚yÂ² = ğ’™[:âˆ‚Â³ğ­âˆ‚xâˆ‚yÂ²]
#     âˆ‚Â³ğ­âˆ‚yÂ³ = ğ’™[:âˆ‚Â³ğ­âˆ‚yÂ³]

#     n = getğ‘›ğ’‘(ap)
#     ğ’‘â‚€áµ€ğ— â»Â¹ = calğ— !(ap,ğ’™)
#     for (i,ğ’™áµ¢) in enumerate(ğ“’)
#         Î”ğ’™ = ğ’™ - ğ’™áµ¢
#         ğ’‘= getğ’‘(ap,Î”ğ’™)
#         ğœ™ = getğœ™(ap,ğ’™áµ¢,Î”ğ’™)
#         âˆ‚ğ­âˆ‚x_ = 0.0
#         âˆ‚ğ­âˆ‚y_ = 0.0
#         âˆ‚Â²ğ­âˆ‚xÂ²_ = 0.0
#         âˆ‚Â²ğ­âˆ‚xâˆ‚y_ = 0.0
#         âˆ‚Â²ğ­âˆ‚yÂ²_ = 0.0
#         âˆ‚Â³ğ­âˆ‚xÂ³_ = 0.0
#         âˆ‚Â³ğ­âˆ‚xÂ²âˆ‚y_ = 0.0
#         âˆ‚Â³ğ­âˆ‚xâˆ‚yÂ²_ = 0.0
#         âˆ‚Â³ğ­âˆ‚yÂ³_ = 0.0
#         for j in 1:n
#             âˆ‚ğ­âˆ‚x_ -= ğ’‘â‚€áµ€ğ— â»Â¹[2,j]*ğ’‘[j]*ğœ™
#             âˆ‚ğ­âˆ‚y_ -= ğ’‘â‚€áµ€ğ— â»Â¹[3,j]*ğ’‘[j]*ğœ™
#             âˆ‚Â²ğ­âˆ‚xÂ²_ += 2*ğ’‘â‚€áµ€ğ— â»Â¹[4,j]*ğ’‘[j]*ğœ™
#             âˆ‚Â²ğ­âˆ‚xâˆ‚y_ += ğ’‘â‚€áµ€ğ— â»Â¹[5,j]*ğ’‘[j]*ğœ™
#             âˆ‚Â²ğ­âˆ‚yÂ²_ += 2*ğ’‘â‚€áµ€ğ— â»Â¹[6,j]*ğ’‘[j]*ğœ™
#             âˆ‚Â³ğ­âˆ‚xÂ³_ -= 6*ğ’‘â‚€áµ€ğ— â»Â¹[7,j]*ğ’‘[j]*ğœ™
#             âˆ‚Â³ğ­âˆ‚xÂ²âˆ‚y_ -= 2*ğ’‘â‚€áµ€ğ— â»Â¹[8,j]*ğ’‘[j]*ğœ™
#             âˆ‚Â³ğ­âˆ‚xâˆ‚yÂ²_ -= 2*ğ’‘â‚€áµ€ğ— â»Â¹[9,j]*ğ’‘[j]*ğœ™
#             âˆ‚Â³ğ­âˆ‚yÂ³_ -= 6*ğ’‘â‚€áµ€ğ— â»Â¹[10,j]*ğ’‘[j]*ğœ™
#         end
#         ğ­[i] = ğ’‘â‚€áµ€ğ— â»Â¹*ğ’‘*ğœ™
#         âˆ‚ğ­âˆ‚x[i] = âˆ‚ğ­âˆ‚x_
#         âˆ‚ğ­âˆ‚y[i] = âˆ‚ğ­âˆ‚y_
#         âˆ‚Â²ğ­âˆ‚xÂ²[i] = âˆ‚Â²ğ­âˆ‚xÂ²_
#         âˆ‚Â²ğ­âˆ‚xâˆ‚y[i] = âˆ‚Â²ğ­âˆ‚xâˆ‚y_
#         âˆ‚Â²ğ­âˆ‚yÂ²[i] = âˆ‚Â²ğ­âˆ‚yÂ²_
#         âˆ‚Â³ğ­âˆ‚xÂ³[i] = âˆ‚Â³ğ­âˆ‚xÂ³_
#         âˆ‚Â³ğ­âˆ‚xÂ²âˆ‚y[i] = âˆ‚Â³ğ­âˆ‚xÂ²âˆ‚y_
#         âˆ‚Â³ğ­âˆ‚xâˆ‚yÂ²[i] = âˆ‚Â³ğ­âˆ‚xâˆ‚yÂ²_
#         âˆ‚Â³ğ­âˆ‚yÂ³[i] = âˆ‚Â³ğ­âˆ‚yÂ³_
#     end
# end