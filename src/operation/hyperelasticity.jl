module Hyperelasticity
    
using ..ApproxOperator: AbstractElement
function âˆ«ESdx(ap::T;k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“– 
    Eáµ‰ = op.E
    for Î¾ in ð“–
        B = Î¾[:âˆ‚ð­âˆ‚x]
        ð‘¤ = Î¾.ð‘¤
        F = 1.0
        for (i,xáµ¢) in enumerate(ð“’)
            F += B[i]*xáµ¢.d
        end
        E = 0.5*(F^2-1.0)
        S = Eáµ‰*E
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[I,J] += B[i]*(S+F^2*Eáµ‰)*B[j]*ð‘¤
            end
            f[I] += B[i]*Eáµ‰*F*E*ð‘¤
        end
    end
end


function Î”âˆ«âˆ«Eáµ¢â±¼Sáµ¢â±¼dxdy_HR_SaintVenantKirchhoff(ap::T;k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    E = op.E
    Î½ = op.Î½
    for Î¾ in ð“–
      
        
        ð‘¤ = Î¾.ð‘¤
        Câ»Â¹áµ¢áµ¢áµ¢áµ¢ = 1/E
        Câ»Â¹áµ¢áµ¢â±¼â±¼ = -Î½/E
        Câ»Â¹áµ¢â±¼áµ¢â±¼ = 2*(1+Î½)/E
      
        
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                 k[3*I-2,3*J-2] += N[i]*Câ»Â¹áµ¢áµ¢áµ¢áµ¢*N[j]*ð‘¤
                k[3*I-2,3*J-1] += N[i]*Câ»Â¹áµ¢áµ¢â±¼â±¼*N[j]*ð‘¤
                k[3*I-1,3*J-2] += N[i]*Câ»Â¹áµ¢áµ¢â±¼â±¼*N[j]*ð‘¤
                k[3*I-1,3*J-1] += N[i]*Câ»Â¹áµ¢áµ¢áµ¢áµ¢*N[j]*ð‘¤
                k[3*I,3*J]     += N[i]*Câ»Â¹áµ¢â±¼áµ¢â±¼*N[j]*ð‘¤

            end
        end
    end
end




function âˆ«âˆ«Eáµ¢â±¼Sáµ¢â±¼dxdy_HR_SaintVenantKirchhoff(ap::T;f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    E = op.E
    Î½ = op.Î½
    for Î¾ in ð“–
       
        ð‘¤ = Î¾.ð‘¤
        Câ»Â¹áµ¢áµ¢áµ¢áµ¢ = 1/E
        Câ»Â¹áµ¢áµ¢â±¼â±¼ = -Î½/E
        Câ»Â¹áµ¢â±¼áµ¢â±¼ = 2*(1+Î½)/E
        N = Î¾[:ð­]
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        
        
        Fâ‚â‚ = 1.0
        Fâ‚â‚‚ = 0.0
        Fâ‚‚â‚ = 0.0
        Fâ‚‚â‚‚ = 1.0
        for (i,xáµ¢) in  enumerate(ð“’)
           Sâ‚â‚ += N[i]*xáµ¢.dâ‚›â‚â‚
           Sâ‚‚â‚‚ += N[i]*xáµ¢.dâ‚›â‚‚â‚‚
           Sâ‚â‚‚ += N[i]*xáµ¢.dâ‚›â‚â‚‚
        end
         Sâ‚â‚ = ð“’[1].dâ‚›â‚â‚+ð“’[2].dâ‚›â‚â‚*xc+ð“’[3].dâ‚›â‚â‚*yc
         Sâ‚‚â‚‚ = ð“’[1].dâ‚›â‚‚â‚‚+ð“’[2].dâ‚›â‚‚â‚‚*xc+ð“’[3].dâ‚›â‚‚â‚‚*yc
         Sâ‚â‚‚ = ð“’[1].dâ‚›â‚â‚‚+ð“’[2].dâ‚›â‚â‚‚*xc+ð“’[3].dâ‚›â‚â‚‚*yc

        Eâ‚â‚ = 0.5*(Fâ‚â‚*Fâ‚â‚+Fâ‚‚â‚*Fâ‚‚â‚-1.0)
        Eâ‚â‚‚ = 0.5*(Fâ‚â‚*Fâ‚â‚‚+Fâ‚‚â‚*Fâ‚‚â‚‚)
        Eâ‚‚â‚‚ = 0.5*(Fâ‚â‚‚*Fâ‚â‚‚+Fâ‚‚â‚‚*Fâ‚‚â‚‚-1.0)

        
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            f[3*I-2] += (N[i]*Câ»Â¹áµ¢áµ¢áµ¢áµ¢*Sâ‚â‚+N[i]*Câ»Â¹áµ¢áµ¢â±¼â±¼*Sâ‚‚â‚‚)*ð‘¤
            f[3*I-1] += (N[i]*Câ»Â¹áµ¢áµ¢â±¼â±¼*Sâ‚â‚+N[i]*Câ»Â¹áµ¢áµ¢áµ¢áµ¢*Sâ‚‚â‚‚)*ð‘¤
            f[3*I]   += ( N[i]*Câ»Â¹áµ¢â±¼áµ¢â±¼*Sâ‚â‚‚ )*ð‘¤
        end
    end
end

function âˆ«âˆ«Î´SÎ”Fnudxdy_HR_SaintVenantKirchhoff(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where  {T<:AbstractElement,S<:AbstractElement}
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
   
    for (Î¾â‚›,Î¾áµ¤) in zip(ð“–â‚›,ð“–áµ¤)
        Bâ‚ = Î¾áµ¤[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾áµ¤[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾â‚›.ð‘¤
        Nâ‚› = Î¾â‚›[:ð­]
        Náµ¤ = Î¾â‚›[:ð­]
        nâ‚ = Î¾áµ¤.nâ‚
        nâ‚‚ = Î¾áµ¤.nâ‚‚
       
       
        Fâ‚â‚ = 1.0
        Fâ‚â‚‚ = 0.0
        Fâ‚‚â‚ = 0.0
        Fâ‚‚â‚‚ = 1.0
        for (i,xáµ¢) in  enumerate(ð“’áµ¤)
            Fâ‚â‚ += Bâ‚[i]*xáµ¢.dâ‚
            Fâ‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚
            Fâ‚‚â‚ += Bâ‚[i]*xáµ¢.dâ‚‚
            Fâ‚‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚‚
            uâ‚  += Náµ¤[i]*xáµ¢.dâ‚
            uâ‚‚  += Náµ¤[i]*xáµ¢.dâ‚‚
        end

        for (i,xáµ¢) in  enumerate(ð“’â‚›)
           Sâ‚â‚ += N[i]*xáµ¢.dâ‚›â‚â‚
           Sâ‚‚â‚‚ += N[i]*xáµ¢.dâ‚›â‚‚â‚‚
           Sâ‚â‚‚ += N[i]*xáµ¢.dâ‚›â‚â‚‚
        end
        
        
      for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[3*I-2,2*J-1] -= Nâ‚›[i]*nâ‚*uâ‚*(Bâ‚[j]+Bâ‚‚[j])*ð‘¤
                k[3*I-1,2*J]   -= Nâ‚›[i]*nâ‚‚*uâ‚*(Bâ‚[j]+Bâ‚‚[j])*ð‘¤
                k[3*I,2*J-1]   -= Nâ‚›[i]*nâ‚*uâ‚‚*(Bâ‚[j]+Bâ‚‚[j])*ð‘¤
                k[3*I,2*J]     -= Nâ‚›[i]*nâ‚‚*uâ‚‚*(Bâ‚[j]+Bâ‚‚[j])*ð‘¤
            end
        end
    end
end
function âˆ«âˆ«Î´SFnÎ”udxdy_HR_SaintVenantKirchhoff(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where  {T<:AbstractElement,S<:AbstractElement}
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
   
    for (Î¾â‚›,Î¾áµ¤) in zip(ð“–â‚›,ð“–áµ¤)
        Bâ‚ = Î¾áµ¤[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾áµ¤[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾â‚›.ð‘¤
        Nâ‚› = Î¾â‚›[:ð­]
        Náµ¤ = Î¾â‚›[:ð­]
        nâ‚ = Î¾áµ¤.nâ‚
        nâ‚‚ = Î¾áµ¤.nâ‚‚
       
       
        Fâ‚â‚ = 1.0
        Fâ‚â‚‚ = 0.0
        Fâ‚‚â‚ = 0.0
        Fâ‚‚â‚‚ = 1.0
        for (i,xáµ¢) in  enumerate(ð“’áµ¤)
            Fâ‚â‚ += Bâ‚[i]*xáµ¢.dâ‚
            Fâ‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚
            Fâ‚‚â‚ += Bâ‚[i]*xáµ¢.dâ‚‚
            Fâ‚‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚‚
            uâ‚  += Náµ¤[i]*xáµ¢.dâ‚
            uâ‚‚  += Náµ¤[i]*xáµ¢.dâ‚‚
        end

        for (i,xáµ¢) in  enumerate(ð“’â‚›)
           Sâ‚â‚ += N[i]*xáµ¢.dâ‚›â‚â‚
           Sâ‚‚â‚‚ += N[i]*xáµ¢.dâ‚›â‚‚â‚‚
           Sâ‚â‚‚ += N[i]*xáµ¢.dâ‚›â‚â‚‚
        end
        
        
      for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[3*I-2,2*J-1] -= Nâ‚›[i]*nâ‚*Náµ¤[j]*(Fâ‚â‚+Fâ‚â‚‚)*ð‘¤
                k[3*I-1,2*J]   -= Nâ‚›[i]*nâ‚‚*Náµ¤[j]*(Fâ‚â‚+Fâ‚â‚‚)*ð‘¤
                k[3*I,2*J-1]   -= Nâ‚›[i]*nâ‚*Náµ¤[j]*(Fâ‚‚â‚+Fâ‚‚â‚‚)*ð‘¤
                k[3*I,2*J]     -= Nâ‚›[i]*nâ‚‚*Náµ¤[j]*(Fâ‚‚â‚+Fâ‚‚â‚‚)*ð‘¤
            end
        end
    end
end
function âˆ«âˆ«Î´SFnudxdy_HR_SaintVenantKirchhoff(aâ‚›::T,aáµ¤::S,f::AbstractVector{Float64})  where  {T<:AbstractElement,S<:AbstractElement}
    ð“’ = ap.ð“’; ð“– = ap.ð“–
   
    for Î¾ in ð“–
        E = Î¾áµ¤.E
        Î½ = Î¾áµ¤.Î½
        Bâ‚ = Î¾áµ¤[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾áµ¤[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾â‚›.ð‘¤
        Nâ‚› = Î¾â‚›[:ð­]
        Náµ¤ = Î¾â‚›[:ð­]
        nâ‚ = Î¾áµ¤.nâ‚
        nâ‚‚ = Î¾áµ¤.nâ‚‚
        ð‘¤ = Î¾.ð‘¤
        Câ»Â¹áµ¢áµ¢áµ¢áµ¢ = 1/E
        Câ»Â¹áµ¢áµ¢â±¼â±¼ = -Î½/E
        Câ»Â¹áµ¢â±¼áµ¢â±¼ = 2*(1+Î½)/E
        Fâ‚â‚ = 1.0
        Fâ‚â‚‚ = 0.0
        Fâ‚‚â‚ = 0.0
        Fâ‚‚â‚‚ = 1.0
        for (i,xáµ¢) in  enumerate(ð“’)
            Fâ‚â‚ += Bâ‚[i]*xáµ¢.dâ‚
            Fâ‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚
            Fâ‚‚â‚ += Bâ‚[i]*xáµ¢.dâ‚‚
            Fâ‚‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚‚
            uâ‚  += Náµ¤[i]*xáµ¢.dâ‚
            uâ‚‚  += Náµ¤[i]*xáµ¢.dâ‚‚
        end
        
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
                f[2*I-1] -= (Nâ‚›[i]*nâ‚*uâ‚*(Fâ‚â‚+Fâ‚â‚‚)+Nâ‚›[i]*nâ‚‚*uâ‚*(Fâ‚â‚+Fâ‚â‚‚))*ð‘¤
                f[2*I]   -= Nâ‚›[i]*nâ‚‚*Náµ¤[j]*(Fâ‚â‚+Fâ‚â‚‚)*ð‘¤

                k[3*I-2,2*J-1] -= (Nâ‚›[i]*)nâ‚*uâ‚*(Bâ‚[j]+Bâ‚‚[j])*ð‘¤
                k[3*I-1,2*J]   -= Nâ‚›[i]*nâ‚‚*uâ‚*(Bâ‚[j]+Bâ‚‚[j])*ð‘¤
                k[3*I,2*J-1]   -= Nâ‚›[i]*nâ‚*uâ‚‚*(Bâ‚[j]+Bâ‚‚[j])*ð‘¤
                k[3*I,2*J]     -= Nâ‚›[i]*nâ‚‚*uâ‚‚*(Bâ‚[j]+Bâ‚‚[j])*ð‘¤
            end
        end
    end
end


function Î”âˆ«âˆ«Eáµ¢â±¼Sáµ¢â±¼dxdy_SaintVenantKirchhoff(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
   
    for Î¾ in ð“–
        E = Î¾.E
        Î½ = Î¾.Î½
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾.ð‘¤
        Cáµ¢áµ¢áµ¢áµ¢ = E*(1-Î½)/(1+Î½)/(1-2*Î½)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1+Î½)/(1-2*Î½)
        Cáµ¢â±¼áµ¢â±¼ = E/(1+Î½)/2
       
        Fâ‚â‚ = 1.0
        Fâ‚â‚‚ = 0.0
        Fâ‚‚â‚ = 0.0
        Fâ‚‚â‚‚ = 1.0
        for (i,xáµ¢) in  enumerate(ð“’)
            Fâ‚â‚ += Bâ‚[i]*xáµ¢.dâ‚
            Fâ‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚
            Fâ‚‚â‚ += Bâ‚[i]*xáµ¢.dâ‚‚
            Fâ‚‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚‚
        end
        
        Eâ‚â‚ = 0.5*(Fâ‚â‚*Fâ‚â‚+Fâ‚‚â‚*Fâ‚‚â‚-1.0)
        Eâ‚â‚‚ = 0.5*(Fâ‚â‚*Fâ‚â‚‚+Fâ‚‚â‚*Fâ‚‚â‚‚)
        Eâ‚‚â‚‚ = 0.5*(Fâ‚â‚‚*Fâ‚â‚‚+Fâ‚‚â‚‚*Fâ‚‚â‚‚-1.0)
        Sâ‚â‚ = Cáµ¢áµ¢áµ¢áµ¢*Eâ‚â‚+Cáµ¢áµ¢â±¼â±¼*Eâ‚‚â‚‚
        Sâ‚‚â‚‚ = Cáµ¢áµ¢â±¼â±¼*Eâ‚â‚+Cáµ¢áµ¢áµ¢áµ¢*Eâ‚‚â‚‚
        Sâ‚â‚‚ = 2.0*Cáµ¢â±¼áµ¢â±¼*Eâ‚â‚‚
        
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[2*I-1,2*J-1] +=((Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚)*Cáµ¢áµ¢áµ¢áµ¢
                               +  (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚â‚)*Cáµ¢áµ¢â±¼â±¼
                               +  (Bâ‚[i]*Fâ‚â‚‚+Bâ‚‚[i]*Fâ‚â‚)*(Bâ‚[j]*Fâ‚â‚‚+Bâ‚‚[j]*Fâ‚â‚)*Cáµ¢â±¼áµ¢â±¼
                               +   Bâ‚[i]*Bâ‚[j]*Sâ‚â‚+Bâ‚‚[i]*Bâ‚‚[j]*Sâ‚‚â‚‚+(Bâ‚[i]*Bâ‚‚[j]+Bâ‚‚[i]*Bâ‚[j])*Sâ‚â‚‚)*ð‘¤
                              
                k[2*I-1,2*J]   += ((Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚)*Cáµ¢áµ¢áµ¢áµ¢
                               +   (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚‚â‚)*Cáµ¢áµ¢â±¼â±¼
                               +   (Bâ‚[i]*Fâ‚â‚‚+Bâ‚‚[i]*Fâ‚â‚)*(Bâ‚[j]*Fâ‚‚â‚‚+Bâ‚‚[j]*Fâ‚‚â‚)*Cáµ¢â±¼áµ¢â±¼)*ð‘¤
                               
                k[2*I,2*J-1]   += ((Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚)*Cáµ¢áµ¢áµ¢áµ¢
                               +   (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚â‚)*Cáµ¢áµ¢â±¼â±¼
                               +   (Bâ‚[i]*Fâ‚‚â‚‚+Bâ‚‚[i]*Fâ‚‚â‚)*(Bâ‚[j]*Fâ‚â‚‚+Bâ‚‚[j]*Fâ‚â‚)*Cáµ¢â±¼áµ¢â±¼)*ð‘¤

                k[2*I,2*J]     += ((Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚)*Cáµ¢áµ¢áµ¢áµ¢ 
                               +   (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚‚â‚)*Cáµ¢áµ¢â±¼â±¼
                               +   (Bâ‚[i]*Fâ‚‚â‚‚+Bâ‚‚[i]*Fâ‚‚â‚)*(Bâ‚[j]*Fâ‚‚â‚‚+Bâ‚‚[j]*Fâ‚‚â‚)*Cáµ¢â±¼áµ¢â±¼
                               +    Bâ‚[i]*Bâ‚[j]*Sâ‚â‚+Bâ‚‚[i]*Bâ‚‚[j]*Sâ‚‚â‚‚+(Bâ‚[i]*Bâ‚‚[j]+Bâ‚‚[i]*Bâ‚[j])*Sâ‚â‚‚)*ð‘¤

            end
        end
    end
end


function âˆ«âˆ«Eáµ¢â±¼Sáµ¢â±¼dxdy_SaintVenantKirchhoff(ap::T,f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    
    for Î¾ in ð“–
        E = Î¾.E
        Î½ = Î¾.Î½
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾.ð‘¤
        Cáµ¢áµ¢áµ¢áµ¢ = E*(1-Î½)/(1+Î½)/(1-2*Î½)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1+Î½)/(1-2*Î½)
        Cáµ¢â±¼áµ¢â±¼ = E/(1+Î½)/2
       
        Fâ‚â‚ = 1.0
        Fâ‚â‚‚ = 0.0
        Fâ‚‚â‚ = 0.0
        Fâ‚‚â‚‚ = 1.0
        for (i,xáµ¢) in  enumerate(ð“’)
            Fâ‚â‚ += Bâ‚[i]*xáµ¢.dâ‚
            Fâ‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚
            Fâ‚‚â‚ += Bâ‚[i]*xáµ¢.dâ‚‚
            Fâ‚‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚‚
        end
        
        Eâ‚â‚ = 0.5*(Fâ‚â‚*Fâ‚â‚+Fâ‚‚â‚*Fâ‚‚â‚-1.0)
        Eâ‚â‚‚ = 0.5*(Fâ‚â‚*Fâ‚â‚‚+Fâ‚‚â‚*Fâ‚‚â‚‚)
        Eâ‚‚â‚‚ = 0.5*(Fâ‚â‚‚*Fâ‚â‚‚+Fâ‚‚â‚‚*Fâ‚‚â‚‚-1.0)
        Sâ‚â‚ = Cáµ¢áµ¢áµ¢áµ¢*Eâ‚â‚+Cáµ¢áµ¢â±¼â±¼*Eâ‚‚â‚‚
        Sâ‚‚â‚‚ = Cáµ¢áµ¢â±¼â±¼*Eâ‚â‚+Cáµ¢áµ¢áµ¢áµ¢*Eâ‚‚â‚‚
        Sâ‚â‚‚ = 2.0*Cáµ¢â±¼áµ¢â±¼*Eâ‚â‚‚
        
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            f[2*I-1] += (Bâ‚[i]*Fâ‚â‚*Sâ‚â‚+Bâ‚‚[i]*Fâ‚â‚‚*Sâ‚‚â‚‚+(Bâ‚[i]*Fâ‚â‚‚+Bâ‚‚[i]*Fâ‚â‚)*Sâ‚â‚‚)*ð‘¤
            f[2*I]   += (Bâ‚[i]*Fâ‚‚â‚*Sâ‚â‚+Bâ‚‚[i]*Fâ‚‚â‚‚*Sâ‚‚â‚‚+(Bâ‚[i]*Fâ‚‚â‚‚+Bâ‚‚[i]*Fâ‚‚â‚)*Sâ‚â‚‚)*ð‘¤
        end
    end
end

function Î”âˆ«âˆ«Eáµ¢â±¼Sáµ¢â±¼dxdy_NeoHookean(ap::T;k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    E=op.E
    Î½=op.Î½
    Î»=E*Î½/(1+Î½)/(1-2*Î½)
    Î¼=E/(1+Î½)/2
    for Î¾ in ð“–
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾.ð‘¤
        Fâ‚â‚ = 1.0
        Fâ‚â‚‚ = 0.0
        Fâ‚‚â‚ = 0.0
        Fâ‚‚â‚‚ = 1.0
        for (i,xáµ¢) in  enumerate(ð“’)  
            Fâ‚â‚ += Bâ‚[i]*xáµ¢.dâ‚
            Fâ‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚
            Fâ‚‚â‚ += Bâ‚[i]*xáµ¢.dâ‚‚
            Fâ‚‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚‚
        end
        Câ‚â‚ = Fâ‚â‚*Fâ‚â‚+Fâ‚‚â‚*Fâ‚‚â‚       
        Câ‚â‚‚ = Fâ‚â‚*Fâ‚â‚‚+Fâ‚‚â‚*Fâ‚‚â‚‚
        Câ‚‚â‚‚ = Fâ‚â‚‚*Fâ‚â‚‚+Fâ‚‚â‚‚*Fâ‚‚â‚‚
        Câ‚ƒâ‚ƒ = 1.0
        J = Fâ‚â‚*Fâ‚‚â‚‚-Fâ‚â‚‚*Fâ‚‚â‚
        
        detC = (Câ‚â‚*Câ‚‚â‚‚-Câ‚â‚‚*Câ‚â‚‚)
        Iâ‚ = Câ‚â‚+Câ‚‚â‚‚+Câ‚ƒâ‚ƒ
        Iâ‚‚ = 0.5*(Iâ‚^2-Câ‚â‚^2-Câ‚‚â‚‚^2-Câ‚ƒâ‚ƒ^2-2*Câ‚â‚‚^2)
        Câ»Â¹â‚â‚=1.0/detC*(Câ‚â‚*Câ‚â‚+Câ‚â‚‚*Câ‚â‚‚-Iâ‚*Câ‚â‚+Iâ‚‚)
        Câ»Â¹â‚â‚‚=1.0/detC*(Câ‚â‚*Câ‚â‚‚+Câ‚â‚‚*Câ‚‚â‚‚-Iâ‚*Câ‚â‚‚)
        Câ»Â¹â‚‚â‚‚=1.0/detC*(Câ‚â‚‚*Câ‚â‚‚+Câ‚‚â‚‚*Câ‚‚â‚‚-Iâ‚*Câ‚‚â‚‚+Iâ‚‚)

        Câ‚â‚â‚â‚=Î»*J*(2*J-1.0)*Câ»Â¹â‚â‚*Câ»Â¹â‚â‚+(Î¼- Î»*J*(J-1.0))*2*Câ»Â¹â‚â‚*Câ»Â¹â‚â‚
        Câ‚‚â‚‚â‚‚â‚‚=Î»*J*(2*J-1.0)*Câ»Â¹â‚‚â‚‚*Câ»Â¹â‚‚â‚‚+(Î¼- Î»*J*(J-1.0))*2*Câ»Â¹â‚‚â‚‚*Câ»Â¹â‚‚â‚‚
        Câ‚â‚â‚‚â‚‚=Î»*J*(2*J-1.0)*Câ»Â¹â‚â‚*Câ»Â¹â‚‚â‚‚+(Î¼- Î»*J*(J-1.0))*2*Câ»Â¹â‚â‚‚*Câ»Â¹â‚â‚‚
        Câ‚â‚â‚â‚‚=Î»*J*(2*J-1.0)*Câ»Â¹â‚â‚*Câ»Â¹â‚â‚‚+(Î¼- Î»*J*(J-1.0))*2*Câ»Â¹â‚â‚*Câ»Â¹â‚â‚‚ 
        Câ‚‚â‚‚â‚â‚‚=Î»*J*(2*J-1.0)*Câ»Â¹â‚‚â‚‚*Câ»Â¹â‚â‚‚+(Î¼- Î»*J*(J-1.0))*2*Câ»Â¹â‚â‚‚*Câ»Â¹â‚‚â‚‚     
        Câ‚â‚‚â‚â‚‚=Î»*J*(2*J-1.0)*Câ»Â¹â‚â‚‚*Câ»Â¹â‚â‚‚+(Î¼- Î»*J*(J-1.0))*(Câ»Â¹â‚â‚*Câ»Â¹â‚‚â‚‚+Câ»Â¹â‚â‚‚*Câ»Â¹â‚â‚‚)   

        Sâ‚â‚ = Î»*J*(J-1)*Câ»Â¹â‚â‚ + Î¼*(1-Câ»Â¹â‚â‚)
        Sâ‚‚â‚‚ = Î»*J*(J-1)*Câ»Â¹â‚‚â‚‚ + Î¼*(1-Câ»Â¹â‚‚â‚‚)
        Sâ‚â‚‚ = Î»*J*(J-1)*Câ»Â¹â‚â‚‚ - Î¼*Câ»Â¹â‚â‚‚
  
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[2*I-1,2*J-1] +=(Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚â‚*Câ‚â‚â‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚*Câ‚‚â‚‚â‚‚â‚‚ 
                               + (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚â‚)*Câ‚â‚â‚‚â‚‚
                               + (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚â‚ + Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚â‚‚)*Câ‚â‚â‚â‚‚
                               + (Bâ‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚â‚)*Câ‚â‚â‚â‚‚
                               + (Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               + (Bâ‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               + (Bâ‚[i]*Fâ‚â‚‚+Bâ‚‚[i]*Fâ‚â‚)*(Bâ‚[j]*Fâ‚â‚‚+Bâ‚‚[j]*Fâ‚â‚)*Câ‚â‚‚â‚â‚‚
                               +  Bâ‚[i]*Bâ‚[j]*Sâ‚â‚+(Bâ‚[i]*Bâ‚‚[j]+Bâ‚‚[i]*Bâ‚[j])*Sâ‚â‚‚+Bâ‚‚[i]*Bâ‚‚[j]*Sâ‚‚â‚‚)*ð‘¤
                              
                k[2*I-1,2*J]   += (Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚‚â‚*Câ‚â‚â‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚*Câ‚‚â‚‚â‚‚â‚‚
                               +  (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚‚â‚)*Câ‚â‚â‚‚â‚‚
                               +  (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚‚â‚ + Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚‚â‚‚)*Câ‚â‚â‚â‚‚ 
                               +  (Bâ‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚‚â‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚â‚‚+Bâ‚‚[i]*Fâ‚â‚)*(Bâ‚[j]*Fâ‚‚â‚‚+Bâ‚‚[j]*Fâ‚‚â‚)*Câ‚â‚‚â‚â‚‚)*ð‘¤
                               
                k[2*I,2*J-1]   += (Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚â‚*Câ‚â‚â‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚*Câ‚‚â‚‚â‚‚â‚‚ 
                               +  (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚â‚)*Câ‚â‚â‚‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚â‚ + Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚â‚‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚â‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚+Bâ‚‚[i]*Fâ‚‚â‚)*(Bâ‚[j]*Fâ‚â‚‚+Bâ‚‚[j]*Fâ‚â‚)*Câ‚â‚‚â‚â‚‚)*ð‘¤

                k[2*I,2*J]     += (Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚‚â‚*Câ‚â‚â‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚*Câ‚‚â‚‚â‚‚â‚‚ 
                               +  (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚‚â‚)*Câ‚â‚â‚‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚‚â‚ + Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚‚â‚‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚‚â‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚+Bâ‚‚[i]*Fâ‚‚â‚)*(Bâ‚[j]*Fâ‚‚â‚‚+Bâ‚‚[j]*Fâ‚‚â‚)*Câ‚â‚‚â‚â‚‚
                               +   Bâ‚[i]*Bâ‚[j]*Sâ‚â‚+(Bâ‚[i]*Bâ‚‚[j]+Bâ‚‚[i]*Bâ‚[j])*Sâ‚â‚‚+Bâ‚‚[i]*Bâ‚‚[j]*Sâ‚‚â‚‚)*ð‘¤

            end
        end
    end
end

function Î”âˆ«âˆ«Eáµ›áµ¢â±¼Sáµ›áµ¢â±¼dxdy_NeoHookean(ap::T;k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    E=op.E
    Î½=op.Î½
    Î»=E*Î½/(1+Î½)/(1-2*Î½)
    Î¼=E/(1+Î½)/2
    for Î¾ in ð“–
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾.ð‘¤
        Fâ‚â‚ = 1.0
        Fâ‚â‚‚ = 0.0
        Fâ‚‚â‚ = 0.0
        Fâ‚‚â‚‚ = 1.0
        for (i,xáµ¢) in  enumerate(ð“’)  
            Fâ‚â‚ += Bâ‚[i]*xáµ¢.dâ‚
            Fâ‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚
            Fâ‚‚â‚ += Bâ‚[i]*xáµ¢.dâ‚‚
            Fâ‚‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚‚
        end
        Câ‚â‚ = Fâ‚â‚*Fâ‚â‚+Fâ‚‚â‚*Fâ‚‚â‚       
        Câ‚â‚‚ = Fâ‚â‚*Fâ‚â‚‚+Fâ‚‚â‚*Fâ‚‚â‚‚
        Câ‚‚â‚‚ = Fâ‚â‚‚*Fâ‚â‚‚+Fâ‚‚â‚‚*Fâ‚‚â‚‚
        Câ‚ƒâ‚ƒ = 1.0
        J = Fâ‚â‚*Fâ‚‚â‚‚-Fâ‚â‚‚*Fâ‚‚â‚
        detC = (Câ‚â‚*Câ‚‚â‚‚-Câ‚â‚‚*Câ‚â‚‚)
        Iâ‚ = Câ‚â‚+Câ‚‚â‚‚+Câ‚ƒâ‚ƒ
        Iâ‚‚ = 0.5*(Iâ‚^2-Câ‚â‚^2-Câ‚‚â‚‚^2-Câ‚ƒâ‚ƒ^2-2*Câ‚â‚‚^2)
        Câ»Â¹â‚â‚=1.0/detC*(Câ‚â‚*Câ‚â‚+Câ‚â‚‚*Câ‚â‚‚-Iâ‚*Câ‚â‚+Iâ‚‚)
        Câ»Â¹â‚â‚‚=1.0/detC*(Câ‚â‚*Câ‚â‚‚+Câ‚â‚‚*Câ‚‚â‚‚-Iâ‚*Câ‚â‚‚)
        Câ»Â¹â‚‚â‚‚=1.0/detC*(Câ‚â‚‚*Câ‚â‚‚+Câ‚‚â‚‚*Câ‚‚â‚‚-Iâ‚*Câ‚‚â‚‚+Iâ‚‚)

        Câ‚â‚â‚â‚=Î»*J*(2*J-1.0)*Câ»Â¹â‚â‚*Câ»Â¹â‚â‚- Î»*J*(J-1.0)*2*Câ»Â¹â‚â‚*Câ»Â¹â‚â‚
        Câ‚‚â‚‚â‚‚â‚‚=Î»*J*(2*J-1.0)*Câ»Â¹â‚‚â‚‚*Câ»Â¹â‚‚â‚‚- Î»*J*(J-1.0)*2*Câ»Â¹â‚‚â‚‚*Câ»Â¹â‚‚â‚‚
        Câ‚â‚â‚‚â‚‚=Î»*J*(2*J-1.0)*Câ»Â¹â‚â‚*Câ»Â¹â‚‚â‚‚- Î»*J*(J-1.0)*2*Câ»Â¹â‚â‚‚*Câ»Â¹â‚â‚‚
        Câ‚â‚â‚â‚‚=Î»*J*(2*J-1.0)*Câ»Â¹â‚â‚*Câ»Â¹â‚â‚‚- Î»*J*(J-1.0)*2*Câ»Â¹â‚â‚*Câ»Â¹â‚â‚‚ 
        Câ‚‚â‚‚â‚â‚‚=Î»*J*(2*J-1.0)*Câ»Â¹â‚‚â‚‚*Câ»Â¹â‚â‚‚- Î»*J*(J-1.0)*2*Câ»Â¹â‚â‚‚*Câ»Â¹â‚‚â‚‚     
        Câ‚â‚‚â‚â‚‚=Î»*J*(2*J-1.0)*Câ»Â¹â‚â‚‚*Câ»Â¹â‚â‚‚- Î»*J*(J-1.0)*(Câ»Â¹â‚â‚*Câ»Â¹â‚‚â‚‚+Câ»Â¹â‚â‚‚*Câ»Â¹â‚â‚‚)   

        Sâ‚â‚ = Î»*J*(J-1)*Câ»Â¹â‚â‚
        Sâ‚‚â‚‚ = Î»*J*(J-1)*Câ»Â¹â‚‚â‚‚
        Sâ‚â‚‚ = Î»*J*(J-1)*Câ»Â¹â‚â‚‚
  
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[2*I-1,2*J-1] +=(Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚â‚*Câ‚â‚â‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚*Câ‚‚â‚‚â‚‚â‚‚ 
                               + (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚â‚)*Câ‚â‚â‚‚â‚‚
                               + (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚â‚ + Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚â‚‚)*Câ‚â‚â‚â‚‚
                               + (Bâ‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚â‚)*Câ‚â‚â‚â‚‚
                               + (Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               + (Bâ‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               + (Bâ‚[i]*Fâ‚â‚‚+Bâ‚‚[i]*Fâ‚â‚)*(Bâ‚[j]*Fâ‚â‚‚+Bâ‚‚[j]*Fâ‚â‚)*Câ‚â‚‚â‚â‚‚
                               +  Bâ‚[i]*Bâ‚[j]*Sâ‚â‚+(Bâ‚[i]*Bâ‚‚[j]+Bâ‚‚[i]*Bâ‚[j])*Sâ‚â‚‚+Bâ‚‚[i]*Bâ‚‚[j]*Sâ‚‚â‚‚)*ð‘¤
                              
                k[2*I-1,2*J]   += (Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚‚â‚*Câ‚â‚â‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚*Câ‚‚â‚‚â‚‚â‚‚
                               +  (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚‚â‚)*Câ‚â‚â‚‚â‚‚
                               +  (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚‚â‚ + Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚‚â‚‚)*Câ‚â‚â‚â‚‚ 
                               +  (Bâ‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚‚â‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚â‚‚+Bâ‚‚[i]*Fâ‚â‚)*(Bâ‚[j]*Fâ‚‚â‚‚+Bâ‚‚[j]*Fâ‚‚â‚)*Câ‚â‚‚â‚â‚‚)*ð‘¤
                               
                k[2*I,2*J-1]   += (Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚â‚*Câ‚â‚â‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚*Câ‚‚â‚‚â‚‚â‚‚ 
                               +  (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚â‚)*Câ‚â‚â‚‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚â‚ + Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚â‚‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚â‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚+Bâ‚‚[i]*Fâ‚‚â‚)*(Bâ‚[j]*Fâ‚â‚‚+Bâ‚‚[j]*Fâ‚â‚)*Câ‚â‚‚â‚â‚‚)*ð‘¤

                k[2*I,2*J]     += (Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚‚â‚*Câ‚â‚â‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚*Câ‚‚â‚‚â‚‚â‚‚ 
                               +  (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚‚â‚)*Câ‚â‚â‚‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚‚â‚ + Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚‚â‚‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚‚â‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚+Bâ‚‚[i]*Fâ‚‚â‚)*(Bâ‚[j]*Fâ‚‚â‚‚+Bâ‚‚[j]*Fâ‚‚â‚)*Câ‚â‚‚â‚â‚‚
                               +   Bâ‚[i]*Bâ‚[j]*Sâ‚â‚+(Bâ‚[i]*Bâ‚‚[j]+Bâ‚‚[i]*Bâ‚[j])*Sâ‚â‚‚+Bâ‚‚[i]*Bâ‚‚[j]*Sâ‚‚â‚‚)*ð‘¤

            end
        end
    end
end

function Î”âˆ«âˆ«Eáµˆáµ¢â±¼Sáµˆáµ¢â±¼dxdy_NeoHookean(ap::T;k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    E=op.E
    Î½=op.Î½
    Î»=E*Î½/(1+Î½)/(1-2*Î½)
    Î¼=E/(1+Î½)/2
    for Î¾ in ð“–
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾.ð‘¤
        Fâ‚â‚ = 1.0
        Fâ‚â‚‚ = 0.0
        Fâ‚‚â‚ = 0.0
        Fâ‚‚â‚‚ = 1.0
        for (i,xáµ¢) in  enumerate(ð“’)  
            Fâ‚â‚ += Bâ‚[i]*xáµ¢.dâ‚
            Fâ‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚
            Fâ‚‚â‚ += Bâ‚[i]*xáµ¢.dâ‚‚
            Fâ‚‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚‚
        end
        Câ‚â‚ = Fâ‚â‚*Fâ‚â‚+Fâ‚‚â‚*Fâ‚‚â‚       
        Câ‚â‚‚ = Fâ‚â‚*Fâ‚â‚‚+Fâ‚‚â‚*Fâ‚‚â‚‚
        Câ‚‚â‚‚ = Fâ‚â‚‚*Fâ‚â‚‚+Fâ‚‚â‚‚*Fâ‚‚â‚‚
        Câ‚ƒâ‚ƒ = 1.0
        J = Fâ‚â‚*Fâ‚‚â‚‚-Fâ‚â‚‚*Fâ‚‚â‚
        detC = (Câ‚â‚*Câ‚‚â‚‚-Câ‚â‚‚*Câ‚â‚‚)
        Iâ‚ = Câ‚â‚+Câ‚‚â‚‚+Câ‚ƒâ‚ƒ
        Iâ‚‚ = 0.5*(Iâ‚^2-Câ‚â‚^2-Câ‚‚â‚‚^2-Câ‚ƒâ‚ƒ^2-2*Câ‚â‚‚^2)
        Câ»Â¹â‚â‚=1.0/detC*(Câ‚â‚*Câ‚â‚+Câ‚â‚‚*Câ‚â‚‚-Iâ‚*Câ‚â‚+Iâ‚‚)
        Câ»Â¹â‚â‚‚=1.0/detC*(Câ‚â‚*Câ‚â‚‚+Câ‚â‚‚*Câ‚‚â‚‚-Iâ‚*Câ‚â‚‚)
        Câ»Â¹â‚‚â‚‚=1.0/detC*(Câ‚â‚‚*Câ‚â‚‚+Câ‚‚â‚‚*Câ‚‚â‚‚-Iâ‚*Câ‚‚â‚‚+Iâ‚‚)

        Câ‚â‚â‚â‚=Î¼*2*Câ»Â¹â‚â‚*Câ»Â¹â‚â‚
        Câ‚‚â‚‚â‚‚â‚‚=Î¼*2*Câ»Â¹â‚‚â‚‚*Câ»Â¹â‚‚â‚‚
        Câ‚â‚â‚‚â‚‚=Î¼*2*Câ»Â¹â‚â‚‚*Câ»Â¹â‚â‚‚
        Câ‚â‚â‚â‚‚=Î¼*2*Câ»Â¹â‚â‚*Câ»Â¹â‚â‚‚ 
        Câ‚‚â‚‚â‚â‚‚=Î¼*2*Câ»Â¹â‚â‚‚*Câ»Â¹â‚‚â‚‚     
        Câ‚â‚‚â‚â‚‚=Î¼*(Câ»Â¹â‚â‚*Câ»Â¹â‚‚â‚‚+Câ»Â¹â‚â‚‚*Câ»Â¹â‚â‚‚)   

        Sâ‚â‚ = Î¼*(1-Câ»Â¹â‚â‚)
        Sâ‚‚â‚‚ = Î¼*(1-Câ»Â¹â‚‚â‚‚)
        Sâ‚â‚‚ = - Î¼*Câ»Â¹â‚â‚‚
  
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[2*I-1,2*J-1] +=(Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚â‚*Câ‚â‚â‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚*Câ‚‚â‚‚â‚‚â‚‚ 
                               + (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚â‚)*Câ‚â‚â‚‚â‚‚
                               + (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚â‚ + Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚â‚‚)*Câ‚â‚â‚â‚‚
                               + (Bâ‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚â‚)*Câ‚â‚â‚â‚‚
                               + (Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               + (Bâ‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               + (Bâ‚[i]*Fâ‚â‚‚+Bâ‚‚[i]*Fâ‚â‚)*(Bâ‚[j]*Fâ‚â‚‚+Bâ‚‚[j]*Fâ‚â‚)*Câ‚â‚‚â‚â‚‚
                               +  Bâ‚[i]*Bâ‚[j]*Sâ‚â‚+(Bâ‚[i]*Bâ‚‚[j]+Bâ‚‚[i]*Bâ‚[j])*Sâ‚â‚‚+Bâ‚‚[i]*Bâ‚‚[j]*Sâ‚‚â‚‚)*ð‘¤
                              
                k[2*I-1,2*J]   += (Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚‚â‚*Câ‚â‚â‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚*Câ‚‚â‚‚â‚‚â‚‚
                               +  (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚‚â‚)*Câ‚â‚â‚‚â‚‚
                               +  (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚‚â‚ + Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚‚â‚‚)*Câ‚â‚â‚â‚‚ 
                               +  (Bâ‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚‚â‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚â‚‚+Bâ‚‚[i]*Fâ‚â‚)*(Bâ‚[j]*Fâ‚‚â‚‚+Bâ‚‚[j]*Fâ‚‚â‚)*Câ‚â‚‚â‚â‚‚)*ð‘¤
                               
                k[2*I,2*J-1]   += (Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚â‚*Câ‚â‚â‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚*Câ‚‚â‚‚â‚‚â‚‚ 
                               +  (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚â‚)*Câ‚â‚â‚‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚â‚ + Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚â‚‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚â‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚+Bâ‚‚[i]*Fâ‚‚â‚)*(Bâ‚[j]*Fâ‚â‚‚+Bâ‚‚[j]*Fâ‚â‚)*Câ‚â‚‚â‚â‚‚)*ð‘¤

                k[2*I,2*J]     += (Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚‚â‚*Câ‚â‚â‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚*Câ‚‚â‚‚â‚‚â‚‚ 
                               +  (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚‚â‚)*Câ‚â‚â‚‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚‚â‚ + Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚‚â‚‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚‚â‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚+Bâ‚‚[i]*Fâ‚‚â‚)*(Bâ‚[j]*Fâ‚‚â‚‚+Bâ‚‚[j]*Fâ‚‚â‚)*Câ‚â‚‚â‚â‚‚
                               +   Bâ‚[i]*Bâ‚[j]*Sâ‚â‚+(Bâ‚[i]*Bâ‚‚[j]+Bâ‚‚[i]*Bâ‚[j])*Sâ‚â‚‚+Bâ‚‚[i]*Bâ‚‚[j]*Sâ‚‚â‚‚)*ð‘¤

            end
        end
    end
end

function âˆ«âˆ«Eáµ¢â±¼Sáµ¢â±¼dxdy_NeoHookean(ap::T;f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    E=op.E
    Î½=op.Î½
    Î»=E*Î½/(1+Î½)/(1-2*Î½)
    Î¼=E/(1+Î½)/2
    for Î¾ in ð“–
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾.ð‘¤
        Fâ‚â‚ = 1.0
        Fâ‚â‚‚ = 0.0
        Fâ‚‚â‚ = 0.0
        Fâ‚‚â‚‚ = 1.0
        for (i,xáµ¢) in  enumerate(ð“’)  
            Fâ‚â‚ += Bâ‚[i]*xáµ¢.dâ‚
            Fâ‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚
            Fâ‚‚â‚ += Bâ‚[i]*xáµ¢.dâ‚‚
            Fâ‚‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚‚
        end
        Câ‚â‚ = Fâ‚â‚*Fâ‚â‚+Fâ‚‚â‚*Fâ‚‚â‚       
        Câ‚â‚‚ = Fâ‚â‚*Fâ‚â‚‚+Fâ‚‚â‚*Fâ‚‚â‚‚
        Câ‚‚â‚‚ = Fâ‚â‚‚*Fâ‚â‚‚+Fâ‚‚â‚‚*Fâ‚‚â‚‚
        Câ‚ƒâ‚ƒ = 1.0
        J = Fâ‚â‚*Fâ‚‚â‚‚-Fâ‚â‚‚*Fâ‚‚â‚
        detC = (Câ‚â‚*Câ‚‚â‚‚-Câ‚â‚‚*Câ‚â‚‚)
        Iâ‚ = Câ‚â‚+Câ‚‚â‚‚+Câ‚ƒâ‚ƒ
        Iâ‚‚ = 0.5*(Iâ‚^2-Câ‚â‚^2-Câ‚‚â‚‚^2-Câ‚ƒâ‚ƒ^2-2*Câ‚â‚‚^2)
        Câ»Â¹â‚â‚=1.0/detC*(Câ‚â‚*Câ‚â‚+Câ‚â‚‚*Câ‚â‚‚-Iâ‚*Câ‚â‚+Iâ‚‚)
        Câ»Â¹â‚â‚‚=1.0/detC*(Câ‚â‚*Câ‚â‚‚+Câ‚â‚‚*Câ‚‚â‚‚-Iâ‚*Câ‚â‚‚)
        Câ»Â¹â‚‚â‚‚=1.0/detC*(Câ‚â‚‚*Câ‚â‚‚+Câ‚‚â‚‚*Câ‚‚â‚‚-Iâ‚*Câ‚‚â‚‚+Iâ‚‚)

        Sâ‚â‚ = Î»*J*(J-1)*Câ»Â¹â‚â‚ + Î¼*(1-Câ»Â¹â‚â‚)
        Sâ‚‚â‚‚ = Î»*J*(J-1)*Câ»Â¹â‚‚â‚‚ + Î¼*(1-Câ»Â¹â‚‚â‚‚)
        Sâ‚â‚‚ = Î»*J*(J-1)*Câ»Â¹â‚â‚‚ - Î¼*Câ»Â¹â‚â‚‚
  
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            f[2*I-1] += (Bâ‚[i]*Fâ‚â‚*Sâ‚â‚+Bâ‚‚[i]*Fâ‚â‚‚*Sâ‚‚â‚‚+(Bâ‚[i]*Fâ‚â‚‚+Bâ‚‚[i]*Fâ‚â‚)*Sâ‚â‚‚)*ð‘¤
            f[2*I]   += (Bâ‚[i]*Fâ‚‚â‚*Sâ‚â‚+Bâ‚‚[i]*Fâ‚‚â‚‚*Sâ‚‚â‚‚+(Bâ‚[i]*Fâ‚‚â‚‚+Bâ‚‚[i]*Fâ‚‚â‚)*Sâ‚â‚‚)*ð‘¤
        end
    end
end

function âˆ«âˆ«Eáµ›áµ¢â±¼Sáµ›áµ¢â±¼dxdy_NeoHookean(ap::T;f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    E=op.E
    Î½=op.Î½
    Î»=E*Î½/(1+Î½)/(1-2*Î½)
    Î¼=E/(1+Î½)/2
    for Î¾ in ð“–
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾.ð‘¤
        Fâ‚â‚ = 1.0
        Fâ‚â‚‚ = 0.0
        Fâ‚‚â‚ = 0.0
        Fâ‚‚â‚‚ = 1.0
        for (i,xáµ¢) in  enumerate(ð“’)  
            Fâ‚â‚ += Bâ‚[i]*xáµ¢.dâ‚
            Fâ‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚
            Fâ‚‚â‚ += Bâ‚[i]*xáµ¢.dâ‚‚
            Fâ‚‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚‚
        end
        Câ‚â‚ = Fâ‚â‚*Fâ‚â‚+Fâ‚‚â‚*Fâ‚‚â‚       
        Câ‚â‚‚ = Fâ‚â‚*Fâ‚â‚‚+Fâ‚‚â‚*Fâ‚‚â‚‚
        Câ‚‚â‚‚ = Fâ‚â‚‚*Fâ‚â‚‚+Fâ‚‚â‚‚*Fâ‚‚â‚‚
        Câ‚ƒâ‚ƒ = 1.0
        J = Fâ‚â‚*Fâ‚‚â‚‚-Fâ‚â‚‚*Fâ‚‚â‚
        detC = (Câ‚â‚*Câ‚‚â‚‚-Câ‚â‚‚*Câ‚â‚‚)
        Iâ‚ = Câ‚â‚+Câ‚‚â‚‚+Câ‚ƒâ‚ƒ
        Iâ‚‚ = 0.5*(Iâ‚^2-Câ‚â‚^2-Câ‚‚â‚‚^2-Câ‚ƒâ‚ƒ^2-2*Câ‚â‚‚^2)
        Câ»Â¹â‚â‚=1.0/detC*(Câ‚â‚*Câ‚â‚+Câ‚â‚‚*Câ‚â‚‚-Iâ‚*Câ‚â‚+Iâ‚‚)
        Câ»Â¹â‚â‚‚=1.0/detC*(Câ‚â‚*Câ‚â‚‚+Câ‚â‚‚*Câ‚‚â‚‚-Iâ‚*Câ‚â‚‚)
        Câ»Â¹â‚‚â‚‚=1.0/detC*(Câ‚â‚‚*Câ‚â‚‚+Câ‚‚â‚‚*Câ‚‚â‚‚-Iâ‚*Câ‚‚â‚‚+Iâ‚‚)

        Sâ‚â‚ = Î»*J*(J-1)*Câ»Â¹â‚â‚
        Sâ‚‚â‚‚ = Î»*J*(J-1)*Câ»Â¹â‚‚â‚‚
        Sâ‚â‚‚ = Î»*J*(J-1)*Câ»Â¹â‚â‚‚
  
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            f[2*I-1] += (Bâ‚[i]*Fâ‚â‚*Sâ‚â‚+Bâ‚‚[i]*Fâ‚â‚‚*Sâ‚‚â‚‚+(Bâ‚[i]*Fâ‚â‚‚+Bâ‚‚[i]*Fâ‚â‚)*Sâ‚â‚‚)*ð‘¤
            f[2*I]   += (Bâ‚[i]*Fâ‚‚â‚*Sâ‚â‚+Bâ‚‚[i]*Fâ‚‚â‚‚*Sâ‚‚â‚‚+(Bâ‚[i]*Fâ‚‚â‚‚+Bâ‚‚[i]*Fâ‚‚â‚)*Sâ‚â‚‚)*ð‘¤
        end
    end
end

function âˆ«âˆ«Eáµˆáµ¢â±¼Sáµˆáµ¢â±¼dxdy_NeoHookean(ap::T;f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    E=op.E
    Î½=op.Î½
    Î»=E*Î½/(1+Î½)/(1-2*Î½)
    Î¼=E/(1+Î½)/2
    for Î¾ in ð“–
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾.ð‘¤
        Fâ‚â‚ = 1.0
        Fâ‚â‚‚ = 0.0
        Fâ‚‚â‚ = 0.0
        Fâ‚‚â‚‚ = 1.0
        for (i,xáµ¢) in  enumerate(ð“’)  
            Fâ‚â‚ += Bâ‚[i]*xáµ¢.dâ‚
            Fâ‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚
            Fâ‚‚â‚ += Bâ‚[i]*xáµ¢.dâ‚‚
            Fâ‚‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚‚
        end
        Câ‚â‚ = Fâ‚â‚*Fâ‚â‚+Fâ‚‚â‚*Fâ‚‚â‚       
        Câ‚â‚‚ = Fâ‚â‚*Fâ‚â‚‚+Fâ‚‚â‚*Fâ‚‚â‚‚
        Câ‚‚â‚‚ = Fâ‚â‚‚*Fâ‚â‚‚+Fâ‚‚â‚‚*Fâ‚‚â‚‚
        Câ‚ƒâ‚ƒ = 1.0
        J = Fâ‚â‚*Fâ‚‚â‚‚-Fâ‚â‚‚*Fâ‚‚â‚
        detC = (Câ‚â‚*Câ‚‚â‚‚-Câ‚â‚‚*Câ‚â‚‚)
        Iâ‚ = Câ‚â‚+Câ‚‚â‚‚+Câ‚ƒâ‚ƒ
        Iâ‚‚ = 0.5*(Iâ‚^2-Câ‚â‚^2-Câ‚‚â‚‚^2-Câ‚ƒâ‚ƒ^2-2*Câ‚â‚‚^2)
        Câ»Â¹â‚â‚=1.0/detC*(Câ‚â‚*Câ‚â‚+Câ‚â‚‚*Câ‚â‚‚-Iâ‚*Câ‚â‚+Iâ‚‚)
        Câ»Â¹â‚â‚‚=1.0/detC*(Câ‚â‚*Câ‚â‚‚+Câ‚â‚‚*Câ‚‚â‚‚-Iâ‚*Câ‚â‚‚)
        Câ»Â¹â‚‚â‚‚=1.0/detC*(Câ‚â‚‚*Câ‚â‚‚+Câ‚‚â‚‚*Câ‚‚â‚‚-Iâ‚*Câ‚‚â‚‚+Iâ‚‚)

        Sâ‚â‚ = Î¼*(1-Câ»Â¹â‚â‚)
        Sâ‚‚â‚‚ = Î¼*(1-Câ»Â¹â‚‚â‚‚)
        Sâ‚â‚‚ = - Î¼*Câ»Â¹â‚â‚‚
  
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            f[2*I-1] += (Bâ‚[i]*Fâ‚â‚*Sâ‚â‚+Bâ‚‚[i]*Fâ‚â‚‚*Sâ‚‚â‚‚+(Bâ‚[i]*Fâ‚â‚‚+Bâ‚‚[i]*Fâ‚â‚)*Sâ‚â‚‚)*ð‘¤
            f[2*I]   += (Bâ‚[i]*Fâ‚‚â‚*Sâ‚â‚+Bâ‚‚[i]*Fâ‚‚â‚‚*Sâ‚‚â‚‚+(Bâ‚[i]*Fâ‚‚â‚‚+Bâ‚‚[i]*Fâ‚‚â‚)*Sâ‚â‚‚)*ð‘¤
        end
    end
end

function âˆ«váµ¢uáµ¢ds(ap::T,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
  
    for Î¾ in ð“–
        Î± = Î¾.Î±
        ð‘¤ = Î¾.ð‘¤
        N = Î¾[:ð­]
        nâ‚â‚ = Î¾.nâ‚â‚
        nâ‚‚â‚‚ = Î¾.nâ‚‚â‚‚
        nâ‚â‚‚ = Î¾.nâ‚â‚‚
        gâ‚ = Î¾.gâ‚
        gâ‚‚ = Î¾.gâ‚‚
        uâ‚ = 0.0
        uâ‚‚ = 0.0
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            uâ‚ += N[i]*xáµ¢.dâ‚
            uâ‚‚ += N[i]*xáµ¢.dâ‚‚
        end
        Î”uâ‚ = gâ‚-uâ‚
        Î”uâ‚‚ = gâ‚‚-uâ‚‚
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[2*I-1,2*J-1] += Î±*N[i]*nâ‚â‚*N[j]*ð‘¤
                k[2*I,2*J-1]   += Î±*N[i]*nâ‚â‚‚*N[j]*ð‘¤
                k[2*I-1,2*J]   += Î±*N[i]*nâ‚â‚‚*N[j]*ð‘¤
                k[2*I,2*J]     += Î±*N[i]*nâ‚‚â‚‚*N[j]*ð‘¤
            end
            f[2*I-1] += Î±*N[i]*(nâ‚â‚*Î”uâ‚+nâ‚â‚‚*Î”uâ‚‚)*ð‘¤
            f[2*I]   += Î±*N[i]*(nâ‚â‚‚*Î”uâ‚+nâ‚‚â‚‚*Î”uâ‚‚)*ð‘¤
        end
    end
end
function Î”âˆ«âˆ«Eáµ¢â±¼Sáµ¢â±¼dxdy_NeoHookean2(ap::T;k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    E=op.E
    Î½=op.Î½
    K=E/(1-2*Î½)/3
    Î»=E*Î½/(1+Î½)/(1-2*Î½)
    Î¼=E/(1+Î½)/2
    for Î¾ in ð“–
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾.ð‘¤
        Fâ‚â‚ = 1.0
        Fâ‚â‚‚ = 0.0
        Fâ‚‚â‚ = 0.0
        Fâ‚‚â‚‚ = 1.0
        for (i,xáµ¢) in  enumerate(ð“’)  
            Fâ‚â‚ += Bâ‚[i]*xáµ¢.dâ‚
            Fâ‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚
            Fâ‚‚â‚ += Bâ‚[i]*xáµ¢.dâ‚‚
            Fâ‚‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚‚
        end
        Câ‚â‚ = Fâ‚â‚*Fâ‚â‚+Fâ‚‚â‚*Fâ‚‚â‚       
        Câ‚â‚‚ = Fâ‚â‚*Fâ‚â‚‚+Fâ‚‚â‚*Fâ‚‚â‚‚
        Câ‚‚â‚‚ = Fâ‚â‚‚*Fâ‚â‚‚+Fâ‚‚â‚‚*Fâ‚‚â‚‚
        Câ‚ƒâ‚ƒ = 1.0
        J = Fâ‚â‚*Fâ‚‚â‚‚-Fâ‚â‚‚*Fâ‚‚â‚
        detC = (Câ‚â‚*Câ‚‚â‚‚-Câ‚â‚‚*Câ‚â‚‚)
        Iâ‚ = Câ‚â‚+Câ‚‚â‚‚+Câ‚ƒâ‚ƒ
        Iâ‚‚ = 0.5*(Iâ‚^2-Câ‚â‚^2-Câ‚‚â‚‚^2-Câ‚ƒâ‚ƒ^2-2*Câ‚â‚‚^2)
        Câ»Â¹â‚â‚=1.0/detC*(Câ‚â‚*Câ‚â‚+Câ‚â‚‚*Câ‚â‚‚-Iâ‚*Câ‚â‚+Iâ‚‚)
        Câ»Â¹â‚â‚‚=1.0/detC*(Câ‚â‚*Câ‚â‚‚+Câ‚â‚‚*Câ‚‚â‚‚-Iâ‚*Câ‚â‚‚)
        Câ»Â¹â‚‚â‚‚=1.0/detC*(Câ‚â‚‚*Câ‚â‚‚+Câ‚‚â‚‚*Câ‚‚â‚‚-Iâ‚*Câ‚‚â‚‚+Iâ‚‚)

        Jâ»Â²=(1.0/J)^2
        # println(Jâ»Â²)
        Jâ»Â²Â³=cbrt(Jâ»Â²)
        # println(Jâ»Â²Â³)
        Câ‚â‚â‚â‚=(-2/3*Câ»Â¹â‚â‚-2/3*Câ»Â¹â‚â‚)*Jâ»Â²Â³*Î¼+(J^2*K+2/9*Jâ»Â²Â³*Iâ‚*Î¼)*Câ»Â¹â‚â‚*Câ»Â¹â‚â‚+(1/3*Î¼*Jâ»Â²Â³*Iâ‚-0.5*K*(J^2-1.0))*2*Câ»Â¹â‚â‚*Câ»Â¹â‚â‚
            #   println(Câ‚â‚â‚â‚)
        Câ‚‚â‚‚â‚‚â‚‚=(-2/3*Câ»Â¹â‚‚â‚‚-2/3*Câ»Â¹â‚‚â‚‚)*Jâ»Â²Â³*Î¼+(J^2*K+2/9*Jâ»Â²Â³*Iâ‚*Î¼)*Câ»Â¹â‚‚â‚‚*Câ»Â¹â‚‚â‚‚+(1/3*Î¼*Jâ»Â²Â³*Iâ‚-0.5*K*(J^2-1.0))*2*Câ»Â¹â‚‚â‚‚*Câ»Â¹â‚‚â‚‚
        Câ‚â‚â‚‚â‚‚=(-2/3*Câ»Â¹â‚‚â‚‚-2/3*Câ»Â¹â‚â‚)*Jâ»Â²Â³*Î¼+(J^2*K+2/9*Jâ»Â²Â³*Iâ‚*Î¼)*Câ»Â¹â‚â‚*Câ»Â¹â‚‚â‚‚+(1/3*Î¼*Jâ»Â²Â³*Iâ‚-0.5*K*(J^2-1.0))*2*Câ»Â¹â‚â‚‚*Câ»Â¹â‚â‚‚
        Câ‚â‚â‚â‚‚=(-2/3*Câ»Â¹â‚â‚‚)*Jâ»Â²Â³*Î¼+(J^2*K+2/9*Jâ»Â²Â³*Iâ‚*Î¼)*Câ»Â¹â‚â‚*Câ»Â¹â‚â‚‚+(1/3*Î¼*Jâ»Â²Â³*Iâ‚-0.5*K*(J^2-1.0))*2*Câ»Â¹â‚â‚*Câ»Â¹â‚â‚‚ 
        Câ‚‚â‚‚â‚â‚‚=(-2/3*Câ»Â¹â‚â‚‚)*Jâ»Â²Â³*Î¼+(J^2*K+2/9*Jâ»Â²Â³*Iâ‚*Î¼)*Câ»Â¹â‚‚â‚‚*Câ»Â¹â‚â‚‚+(1/3*Î¼*Jâ»Â²Â³*Iâ‚-0.5*K*(J^2-1.0))*2*Câ»Â¹â‚‚â‚‚*Câ»Â¹â‚â‚‚     
        Câ‚â‚‚â‚â‚‚=(J^2*K+2/9*Jâ»Â²Â³*Iâ‚*Î¼)*Câ»Â¹â‚â‚‚*Câ»Â¹â‚â‚‚+(1/3*Î¼*Jâ»Â²Â³*Iâ‚-0.5*K*(J^2-1.0))*(Câ»Â¹â‚â‚*Câ»Â¹â‚‚â‚‚+Câ»Â¹â‚â‚‚*Câ»Â¹â‚â‚‚)   
              
        Sâ‚â‚ = Î¼*Jâ»Â²Â³*(1.0-1/3*Iâ‚*Câ»Â¹â‚â‚)+0.5*K*(J^2-1.0)*Câ»Â¹â‚â‚
        Sâ‚‚â‚‚ = Î¼*Jâ»Â²Â³*(1.0-1/3*Iâ‚*Câ»Â¹â‚‚â‚‚)+0.5*K*(J^2-1.0)*Câ»Â¹â‚‚â‚‚
        Sâ‚â‚‚ = Î¼*Jâ»Â²Â³*(-1/3*Iâ‚*Câ»Â¹â‚â‚‚)+0.5*K*(J^2-1.0)*Câ»Â¹â‚â‚‚
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[2*I-1,2*J-1] +=(Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚â‚*Câ‚â‚â‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚*Câ‚‚â‚‚â‚‚â‚‚ 
                               + (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚â‚)*Câ‚â‚â‚‚â‚‚
                               + (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚â‚ + Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚â‚‚)*Câ‚â‚â‚â‚‚
                               + (Bâ‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚â‚)*Câ‚â‚â‚â‚‚
                               + (Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               + (Bâ‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               + (Bâ‚[i]*Fâ‚â‚‚+Bâ‚‚[i]*Fâ‚â‚)*(Bâ‚[j]*Fâ‚â‚‚+Bâ‚‚[j]*Fâ‚â‚)*Câ‚â‚‚â‚â‚‚
                               +  Bâ‚[i]*Bâ‚[j]*Sâ‚â‚+(Bâ‚[i]*Bâ‚‚[j]+Bâ‚‚[i]*Bâ‚[j])*Sâ‚â‚‚+Bâ‚‚[i]*Bâ‚‚[j]*Sâ‚‚â‚‚)*ð‘¤
                              
                k[2*I-1,2*J]   += (Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚‚â‚*Câ‚â‚â‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚*Câ‚‚â‚‚â‚‚â‚‚
                               +  (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚‚â‚)*Câ‚â‚â‚‚â‚‚
                               +  (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚‚â‚ + Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚‚â‚‚)*Câ‚â‚â‚â‚‚ 
                               +  (Bâ‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚‚â‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚â‚‚+Bâ‚‚[i]*Fâ‚â‚)*(Bâ‚[j]*Fâ‚‚â‚‚+Bâ‚‚[j]*Fâ‚‚â‚)*Câ‚â‚‚â‚â‚‚)*ð‘¤
                               
                k[2*I,2*J-1]   += (Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚â‚*Câ‚â‚â‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚*Câ‚‚â‚‚â‚‚â‚‚ 
                               +  (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚â‚)*Câ‚â‚â‚‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚â‚ + Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚â‚‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚â‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚+Bâ‚‚[i]*Fâ‚‚â‚)*(Bâ‚[j]*Fâ‚â‚‚+Bâ‚‚[j]*Fâ‚â‚)*Câ‚â‚‚â‚â‚‚)*ð‘¤

                k[2*I,2*J]     += (Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚‚â‚*Câ‚â‚â‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚*Câ‚‚â‚‚â‚‚â‚‚ 
                               +  (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚‚â‚)*Câ‚â‚â‚‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚‚â‚ + Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚‚â‚‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚‚â‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚+Bâ‚‚[i]*Fâ‚‚â‚)*(Bâ‚[j]*Fâ‚‚â‚‚+Bâ‚‚[j]*Fâ‚‚â‚)*Câ‚â‚‚â‚â‚‚
                               +   Bâ‚[i]*Bâ‚[j]*Sâ‚â‚+(Bâ‚[i]*Bâ‚‚[j]+Bâ‚‚[i]*Bâ‚[j])*Sâ‚â‚‚+Bâ‚‚[i]*Bâ‚‚[j]*Sâ‚‚â‚‚)*ð‘¤

            end
        end
    end
end

function Î”âˆ«âˆ«Eáµ›áµ¢â±¼Sáµ›áµ¢â±¼dxdy_NeoHookean2(ap::T;k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    E=op.E
    Î½=op.Î½
    K=E/(1-2*Î½)/3
    Î»=E*Î½/(1+Î½)/(1-2*Î½)
    Î¼=E/(1+Î½)/2
    for Î¾ in ð“–
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾.ð‘¤
        Fâ‚â‚ = 1.0
        Fâ‚â‚‚ = 0.0
        Fâ‚‚â‚ = 0.0
        Fâ‚‚â‚‚ = 1.0
        for (i,xáµ¢) in  enumerate(ð“’)  
            Fâ‚â‚ += Bâ‚[i]*xáµ¢.dâ‚
            Fâ‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚
            Fâ‚‚â‚ += Bâ‚[i]*xáµ¢.dâ‚‚
            Fâ‚‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚‚
        end
        Câ‚â‚ = Fâ‚â‚*Fâ‚â‚+Fâ‚‚â‚*Fâ‚‚â‚       
        Câ‚â‚‚ = Fâ‚â‚*Fâ‚â‚‚+Fâ‚‚â‚*Fâ‚‚â‚‚
        Câ‚‚â‚‚ = Fâ‚â‚‚*Fâ‚â‚‚+Fâ‚‚â‚‚*Fâ‚‚â‚‚
        Câ‚ƒâ‚ƒ = 1.0
        J = Fâ‚â‚*Fâ‚‚â‚‚-Fâ‚â‚‚*Fâ‚‚â‚
        detC = (Câ‚â‚*Câ‚‚â‚‚-Câ‚â‚‚*Câ‚â‚‚)
        Iâ‚ = Câ‚â‚+Câ‚‚â‚‚+Câ‚ƒâ‚ƒ
        Iâ‚‚ = 0.5*(Iâ‚^2-Câ‚â‚^2-Câ‚‚â‚‚^2-Câ‚ƒâ‚ƒ^2-2*Câ‚â‚‚^2)
        Câ»Â¹â‚â‚=1.0/detC*(Câ‚â‚*Câ‚â‚+Câ‚â‚‚*Câ‚â‚‚-Iâ‚*Câ‚â‚+Iâ‚‚)
        Câ»Â¹â‚â‚‚=1.0/detC*(Câ‚â‚*Câ‚â‚‚+Câ‚â‚‚*Câ‚‚â‚‚-Iâ‚*Câ‚â‚‚)
        Câ»Â¹â‚‚â‚‚=1.0/detC*(Câ‚â‚‚*Câ‚â‚‚+Câ‚‚â‚‚*Câ‚‚â‚‚-Iâ‚*Câ‚‚â‚‚+Iâ‚‚)

        Jâ»Â²=(1.0/J)^2
        Jâ»Â²Â³=cbrt(Jâ»Â²)

        Câ‚â‚â‚â‚=J^2*K*Câ»Â¹â‚â‚*Câ»Â¹â‚â‚+0.5*K*(J^2-1.0)*2*Câ»Â¹â‚â‚*Câ»Â¹â‚â‚
        Câ‚‚â‚‚â‚‚â‚‚=J^2*K*Câ»Â¹â‚‚â‚‚*Câ»Â¹â‚‚â‚‚+0.5*K*(J^2-1.0)*2*Câ»Â¹â‚‚â‚‚*Câ»Â¹â‚‚â‚‚
        Câ‚â‚â‚‚â‚‚=J^2*K*Câ»Â¹â‚â‚*Câ»Â¹â‚‚â‚‚+0.5*K*(J^2-1.0)*2*Câ»Â¹â‚â‚‚*Câ»Â¹â‚â‚‚
        Câ‚â‚â‚â‚‚=J^2*K*Câ»Â¹â‚â‚*Câ»Â¹â‚â‚‚+0.5*K*(J^2-1.0)*2*Câ»Â¹â‚â‚*Câ»Â¹â‚â‚‚ 
        Câ‚‚â‚‚â‚â‚‚=J^2*K*Câ»Â¹â‚‚â‚‚*Câ»Â¹â‚â‚‚+0.5*K*(J^2-1.0)*2*Câ»Â¹â‚‚â‚‚*Câ»Â¹â‚â‚‚     
        Câ‚â‚‚â‚â‚‚=J^2*K*Câ»Â¹â‚â‚‚*Câ»Â¹â‚â‚‚+0.5*K*(J^2-1.0)*(Câ»Â¹â‚â‚*Câ»Â¹â‚‚â‚‚+Câ»Â¹â‚â‚‚*Câ»Â¹â‚â‚‚)   
              
        Sâ‚â‚ = 0.5*K*(J^2-1.0)*Câ»Â¹â‚â‚
        Sâ‚‚â‚‚ = 0.5*K*(J^2-1.0)*Câ»Â¹â‚‚â‚‚
        Sâ‚â‚‚ = 0.5*K*(J^2-1.0)*Câ»Â¹â‚â‚‚
  
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[2*I-1,2*J-1] +=(Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚â‚*Câ‚â‚â‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚*Câ‚‚â‚‚â‚‚â‚‚ 
                               + (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚â‚)*Câ‚â‚â‚‚â‚‚
                               + (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚â‚ + Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚â‚‚)*Câ‚â‚â‚â‚‚
                               + (Bâ‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚â‚)*Câ‚â‚â‚â‚‚
                               + (Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               + (Bâ‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               + (Bâ‚[i]*Fâ‚â‚‚+Bâ‚‚[i]*Fâ‚â‚)*(Bâ‚[j]*Fâ‚â‚‚+Bâ‚‚[j]*Fâ‚â‚)*Câ‚â‚‚â‚â‚‚
                               +  Bâ‚[i]*Bâ‚[j]*Sâ‚â‚+(Bâ‚[i]*Bâ‚‚[j]+Bâ‚‚[i]*Bâ‚[j])*Sâ‚â‚‚+Bâ‚‚[i]*Bâ‚‚[j]*Sâ‚‚â‚‚)*ð‘¤
                              
                k[2*I-1,2*J]   += (Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚‚â‚*Câ‚â‚â‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚*Câ‚‚â‚‚â‚‚â‚‚
                               +  (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚‚â‚)*Câ‚â‚â‚‚â‚‚
                               +  (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚‚â‚ + Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚‚â‚‚)*Câ‚â‚â‚â‚‚ 
                               +  (Bâ‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚‚â‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚â‚‚+Bâ‚‚[i]*Fâ‚â‚)*(Bâ‚[j]*Fâ‚‚â‚‚+Bâ‚‚[j]*Fâ‚‚â‚)*Câ‚â‚‚â‚â‚‚)*ð‘¤
                               
                k[2*I,2*J-1]   += (Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚â‚*Câ‚â‚â‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚*Câ‚‚â‚‚â‚‚â‚‚ 
                               +  (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚â‚)*Câ‚â‚â‚‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚â‚ + Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚â‚‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚â‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚+Bâ‚‚[i]*Fâ‚‚â‚)*(Bâ‚[j]*Fâ‚â‚‚+Bâ‚‚[j]*Fâ‚â‚)*Câ‚â‚‚â‚â‚‚)*ð‘¤

                k[2*I,2*J]     += (Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚‚â‚*Câ‚â‚â‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚*Câ‚‚â‚‚â‚‚â‚‚ 
                               +  (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚‚â‚)*Câ‚â‚â‚‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚‚â‚ + Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚‚â‚‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚‚â‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚+Bâ‚‚[i]*Fâ‚‚â‚)*(Bâ‚[j]*Fâ‚‚â‚‚+Bâ‚‚[j]*Fâ‚‚â‚)*Câ‚â‚‚â‚â‚‚
                               +   Bâ‚[i]*Bâ‚[j]*Sâ‚â‚+(Bâ‚[i]*Bâ‚‚[j]+Bâ‚‚[i]*Bâ‚[j])*Sâ‚â‚‚+Bâ‚‚[i]*Bâ‚‚[j]*Sâ‚‚â‚‚)*ð‘¤

            end
        end
    end
end
function Î”âˆ«âˆ«Eáµˆáµ¢â±¼Sáµˆáµ¢â±¼dxdy_NeoHookean2(ap::T;k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    E=op.E
    Î½=op.Î½
    K=E/(1-2*Î½)/3
    Î»=E*Î½/(1+Î½)/(1-2*Î½)
    Î¼=E/(1+Î½)/2
    for Î¾ in ð“–
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾.ð‘¤
        Fâ‚â‚ = 1.0
        Fâ‚â‚‚ = 0.0
        Fâ‚‚â‚ = 0.0
        Fâ‚‚â‚‚ = 1.0
        for (i,xáµ¢) in  enumerate(ð“’)  
            Fâ‚â‚ += Bâ‚[i]*xáµ¢.dâ‚
            Fâ‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚
            Fâ‚‚â‚ += Bâ‚[i]*xáµ¢.dâ‚‚
            Fâ‚‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚‚
        end
        Câ‚â‚ = Fâ‚â‚*Fâ‚â‚+Fâ‚‚â‚*Fâ‚‚â‚       
        Câ‚â‚‚ = Fâ‚â‚*Fâ‚â‚‚+Fâ‚‚â‚*Fâ‚‚â‚‚
        Câ‚‚â‚‚ = Fâ‚â‚‚*Fâ‚â‚‚+Fâ‚‚â‚‚*Fâ‚‚â‚‚
        Câ‚ƒâ‚ƒ = 1.0
        J = Fâ‚â‚*Fâ‚‚â‚‚-Fâ‚â‚‚*Fâ‚‚â‚
        detC = (Câ‚â‚*Câ‚‚â‚‚-Câ‚â‚‚*Câ‚â‚‚)
        Iâ‚ = Câ‚â‚+Câ‚‚â‚‚+Câ‚ƒâ‚ƒ
        Iâ‚‚ = 0.5*(Iâ‚^2-Câ‚â‚^2-Câ‚‚â‚‚^2-Câ‚ƒâ‚ƒ^2-2*Câ‚â‚‚^2)
        Câ»Â¹â‚â‚=1.0/detC*(Câ‚â‚*Câ‚â‚+Câ‚â‚‚*Câ‚â‚‚-Iâ‚*Câ‚â‚+Iâ‚‚)
        Câ»Â¹â‚â‚‚=1.0/detC*(Câ‚â‚*Câ‚â‚‚+Câ‚â‚‚*Câ‚‚â‚‚-Iâ‚*Câ‚â‚‚)
        Câ»Â¹â‚‚â‚‚=1.0/detC*(Câ‚â‚‚*Câ‚â‚‚+Câ‚‚â‚‚*Câ‚‚â‚‚-Iâ‚*Câ‚‚â‚‚+Iâ‚‚)

        Jâ»Â²=(1.0/J)^2
        Jâ»Â²Â³=cbrt(Jâ»Â²)
        Câ‚â‚â‚â‚=(-2/3*Câ»Â¹â‚â‚-2/3*Câ»Â¹â‚â‚)*Jâ»Â²Â³*Î¼ + (2/9*Jâ»Â²Â³*Iâ‚*Î¼)*Câ»Â¹â‚â‚*Câ»Â¹â‚â‚ + (1/3*Î¼*Jâ»Â²Â³*Iâ‚)*2*Câ»Â¹â‚â‚*Câ»Â¹â‚â‚
        Câ‚‚â‚‚â‚‚â‚‚=(-2/3*Câ»Â¹â‚‚â‚‚-2/3*Câ»Â¹â‚‚â‚‚)*Jâ»Â²Â³*Î¼ + (2/9*Jâ»Â²Â³*Iâ‚*Î¼)*Câ»Â¹â‚‚â‚‚*Câ»Â¹â‚‚â‚‚ + (1/3*Î¼*Jâ»Â²Â³*Iâ‚)*2*Câ»Â¹â‚‚â‚‚*Câ»Â¹â‚‚â‚‚
        Câ‚â‚â‚‚â‚‚=(-2/3*Câ»Â¹â‚‚â‚‚-2/3*Câ»Â¹â‚â‚)*Jâ»Â²Â³*Î¼ + (2/9*Jâ»Â²Â³*Iâ‚*Î¼)*Câ»Â¹â‚â‚*Câ»Â¹â‚‚â‚‚ + (1/3*Î¼*Jâ»Â²Â³*Iâ‚)*2*Câ»Â¹â‚â‚‚*Câ»Â¹â‚â‚‚
        Câ‚â‚â‚â‚‚=(-2/3*Câ»Â¹â‚â‚‚)*Jâ»Â²Â³*Î¼ + (2/9*Jâ»Â²Â³*Iâ‚*Î¼)*Câ»Â¹â‚â‚*Câ»Â¹â‚â‚‚ + (1/3*Î¼*Jâ»Â²Â³*Iâ‚)*2*Câ»Â¹â‚â‚*Câ»Â¹â‚â‚‚ 
        Câ‚‚â‚‚â‚â‚‚=(-2/3*Câ»Â¹â‚â‚‚)*Jâ»Â²Â³*Î¼ + (2/9*Jâ»Â²Â³*Iâ‚*Î¼)*Câ»Â¹â‚‚â‚‚*Câ»Â¹â‚â‚‚ + (1/3*Î¼*Jâ»Â²Â³*Iâ‚)*2*Câ»Â¹â‚‚â‚‚*Câ»Â¹â‚â‚‚     
        Câ‚â‚‚â‚â‚‚=(2/9*Jâ»Â²Â³*Iâ‚*Î¼)*Câ»Â¹â‚â‚‚*Câ»Â¹â‚â‚‚ + (1/3*Î¼*Jâ»Â²Â³*Iâ‚)*(Câ»Â¹â‚â‚*Câ»Â¹â‚‚â‚‚+Câ»Â¹â‚â‚‚*Câ»Â¹â‚â‚‚)   
              
        Sâ‚â‚ = Î¼*Jâ»Â²Â³*(1.0-1/3*Iâ‚*Câ»Â¹â‚â‚)
        Sâ‚‚â‚‚ = Î¼*Jâ»Â²Â³*(1.0-1/3*Iâ‚*Câ»Â¹â‚‚â‚‚)
        Sâ‚â‚‚ = Î¼*Jâ»Â²Â³*(-1/3*Iâ‚*Câ»Â¹â‚â‚‚)
  
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[2*I-1,2*J-1] +=(Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚â‚*Câ‚â‚â‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚*Câ‚‚â‚‚â‚‚â‚‚ 
                               + (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚â‚)*Câ‚â‚â‚‚â‚‚
                               + (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚â‚ + Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚â‚‚)*Câ‚â‚â‚â‚‚
                               + (Bâ‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚â‚)*Câ‚â‚â‚â‚‚
                               + (Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               + (Bâ‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               + (Bâ‚[i]*Fâ‚â‚‚+Bâ‚‚[i]*Fâ‚â‚)*(Bâ‚[j]*Fâ‚â‚‚+Bâ‚‚[j]*Fâ‚â‚)*Câ‚â‚‚â‚â‚‚
                               +  Bâ‚[i]*Bâ‚[j]*Sâ‚â‚+(Bâ‚[i]*Bâ‚‚[j]+Bâ‚‚[i]*Bâ‚[j])*Sâ‚â‚‚+Bâ‚‚[i]*Bâ‚‚[j]*Sâ‚‚â‚‚)*ð‘¤
                              
                k[2*I-1,2*J]   += (Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚‚â‚*Câ‚â‚â‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚*Câ‚‚â‚‚â‚‚â‚‚
                               +  (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚‚â‚)*Câ‚â‚â‚‚â‚‚
                               +  (Bâ‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚‚â‚ + Bâ‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚‚â‚‚)*Câ‚â‚â‚â‚‚ 
                               +  (Bâ‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚â‚*Bâ‚[j]*Fâ‚‚â‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚â‚‚*Bâ‚[j]*Fâ‚‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚â‚‚+Bâ‚‚[i]*Fâ‚â‚)*(Bâ‚[j]*Fâ‚‚â‚‚+Bâ‚‚[j]*Fâ‚‚â‚)*Câ‚â‚‚â‚â‚‚)*ð‘¤
                               
                k[2*I,2*J-1]   += (Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚â‚*Câ‚â‚â‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚*Câ‚‚â‚‚â‚‚â‚‚ 
                               +  (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚â‚)*Câ‚â‚â‚‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚â‚ + Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚â‚‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚â‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚+Bâ‚‚[i]*Fâ‚‚â‚)*(Bâ‚[j]*Fâ‚â‚‚+Bâ‚‚[j]*Fâ‚â‚)*Câ‚â‚‚â‚â‚‚)*ð‘¤

                k[2*I,2*J]     += (Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚‚â‚*Câ‚â‚â‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚*Câ‚‚â‚‚â‚‚â‚‚ 
                               +  (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚‚â‚)*Câ‚â‚â‚‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚‚â‚ + Bâ‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚‚â‚‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚*Bâ‚[j]*Fâ‚‚â‚)*Câ‚â‚â‚â‚‚
                               +  (Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚ + Bâ‚‚[i]*Fâ‚‚â‚‚*Bâ‚[j]*Fâ‚‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚*Bâ‚‚[j]*Fâ‚‚â‚‚ + Bâ‚‚[i]*Fâ‚‚â‚*Bâ‚‚[j]*Fâ‚‚â‚‚)*Câ‚‚â‚‚â‚â‚‚
                               +  (Bâ‚[i]*Fâ‚‚â‚‚+Bâ‚‚[i]*Fâ‚‚â‚)*(Bâ‚[j]*Fâ‚‚â‚‚+Bâ‚‚[j]*Fâ‚‚â‚)*Câ‚â‚‚â‚â‚‚
                               +   Bâ‚[i]*Bâ‚[j]*Sâ‚â‚+(Bâ‚[i]*Bâ‚‚[j]+Bâ‚‚[i]*Bâ‚[j])*Sâ‚â‚‚+Bâ‚‚[i]*Bâ‚‚[j]*Sâ‚‚â‚‚)*ð‘¤

            end
        end
    end
end
function âˆ«âˆ«Eáµ¢â±¼Sáµ¢â±¼dxdy_NeoHookean2(ap::T;f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    E=op.E
    Î½=op.Î½
    K=E/(1-2*Î½)/3
    Î»=E*Î½/(1+Î½)/(1-2*Î½)
    Î¼=E/(1+Î½)/2
    for Î¾ in ð“–
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾.ð‘¤
        Fâ‚â‚ = 1.0
        Fâ‚â‚‚ = 0.0
        Fâ‚‚â‚ = 0.0
        Fâ‚‚â‚‚ = 1.0
        for (i,xáµ¢) in  enumerate(ð“’)  
            Fâ‚â‚ += Bâ‚[i]*xáµ¢.dâ‚
            Fâ‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚
            Fâ‚‚â‚ += Bâ‚[i]*xáµ¢.dâ‚‚
            Fâ‚‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚‚
        end
        Câ‚â‚ = Fâ‚â‚*Fâ‚â‚+Fâ‚‚â‚*Fâ‚‚â‚       
        Câ‚â‚‚ = Fâ‚â‚*Fâ‚â‚‚+Fâ‚‚â‚*Fâ‚‚â‚‚
        Câ‚‚â‚‚ = Fâ‚â‚‚*Fâ‚â‚‚+Fâ‚‚â‚‚*Fâ‚‚â‚‚
        Câ‚ƒâ‚ƒ = 1.0
        J = Fâ‚â‚*Fâ‚‚â‚‚-Fâ‚â‚‚*Fâ‚‚â‚
        detC = (Câ‚â‚*Câ‚‚â‚‚-Câ‚â‚‚*Câ‚â‚‚)
        Iâ‚ = Câ‚â‚+Câ‚‚â‚‚+Câ‚ƒâ‚ƒ
        Iâ‚‚ = 0.5*(Iâ‚^2-Câ‚â‚^2-Câ‚‚â‚‚^2-Câ‚ƒâ‚ƒ^2-2*Câ‚â‚‚^2)
        Câ»Â¹â‚â‚=1.0/detC*(Câ‚â‚*Câ‚â‚+Câ‚â‚‚*Câ‚â‚‚-Iâ‚*Câ‚â‚+Iâ‚‚)
        Câ»Â¹â‚â‚‚=1.0/detC*(Câ‚â‚*Câ‚â‚‚+Câ‚â‚‚*Câ‚‚â‚‚-Iâ‚*Câ‚â‚‚)
        Câ»Â¹â‚‚â‚‚=1.0/detC*(Câ‚â‚‚*Câ‚â‚‚+Câ‚‚â‚‚*Câ‚‚â‚‚-Iâ‚*Câ‚‚â‚‚+Iâ‚‚)
        
        Jâ»Â²=(1.0/J)^2
        Jâ»Â²Â³=cbrt(Jâ»Â²)
        Sâ‚â‚ = Î¼*Jâ»Â²Â³*(1.0-1/3*Iâ‚*Câ»Â¹â‚â‚) + 0.5*K*(J^2-1.0)*Câ»Â¹â‚â‚
        Sâ‚‚â‚‚ = Î¼*Jâ»Â²Â³*(1.0-1/3*Iâ‚*Câ»Â¹â‚‚â‚‚) + 0.5*K*(J^2-1.0)*Câ»Â¹â‚‚â‚‚
        Sâ‚â‚‚ = Î¼*Jâ»Â²Â³*(-1/3*Iâ‚*Câ»Â¹â‚â‚‚) + 0.5*K*(J^2-1.0)*Câ»Â¹â‚â‚‚
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            f[2*I-1] += (Bâ‚[i]*Fâ‚â‚*Sâ‚â‚+Bâ‚‚[i]*Fâ‚â‚‚*Sâ‚‚â‚‚+(Bâ‚[i]*Fâ‚â‚‚+Bâ‚‚[i]*Fâ‚â‚)*Sâ‚â‚‚)*ð‘¤
            f[2*I]   += (Bâ‚[i]*Fâ‚‚â‚*Sâ‚â‚+Bâ‚‚[i]*Fâ‚‚â‚‚*Sâ‚‚â‚‚+(Bâ‚[i]*Fâ‚‚â‚‚+Bâ‚‚[i]*Fâ‚‚â‚)*Sâ‚â‚‚)*ð‘¤
        end
    end
end
function âˆ«âˆ«Eáµ›áµ¢â±¼Sáµ›áµ¢â±¼dxdy_NeoHookean2(ap::T;f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    E=op.E
    Î½=op.Î½
    K=E/(1-2*Î½)/3
    Î»=E*Î½/(1+Î½)/(1-2*Î½)
    Î¼=E/(1+Î½)/2
    for Î¾ in ð“–
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾.ð‘¤
        Fâ‚â‚ = 1.0
        Fâ‚â‚‚ = 0.0
        Fâ‚‚â‚ = 0.0
        Fâ‚‚â‚‚ = 1.0
        for (i,xáµ¢) in  enumerate(ð“’)  
            Fâ‚â‚ += Bâ‚[i]*xáµ¢.dâ‚
            Fâ‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚
            Fâ‚‚â‚ += Bâ‚[i]*xáµ¢.dâ‚‚
            Fâ‚‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚‚
        end
        Câ‚â‚ = Fâ‚â‚*Fâ‚â‚+Fâ‚‚â‚*Fâ‚‚â‚       
        Câ‚â‚‚ = Fâ‚â‚*Fâ‚â‚‚+Fâ‚‚â‚*Fâ‚‚â‚‚
        Câ‚‚â‚‚ = Fâ‚â‚‚*Fâ‚â‚‚+Fâ‚‚â‚‚*Fâ‚‚â‚‚
        Câ‚ƒâ‚ƒ = 1.0
        J = Fâ‚â‚*Fâ‚‚â‚‚-Fâ‚â‚‚*Fâ‚‚â‚
        detC = (Câ‚â‚*Câ‚‚â‚‚-Câ‚â‚‚*Câ‚â‚‚)
        Iâ‚ = Câ‚â‚+Câ‚‚â‚‚+Câ‚ƒâ‚ƒ
        Iâ‚‚ = 0.5*(Iâ‚^2-Câ‚â‚^2-Câ‚‚â‚‚^2-Câ‚ƒâ‚ƒ^2-2*Câ‚â‚‚^2)
        Câ»Â¹â‚â‚=1.0/detC*(Câ‚â‚*Câ‚â‚+Câ‚â‚‚*Câ‚â‚‚-Iâ‚*Câ‚â‚+Iâ‚‚)
        Câ»Â¹â‚â‚‚=1.0/detC*(Câ‚â‚*Câ‚â‚‚+Câ‚â‚‚*Câ‚‚â‚‚-Iâ‚*Câ‚â‚‚)
        Câ»Â¹â‚‚â‚‚=1.0/detC*(Câ‚â‚‚*Câ‚â‚‚+Câ‚‚â‚‚*Câ‚‚â‚‚-Iâ‚*Câ‚‚â‚‚+Iâ‚‚)

        
        Sâ‚â‚ = 0.5*K*(J^2-1.0)*Câ»Â¹â‚â‚
        Sâ‚‚â‚‚ = 0.5*K*(J^2-1.0)*Câ»Â¹â‚‚â‚‚
        Sâ‚â‚‚ = 0.5*K*(J^2-1.0)*Câ»Â¹â‚â‚‚
  
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            f[2*I-1] += (Bâ‚[i]*Fâ‚â‚*Sâ‚â‚+Bâ‚‚[i]*Fâ‚â‚‚*Sâ‚‚â‚‚+(Bâ‚[i]*Fâ‚â‚‚+Bâ‚‚[i]*Fâ‚â‚)*Sâ‚â‚‚)*ð‘¤
            f[2*I]   += (Bâ‚[i]*Fâ‚‚â‚*Sâ‚â‚+Bâ‚‚[i]*Fâ‚‚â‚‚*Sâ‚‚â‚‚+(Bâ‚[i]*Fâ‚‚â‚‚+Bâ‚‚[i]*Fâ‚‚â‚)*Sâ‚â‚‚)*ð‘¤
        end
    end
end
function âˆ«âˆ«Eáµˆáµ¢â±¼Sáµˆáµ¢â±¼dxdy_NeoHookean2(ap::T;f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    E=op.E
    Î½=op.Î½
    K=E/(1-2*Î½)/3
    Î»=E*Î½/(1+Î½)/(1-2*Î½)
    Î¼=E/(1+Î½)/2
    for Î¾ in ð“–
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾.ð‘¤
        Fâ‚â‚ = 1.0
        Fâ‚â‚‚ = 0.0
        Fâ‚‚â‚ = 0.0
        Fâ‚‚â‚‚ = 1.0
        for (i,xáµ¢) in  enumerate(ð“’)  
            Fâ‚â‚ += Bâ‚[i]*xáµ¢.dâ‚
            Fâ‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚
            Fâ‚‚â‚ += Bâ‚[i]*xáµ¢.dâ‚‚
            Fâ‚‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚‚
        end
        Câ‚â‚ = Fâ‚â‚*Fâ‚â‚+Fâ‚‚â‚*Fâ‚‚â‚       
        Câ‚â‚‚ = Fâ‚â‚*Fâ‚â‚‚+Fâ‚‚â‚*Fâ‚‚â‚‚
        Câ‚‚â‚‚ = Fâ‚â‚‚*Fâ‚â‚‚+Fâ‚‚â‚‚*Fâ‚‚â‚‚
        Câ‚ƒâ‚ƒ = 1.0
        J = Fâ‚â‚*Fâ‚‚â‚‚-Fâ‚â‚‚*Fâ‚‚â‚
        detC = (Câ‚â‚*Câ‚‚â‚‚-Câ‚â‚‚*Câ‚â‚‚)
        Iâ‚ = Câ‚â‚+Câ‚‚â‚‚+Câ‚ƒâ‚ƒ
        Iâ‚‚ = 0.5*(Iâ‚^2-Câ‚â‚^2-Câ‚‚â‚‚^2-Câ‚ƒâ‚ƒ^2-2*Câ‚â‚‚^2)
        Câ»Â¹â‚â‚=1.0/detC*(Câ‚â‚*Câ‚â‚+Câ‚â‚‚*Câ‚â‚‚-Iâ‚*Câ‚â‚+Iâ‚‚)
        Câ»Â¹â‚â‚‚=1.0/detC*(Câ‚â‚*Câ‚â‚‚+Câ‚â‚‚*Câ‚‚â‚‚-Iâ‚*Câ‚â‚‚)
        Câ»Â¹â‚‚â‚‚=1.0/detC*(Câ‚â‚‚*Câ‚â‚‚+Câ‚‚â‚‚*Câ‚‚â‚‚-Iâ‚*Câ‚‚â‚‚+Iâ‚‚)

        Jâ»Â²=(1.0/J)^2
        Jâ»Â²Â³=cbrt(Jâ»Â²)
        Sâ‚â‚ = Î¼*Jâ»Â²Â³*(1.0-1/3*Iâ‚*Câ»Â¹â‚â‚)
        Sâ‚‚â‚‚ = Î¼*Jâ»Â²Â³*(1.0-1/3*Iâ‚*Câ»Â¹â‚‚â‚‚)
        Sâ‚â‚‚ = Î¼*Jâ»Â²Â³*(-1/3*Iâ‚*Câ»Â¹â‚â‚‚)
  
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            f[2*I-1] += (Bâ‚[i]*Fâ‚â‚*Sâ‚â‚+Bâ‚‚[i]*Fâ‚â‚‚*Sâ‚‚â‚‚+(Bâ‚[i]*Fâ‚â‚‚+Bâ‚‚[i]*Fâ‚â‚)*Sâ‚â‚‚)*ð‘¤
            f[2*I]   += (Bâ‚[i]*Fâ‚‚â‚*Sâ‚â‚+Bâ‚‚[i]*Fâ‚‚â‚‚*Sâ‚‚â‚‚+(Bâ‚[i]*Fâ‚‚â‚‚+Bâ‚‚[i]*Fâ‚‚â‚)*Sâ‚â‚‚)*ð‘¤
        end
    end
end

end