module Elasticity
    
using ..ApproxOperator: AbstractElement
function âˆ«Îµáµ¢â±¼Ïƒáµ¢â±¼dÎ©(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        Bâ‚ƒ = Î¾[:âˆ‚ð­âˆ‚z]
        ð‘¤ = Î¾.ð‘¤
        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµ¢áµ¢áµ¢áµ¢ = E*(1-Î½)/(1+Î½)/(1-2Î½)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1+Î½)/(1-2Î½)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[3*I-2,3*J-2] += (Cáµ¢áµ¢áµ¢áµ¢*Bâ‚[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚ƒ[i]*Bâ‚ƒ[j])*ð‘¤
                k[3*I-2,3*J-1] += (Cáµ¢áµ¢â±¼â±¼*Bâ‚[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚[j])*ð‘¤
                k[3*I-2,3*J]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚[i]*Bâ‚ƒ[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚ƒ[i]*Bâ‚[j])*ð‘¤
                k[3*I-1,3*J-2] += (Cáµ¢áµ¢â±¼â±¼*Bâ‚‚[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚‚[j])*ð‘¤
                k[3*I-1,3*J-1] += (Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚[j] + Cáµ¢áµ¢áµ¢áµ¢*Bâ‚‚[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚ƒ[i]*Bâ‚ƒ[j])*ð‘¤
                k[3*I-1,3*J]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚‚[i]*Bâ‚ƒ[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚ƒ[i]*Bâ‚‚[j])*ð‘¤
                k[3*I,3*J-2]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚ƒ[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚ƒ[j])*ð‘¤
                k[3*I,3*J-1]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚ƒ[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚ƒ[j])*ð‘¤
                k[3*I,3*J]     += (Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚‚[j] + Cáµ¢áµ¢áµ¢áµ¢*Bâ‚ƒ[i]*Bâ‚ƒ[j])*ð‘¤
            end
        end
    end
end
function âˆ«âˆ«Ïváµ¢uáµ¢dxdy(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’;ð“– = ap.ð“–
    for Î¾ in ð“–
        N = Î¾[:ð­]
        ð‘¤ = Î¾.ð‘¤
        Ï = Î¾.Ï
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[2*I-1,2*J-1] += Ï*N[i]*N[j]*ð‘¤
                k[2*I,2*J]     += Ï*N[i]*N[j]*ð‘¤
            end
        end
    end
end

function âˆ«âˆ«Îµáµ¢â±¼Ïƒáµ¢â±¼dxdy(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾.ð‘¤
        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµ¢áµ¢áµ¢áµ¢ = E/(1-Î½^2)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-Î½^2)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[2*I-1,2*J-1] += (Cáµ¢áµ¢áµ¢áµ¢*Bâ‚[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚‚[j])*ð‘¤
                k[2*I-1,2*J]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚[j])*ð‘¤
                k[2*I,2*J-1]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚‚[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚‚[j])*ð‘¤
                k[2*I,2*J]     += (Cáµ¢áµ¢áµ¢áµ¢*Bâ‚‚[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚[j])*ð‘¤
            end
        end
    end
end

function âˆ«âˆ«Îµáµ¢â±¼Ïƒáµ¢â±¼dxdy_PlaneStrian(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾.ð‘¤
        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµ¢áµ¢áµ¢áµ¢ = E*(1-Î½)/(1-2*Î½)/(1+Î½)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-2*Î½)/(1+Î½)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[2*I-1,2*J-1] += (Cáµ¢áµ¢áµ¢áµ¢*Bâ‚[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚‚[j])*ð‘¤
                k[2*I-1,2*J]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚[j])*ð‘¤
                k[2*I,2*J-1]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚‚[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚‚[j])*ð‘¤
                k[2*I,2*J]     += (Cáµ¢áµ¢áµ¢áµ¢*Bâ‚‚[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚[j])*ð‘¤
            end
        end
    end
end

function âˆ«âˆ«Îµáµ¢â±¼Ïƒáµ¢â±¼dxdy(aáµ¤::T,aâ‚›::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    for (Î¾áµ¤,Î¾â‚›) in zip(ð“–áµ¤,ð“–â‚›)
        Báµ¤â‚ = Î¾áµ¤[:âˆ‚ð­âˆ‚x]
        Báµ¤â‚‚ = Î¾áµ¤[:âˆ‚ð­âˆ‚y]
        Bâ‚›â‚ = Î¾â‚›[:âˆ‚ð­âˆ‚x]
        Bâ‚›â‚‚ = Î¾â‚›[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾áµ¤.ð‘¤
        E = Î¾áµ¤.E
        Î½ = Î¾áµ¤.Î½
        Cáµ¢áµ¢áµ¢áµ¢ = E/(1-Î½^2)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-Î½^2)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[2*I-1,2*J-1] += ( Cáµ¢áµ¢áµ¢áµ¢*Bâ‚›â‚[i]*Báµ¤â‚[j]+Cáµ¢â±¼áµ¢â±¼*Bâ‚›â‚‚[i]*Báµ¤â‚‚[j])*ð‘¤
                k[2*I-1,2*J]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚›â‚[i]*Báµ¤â‚‚[j]+Cáµ¢â±¼áµ¢â±¼*Bâ‚›â‚‚[i]*Báµ¤â‚[j])*ð‘¤
                k[2*I,2*J-1]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚›â‚‚[i]*Báµ¤â‚[j]+Cáµ¢â±¼áµ¢â±¼*Bâ‚›â‚[i]*Báµ¤â‚‚[j])*ð‘¤
                k[2*I,2*J]     += (Cáµ¢áµ¢áµ¢áµ¢*Bâ‚›â‚‚[i]*Báµ¤â‚‚[j]+Cáµ¢â±¼áµ¢â±¼*Bâ‚›â‚[i]*Báµ¤â‚[j])*ð‘¤
            end
        end
    end
end

function âˆ«âˆ«Îµáµ¢â±¼Ïƒáµ¢â±¼dxdy_PlaneStrian(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    for (Î¾áµ¤,Î¾â‚›) in zip(ð“–áµ¤,ð“–â‚›)
        Báµ¤â‚ = Î¾áµ¤[:âˆ‚ð­âˆ‚x]
        Báµ¤â‚‚ = Î¾áµ¤[:âˆ‚ð­âˆ‚y]
        Bâ‚›â‚ = Î¾â‚›[:âˆ‚ð­âˆ‚x]
        Bâ‚›â‚‚ = Î¾â‚›[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾áµ¤.ð‘¤
        E = Î¾â‚›.E
        Î½ = Î¾â‚›.Î½
        Cáµ¢áµ¢áµ¢áµ¢ = E*(1-Î½)/(1-2*Î½)/(1+Î½)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-2*Î½)/(1+Î½)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[2*I-1,2*J-1] += ( Cáµ¢áµ¢áµ¢áµ¢*Bâ‚›â‚[i]*Báµ¤â‚[j]+Cáµ¢â±¼áµ¢â±¼*Bâ‚›â‚‚[i]*Báµ¤â‚‚[j])*ð‘¤
                k[2*I-1,2*J]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚›â‚[i]*Báµ¤â‚‚[j]+Cáµ¢â±¼áµ¢â±¼*Bâ‚›â‚‚[i]*Báµ¤â‚[j])*ð‘¤
                k[2*I,2*J-1]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚›â‚‚[i]*Báµ¤â‚[j]+Cáµ¢â±¼áµ¢â±¼*Bâ‚›â‚[i]*Báµ¤â‚‚[j])*ð‘¤
                k[2*I,2*J]     += (Cáµ¢áµ¢áµ¢áµ¢*Bâ‚›â‚‚[i]*Báµ¤â‚‚[j]+Cáµ¢â±¼áµ¢â±¼*Bâ‚›â‚[i]*Báµ¤â‚[j])*ð‘¤
            end
        end
    end
end
function âˆ«âˆ«Îµáµ›áµ¢â±¼Ïƒáµ›áµ¢â±¼dxdy(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾.ð‘¤
        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµ› = E/(1-2*Î½)
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[2*I-1,2*J-1] += Cáµ›/3*Bâ‚[i]*Bâ‚[j]*ð‘¤
                k[2*I-1,2*J]   += Cáµ›/3*Bâ‚[i]*Bâ‚‚[j]*ð‘¤
                k[2*I,2*J-1]   += Cáµ›/3*Bâ‚‚[i]*Bâ‚[j]*ð‘¤
                k[2*I,2*J]     += Cáµ›/3*Bâ‚‚[i]*Bâ‚‚[j]*ð‘¤
            end
        end
    end
end

function âˆ«âˆ«Îµáµˆáµ¢â±¼Ïƒáµˆáµ¢â±¼dxdy(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾.ð‘¤
        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµˆ = E/(1+Î½)
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[2*I-1,2*J-1] += Cáµˆ*( 2/3*Bâ‚[i]*Bâ‚[j]+1/2*Bâ‚‚[i]*Bâ‚‚[j])*ð‘¤
                k[2*I-1,2*J]   += Cáµˆ*(-1/3*Bâ‚[i]*Bâ‚‚[j]+1/2*Bâ‚‚[i]*Bâ‚[j])*ð‘¤
                k[2*I,2*J-1]   += Cáµˆ*(-1/3*Bâ‚‚[i]*Bâ‚[j]+1/2*Bâ‚[i]*Bâ‚‚[j])*ð‘¤
                k[2*I,2*J]     += Cáµˆ*( 2/3*Bâ‚‚[i]*Bâ‚‚[j]+1/2*Bâ‚[i]*Bâ‚[j])*ð‘¤
            end
        end
    end
end
function âˆ«Îµáµˆáµ¢â±¼Ïƒáµˆáµ¢â±¼dÎ©(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        Bâ‚ƒ = Î¾[:âˆ‚ð­âˆ‚z]
        ð‘¤ = Î¾.ð‘¤
        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµˆ = E/(1+Î½)
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[3*I-2,3*J-2] += Cáµˆ*( 2/3*Bâ‚[i]*Bâ‚[j]+1/2*Bâ‚‚[i]*Bâ‚‚[j]+1/2*Bâ‚ƒ[i]*Bâ‚ƒ[j])*ð‘¤
                k[3*I-2,3*J-1] += Cáµˆ*(-1/3*Bâ‚[i]*Bâ‚‚[j]+1/2*Bâ‚‚[i]*Bâ‚[j])*ð‘¤
                k[3*I-2,3*J]   += Cáµˆ*(-1/3*Bâ‚[i]*Bâ‚ƒ[j]+1/2*Bâ‚ƒ[i]*Bâ‚[j])*ð‘¤
                k[3*I-1,3*J-2] += Cáµˆ*(-1/3*Bâ‚‚[i]*Bâ‚[j]+1/2*Bâ‚[i]*Bâ‚‚[j])*ð‘¤
                k[3*I-1,3*J-1] += Cáµˆ*( 2/3*Bâ‚‚[i]*Bâ‚‚[j]+1/2*Bâ‚ƒ[i]*Bâ‚ƒ[j]+1/2*Bâ‚[i]*Bâ‚[j])*ð‘¤
                k[3*I-1,3*J]   += Cáµˆ*(-1/3*Bâ‚‚[i]*Bâ‚ƒ[j]+1/2*Bâ‚ƒ[i]*Bâ‚‚[j])*ð‘¤
                k[3*I,3*J-2]   += Cáµˆ*(-1/3*Bâ‚ƒ[i]*Bâ‚[j]+1/2*Bâ‚[i]*Bâ‚ƒ[j])*ð‘¤
                k[3*I,3*J-1]   += Cáµˆ*(-1/3*Bâ‚ƒ[i]*Bâ‚‚[j]+1/2*Bâ‚‚[i]*Bâ‚ƒ[j])*ð‘¤
                k[3*I,3*J]     += Cáµˆ*( 2/3*Bâ‚ƒ[i]*Bâ‚ƒ[j]+1/2*Bâ‚[i]*Bâ‚[j]+1/2*Bâ‚‚[i]*Bâ‚‚[j])*ð‘¤
            end
        end
    end
end



function âˆ«âˆ«Îµáµˆáµ¢â±¼Ïƒáµˆáµ¢â±¼dxdy_PPP(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾.ð‘¤
        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµˆ = E/(1+Î½)
        Cáµ¢áµ¢áµ¢áµ¢ = E*(1-Î½)/(1-2*Î½)/(1+Î½)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-2*Î½)/(1+Î½)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)

        C1 = E*(1-Î½)/(1-2*Î½)/(1+Î½)
        C2 = E*Î½/(1-2*Î½)/(1+Î½)
        C3 = E/2/(1+Î½)
        # Cáµ¢áµ¢áµ¢áµ¢ = C1^2 + C2^2 
        # Cáµ¢áµ¢â±¼â±¼ = 2*C1*C2
        # Cáµ¢â±¼áµ¢â±¼ = C3^2
        ðº = E/(1+Î½)/2
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                # k[2*I-1,2*J-1] -= Cáµˆ*( 2/3*Bâ‚[i]*Bâ‚[j]+1/2*Bâ‚‚[i]*Bâ‚‚[j])*ð‘¤
                # k[2*I-1,2*J]   -= Cáµˆ*(-1/3*Bâ‚[i]*Bâ‚‚[j]+1/2*Bâ‚‚[i]*Bâ‚[j])*ð‘¤
                # k[2*I,2*J-1]   -= Cáµˆ*(-1/3*Bâ‚‚[i]*Bâ‚[j]+1/2*Bâ‚[i]*Bâ‚‚[j])*ð‘¤
                # k[2*I,2*J]     -= Cáµˆ*( 2/3*Bâ‚‚[i]*Bâ‚‚[j]+1/2*Bâ‚[i]*Bâ‚[j])*ð‘¤

                k[2*I-1,2*J-1] += (Cáµ¢áµ¢áµ¢áµ¢*Bâ‚[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚‚[j])*ð‘¤
                k[2*I-1,2*J]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚[j])*ð‘¤
                k[2*I,2*J-1]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚‚[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚‚[j])*ð‘¤
                k[2*I,2*J]     += (Cáµ¢áµ¢áµ¢áµ¢*Bâ‚‚[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚[j])*ð‘¤

                # k[2*I-1,2*J-1] -= 1/ðº/2*(Cáµ¢áµ¢áµ¢áµ¢*Bâ‚[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚‚[j])*ð‘¤
                # k[2*I-1,2*J]   -= 1/ðº/2*(Cáµ¢áµ¢â±¼â±¼*Bâ‚[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚[j])*ð‘¤
                # k[2*I,2*J-1]   -= 1/ðº/2*(Cáµ¢áµ¢â±¼â±¼*Bâ‚‚[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚‚[j])*ð‘¤
                # k[2*I,2*J]     -= 1/ðº/2*(Cáµ¢áµ¢áµ¢áµ¢*Bâ‚‚[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚[j])*ð‘¤
            
            end
        end
    end
end
function âˆ«âˆ«Ïƒáµ¢â±¼Ïƒâ‚–â‚—dxdy_PPP(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’;ð“– = ap.ð“–
    for Î¾ in ð“–
        N = Î¾[:ð­]
        ð‘¤ = Î¾.ð‘¤
        E = Î¾.E
        Î½ = Î¾.Î½
        Câ»Â¹áµ¢áµ¢áµ¢áµ¢ = (1-Î½^2)/E
        Câ»Â¹áµ¢áµ¢â±¼â±¼ = -(Î½+Î½^2)/E
        Câ»Â¹áµ¢â±¼áµ¢â±¼ = 2*(1+Î½)/E
        ðº = E/(1+Î½)/2
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[3*I-2,3*J-2] += N[i]*Câ»Â¹áµ¢áµ¢áµ¢áµ¢*N[j]*ð‘¤
                k[3*I-2,3*J-1] += N[i]*Câ»Â¹áµ¢áµ¢â±¼â±¼*N[j]*ð‘¤
                k[3*I-1,3*J-2] += N[i]*Câ»Â¹áµ¢áµ¢â±¼â±¼*N[j]*ð‘¤
                k[3*I-1,3*J-1] += N[i]*Câ»Â¹áµ¢áµ¢áµ¢áµ¢*N[j]*ð‘¤
                k[3*I,3*J]     += N[i]*Câ»Â¹áµ¢â±¼áµ¢â±¼*N[j]*ð‘¤

                # k[3*I-2,3*J-2] += 1/ðº/2*N[i]*N[j]*ð‘¤
                # k[3*I-2,3*J-1] += 1/ðº/2*N[i]*N[j]*ð‘¤
                # k[3*I-1,3*J-2] += 1/ðº/2*N[i]*N[j]*ð‘¤
                # k[3*I-1,3*J-1] += 1/ðº/2*N[i]*N[j]*ð‘¤
                # k[3*I,3*J]     += 1/ðº/2*N[i]*N[j]*ð‘¤



            end
        end
    end
end
function âˆ«âˆ«Cáµ¢â±¼â‚–â‚—Îµáµ¢â±¼Ïƒáµ¢â±¼dxdy_PPP(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    for (Î¾â‚›,Î¾áµ¤) in zip(ð“–â‚›,ð“–áµ¤)
        Bâ‚ = Î¾áµ¤[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾áµ¤[:âˆ‚ð­âˆ‚y]
        N = Î¾â‚›[:ð­]
        # ð‘¤ = Î¾áµ¤.ð‘¤
        ð‘¤ = Î¾â‚›.ð‘¤
        E = Î¾â‚›.E
        Î½ = Î¾â‚›.Î½
        Cáµˆ = E/(1+Î½)
        Cáµ¢áµ¢áµ¢áµ¢ = E*(1-Î½)/(1-2*Î½)/(1+Î½)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-2*Î½)/(1+Î½)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
       
        ðº = E/(1+Î½)/2
        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
               
                # k[3*I-2,2*J-1] += Cáµ¢áµ¢áµ¢áµ¢*Bâ‚[i]*N[j]*ð‘¤
                # k[3*I-2,2*J]   += Cáµ¢áµ¢â±¼â±¼*Bâ‚‚[i]*N[j]*ð‘¤
                # k[3*I-1,2*J-1] += Cáµ¢áµ¢â±¼â±¼*Bâ‚[i]*N[j]*ð‘¤
                # k[3*I-1,2*J]   += Cáµ¢áµ¢áµ¢áµ¢*Bâ‚‚[i]*N[j]*ð‘¤
                # k[3*I,2*J-1]   += Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*N[j]*ð‘¤
                # k[3*I,2*J]     += Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*N[j]*ð‘¤

                # k[3*I-2,2*J-1] += 2*Bâ‚[j]*N[i]*ð‘¤
                # k[3*I-2,2*J]   += 2*Bâ‚‚[j]*N[i]*ð‘¤
                # k[3*I-1,2*J-1] += 2*Bâ‚[j]*N[i]*ð‘¤
                # k[3*I-1,2*J]   += 2*Bâ‚‚[j]*N[i]*ð‘¤
                # k[3*I,2*J-1]   += 2*Bâ‚‚[j]*N[i]*ð‘¤
                # k[3*I,2*J]     += 2*Bâ‚[j]*N[i]*ð‘¤

                k[3*I-2,2*J-1] -= 2*Bâ‚[j]*N[i]*ð‘¤
                k[3*I-2,2*J]   -= 2*Bâ‚‚[j]*N[i]*ð‘¤
                k[3*I-1,2*J-1] -= 2*Bâ‚[j]*N[i]*ð‘¤
                k[3*I-1,2*J]   -= 2*Bâ‚‚[j]*N[i]*ð‘¤
                k[3*I,2*J-1]   -= 2*Bâ‚‚[j]*N[i]*ð‘¤
                k[3*I,2*J]     -= 2*Bâ‚[j]*N[i]*ð‘¤
                # k[2*I-1,2*J-1] -= (Cáµ¢áµ¢áµ¢áµ¢*Bâ‚[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚‚[j])*ð‘¤
                # k[2*I-1,2*J]   -= (Cáµ¢áµ¢â±¼â±¼*Bâ‚[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚[j])*ð‘¤
                # k[2*I,2*J-1]   -= (Cáµ¢áµ¢â±¼â±¼*Bâ‚‚[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚‚[j])*ð‘¤
                # k[2*I,2*J]     -= (Cáµ¢áµ¢áµ¢áµ¢*Bâ‚‚[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚[j])*ð‘¤

               
            end
        end
    end
end
function âˆ«âˆ«Îµáµˆáµ¢â±¼Ïƒáµˆáµ¢â±¼dxdy(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    for (Î¾áµ¤,Î¾â‚›) in zip(ð“–áµ¤,ð“–â‚›)
        Báµ¤â‚ = Î¾áµ¤[:âˆ‚ð­âˆ‚x]
        Báµ¤â‚‚ = Î¾áµ¤[:âˆ‚ð­âˆ‚y]
        Bâ‚›â‚ = Î¾â‚›[:âˆ‚ð­âˆ‚x]
        Bâ‚›â‚‚ = Î¾â‚›[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾áµ¤.ð‘¤
        E = Î¾â‚›.E
        Î½ = Î¾â‚›.Î½
        Cáµˆ = E/(1+Î½)
        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[2*I-1,2*J-1] += Cáµˆ*( 2/3*Bâ‚›â‚[i]*Báµ¤â‚[j]+1/2*Bâ‚›â‚‚[i]*Báµ¤â‚‚[j])*ð‘¤
                k[2*I-1,2*J]   += Cáµˆ*(-1/3*Bâ‚›â‚[i]*Báµ¤â‚‚[j]+1/2*Bâ‚›â‚‚[i]*Báµ¤â‚[j])*ð‘¤
                k[2*I,2*J-1]   += Cáµˆ*(-1/3*Bâ‚›â‚‚[i]*Báµ¤â‚[j]+1/2*Bâ‚›â‚[i]*Báµ¤â‚‚[j])*ð‘¤
                k[2*I,2*J]     += Cáµˆ*( 2/3*Bâ‚›â‚‚[i]*Báµ¤â‚‚[j]+1/2*Bâ‚›â‚[i]*Báµ¤â‚[j])*ð‘¤
            end
        end
    end
end

function âˆ«âˆ«Ïƒáµ¢â±¼Ïƒâ‚–â‚—dxdy(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’;ð“– = ap.ð“–
    for Î¾ in ð“–
        N = Î¾[:ð­]
        ð‘¤ = Î¾.ð‘¤
        E = Î¾.E
        Î½ = Î¾.Î½
        Câ»Â¹áµ¢áµ¢áµ¢áµ¢ = 1/E
        Câ»Â¹áµ¢áµ¢â±¼â±¼ = -Î½/E
        Câ»Â¹áµ¢â±¼áµ¢â±¼ = 2*(1+Î½)/E
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[3*I-2,3*J-2] += N[i]*Câ»Â¹áµ¢áµ¢áµ¢áµ¢*N[j]*ð‘¤
                k[3*I-2,3*J-1] += N[i]*Câ»Â¹áµ¢áµ¢â±¼â±¼*N[j]*ð‘¤
                k[3*I-1,3*J-2] += N[i]*Câ»Â¹áµ¢áµ¢â±¼â±¼*N[j]*ð‘¤
                k[3*I-1,3*J-1] += N[i]*Câ»Â¹áµ¢áµ¢áµ¢áµ¢*N[j]*ð‘¤
                k[3*I,3*J]     += N[i]*Câ»Â¹áµ¢â±¼áµ¢â±¼*N[j]*ð‘¤
            end
        end
    end
end

function âˆ«âˆ«uáµ¢â±¼uâ‚–â‚—dxdy(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’;ð“– = ap.ð“–
    for Î¾ in ð“–
        N = Î¾[:ð­]
        ð‘¤ = Î¾.ð‘¤
   
       
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[2*I-1,2*J-1] += N[i]*N[j]*ð‘¤
                # k[2*I-1,2*J] += N[i]*N[j]*ð‘¤
                # k[2*I,2*J-1] += N[i]*N[j]*ð‘¤
                k[2*I,2*J] += N[i]*N[j]*ð‘¤
              
            end
        end
    end
end

function âˆ«âˆ«Ïƒáµ¢â±¼Ïƒâ‚–â‚—dÎ©(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’;ð“– = ap.ð“–
    for Î¾ in ð“–
        N = Î¾[:ð­]
        ð‘¤ = Î¾.ð‘¤
        E = Î¾.E
        Î½ = Î¾.Î½
        Câ»Â¹áµ¢áµ¢áµ¢áµ¢ = 1/E
        Câ»Â¹áµ¢áµ¢â±¼â±¼ = -Î½/E
        # Câ»Â¹áµ¢â±¼áµ¢â±¼ = 2*(1+Î½)/E
        Câ»Â¹áµ¢â±¼áµ¢â±¼ = (1+Î½)/E
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                

                k[6*I-5,6*J-5] += N[i]*Câ»Â¹áµ¢áµ¢áµ¢áµ¢*N[j]*ð‘¤
                k[6*I-5,6*J-4] += N[i]*Câ»Â¹áµ¢áµ¢â±¼â±¼*N[j]*ð‘¤
                k[6*I-5,6*J-3] += N[i]*Câ»Â¹áµ¢áµ¢â±¼â±¼*N[j]*ð‘¤

                k[6*I-4,6*J-5] += N[i]*Câ»Â¹áµ¢áµ¢â±¼â±¼*N[j]*ð‘¤
                k[6*I-4,6*J-4] += N[i]*Câ»Â¹áµ¢áµ¢áµ¢áµ¢*N[j]*ð‘¤
                k[6*I-4,6*J-3] += N[i]*Câ»Â¹áµ¢áµ¢â±¼â±¼*N[j]*ð‘¤

                k[6*I-3,6*J-5] += N[i]*Câ»Â¹áµ¢áµ¢â±¼â±¼*N[j]*ð‘¤
                k[6*I-3,6*J-4] += N[i]*Câ»Â¹áµ¢áµ¢â±¼â±¼*N[j]*ð‘¤
                k[6*I-3,6*J-3] += N[i]*Câ»Â¹áµ¢áµ¢áµ¢áµ¢*N[j]*ð‘¤

                k[6*I-2,6*J-2] += N[i]*Câ»Â¹áµ¢â±¼áµ¢â±¼*N[j]*ð‘¤
                k[6*I-1,6*J-1] += N[i]*Câ»Â¹áµ¢â±¼áµ¢â±¼*N[j]*ð‘¤
                k[6*I,6*J]     += N[i]*Câ»Â¹áµ¢â±¼áµ¢â±¼*N[j]*ð‘¤
            end
        end
    end
end

function âˆ«âˆ«Ïƒáµ¢â±¼Ïƒâ‚–â‚—dxdy(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’;ð“– = ap.ð“–
    for Î¾ in ð“–
        N = Î¾[:ð­]
        ð‘¤ = Î¾.ð‘¤
        E = Î¾.E
        Î½ = Î¾.Î½
        Câ»Â¹áµ¢áµ¢áµ¢áµ¢ = 1/E
        Câ»Â¹áµ¢áµ¢â±¼â±¼ = -Î½/E
        Câ»Â¹áµ¢â±¼áµ¢â±¼ = 2*(1+Î½)/E
        # Câ»Â¹áµ¢â±¼áµ¢â±¼ = (1+Î½)/E
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[3*I-2,3*J-2] += N[i]*Câ»Â¹áµ¢áµ¢áµ¢áµ¢*N[j]*ð‘¤
                k[3*I-2,3*J-1] += N[i]*Câ»Â¹áµ¢áµ¢â±¼â±¼*N[j]*ð‘¤
                k[3*I-1,3*J-2] += N[i]*Câ»Â¹áµ¢áµ¢â±¼â±¼*N[j]*ð‘¤
                k[3*I-1,3*J-1] += N[i]*Câ»Â¹áµ¢áµ¢áµ¢áµ¢*N[j]*ð‘¤
                k[3*I,3*J]     += N[i]*Câ»Â¹áµ¢â±¼áµ¢â±¼*N[j]*ð‘¤
            end
        end
    end
end
function âˆ«âˆ«Îµáµ¢â±¼Cáµ¢â±¼â‚–â‚—Eâ‚–â‚—dxdy(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    for (Î¾â‚›,Î¾áµ¤) in zip(ð“–â‚›,ð“–áµ¤)
        N = Î¾â‚›[:ð­]
        Bâ‚ = Î¾áµ¤[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾áµ¤[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾â‚›.ð‘¤
        E = Î¾â‚›.E
        Î½ = Î¾â‚›.Î½
        Cáµ¢áµ¢áµ¢áµ¢ = E/(1-Î½^2)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-Î½^2)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                
                k[3*I-2,2*J-1] -= N[i]*Cáµ¢áµ¢áµ¢áµ¢*Bâ‚[j]*ð‘¤
                k[3*I-2,2*J]   -= N[i]*Cáµ¢áµ¢â±¼â±¼*Bâ‚‚[j]*ð‘¤
                k[3*I-1,2*J-1] -= N[i]*Cáµ¢áµ¢â±¼â±¼*Bâ‚[j]*ð‘¤
                k[3*I-1,2*J]   -= N[i]*Cáµ¢áµ¢áµ¢áµ¢*Bâ‚‚[j]*ð‘¤
                k[3*I,2*J-1]   -= N[i]*Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[j]*ð‘¤
                k[3*I,2*J]     -= N[i]*Cáµ¢â±¼áµ¢â±¼*Bâ‚[j]*ð‘¤
            end
        end
    end
end

function âˆ«âˆ«Îµáµ¢â±¼Cáµ¢â±¼â‚–â‚—Îµâ‚–â‚—dxdy(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’;ð“– = ap.ð“–
    for Î¾ in ð“–
        N = Î¾[:ð­]
        ð‘¤ = Î¾.ð‘¤
        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµ¢áµ¢áµ¢áµ¢ = E/(1-Î½^2)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-Î½^2)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[3*I-2,3*J-2] += N[i]*Cáµ¢áµ¢áµ¢áµ¢*N[j]*ð‘¤
                k[3*I-2,3*J-1] += N[i]*Cáµ¢áµ¢â±¼â±¼*N[j]*ð‘¤
                k[3*I-1,3*J-2] += N[i]*Cáµ¢áµ¢â±¼â±¼*N[j]*ð‘¤
                k[3*I-1,3*J-1] += N[i]*Cáµ¢áµ¢áµ¢áµ¢*N[j]*ð‘¤
                k[3*I,3*J]     += N[i]*Cáµ¢â±¼áµ¢â±¼*N[j]*ð‘¤
            end
        end
    end
end

function âˆ«âˆ«Îµáµˆáµ¢â±¼Cáµ¢â±¼â‚–â‚—Îµáµˆâ‚–â‚—dxdy(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’;ð“– = ap.ð“–
    for Î¾ in ð“–
        N = Î¾[:ð­]
        ð‘¤ = Î¾.ð‘¤
        EÌ„ = Î¾.EÌ„
        Î½Ì„  = Î¾.Î½Ì„ 
       
        Cáµˆ = EÌ„/(1+Î½Ì„ )
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[3*I-2,3*J-2] += 2/3*N[i]*Cáµˆ*N[j]*ð‘¤
                k[3*I-2,3*J-1] += -1/3*N[i]*Cáµˆ*N[j]*ð‘¤
                
                k[3*I-1,3*J-2] += -1/3*N[i]*Cáµˆ*N[j]*ð‘¤
                k[3*I-1,3*J-1] += 2/3*N[i]*Cáµˆ*N[j]*ð‘¤
                k[3*I,3*J]     += 1/2*N[i]*Cáµˆ*N[j]*ð‘¤

            end
        end
    end
end

function âˆ«âˆ«Ïƒáµˆáµ¢â±¼Ïƒáµˆâ‚–â‚—dxdy(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’;ð“– = ap.ð“–
    for Î¾ in ð“–
        N = Î¾[:ð­]
        ð‘¤ = Î¾.ð‘¤
        EÌ„ = Î¾.EÌ„
        Î½Ì„  = Î¾.Î½Ì„ 
        Cáµˆ = EÌ„/(1+Î½Ì„ )
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[3*I-2,3*J-2] += 2/Cáµˆ*N[i]*N[j]*ð‘¤
                k[3*I-2,3*J-1] += 1/Cáµˆ*N[i]*Cáµˆ*N[j]*ð‘¤
                
                k[3*I-1,3*J-2] += 1/Cáµˆ*N[i]*Cáµˆ*N[j]*ð‘¤
                k[3*I-1,3*J-1] += 2/Cáµˆ*N[i]*Cáµˆ*N[j]*ð‘¤
                k[3*I,3*J]     += 2/Cáµˆ*N[i]*Cáµˆ*N[j]*ð‘¤

            end
        end
    end
end
function âˆ«âˆ«Ïƒáµ›áµ¢â±¼Ïƒáµ›â‚–â‚—dxdy(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’;ð“– = ap.ð“–
    for Î¾ in ð“–
        N = Î¾[:ð­]
        ð‘¤ = Î¾.ð‘¤
        EÌ„ = Î¾.EÌ„
        Î½Ì„  = Î¾.Î½Ì„ 
        Cáµ› = EÌ„/(1-2*Î½Ì„ )
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[3*I-2,3*J-2] += 3/4/Cáµ›*N[i]*N[j]*ð‘¤
                k[3*I-2,3*J-1] += 3/4/Cáµ›*N[i]*N[j]*ð‘¤
                k[3*I-1,3*J-2] += 3/4/Cáµ›*N[i]*N[j]*ð‘¤
                k[3*I-1,3*J-1] += 3/4/Cáµ›*N[i]*N[j]*ð‘¤
                
            end
        end
    end
end

function âˆ«âˆ«Îµáµ›áµ¢â±¼Cáµ¢â±¼â‚–â‚—Îµáµ›â‚–â‚—dxdy_Taylor(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’;ð“– = ap.ð“–
    for Î¾ in ð“–
        N = Î¾[:ð­]
        ð‘¤ = Î¾.ð‘¤
        EÌ„ = Î¾.EÌ„
        Î½Ì„  = Î¾.Î½Ì„ 
        xL = 0.0
        yL = 0.0
        x0 = 0.0
        y0 = 0.0
        for Î¾ in ð“–
        x0 += Î¾.x
        y0 += Î¾.y
        end
        xL = x0/length(ð“–)
        yL = y0/length(ð“–)
        ð­ = zeros(21)
        âˆ‚ð­âˆ‚x = zeros(21)
        âˆ‚ð­âˆ‚y = zeros(21)
        âˆ‚Â²ð­âˆ‚xÂ² = zeros(21)
        âˆ‚Â²ð­âˆ‚yÂ² = zeros(21)
        âˆ‚Â²ð­âˆ‚xâˆ‚y = zeros(21)

        ð­[1] = 1.0
        ð­[2] = xL
        ð­[3] = yL
        âˆ‚ð­âˆ‚x[1] = 0.0
        âˆ‚ð­âˆ‚x[2] = 1.0
        âˆ‚ð­âˆ‚x[3] = 0.0
        âˆ‚ð­âˆ‚y[1] = 0.0
        âˆ‚ð­âˆ‚y[2] = 0.0
        âˆ‚ð­âˆ‚y[3] = 1.0

        
        # ð­[1] = 1.0
        # ð­[2] = xL
        # ð­[3] = yL
        # ð­[4] = xL^2
        # ð­[5] = xL*yL
        # ð­[6] = yL^2
        # âˆ‚ð­âˆ‚x[1] = 0.0
        # âˆ‚ð­âˆ‚x[2] = 1.0
        # âˆ‚ð­âˆ‚x[3] = 0.0
        # âˆ‚ð­âˆ‚x[4] = 2*xL
        # âˆ‚ð­âˆ‚x[5] = yL
        # âˆ‚ð­âˆ‚x[6] = 0.0
        # âˆ‚ð­âˆ‚y[1] = 0.0
        # âˆ‚ð­âˆ‚y[2] = 0.0
        # âˆ‚ð­âˆ‚y[3] = 1.0
        # âˆ‚ð­âˆ‚y[4] = 0.0
        # âˆ‚ð­âˆ‚y[5] = xL
        # âˆ‚ð­âˆ‚y[6] = 2*yL

        # âˆ‚Â²ð­âˆ‚xÂ²[1] = 0.0
        # âˆ‚Â²ð­âˆ‚xÂ²[2] = 0.0
        # âˆ‚Â²ð­âˆ‚xÂ²[3] = 0.0 
        # âˆ‚Â²ð­âˆ‚xÂ²[4] = 2.0
        # âˆ‚Â²ð­âˆ‚xÂ²[5] = 0.0
        # âˆ‚Â²ð­âˆ‚xÂ²[6] = 0.0 
        # âˆ‚Â²ð­âˆ‚yÂ²[1] = 0.0
        # âˆ‚Â²ð­âˆ‚yÂ²[2] = 0.0
        # âˆ‚Â²ð­âˆ‚yÂ²[3] = 0.0
        # âˆ‚Â²ð­âˆ‚yÂ²[4] = 0.0
        # âˆ‚Â²ð­âˆ‚yÂ²[5] = 0.0
        # âˆ‚Â²ð­âˆ‚yÂ²[6] = 2.0
        # âˆ‚Â²ð­âˆ‚xâˆ‚y[1] = 0.0
        # âˆ‚Â²ð­âˆ‚xâˆ‚y[2] = 0.0
        # âˆ‚Â²ð­âˆ‚xâˆ‚y[3] = 0.0
        # âˆ‚Â²ð­âˆ‚xâˆ‚y[4] = 0.0
        # âˆ‚Â²ð­âˆ‚xâˆ‚y[5] = 1.0
        # âˆ‚Â²ð­âˆ‚xâˆ‚y[6] = 0.0
        
        xÎ¾ = Î¾.x
        yÎ¾ = Î¾.y
      
        Cáµ› = EÌ„/(1-2*Î½Ì„ )
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                # k[3*I-2,3*J-2] += 1/3*Cáµ›*(ð­[i]*ð­[j]+âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)^2 + 1/4*âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^4 + 1/4*âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^4+ 1/2*âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2*(yÎ¾-yL)^2)*ð‘¤
                # k[3*I-2,3*J-1] += 1/3*Cáµ›*(ð­[i]*ð­[j]+âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)^2 + 1/4*âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^4 + 1/4*âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^4+ 1/2*âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2*(yÎ¾-yL)^2)*ð‘¤
                # k[3*I-1,3*J-2] += 1/3*Cáµ›*(ð­[i]*ð­[j]+âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)^2 + 1/4*âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^4 + 1/4*âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^4+ 1/2*âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2*(yÎ¾-yL)^2)*ð‘¤
                # k[3*I-1,3*J-1] += 1/3*Cáµ›*(ð­[i]*ð­[j]+âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)^2 + 1/4*âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^4 + 1/4*âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^4+ 1/2*âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2*(yÎ¾-yL)^2)*ð‘¤
                

                # k[3*I-2,3*J-2] += 1/3*Cáµ›*((ð­[i]+âˆ‚ð­âˆ‚x[i]*(xÎ¾-xL)+âˆ‚ð­âˆ‚y[i]*(yÎ¾-yL))*(ð­[j]+âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)+âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)))*ð‘¤
                # k[3*I-2,3*J-1] += 1/3*Cáµ›*((ð­[i]+âˆ‚ð­âˆ‚x[i]*(xÎ¾-xL)+âˆ‚ð­âˆ‚y[i]*(yÎ¾-yL))*(ð­[j]+âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)+âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)))*ð‘¤
                # k[3*I-1,3*J-2] += 1/3*Cáµ›*((ð­[i]+âˆ‚ð­âˆ‚x[i]*(xÎ¾-xL)+âˆ‚ð­âˆ‚y[i]*(yÎ¾-yL))*(ð­[j]+âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)+âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)))*ð‘¤
                # k[3*I-1,3*J-1] += 1/3*Cáµ›*((ð­[i]+âˆ‚ð­âˆ‚x[i]*(xÎ¾-xL)+âˆ‚ð­âˆ‚y[i]*(yÎ¾-yL))*(ð­[j]+âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)+âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)))*ð‘¤
                
                k[3*I-2,3*J-2] += 1/3*Cáµ›*((ð­[i])*(ð­[j]))*ð‘¤
                k[3*I-2,3*J-1] += 1/3*Cáµ›*((ð­[i])*(ð­[j]))*ð‘¤
                k[3*I-1,3*J-2] += 1/3*Cáµ›*((ð­[i])*(ð­[j]))*ð‘¤
                k[3*I-1,3*J-1] += 1/3*Cáµ›*((ð­[i])*(ð­[j]))*ð‘¤
                
            end
        end
    end
end

function âˆ«âˆ«Îµáµˆáµ¢â±¼Cáµ¢â±¼â‚–â‚—Îµáµˆâ‚–â‚—dxdy_Taylor(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’;ð“– = ap.ð“–
    for Î¾ in ð“–
        N = Î¾[:ð­]
        ð‘¤ = Î¾.ð‘¤
        EÌ„ = Î¾.EÌ„
        Î½Ì„  = Î¾.Î½Ì„ 
        xL = 0.0
        yL = 0.0
        x0 = 0.0
        y0 = 0.0
        for Î¾ in ð“–
        x0 += Î¾.x
        y0 += Î¾.y
        end
        xL = x0/length(ð“–)
        yL = y0/length(ð“–)
        ð­ = zeros(21)
        âˆ‚ð­âˆ‚x = zeros(21)
        âˆ‚ð­âˆ‚y = zeros(21)
        âˆ‚Â²ð­âˆ‚xÂ² = zeros(21)
        âˆ‚Â²ð­âˆ‚yÂ² = zeros(21)
        âˆ‚Â²ð­âˆ‚xâˆ‚y = zeros(21)

        # ð­[1] = 1.0
        # ð­[2] = xL
        # ð­[3] = yL
        # âˆ‚ð­âˆ‚x[1] = 0.0
        # âˆ‚ð­âˆ‚x[2] = 1.0
        # âˆ‚ð­âˆ‚x[3] = 0.0
        # âˆ‚ð­âˆ‚y[1] = 0.0
        # âˆ‚ð­âˆ‚y[2] = 0.0
        # âˆ‚ð­âˆ‚y[3] = 1.0

        
        ð­[1] = 1.0
        ð­[2] = xL
        ð­[3] = yL
        ð­[4] = xL^2
        ð­[5] = xL*yL
        ð­[6] = yL^2
        âˆ‚ð­âˆ‚x[1] = 0.0
        âˆ‚ð­âˆ‚x[2] = 1.0
        âˆ‚ð­âˆ‚x[3] = 0.0
        âˆ‚ð­âˆ‚x[4] = 2*xL
        âˆ‚ð­âˆ‚x[5] = yL
        âˆ‚ð­âˆ‚x[6] = 0.0
        âˆ‚ð­âˆ‚y[1] = 0.0
        âˆ‚ð­âˆ‚y[2] = 0.0
        âˆ‚ð­âˆ‚y[3] = 1.0
        âˆ‚ð­âˆ‚y[4] = 0.0
        âˆ‚ð­âˆ‚y[5] = xL
        âˆ‚ð­âˆ‚y[6] = 2*yL

        âˆ‚Â²ð­âˆ‚xÂ²[1] = 0.0
        âˆ‚Â²ð­âˆ‚xÂ²[2] = 0.0
        âˆ‚Â²ð­âˆ‚xÂ²[3] = 0.0 
        âˆ‚Â²ð­âˆ‚xÂ²[4] = 2.0
        âˆ‚Â²ð­âˆ‚xÂ²[5] = 0.0
        âˆ‚Â²ð­âˆ‚xÂ²[6] = 0.0 
        âˆ‚Â²ð­âˆ‚yÂ²[1] = 0.0
        âˆ‚Â²ð­âˆ‚yÂ²[2] = 0.0
        âˆ‚Â²ð­âˆ‚yÂ²[3] = 0.0
        âˆ‚Â²ð­âˆ‚yÂ²[4] = 0.0
        âˆ‚Â²ð­âˆ‚yÂ²[5] = 0.0
        âˆ‚Â²ð­âˆ‚yÂ²[6] = 2.0
        âˆ‚Â²ð­âˆ‚xâˆ‚y[1] = 0.0
        âˆ‚Â²ð­âˆ‚xâˆ‚y[2] = 0.0
        âˆ‚Â²ð­âˆ‚xâˆ‚y[3] = 0.0
        âˆ‚Â²ð­âˆ‚xâˆ‚y[4] = 0.0
        âˆ‚Â²ð­âˆ‚xâˆ‚y[5] = 1.0
        âˆ‚Â²ð­âˆ‚xâˆ‚y[6] = 0.0
        
        xÎ¾ = Î¾.x
        yÎ¾ = Î¾.y
        Cáµˆ = EÌ„/(1+Î½Ì„ )
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                # k[3*I-2,3*J-2] += 2/3*Cáµˆ*(ð­[i]*ð­[j]+âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)^2 + 1/4*âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^4 + 1/4*âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^4+ 1/2*âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2*(yÎ¾-yL)^2)*ð‘¤
                # k[3*I-2,3*J-1] += -1/3*Cáµˆ*(ð­[i]*ð­[j]+âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)^2 + 1/4*âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^4 + 1/4*âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^4+ 1/2*âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2*(yÎ¾-yL)^2)*ð‘¤
                # k[3*I-1,3*J-2] += -1/3*Cáµˆ*(ð­[i]*ð­[j]+âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)^2 + 1/4*âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^4 + 1/4*âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^4+ 1/2*âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2*(yÎ¾-yL)^2)*ð‘¤
                # k[3*I-1,3*J-1] += 2/3*Cáµˆ*(ð­[i]*ð­[j]+âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)^2 + 1/4*âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^4 + 1/4*âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^4+ 1/2*âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2*(yÎ¾-yL)^2)*ð‘¤
                # k[3*I,3*J]     += 1/2*Cáµˆ*(ð­[i]*ð­[j]+âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)^2 + 1/4*âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^4 + 1/4*âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^4+ 1/2*âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2*(yÎ¾-yL)^2)*ð‘¤


                k[3*I-2,3*J-2] += 2/3*Cáµˆ*( âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)^2 +1/4*âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^4 + 1/4*âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^4+ 1/2*âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2*(yÎ¾-yL)^2)*ð‘¤
                k[3*I-2,3*J-1] += -1/3*Cáµˆ*(âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)^2 +1/4*âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^4 + 1/4*âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^4+ 1/2*âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2*(yÎ¾-yL)^2)*ð‘¤
                k[3*I-1,3*J-2] += -1/3*Cáµˆ*( âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)^2 +1/4*âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^4 + 1/4*âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^4+ 1/2*âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2*(yÎ¾-yL)^2)*ð‘¤
                k[3*I-1,3*J-1] += 2/3*Cáµˆ*(âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)^2 +1/4*âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^4 + 1/4*âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^4+ 1/2*âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2*(yÎ¾-yL)^2)*ð‘¤
                k[3*I,3*J]     += 1/2*Cáµˆ*(âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)^2 +1/4*âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^4 + 1/4*âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^4+ 1/2*âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2*(yÎ¾-yL)^2)*ð‘¤

            end
        end
    end
end

function âˆ«âˆ«Îµáµ›áµ¢â±¼Cáµ¢â±¼â‚–â‚—Îµáµ›â‚–â‚—dxdy(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’;ð“– = ap.ð“–
    for Î¾ in ð“–
        N = Î¾[:ð­]
        ð‘¤ = Î¾.ð‘¤
        EÌ„ = Î¾.EÌ„
        Î½Ì„  = Î¾.Î½Ì„ 
        
        Cáµ› = EÌ„/(1-2*Î½Ì„ )
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[3*I-2,3*J-2] += 1/3*N[i]*Cáµ›*N[j]*ð‘¤
                k[3*I-2,3*J-1] += 1/3*N[i]*Cáµ›*N[j]*ð‘¤
                k[3*I-1,3*J-2] += 1/3*N[i]*Cáµ›*N[j]*ð‘¤
                k[3*I-1,3*J-1] += 1/3*N[i]*Cáµ›*N[j]*ð‘¤
                
            end
        end
    end
end
function âˆ«âˆ«Ïƒáµ¢â±¼Ïƒâ‚–â‚—dxdy_Taylor(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’;ð“– = ap.ð“–
    for Î¾ in ð“–
        N = Î¾[:ð­]
       
        ð‘¤ = Î¾.ð‘¤
        E = Î¾.E
        Î½ = Î¾.Î½ 
        xL = 0.0
        yL = 0.0
        x0 = 0.0
        y0 = 0.0
        for Î¾ in ð“–
        x0 += Î¾.x
        y0 += Î¾.y
        end
        xL = x0/length(ð“–)
        yL = y0/length(ð“–)
        ð­ = zeros(21)
        âˆ‚ð­âˆ‚x = zeros(21)
        âˆ‚ð­âˆ‚y = zeros(21)
        âˆ‚Â²ð­âˆ‚xÂ² = zeros(21)
        âˆ‚Â²ð­âˆ‚yÂ² = zeros(21)
        âˆ‚Â²ð­âˆ‚xâˆ‚y = zeros(21)

        ð­[1] = 1.0
        ð­[2] = xL
        ð­[3] = yL
        âˆ‚ð­âˆ‚x[1] = 0.0
        âˆ‚ð­âˆ‚x[2] = 1.0
        âˆ‚ð­âˆ‚x[3] = 0.0
        âˆ‚ð­âˆ‚y[1] = 0.0
        âˆ‚ð­âˆ‚y[2] = 0.0
        âˆ‚ð­âˆ‚y[3] = 1.0

        # ð­[1] = 1.0
        # ð­[2] = xL
        # ð­[3] = yL
        # ð­[4] = xL^2
        # ð­[5] = xL*yL
        # ð­[6] = yL^2
        # âˆ‚ð­âˆ‚x[1] = 0.0
        # âˆ‚ð­âˆ‚x[2] = 1.0
        # âˆ‚ð­âˆ‚x[3] = 0.0
        # âˆ‚ð­âˆ‚x[4] = 2*xL
        # âˆ‚ð­âˆ‚x[5] = yL
        # âˆ‚ð­âˆ‚x[6] = 0.0
        # âˆ‚ð­âˆ‚y[1] = 0.0
        # âˆ‚ð­âˆ‚y[2] = 0.0
        # âˆ‚ð­âˆ‚y[3] = 1.0
        # âˆ‚ð­âˆ‚y[4] = 0.0
        # âˆ‚ð­âˆ‚y[5] = xL
        # âˆ‚ð­âˆ‚y[6] = 2*yL

        # âˆ‚Â²ð­âˆ‚xÂ²[1] = 0.0
        # âˆ‚Â²ð­âˆ‚xÂ²[2] = 0.0
        # âˆ‚Â²ð­âˆ‚xÂ²[3] = 0.0 
        # âˆ‚Â²ð­âˆ‚xÂ²[4] = 2.0
        # âˆ‚Â²ð­âˆ‚xÂ²[5] = 0.0
        # âˆ‚Â²ð­âˆ‚xÂ²[6] = 0.0 
        # âˆ‚Â²ð­âˆ‚yÂ²[1] = 0.0
        # âˆ‚Â²ð­âˆ‚yÂ²[2] = 0.0
        # âˆ‚Â²ð­âˆ‚yÂ²[3] = 0.0
        # âˆ‚Â²ð­âˆ‚yÂ²[4] = 0.0
        # âˆ‚Â²ð­âˆ‚yÂ²[5] = 0.0
        # âˆ‚Â²ð­âˆ‚yÂ²[6] = 2.0
        # âˆ‚Â²ð­âˆ‚xâˆ‚y[1] = 0.0
        # âˆ‚Â²ð­âˆ‚xâˆ‚y[2] = 0.0
        # âˆ‚Â²ð­âˆ‚xâˆ‚y[3] = 0.0
        # âˆ‚Â²ð­âˆ‚xâˆ‚y[4] = 0.0
        # âˆ‚Â²ð­âˆ‚xâˆ‚y[5] = 1.0
        # âˆ‚Â²ð­âˆ‚xâˆ‚y[6] = 0.0

        xÎ¾ = Î¾.x
        yÎ¾ = Î¾.y
        Câ»Â¹áµ¢áµ¢áµ¢áµ¢ = 1/E
        Câ»Â¹áµ¢áµ¢â±¼â±¼ = -Î½/E
        Câ»Â¹áµ¢â±¼áµ¢â±¼ = 2*(1+Î½)/E
        ðº = E/(1+Î½)/2

        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                # k[3*I-2,3*J-2] += Câ»Â¹áµ¢áµ¢áµ¢áµ¢*(ð­[i]*ð­[j]+âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)^2 + 1/4*âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^4 + 1/4*âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^4+ 1/2*âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2*(yÎ¾-yL)^2)*ð‘¤
                # k[3*I-2,3*J-1] += Câ»Â¹áµ¢áµ¢â±¼â±¼*(ð­[i]*ð­[j]+âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)^2 + 1/4*âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^4 + 1/4*âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^4+ 1/2*âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2*(yÎ¾-yL)^2)*ð‘¤
                # k[3*I-1,3*J-2] += Câ»Â¹áµ¢áµ¢â±¼â±¼*(ð­[i]*ð­[j]+âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)^2 + 1/4*âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^4 + 1/4*âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^4+ 1/2*âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2*(yÎ¾-yL)^2)*ð‘¤
                # k[3*I-1,3*J-1] += Câ»Â¹áµ¢áµ¢áµ¢áµ¢*(ð­[i]*ð­[j]+âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)^2 + 1/4*âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^4 + 1/4*âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^4+ 1/2*âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2*(yÎ¾-yL)^2)*ð‘¤
                # k[3*I,3*J]     += Câ»Â¹áµ¢â±¼áµ¢â±¼*(ð­[i]*ð­[j]+âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)^2 + 1/4*âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^4 + 1/4*âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^4+ 1/2*âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2*(yÎ¾-yL)^2)*ð‘¤
            
                k[3*I-2,3*J-2] += Câ»Â¹áµ¢áµ¢áµ¢áµ¢*((ð­[i]+âˆ‚ð­âˆ‚x[i]*(xÎ¾-xL)+âˆ‚ð­âˆ‚y[i]*(yÎ¾-yL))*(ð­[j]+âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)+âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)))*ð‘¤
                k[3*I-2,3*J-1] += Câ»Â¹áµ¢áµ¢â±¼â±¼*((ð­[i]+âˆ‚ð­âˆ‚x[i]*(xÎ¾-xL)+âˆ‚ð­âˆ‚y[i]*(yÎ¾-yL))*(ð­[j]+âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)+âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)))*ð‘¤
                k[3*I-1,3*J-2] += Câ»Â¹áµ¢áµ¢â±¼â±¼*((ð­[i]+âˆ‚ð­âˆ‚x[i]*(xÎ¾-xL)+âˆ‚ð­âˆ‚y[i]*(yÎ¾-yL))*(ð­[j]+âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)+âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)))*ð‘¤
                k[3*I-1,3*J-1] += Câ»Â¹áµ¢áµ¢áµ¢áµ¢*((ð­[i]+âˆ‚ð­âˆ‚x[i]*(xÎ¾-xL)+âˆ‚ð­âˆ‚y[i]*(yÎ¾-yL))*(ð­[j]+âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)+âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)))*ð‘¤
                k[3*I,3*J]     += Câ»Â¹áµ¢â±¼áµ¢â±¼*((ð­[i]+âˆ‚ð­âˆ‚x[i]*(xÎ¾-xL)+âˆ‚ð­âˆ‚y[i]*(yÎ¾-yL))*(ð­[j]+âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)+âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)))*ð‘¤
            
                # k[3*I-2,3*J-2] += 1/ðº*(ð­[i]*ð­[j]+âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)^2 + 1/4*âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^4 + 1/4*âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^4+ 1/2*âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2*(yÎ¾-yL)^2)*ð‘¤
                # k[3*I-2,3*J-1] += 1/ðº*(ð­[i]*ð­[j]+âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)^2 + 1/4*âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^4 + 1/4*âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^4+ 1/2*âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2*(yÎ¾-yL)^2)*ð‘¤
                # k[3*I-1,3*J-2] += 1/ðº*(ð­[i]*ð­[j]+âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)^2 + 1/4*âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^4 + 1/4*âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^4+ 1/2*âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2*(yÎ¾-yL)^2)*ð‘¤
                # k[3*I-1,3*J-1] += 1/ðº*(ð­[i]*ð­[j]+âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)^2 + 1/4*âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^4 + 1/4*âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^4+ 1/2*âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2*(yÎ¾-yL)^2)*ð‘¤
                # k[3*I,3*J]     += 1/ðº*(ð­[i]*ð­[j]+âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]*(yÎ¾-yL)^2 + 1/4*âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^4 + 1/4*âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^4+ 1/2*âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2*(yÎ¾-yL)^2)*ð‘¤
            
            end
        end
    end
end

function âˆ«âˆ«Ïƒáµ¢â±¼Ïƒâ‚–â‚—dxdy_PlaneStrian(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’;ð“– = ap.ð“–
    for Î¾ in ð“–
        N = Î¾[:ð­]
        ð‘¤ = Î¾.ð‘¤
        E = Î¾.E
        Î½ = Î¾.Î½
        Câ»Â¹áµ¢áµ¢áµ¢áµ¢ = (1-Î½^2)/E
        Câ»Â¹áµ¢áµ¢â±¼â±¼ = -(Î½+Î½^2)/E
        Câ»Â¹áµ¢â±¼áµ¢â±¼ = 2*(1+Î½)/E
        
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[3*I-2,3*J-2] += N[i]*Câ»Â¹áµ¢áµ¢áµ¢áµ¢*N[j]*ð‘¤
                k[3*I-2,3*J-1] += N[i]*Câ»Â¹áµ¢áµ¢â±¼â±¼*N[j]*ð‘¤
                k[3*I-1,3*J-2] += N[i]*Câ»Â¹áµ¢áµ¢â±¼â±¼*N[j]*ð‘¤
                k[3*I-1,3*J-1] += N[i]*Câ»Â¹áµ¢áµ¢áµ¢áµ¢*N[j]*ð‘¤
                k[3*I,3*J]     += N[i]*Câ»Â¹áµ¢â±¼áµ¢â±¼*N[j]*ð‘¤
            end
        end
    end
end



function âˆ«Ïƒáµ¢â±¼nâ±¼gáµ¢ds(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    for (Î¾â‚›,Î¾áµ¤) in zip(ð“–â‚›,ð“–áµ¤)
        ð‘¤ = Î¾â‚›.ð‘¤
        # ð‘¤ = Î¾áµ¤.ð‘¤
        N = Î¾â‚›[:ð­]
        NÌ„ = Î¾áµ¤[:ð­]
        nâ‚ = Î¾áµ¤.nâ‚
        nâ‚‚ = Î¾áµ¤.nâ‚‚
        nâ‚â‚ = Î¾áµ¤.nâ‚â‚
        nâ‚â‚‚ = Î¾áµ¤.nâ‚â‚‚
        nâ‚‚â‚‚ = Î¾áµ¤.nâ‚‚â‚‚
        gâ‚ = Î¾áµ¤.gâ‚
        gâ‚‚ = Î¾áµ¤.gâ‚‚
        

        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[3*I-2,2*J-1] += N[i]*nâ‚*nâ‚â‚*NÌ„[j]*ð‘¤
                k[3*I-2,2*J]   += N[i]*nâ‚*nâ‚â‚‚*NÌ„[j]*ð‘¤
                k[3*I-1,2*J-1] += N[i]*nâ‚‚*nâ‚â‚‚*NÌ„[j]*ð‘¤
                k[3*I-1,2*J]   += N[i]*nâ‚‚*nâ‚‚â‚‚*NÌ„[j]*ð‘¤
                k[3*I,2*J-1]   += N[i]*(nâ‚*nâ‚â‚‚ + nâ‚‚*nâ‚â‚)*NÌ„[j]*ð‘¤
                k[3*I,2*J]     += N[i]*(nâ‚*nâ‚‚â‚‚ + nâ‚‚*nâ‚â‚‚)*NÌ„[j]*ð‘¤
            end
            f[3*I-2] += N[i]*(nâ‚*nâ‚â‚*gâ‚ + nâ‚*nâ‚â‚‚*gâ‚‚)*ð‘¤
            f[3*I-1] += N[i]*(nâ‚‚*nâ‚â‚‚*gâ‚ + nâ‚‚*nâ‚‚â‚‚*gâ‚‚)*ð‘¤
            f[3*I]   += N[i]*((nâ‚*nâ‚â‚‚+nâ‚‚*nâ‚â‚)*gâ‚ + (nâ‚*nâ‚‚â‚‚+nâ‚‚*nâ‚â‚‚)*gâ‚‚)*ð‘¤ 
        end
    end
end

function âˆ«Ïƒáµ¢â±¼nâ±¼gáµ¢dÎ“(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    for (Î¾â‚›,Î¾áµ¤) in zip(ð“–â‚›,ð“–áµ¤)
        ð‘¤ = Î¾â‚›.ð‘¤
        # ð‘¤ = Î¾áµ¤.ð‘¤
        N = Î¾â‚›[:ð­]
        NÌ„ = Î¾áµ¤[:ð­]
        nâ‚ = Î¾áµ¤.nâ‚
        nâ‚‚ = Î¾áµ¤.nâ‚‚
        nâ‚ƒ = Î¾áµ¤.nâ‚ƒ
        nâ‚â‚ = Î¾áµ¤.nâ‚â‚
        nâ‚â‚‚ = Î¾áµ¤.nâ‚â‚‚
        nâ‚â‚ƒ = Î¾áµ¤.nâ‚â‚ƒ
        nâ‚‚â‚‚ = Î¾áµ¤.nâ‚‚â‚‚
        nâ‚‚â‚ƒ = Î¾áµ¤.nâ‚‚â‚ƒ
        nâ‚ƒâ‚ƒ = Î¾áµ¤.nâ‚ƒâ‚ƒ
        gâ‚ = Î¾áµ¤.gâ‚
        gâ‚‚ = Î¾áµ¤.gâ‚‚
        gâ‚ƒ = Î¾áµ¤.gâ‚ƒ
        

        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
            
                k[6*I-5,3*J-2] += N[i]*nâ‚*nâ‚â‚*NÌ„[j]*ð‘¤
                k[6*I-5,3*J-1] += N[i]*nâ‚*nâ‚â‚‚*NÌ„[j]*ð‘¤
                k[6*I-5,3*J]   += N[i]*nâ‚*nâ‚â‚ƒ*NÌ„[j]*ð‘¤

                k[6*I-4,3*J-2] += N[i]*nâ‚‚*nâ‚â‚‚*NÌ„[j]*ð‘¤
                k[6*I-4,3*J-1] += N[i]*nâ‚‚*nâ‚‚â‚‚*NÌ„[j]*ð‘¤
                k[6*I-4,3*J]   += N[i]*nâ‚‚*nâ‚‚â‚ƒ*NÌ„[j]*ð‘¤

                k[6*I-3,3*J-2] += N[i]*nâ‚ƒ*nâ‚â‚ƒ*NÌ„[j]*ð‘¤
                k[6*I-3,3*J-1] += N[i]*nâ‚ƒ*nâ‚‚â‚ƒ*NÌ„[j]*ð‘¤
                k[6*I-3,3*J]   += N[i]*nâ‚ƒ*nâ‚ƒâ‚ƒ*NÌ„[j]*ð‘¤

                k[6*I-2,3*J-2] += N[i]*(nâ‚*nâ‚â‚‚ + nâ‚‚*nâ‚â‚)*NÌ„[j]*ð‘¤
                k[6*I-2,3*J-1] += N[i]*(nâ‚*nâ‚‚â‚‚ + nâ‚‚*nâ‚â‚‚)*NÌ„[j]*ð‘¤
                k[6*I-2,3*J]   += N[i]*(nâ‚*nâ‚‚â‚ƒ + nâ‚‚*nâ‚â‚ƒ)*NÌ„[j]*ð‘¤

                k[6*I-1,3*J-2] += N[i]*(nâ‚ƒ*nâ‚â‚‚ + nâ‚‚*nâ‚â‚ƒ)*NÌ„[j]*ð‘¤
                k[6*I-1,3*J-1] += N[i]*(nâ‚‚*nâ‚‚â‚ƒ + nâ‚ƒ*nâ‚‚â‚‚)*NÌ„[j]*ð‘¤
                k[6*I-1,3*J]   += N[i]*(nâ‚‚*nâ‚ƒâ‚ƒ + nâ‚ƒ*nâ‚‚â‚ƒ)*NÌ„[j]*ð‘¤

                k[6*I,3*J-2] += N[i]*(nâ‚*nâ‚â‚ƒ + nâ‚ƒ*nâ‚â‚)*NÌ„[j]*ð‘¤
                k[6*I,3*J-1] += N[i]*(nâ‚*nâ‚‚â‚ƒ + nâ‚ƒ*nâ‚â‚‚)*NÌ„[j]*ð‘¤
                k[6*I,3*J]   += N[i]*(nâ‚*nâ‚ƒâ‚ƒ + nâ‚ƒ*nâ‚â‚ƒ)*NÌ„[j]*ð‘¤

            end
            f[6*I-5] += N[i]*(nâ‚*nâ‚â‚*gâ‚ + nâ‚*nâ‚â‚‚*gâ‚‚ + nâ‚*nâ‚â‚ƒ*gâ‚ƒ)*ð‘¤
            f[6*I-4] += N[i]*(nâ‚‚*nâ‚â‚‚*gâ‚ + nâ‚‚*nâ‚‚â‚‚*gâ‚‚ + nâ‚‚*nâ‚‚â‚ƒ*gâ‚ƒ)*ð‘¤
            f[6*I-3] += N[i]*(nâ‚ƒ*nâ‚â‚ƒ*gâ‚ + nâ‚ƒ*nâ‚‚â‚ƒ*gâ‚‚ + nâ‚ƒ*nâ‚ƒâ‚ƒ*gâ‚ƒ)*ð‘¤
            f[6*I-2] += N[i]*((nâ‚*nâ‚â‚‚+nâ‚‚*nâ‚â‚)*gâ‚ + (nâ‚*nâ‚‚â‚‚+nâ‚‚*nâ‚â‚‚)*gâ‚‚ + (nâ‚*nâ‚‚â‚ƒ+nâ‚‚*nâ‚â‚ƒ)*gâ‚ƒ)*ð‘¤ 
            f[6*I-1] += N[i]*((nâ‚ƒ*nâ‚â‚‚+nâ‚‚*nâ‚â‚ƒ)*gâ‚ + (nâ‚‚*nâ‚‚â‚ƒ+nâ‚ƒ*nâ‚‚â‚‚)*gâ‚‚ + (nâ‚‚*nâ‚ƒâ‚ƒ+nâ‚ƒ*nâ‚‚â‚ƒ)*gâ‚ƒ)*ð‘¤ 
            f[6*I]   += N[i]*((nâ‚*nâ‚â‚ƒ+nâ‚ƒ*nâ‚â‚)*gâ‚ + (nâ‚*nâ‚‚â‚ƒ+nâ‚ƒ*nâ‚â‚‚)*gâ‚‚ + (nâ‚*nâ‚ƒâ‚ƒ+nâ‚ƒ*nâ‚â‚ƒ)*gâ‚ƒ)*ð‘¤

          
        end
    end
end

function âˆ«CÎµáµ¢â±¼nâ±¼gáµ¢ds(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    for (Î¾â‚›,Î¾áµ¤) in zip(ð“–â‚›,ð“–áµ¤)
        # ð‘¤ = Î¾â‚›.ð‘¤
        ð‘¤ = Î¾áµ¤.ð‘¤
        N = Î¾â‚›[:ð­]
        NÌ„ = Î¾áµ¤[:ð­]
        nâ‚ = Î¾áµ¤.nâ‚
        nâ‚‚ = Î¾áµ¤.nâ‚‚
        nâ‚â‚ = Î¾áµ¤.nâ‚â‚
        nâ‚â‚‚ = Î¾áµ¤.nâ‚â‚‚
        nâ‚‚â‚‚ = Î¾áµ¤.nâ‚‚â‚‚
        gâ‚ = Î¾áµ¤.gâ‚
        gâ‚‚ = Î¾áµ¤.gâ‚‚
        E = Î¾áµ¤.E
        Î½ = Î¾áµ¤.Î½
        Cáµ¢áµ¢áµ¢áµ¢ = E/(1-Î½^2)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-Î½^2)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)

        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[3*I-2,2*J-1] +=  (Cáµ¢áµ¢áµ¢áµ¢*N[i]*nâ‚*nâ‚â‚*NÌ„[j]+Cáµ¢áµ¢â±¼â±¼*N[i]*nâ‚‚*nâ‚â‚‚*NÌ„[j])*ð‘¤
                k[3*I-2,2*J]   +=  (Cáµ¢áµ¢áµ¢áµ¢*N[i]*nâ‚*nâ‚â‚‚*NÌ„[j]+Cáµ¢áµ¢â±¼â±¼*N[i]*nâ‚‚*nâ‚‚â‚‚*NÌ„[j])*ð‘¤
                k[3*I-1,2*J-1] +=  (Cáµ¢áµ¢â±¼â±¼*N[i]*nâ‚*nâ‚â‚*NÌ„[j]+Cáµ¢áµ¢áµ¢áµ¢*N[i]*nâ‚‚*nâ‚â‚‚*NÌ„[j])*ð‘¤
                k[3*I-1,2*J]   +=  (Cáµ¢áµ¢â±¼â±¼*N[i]*nâ‚*nâ‚â‚‚*NÌ„[j]+Cáµ¢áµ¢áµ¢áµ¢*N[i]*nâ‚‚*nâ‚‚â‚‚*NÌ„[j])*ð‘¤
                k[3*I,2*J-1]   +=  Cáµ¢â±¼áµ¢â±¼*N[i]*(nâ‚*nâ‚â‚‚ + nâ‚‚*nâ‚â‚)*NÌ„[j]*ð‘¤
                k[3*I,2*J]     +=  Cáµ¢â±¼áµ¢â±¼*N[i]*(nâ‚*nâ‚‚â‚‚ + nâ‚‚*nâ‚â‚‚)*NÌ„[j]*ð‘¤
            end
            f[3*I-2] += N[i]*((Cáµ¢áµ¢áµ¢áµ¢*nâ‚*nâ‚â‚+Cáµ¢áµ¢â±¼â±¼*nâ‚‚*nâ‚â‚‚)*gâ‚ + (Cáµ¢áµ¢áµ¢áµ¢*nâ‚*nâ‚â‚‚+Cáµ¢áµ¢â±¼â±¼*nâ‚‚*nâ‚‚â‚‚)*gâ‚‚)*ð‘¤
            f[3*I-1] += N[i]*((Cáµ¢áµ¢â±¼â±¼*nâ‚*nâ‚â‚+Cáµ¢áµ¢áµ¢áµ¢*nâ‚‚*nâ‚â‚‚)*gâ‚ + (Cáµ¢áµ¢â±¼â±¼*nâ‚*nâ‚â‚‚+Cáµ¢áµ¢áµ¢áµ¢*nâ‚‚*nâ‚‚â‚‚)*gâ‚‚)*ð‘¤
            f[3*I]   += Cáµ¢â±¼áµ¢â±¼*N[i]*((nâ‚*nâ‚â‚‚+nâ‚‚*nâ‚â‚)*gâ‚ + (nâ‚*nâ‚‚â‚‚+nâ‚‚*nâ‚â‚‚)*gâ‚‚)*ð‘¤ 
        end
    end
end
function âˆ«Cáµ›Îµáµ¢â±¼nâ±¼gáµ¢ds(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    for (Î¾â‚›,Î¾áµ¤) in zip(ð“–â‚›,ð“–áµ¤)
        # ð‘¤ = Î¾â‚›.ð‘¤
        ð‘¤ = Î¾áµ¤.ð‘¤
        N = Î¾â‚›[:ð­]
        NÌ„ = Î¾áµ¤[:ð­]
        nâ‚ = Î¾áµ¤.nâ‚
        nâ‚‚ = Î¾áµ¤.nâ‚‚
        nâ‚â‚ = Î¾áµ¤.nâ‚â‚
        nâ‚â‚‚ = Î¾áµ¤.nâ‚â‚‚
        nâ‚‚â‚‚ = Î¾áµ¤.nâ‚‚â‚‚
        gâ‚ = Î¾áµ¤.gâ‚
        gâ‚‚ = Î¾áµ¤.gâ‚‚
        E = Î¾áµ¤.E
        Î½ = Î¾áµ¤.Î½
        EÌ„ = Î¾áµ¤.EÌ„
        Î½Ì„  = Î¾áµ¤.Î½Ì„ 
        Cáµ› = EÌ„/(1-2*Î½Ì„ )

        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[3*I-2,2*J-1] +=  1/3*Cáµ›*(N[i]*nâ‚*nâ‚â‚*NÌ„[j]+N[i]*nâ‚‚*nâ‚â‚‚*NÌ„[j])*ð‘¤
                k[3*I-2,2*J]   +=  1/3*Cáµ›*(N[i]*nâ‚*nâ‚â‚‚*NÌ„[j]+N[i]*nâ‚‚*nâ‚‚â‚‚*NÌ„[j])*ð‘¤
                k[3*I-1,2*J-1] +=  1/3*Cáµ›*(N[i]*nâ‚*nâ‚â‚*NÌ„[j]+N[i]*nâ‚‚*nâ‚â‚‚*NÌ„[j])*ð‘¤
                k[3*I-1,2*J]   +=  1/3*Cáµ›*(N[i]*nâ‚*nâ‚â‚‚*NÌ„[j]+N[i]*nâ‚‚*nâ‚‚â‚‚*NÌ„[j])*ð‘¤
                
            end
            f[3*I-2] += N[i]*((1/3*Cáµ›*nâ‚*nâ‚â‚+1/3*Cáµ›*nâ‚‚*nâ‚â‚‚)*gâ‚ + (1/3*Cáµ›*nâ‚*nâ‚â‚‚+1/3*Cáµ›*nâ‚‚*nâ‚‚â‚‚)*gâ‚‚)*ð‘¤
            f[3*I-1] += N[i]*((1/3*Cáµ›*nâ‚*nâ‚â‚+1/3*Cáµ›*nâ‚‚*nâ‚â‚‚)*gâ‚ + (1/3*Cáµ›*nâ‚*nâ‚â‚‚+1/3*Cáµ›*nâ‚‚*nâ‚‚â‚‚)*gâ‚‚)*ð‘¤
            
        end
    end
end
function âˆ«CáµˆÎµáµ¢â±¼nâ±¼gáµ¢ds(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    for (Î¾â‚›,Î¾áµ¤) in zip(ð“–â‚›,ð“–áµ¤)
        # ð‘¤ = Î¾â‚›.ð‘¤
        ð‘¤ = Î¾áµ¤.ð‘¤
        N = Î¾â‚›[:ð­]
        NÌ„ = Î¾áµ¤[:ð­]
        nâ‚ = Î¾áµ¤.nâ‚
        nâ‚‚ = Î¾áµ¤.nâ‚‚
        nâ‚â‚ = Î¾áµ¤.nâ‚â‚
        nâ‚â‚‚ = Î¾áµ¤.nâ‚â‚‚
        nâ‚‚â‚‚ = Î¾áµ¤.nâ‚‚â‚‚
        gâ‚ = Î¾áµ¤.gâ‚
        gâ‚‚ = Î¾áµ¤.gâ‚‚
        EÌ„ = Î¾áµ¤.EÌ„
        Î½Ì„  = Î¾áµ¤.Î½Ì„ 
        Cáµˆ = EÌ„/(1+Î½Ì„ )

        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[3*I-2,2*J-1] +=  ( 2/3*Cáµˆ*N[i]*nâ‚*nâ‚â‚*NÌ„[j]-1/3*Cáµˆ*N[i]*nâ‚‚*nâ‚â‚‚*NÌ„[j])*ð‘¤
                k[3*I-2,2*J]   +=  ( 2/3*Cáµˆ*N[i]*nâ‚*nâ‚â‚‚*NÌ„[j]-1/3*Cáµˆ*N[i]*nâ‚‚*nâ‚‚â‚‚*NÌ„[j])*ð‘¤
                k[3*I-1,2*J-1] +=  (-1/3*Cáµˆ*N[i]*nâ‚*nâ‚â‚*NÌ„[j]+2/3*Cáµˆ*N[i]*nâ‚‚*nâ‚â‚‚*NÌ„[j])*ð‘¤
                k[3*I-1,2*J]   +=  (-1/3*Cáµˆ*N[i]*nâ‚*nâ‚â‚‚*NÌ„[j]+2/3*Cáµˆ*N[i]*nâ‚‚*nâ‚‚â‚‚*NÌ„[j])*ð‘¤
                k[3*I,2*J-1]   +=  1/2*Cáµˆ*N[i]*(nâ‚*nâ‚â‚‚ + nâ‚‚*nâ‚â‚)*NÌ„[j]*ð‘¤
                k[3*I,2*J]     +=  1/2*Cáµˆ*N[i]*(nâ‚*nâ‚‚â‚‚ + nâ‚‚*nâ‚â‚‚)*NÌ„[j]*ð‘¤
            end
            f[3*I-2] += N[i]*(( 2/3*Cáµˆ*nâ‚*nâ‚â‚-1/3*Cáµˆ*nâ‚‚*nâ‚â‚‚)*gâ‚ + ( 2/3*Cáµˆ*nâ‚*nâ‚â‚‚-1/3*Cáµˆ*nâ‚‚*nâ‚‚â‚‚)*gâ‚‚)*ð‘¤
            f[3*I-1] += N[i]*((-1/3*Cáµˆ*nâ‚*nâ‚â‚+2/3*Cáµˆ*nâ‚‚*nâ‚â‚‚)*gâ‚ + (-1/3*Cáµˆ*nâ‚*nâ‚â‚‚+2/3*Cáµˆ*nâ‚‚*nâ‚‚â‚‚)*gâ‚‚)*ð‘¤
            f[3*I]   += 1/2*Cáµˆ*N[i]*((nâ‚*nâ‚â‚‚+nâ‚‚*nâ‚â‚)*gâ‚ + (nâ‚*nâ‚‚â‚‚+nâ‚‚*nâ‚â‚‚)*gâ‚‚)*ð‘¤ 
        end
    end
end

function âˆ«Ïƒáµ¢â±¼nâ±¼uáµ¢ds(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    for (Î¾â‚›,Î¾áµ¤) in zip(ð“–â‚›,ð“–áµ¤)
        # ð‘¤ = Î¾â‚›.ð‘¤
        ð‘¤ = Î¾áµ¤.ð‘¤

        N = Î¾â‚›[:ð­]
        NÌ„ = Î¾áµ¤[:ð­]
        nâ‚ = Î¾áµ¤.nâ‚
        nâ‚‚ = Î¾áµ¤.nâ‚‚
        
        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[3*I-2,2*J-1] -= N[i]*nâ‚*NÌ„[j]*ð‘¤
                k[3*I-1,2*J]   -= N[i]*nâ‚‚*NÌ„[j]*ð‘¤
                k[3*I,2*J-1]   -= N[i]*nâ‚‚*NÌ„[j]*ð‘¤
                k[3*I,2*J]     -= N[i]*nâ‚*NÌ„[j]*ð‘¤
            end
        end
    end
end



function âˆ«Ïƒáµ¢â±¼nâ±¼uáµ¢dÎ“(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
  
    for (Î¾â‚›,Î¾áµ¤) in zip(ð“–â‚›,ð“–áµ¤)
      
        # ð‘¤ = Î¾â‚›.ð‘¤
        ð‘¤ = Î¾áµ¤.ð‘¤

        N = Î¾â‚›[:ð­]
        NÌ„ = Î¾áµ¤[:ð­]
        nâ‚ = Î¾áµ¤.nâ‚
        nâ‚‚ = Î¾áµ¤.nâ‚‚
        nâ‚ƒ = Î¾áµ¤.nâ‚ƒ

        
        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[6*I-5,3*J-2] -= N[i]*nâ‚*NÌ„[j]*ð‘¤
                k[6*I-4,3*J-1] -= N[i]*nâ‚‚*NÌ„[j]*ð‘¤
                k[6*I-3,3*J]   -= N[i]*nâ‚ƒ*NÌ„[j]*ð‘¤

                k[6*I-2,3*J-2] -= N[i]*nâ‚‚*NÌ„[j]*ð‘¤
                k[6*I-2,3*J-1] -=  N[i]*nâ‚*NÌ„[j]*ð‘¤

                k[6*I-1,3*J-1] -=  N[i]*nâ‚ƒ*NÌ„[j]*ð‘¤
                k[6*I-1,3*J]   -=  N[i]*nâ‚‚*NÌ„[j]*ð‘¤

                k[6*I,3*J-2]   -=  N[i]*nâ‚ƒ*NÌ„[j]*ð‘¤
                k[6*I,3*J]     -=  N[i]*nâ‚*NÌ„[j]*ð‘¤
            
            end

        end
   


    end
end


function âˆ«CÎµáµ¢â±¼nâ±¼uáµ¢ds(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    for (Î¾â‚›,Î¾áµ¤) in zip(ð“–â‚›,ð“–áµ¤)
        ð‘¤ = Î¾â‚›.ð‘¤
        # ð‘¤ = Î¾áµ¤.ð‘¤

        N = Î¾â‚›[:ð­]
        NÌ„ = Î¾áµ¤[:ð­]
        nâ‚ = Î¾áµ¤.nâ‚
        nâ‚‚ = Î¾áµ¤.nâ‚‚
        E = Î¾áµ¤.E
        Î½ = Î¾áµ¤.Î½
        Cáµ¢áµ¢áµ¢áµ¢ = E/(1-Î½^2)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-Î½^2)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)

        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[3*I-2,2*J-1] -= Cáµ¢áµ¢áµ¢áµ¢*N[i]*nâ‚*NÌ„[j]*ð‘¤
                k[3*I-2,2*J]   -= Cáµ¢áµ¢â±¼â±¼*N[i]*nâ‚‚*NÌ„[j]*ð‘¤
                k[3*I-1,2*J-1] -= Cáµ¢áµ¢â±¼â±¼*N[i]*nâ‚*NÌ„[j]*ð‘¤
                k[3*I-1,2*J]   -= Cáµ¢áµ¢áµ¢áµ¢*N[i]*nâ‚‚*NÌ„[j]*ð‘¤
                k[3*I,2*J-1]   -= Cáµ¢â±¼áµ¢â±¼*N[i]*nâ‚‚*NÌ„[j]*ð‘¤
                k[3*I,2*J]     -= Cáµ¢â±¼áµ¢â±¼*N[i]*nâ‚*NÌ„[j]*ð‘¤
            end
        end
    end
end

function âˆ«CáµˆÎµáµ¢â±¼nâ±¼uáµ¢ds(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    for (Î¾â‚›,Î¾áµ¤) in zip(ð“–â‚›,ð“–áµ¤)
        ð‘¤ = Î¾â‚›.ð‘¤
        # ð‘¤ = Î¾áµ¤.ð‘¤

        N = Î¾â‚›[:ð­]
        NÌ„ = Î¾áµ¤[:ð­]
        nâ‚ = Î¾áµ¤.nâ‚
        nâ‚‚ = Î¾áµ¤.nâ‚‚
        EÌ„ = Î¾áµ¤.EÌ„
        Î½Ì„  = Î¾áµ¤.Î½Ì„ 
        Cáµˆ = EÌ„/(1+Î½Ì„ )
        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[3*I-2,2*J-1] -= 2/3*Cáµˆ*N[i]*nâ‚*NÌ„[j]*ð‘¤
                k[3*I-2,2*J]   += 1/3*Cáµˆ*N[i]*nâ‚‚*NÌ„[j]*ð‘¤
                k[3*I-1,2*J-1] += 1/3*Cáµˆ*N[i]*nâ‚*NÌ„[j]*ð‘¤
                k[3*I-1,2*J]   -= 2/3*Cáµˆ*N[i]*nâ‚‚*NÌ„[j]*ð‘¤
                k[3*I,2*J-1]   -= 1/2*Cáµˆ*N[i]*nâ‚‚*NÌ„[j]*ð‘¤
                k[3*I,2*J]     -= 1/2*Cáµˆ*N[i]*nâ‚*NÌ„[j]*ð‘¤
            end
        end
    end
end

function âˆ«Cáµ›Îµáµ¢â±¼nâ±¼uáµ¢ds(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    for (Î¾â‚›,Î¾áµ¤) in zip(ð“–â‚›,ð“–áµ¤)
        ð‘¤ = Î¾â‚›.ð‘¤
        # ð‘¤ = Î¾áµ¤.ð‘¤

        N = Î¾â‚›[:ð­]
        NÌ„ = Î¾áµ¤[:ð­]
        nâ‚ = Î¾áµ¤.nâ‚
        nâ‚‚ = Î¾áµ¤.nâ‚‚
        
        EÌ„ = Î¾áµ¤.EÌ„
        Î½Ì„  = Î¾áµ¤.Î½Ì„ 
        Cáµ› = EÌ„/(1-2*Î½Ì„ )
        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[3*I-2,2*J-1] -= 1/3*Cáµ›*N[i]*nâ‚*NÌ„[j]*ð‘¤
                k[3*I-2,2*J]   -= 1/3*Cáµ›*N[i]*nâ‚‚*NÌ„[j]*ð‘¤
                k[3*I-1,2*J-1] -= 1/3*Cáµ›*N[i]*nâ‚*NÌ„[j]*ð‘¤
                k[3*I-1,2*J]   -= 1/3*Cáµ›*N[i]*nâ‚‚*NÌ„[j]*ð‘¤
                
            end
        end
    end
end


function âˆ«âˆ«âˆ‡Ïƒáµ¢â±¼uáµ¢dxdy(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    for (Î¾â‚›,Î¾áµ¤) in zip(ð“–â‚›,ð“–áµ¤)
        # ð‘¤ = Î¾â‚›.ð‘¤
        ð‘¤ = Î¾áµ¤.ð‘¤
        Bâ‚ = Î¾â‚›[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾â‚›[:âˆ‚ð­âˆ‚y]
        N = Î¾áµ¤[:ð­]
        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[3*I-2,2*J-1] += Bâ‚[i]*N[j]*ð‘¤
                k[3*I-1,2*J]   += Bâ‚‚[i]*N[j]*ð‘¤
                k[3*I,2*J-1]   += Bâ‚‚[i]*N[j]*ð‘¤
                k[3*I,2*J]     += Bâ‚[i]*N[j]*ð‘¤
            end
        end
    end
end

function âˆ«âˆ«âˆ‡Ïƒáµ¢â±¼uáµ¢dÎ©(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    for (Î¾â‚›,Î¾áµ¤) in zip(ð“–â‚›,ð“–áµ¤)
        # ð‘¤ = Î¾â‚›.ð‘¤
        ð‘¤ = Î¾áµ¤.ð‘¤
        Bâ‚ = Î¾â‚›[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾â‚›[:âˆ‚ð­âˆ‚y]
        Bâ‚ƒ = Î¾â‚›[:âˆ‚ð­âˆ‚z]
        N = Î¾áµ¤[:ð­]
        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
               
                k[6*I-5,3*J-2] += Bâ‚[i]*N[j]*ð‘¤
                k[6*I-4,3*J-1] += Bâ‚‚[i]*N[j]*ð‘¤
                k[6*I-3,3*J]   += Bâ‚ƒ[i]*N[j]*ð‘¤
                k[6*I-2,3*J-2] += Bâ‚‚[i]*N[j]*ð‘¤
                k[6*I-2,3*J-1] += Bâ‚[i]*N[j]*ð‘¤
                k[6*I-1,3*J-1] += Bâ‚ƒ[i]*N[j]*ð‘¤
                k[6*I-1,3*J]   += Bâ‚‚[i]*N[j]*ð‘¤
                k[6*I,3*J-2]   += Bâ‚ƒ[i]*N[j]*ð‘¤
                k[6*I,3*J]     += Bâ‚[i]*N[j]*ð‘¤


            end
        end
    end
end
function âˆ«pâˆ‡udÎ©(aâ‚š::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    ð“’â‚š = aâ‚š.ð“’;ð“–â‚š = aâ‚š.ð“–
    for (Î¾áµ¤,Î¾â‚š) in zip(ð“–áµ¤,ð“–â‚š)
        N = Î¾â‚š[:ð­]
        Bâ‚ = Î¾áµ¤[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾áµ¤[:âˆ‚ð­âˆ‚y]
        Bâ‚ƒ = Î¾áµ¤[:âˆ‚ð­âˆ‚z]
        ð‘¤ = Î¾áµ¤.ð‘¤
        for (i,xáµ¢) in enumerate(ð“’â‚š)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[I,3*J-2] -= N[i]*Bâ‚[j]*ð‘¤
                k[I,3*J-1] -= N[i]*Bâ‚‚[j]*ð‘¤
                k[I,3*J]   -= N[i]*Bâ‚ƒ[j]*ð‘¤
            end
        end
    end
end

function âˆ«âˆ«Câˆ‡Îµáµ¢â±¼uáµ¢dxdy(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    for (Î¾â‚›,Î¾áµ¤) in zip(ð“–â‚›,ð“–áµ¤)
        ð‘¤ = Î¾â‚›.ð‘¤
        # ð‘¤ = Î¾áµ¤.ð‘¤
        Bâ‚ = Î¾â‚›[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾â‚›[:âˆ‚ð­âˆ‚y]
        N = Î¾áµ¤[:ð­]
        E = Î¾â‚›.E
        Î½ = Î¾â‚›.Î½
        Cáµ¢áµ¢áµ¢áµ¢ = E/(1-Î½^2)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-Î½^2)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[3*I-2,2*J-1] += Cáµ¢áµ¢áµ¢áµ¢*Bâ‚[i]*N[j]*ð‘¤
                k[3*I-2,2*J]   += Cáµ¢áµ¢â±¼â±¼*Bâ‚‚[i]*N[j]*ð‘¤
                k[3*I-1,2*J-1] += Cáµ¢áµ¢â±¼â±¼*Bâ‚[i]*N[j]*ð‘¤
                k[3*I-1,2*J]   += Cáµ¢áµ¢áµ¢áµ¢*Bâ‚‚[i]*N[j]*ð‘¤
                k[3*I,2*J-1]   += Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*N[j]*ð‘¤
                k[3*I,2*J]     += Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*N[j]*ð‘¤
            end
        end
    end
end

function âˆ«âˆ«Cáµˆâˆ‡Îµáµ¢â±¼uáµ¢dxdy(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    for (Î¾â‚›,Î¾áµ¤) in zip(ð“–â‚›,ð“–áµ¤)
        ð‘¤ = Î¾â‚›.ð‘¤
        # ð‘¤ = Î¾áµ¤.ð‘¤
        Bâ‚ = Î¾â‚›[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾â‚›[:âˆ‚ð­âˆ‚y]
        N = Î¾áµ¤[:ð­]

        EÌ„ = Î¾â‚›.EÌ„
        Î½Ì„  = Î¾â‚›.Î½Ì„ 
        Cáµˆ = EÌ„/(1+Î½Ì„ )
        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[3*I-2,2*J-1] += 2/3*Cáµˆ*Bâ‚[i]*N[j]*ð‘¤
                k[3*I-2,2*J]   -= 1/3*Cáµˆ*Bâ‚‚[i]*N[j]*ð‘¤
                k[3*I-1,2*J-1] -= 1/3*Cáµˆ*Bâ‚[i]*N[j]*ð‘¤
                k[3*I-1,2*J]   += 2/3*Cáµˆ*Bâ‚‚[i]*N[j]*ð‘¤
                k[3*I,2*J-1]   += 1/2*Cáµˆ*Bâ‚‚[i]*N[j]*ð‘¤
                k[3*I,2*J]     += 1/2*Cáµˆ*Bâ‚[i]*N[j]*ð‘¤
            end
        end
    end
end
function âˆ«âˆ«Cáµ›âˆ‡Îµáµ¢â±¼uáµ¢dxdy(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    for (Î¾â‚›,Î¾áµ¤) in zip(ð“–â‚›,ð“–áµ¤)
        ð‘¤ = Î¾â‚›.ð‘¤
        # ð‘¤ = Î¾áµ¤.ð‘¤
        Bâ‚ = Î¾â‚›[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾â‚›[:âˆ‚ð­âˆ‚y]
        N = Î¾áµ¤[:ð­]
        EÌ„ = Î¾â‚›.EÌ„
        Î½Ì„  = Î¾â‚›.Î½Ì„ 
        Cáµ› = EÌ„/(1-2*Î½Ì„ )
        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[3*I-2,2*J-1] += 1/3*Cáµ›*Bâ‚[i]*N[j]*ð‘¤
                k[3*I-2,2*J]   += 1/3*Cáµ›*Bâ‚‚[i]*N[j]*ð‘¤
                k[3*I-1,2*J-1] += 1/3*Cáµ›*Bâ‚[i]*N[j]*ð‘¤
                k[3*I-1,2*J]   += 1/3*Cáµ›*Bâ‚‚[i]*N[j]*ð‘¤
                
            end
        end
    end
end
function âˆ«âˆ«váµ¢báµ¢dxdy(ap::T,f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        N = Î¾[:ð­]
        ð‘¤ = Î¾.ð‘¤
        bâ‚ = Î¾.bâ‚
        bâ‚‚ = Î¾.bâ‚‚
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            f[2*I-1] += N[i]*bâ‚*ð‘¤
            f[2*I]   += N[i]*bâ‚‚*ð‘¤
        end
    end
end

function âˆ«váµ¢báµ¢dÎ©(ap::T,f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        N = Î¾[:ð­]
        ð‘¤ = Î¾.ð‘¤
        bâ‚ = Î¾.bâ‚
        bâ‚‚ = Î¾.bâ‚‚
        bâ‚ƒ = Î¾.bâ‚ƒ
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            f[3*I-2] += N[i]*bâ‚*ð‘¤
            f[3*I-1] += N[i]*bâ‚‚*ð‘¤
            f[3*I]   += N[i]*bâ‚ƒ*ð‘¤
        end
    end
end

function âˆ«váµ¢táµ¢ds(ap::T,f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        N = Î¾[:ð­]
        ð‘¤ = Î¾.ð‘¤
        tâ‚ = Î¾.tâ‚
        tâ‚‚ = Î¾.tâ‚‚
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            f[2*I-1] += N[i]*tâ‚*ð‘¤
            f[2*I]   += N[i]*tâ‚‚*ð‘¤
        end
    end
end

function âˆ«váµ¢táµ¢dÎ“(ap::T,f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        N = Î¾[:ð­]
        ð‘¤ = Î¾.ð‘¤
        tâ‚ = Î¾.tâ‚
        tâ‚‚ = Î¾.tâ‚‚
        tâ‚ƒ = Î¾.tâ‚ƒ
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            f[3*I-2] += N[i]*tâ‚*ð‘¤
            f[3*I-1] += N[i]*tâ‚‚*ð‘¤
            f[3*I]   += N[i]*tâ‚ƒ*ð‘¤
        end
    end
end

function âˆ«qpdÎ©(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        ð‘¤ = Î¾.ð‘¤
        N = Î¾[:ð­]
        E = Î¾.E
        Î½ = Î¾.Î½
        K = E/3/(1-2*Î½)
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[I,J] += N[i]*N[j]/K*ð‘¤
            end
        end
    end
end

function âˆ«âˆ«pâˆ‡udxdy(aâ‚š::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    ð“’â‚š = aâ‚š.ð“’;ð“–â‚š = aâ‚š.ð“–
    for (Î¾áµ¤,Î¾â‚š) in zip(ð“–áµ¤,ð“–â‚š)
        N = Î¾â‚š[:ð­]
        Bâ‚ = Î¾áµ¤[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾áµ¤[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾áµ¤.ð‘¤
        # ð‘¤ = Î¾â‚š.ð‘¤
        for (i,xáµ¢) in enumerate(ð“’â‚š)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[I,2*J-1] -= N[i]*Bâ‚[j]*ð‘¤
                k[I,2*J]   -= N[i]*Bâ‚‚[j]*ð‘¤
            end
        end
    end
end

function âˆ«âˆ«âˆ‡puáµ¢dxdy(aâ‚š::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    ð“’â‚š = aâ‚š.ð“’;ð“–â‚š = aâ‚š.ð“–
    for (Î¾áµ¤,Î¾â‚š) in zip(ð“–áµ¤,ð“–â‚š)
        Bâ‚ = Î¾â‚š[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾â‚š[:âˆ‚ð­âˆ‚y]
        N = Î¾áµ¤[:ð­]
        ð‘¤ = Î¾áµ¤.ð‘¤
        for (i,xáµ¢) in enumerate(ð“’â‚š)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[I,2*J-1] += Bâ‚[i]*N[j]*ð‘¤
                k[I,2*J]   += Bâ‚‚[i]*N[j]*ð‘¤
            end
        end
    end
end

function âˆ«pnáµ¢uáµ¢ds(aâ‚š::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    ð“’â‚š = aâ‚š.ð“’;ð“–â‚š = aâ‚š.ð“–
    for (Î¾áµ¤,Î¾â‚š) in zip(ð“–áµ¤,ð“–â‚š)
        Nâ‚š = Î¾â‚š[:ð­]
        Náµ¤ = Î¾áµ¤[:ð­]
        nâ‚ = Î¾áµ¤.nâ‚
        nâ‚‚ = Î¾áµ¤.nâ‚‚
        ð‘¤ = Î¾áµ¤.ð‘¤
        # ð‘¤ = Î¾â‚š.ð‘¤
        for (i,xáµ¢) in enumerate(ð“’â‚š)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[I,2*J-1] -= Nâ‚š[i]*Náµ¤[j]*nâ‚*ð‘¤
                k[I,2*J]   -= Nâ‚š[i]*Náµ¤[j]*nâ‚‚*ð‘¤
            end
        end
    end
end

function âˆ«pnáµ¢gáµ¢ds(aâ‚š::T,aáµ¤::S,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    ð“’â‚š = aâ‚š.ð“’;ð“–â‚š = aâ‚š.ð“–
    for (Î¾áµ¤,Î¾â‚š) in zip(ð“–áµ¤,ð“–â‚š)
        Nâ‚š = Î¾â‚š[:ð­]
        Náµ¤ = Î¾áµ¤[:ð­]
        nâ‚ = Î¾áµ¤.nâ‚
        nâ‚‚ = Î¾áµ¤.nâ‚‚
        gâ‚ = Î¾áµ¤.gâ‚
        gâ‚‚ = Î¾áµ¤.gâ‚‚
        nâ‚â‚ = Î¾áµ¤.nâ‚â‚
        nâ‚â‚‚ = Î¾áµ¤.nâ‚â‚‚
        nâ‚‚â‚‚ = Î¾áµ¤.nâ‚‚â‚‚
        ð‘¤ = Î¾áµ¤.ð‘¤
        # ð‘¤ = Î¾â‚š.ð‘¤
        for (i,xáµ¢) in enumerate(ð“’â‚š)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[I,2*J-1] += Nâ‚š[i]*Náµ¤[j]*(nâ‚*nâ‚â‚+nâ‚‚*nâ‚â‚‚)*ð‘¤
                k[I,2*J]   += Nâ‚š[i]*Náµ¤[j]*(nâ‚*nâ‚â‚‚+nâ‚‚*nâ‚‚â‚‚)*ð‘¤
            end
            f[I] += Nâ‚š[i]*(nâ‚*nâ‚â‚*gâ‚+nâ‚*nâ‚â‚‚*gâ‚‚+nâ‚‚*nâ‚â‚‚*gâ‚+nâ‚‚*nâ‚‚â‚‚*gâ‚‚)*ð‘¤
        end
    end
end

function âˆ«âˆ«sáµ¢â±¼sáµ¢â±¼dxdy(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        ð‘¤ = Î¾.ð‘¤
        N = Î¾[:ð­]
        E = Î¾.E
        Î½ = Î¾.Î½
        G = E/(1+Î½)
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[4*I-3,4*J-3] +=   N[i]*N[j]/G*ð‘¤
                k[4*I-2,4*J-2] +=   N[i]*N[j]/G*ð‘¤
                k[4*I-1,4*J-1] +=   N[i]*N[j]/G*ð‘¤
                k[4*I,4*J]     += 2*N[i]*N[j]/G*ð‘¤
            end
        end
    end
end

function âˆ«âˆ«sáµ¢â±¼Îµáµ¢â±¼dxdy(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    for (Î¾áµ¤,Î¾â‚›) in zip(ð“–áµ¤,ð“–â‚›)
        N = Î¾â‚›[:ð­]
        Bâ‚ = Î¾áµ¤[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾áµ¤[:âˆ‚ð­âˆ‚y]
        ð‘¤ = Î¾áµ¤.ð‘¤
        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[4*I-3,2*J-1] -= 2/3*N[i]*Bâ‚[j]*ð‘¤
                k[4*I-3,2*J]   += 1/3*N[i]*Bâ‚‚[j]*ð‘¤
                k[4*I-2,2*J-1] += 1/3*N[i]*Bâ‚[j]*ð‘¤
                k[4*I-2,2*J]   -= 2/3*N[i]*Bâ‚‚[j]*ð‘¤
                k[4*I-1,2*J-1] += 1/3*N[i]*Bâ‚[j]*ð‘¤
                k[4*I-1,2*J]   += 1/3*N[i]*Bâ‚‚[j]*ð‘¤
                k[4*I,2*J-1]   -=     N[i]*Bâ‚‚[j]*ð‘¤
                k[4*I,2*J]     -=     N[i]*Bâ‚[j]*ð‘¤
            end
        end
    end
end

function âˆ«âˆ«âˆ‡sáµ¢â±¼uáµ¢dxdy(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    for (Î¾áµ¤,Î¾â‚›) in zip(ð“–áµ¤,ð“–â‚›)
        Bâ‚ = Î¾â‚›[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾â‚›[:âˆ‚ð­âˆ‚y]
        Náµ¤ = Î¾áµ¤[:ð­]
        ð‘¤ = Î¾áµ¤.ð‘¤
        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[4*I-3,2*J-1] += 2/3*Bâ‚[i]*Náµ¤[j]*ð‘¤
                k[4*I-3,2*J]   -= 1/3*Bâ‚‚[i]*Náµ¤[j]*ð‘¤
                k[4*I-2,2*J-1] -= 1/3*Bâ‚[i]*Náµ¤[j]*ð‘¤
                k[4*I-2,2*J]   += 2/3*Bâ‚‚[i]*Náµ¤[j]*ð‘¤
                k[4*I-1,2*J-1] -= 1/3*Bâ‚[i]*Náµ¤[j]*ð‘¤
                k[4*I-1,2*J]   -= 1/3*Bâ‚‚[i]*Náµ¤[j]*ð‘¤
                k[4*I,2*J-1]   += Bâ‚‚[i]*Náµ¤[j]*ð‘¤
                k[4*I,2*J]     += Bâ‚[i]*Náµ¤[j]*ð‘¤
            end
        end
    end
end

function âˆ«sáµ¢â±¼nâ±¼uáµ¢ds(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    for (Î¾áµ¤,Î¾â‚›) in zip(ð“–áµ¤,ð“–â‚›)
        Nâ‚› = Î¾â‚›[:ð­]
        Náµ¤ = Î¾áµ¤[:ð­]
        nâ‚ = Î¾áµ¤.nâ‚
        nâ‚‚ = Î¾áµ¤.nâ‚‚
        ð‘¤ = Î¾áµ¤.ð‘¤
        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[4*I-3,2*J-1] -= 2/3*Nâ‚›[i]*Náµ¤[j]*nâ‚*ð‘¤
                k[4*I-3,2*J]   += 1/3*Nâ‚›[i]*Náµ¤[j]*nâ‚‚*ð‘¤
                k[4*I-2,2*J-1] += 1/3*Nâ‚›[i]*Náµ¤[j]*nâ‚*ð‘¤
                k[4*I-2,2*J]   -= 2/3*Nâ‚›[i]*Náµ¤[j]*nâ‚‚*ð‘¤
                k[4*I-1,2*J-1] += 1/3*Nâ‚›[i]*Náµ¤[j]*nâ‚*ð‘¤
                k[4*I-1,2*J]   += 1/3*Nâ‚›[i]*Náµ¤[j]*nâ‚‚*ð‘¤
                k[4*I,2*J-1]   -= Nâ‚›[i]*Náµ¤[j]*nâ‚‚*ð‘¤
                k[4*I,2*J]     -= Nâ‚›[i]*Náµ¤[j]*nâ‚*ð‘¤
            end
        end
    end
end

function âˆ«sáµ¢â±¼nâ±¼gáµ¢ds(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    for (Î¾áµ¤,Î¾â‚›) in zip(ð“–áµ¤,ð“–â‚›)
        Nâ‚› = Î¾â‚›[:ð­]
        Náµ¤ = Î¾áµ¤[:ð­]
        nâ‚ = Î¾áµ¤.nâ‚
        nâ‚‚ = Î¾áµ¤.nâ‚‚
        gâ‚ = Î¾áµ¤.gâ‚
        gâ‚‚ = Î¾áµ¤.gâ‚‚
        nâ‚â‚ = Î¾áµ¤.nâ‚â‚
        nâ‚â‚‚ = Î¾áµ¤.nâ‚â‚‚
        nâ‚‚â‚‚ = Î¾áµ¤.nâ‚‚â‚‚
        ð‘¤ = Î¾áµ¤.ð‘¤
        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[4*I-3,2*J-1] += Nâ‚›[i]*Náµ¤[j]*( 2/3*nâ‚*nâ‚â‚ - 1/3*nâ‚‚*nâ‚â‚‚)*ð‘¤
                k[4*I-3,2*J]   += Nâ‚›[i]*Náµ¤[j]*( 2/3*nâ‚*nâ‚â‚‚ - 1/3*nâ‚‚*nâ‚‚â‚‚)*ð‘¤
                k[4*I-2,2*J-1] += Nâ‚›[i]*Náµ¤[j]*(-1/3*nâ‚*nâ‚â‚ + 2/3*nâ‚‚*nâ‚â‚‚)*ð‘¤
                k[4*I-2,2*J]   += Nâ‚›[i]*Náµ¤[j]*(-1/3*nâ‚*nâ‚â‚‚ + 2/3*nâ‚‚*nâ‚‚â‚‚)*ð‘¤
                k[4*I-1,2*J-1] += Nâ‚›[i]*Náµ¤[j]*(-1/3*nâ‚*nâ‚â‚ - 1/3*nâ‚‚*nâ‚â‚‚)*ð‘¤
                k[4*I-1,2*J]   += Nâ‚›[i]*Náµ¤[j]*(-1/3*nâ‚*nâ‚â‚‚ - 1/3*nâ‚‚*nâ‚‚â‚‚)*ð‘¤
                k[4*I,2*J-1]   += Nâ‚›[i]*Náµ¤[j]*(nâ‚*nâ‚â‚‚ + nâ‚‚*nâ‚â‚)*ð‘¤
                k[4*I,2*J]     += Nâ‚›[i]*Náµ¤[j]*(nâ‚*nâ‚‚â‚‚ + nâ‚‚*nâ‚â‚‚)*ð‘¤
            end
            f[4*I-3] += Nâ‚›[i]*(( 2/3*nâ‚*nâ‚â‚-1/3*nâ‚‚*nâ‚â‚‚)*gâ‚+( 2/3*nâ‚*nâ‚â‚‚-1/3*nâ‚‚*nâ‚‚â‚‚)*gâ‚‚)*ð‘¤
            f[4*I-2] += Nâ‚›[i]*((-1/3*nâ‚*nâ‚â‚+2/3*nâ‚‚*nâ‚â‚‚)*gâ‚+(-1/3*nâ‚*nâ‚â‚‚+2/3*nâ‚‚*nâ‚‚â‚‚)*gâ‚‚)*ð‘¤
            f[4*I-1] += Nâ‚›[i]*((-1/3*nâ‚*nâ‚â‚-1/3*nâ‚‚*nâ‚â‚‚)*gâ‚+(-1/3*nâ‚*nâ‚â‚‚-1/3*nâ‚‚*nâ‚‚â‚‚)*gâ‚‚)*ð‘¤
            f[4*I]   += Nâ‚›[i]*((nâ‚*nâ‚â‚‚+nâ‚‚*nâ‚â‚)*gâ‚+(nâ‚*nâ‚‚â‚‚+nâ‚‚*nâ‚â‚‚)*gâ‚‚)*ð‘¤
        end
    end
end


function gâ‚‚(ap::T,k::AbstractMatrix{Float64},f::AbstractVector{Float64},dof::Symbol) where T<:AbstractElement
    x, = ap.ð“’
    if dof == :dâ‚
        j = 2*x.ð¼-1
    else
        j = 2*x.ð¼
    end
    g = getproperty(x,dof)
    for i in eachindex(f)
        f[i] -= k[i,j]*g
    end
    k[j,:] .= 0.
    k[:,j] .= 0.
    k[j,j] = 1.
    f[j] = g
end

function âˆ«Î»áµ¢gáµ¢ds(aâ‚—::T,aáµ¤::S,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’â‚— = aâ‚—.ð“’;ð“–â‚— = aâ‚—.ð“–
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    for (Î¾â‚—,Î¾áµ¤) in zip(ð“–â‚—,ð“–áµ¤)
        ð‘¤ = Î¾â‚—.ð‘¤
        NÌ„ = Î¾â‚—[:ð­]
        N = Î¾áµ¤[:ð­]
        gâ‚ = Î¾áµ¤.gâ‚
        gâ‚‚ = Î¾áµ¤.gâ‚‚
        nâ‚â‚ = Î¾áµ¤.nâ‚â‚
        nâ‚‚â‚‚ = Î¾áµ¤.nâ‚‚â‚‚
        nâ‚â‚‚ = Î¾áµ¤.nâ‚â‚‚
        for (i,xáµ¢) in enumerate(ð“’â‚—)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                k[2*I-1,2*J-1] -= nâ‚â‚*NÌ„[i]*N[j]*ð‘¤
                k[2*I-1,2*J]   -= nâ‚â‚‚*NÌ„[i]*N[j]*ð‘¤
                k[2*I,2*J-1]   -= nâ‚â‚‚*NÌ„[i]*N[j]*ð‘¤
                k[2*I,2*J]     -= nâ‚‚â‚‚*NÌ„[i]*N[j]*ð‘¤
            end
            f[2*I-1] -= NÌ„[i]*(nâ‚â‚*gâ‚+nâ‚â‚‚*gâ‚‚)*ð‘¤
            f[2*I]   -= NÌ„[i]*(nâ‚â‚‚*gâ‚+nâ‚‚â‚‚*gâ‚‚)*ð‘¤
        end
    end
end

function âˆ«Ïƒáµ¢â±¼nâ±¼gáµ¢ds(ap::T,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        ð‘¤ = Î¾.ð‘¤
        N = Î¾[:ð­]
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        nâ‚â‚ = Î¾.nâ‚â‚
        nâ‚â‚‚ = Î¾.nâ‚â‚‚
        nâ‚‚â‚‚ = Î¾.nâ‚‚â‚‚
        gâ‚ = Î¾.gâ‚
        gâ‚‚ = Î¾.gâ‚‚
        nâ‚ = Î¾.nâ‚
        nâ‚‚ = Î¾.nâ‚‚
        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµ¢áµ¢áµ¢áµ¢ = E/(1-Î½^2)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-Î½^2)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
        Câ‚â‚â‚ = Cáµ¢áµ¢áµ¢áµ¢*nâ‚*nâ‚â‚+Cáµ¢áµ¢â±¼â±¼*nâ‚‚*nâ‚â‚‚
        Câ‚â‚â‚‚ = Cáµ¢áµ¢áµ¢áµ¢*nâ‚*nâ‚â‚‚+Cáµ¢áµ¢â±¼â±¼*nâ‚‚*nâ‚‚â‚‚
        Câ‚‚â‚‚â‚ = Cáµ¢áµ¢â±¼â±¼*nâ‚*nâ‚â‚+Cáµ¢áµ¢áµ¢áµ¢*nâ‚‚*nâ‚â‚‚
        Câ‚‚â‚‚â‚‚ = Cáµ¢áµ¢â±¼â±¼*nâ‚*nâ‚â‚‚+Cáµ¢áµ¢áµ¢áµ¢*nâ‚‚*nâ‚‚â‚‚
        Câ‚â‚‚â‚ = Cáµ¢â±¼áµ¢â±¼*(nâ‚*nâ‚â‚‚+nâ‚‚*nâ‚â‚)
        Câ‚â‚‚â‚‚ = Cáµ¢â±¼áµ¢â±¼*(nâ‚‚*nâ‚â‚‚+nâ‚*nâ‚‚â‚‚)
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[2*I-1,2*J-1] -= (Câ‚â‚â‚*(N[i]*Bâ‚[j]+Bâ‚[i]*N[j]) + Câ‚â‚‚â‚*(N[i]*Bâ‚‚[j]+Bâ‚‚[i]*N[j]))*ð‘¤
                k[2*I-1,2*J]   -= (Câ‚â‚‚â‚*N[i]*Bâ‚[j] + Câ‚â‚â‚‚*Bâ‚[i]*N[j] + Câ‚‚â‚‚â‚*N[i]*Bâ‚‚[j] + Câ‚â‚‚â‚‚*Bâ‚‚[i]*N[j])*ð‘¤
                k[2*I,2*J-1]   -= (Câ‚â‚â‚‚*N[i]*Bâ‚[j] + Câ‚â‚‚â‚*Bâ‚[i]*N[j] + Câ‚â‚‚â‚‚*N[i]*Bâ‚‚[j] + Câ‚‚â‚‚â‚*Bâ‚‚[i]*N[j])*ð‘¤
                k[2*I,2*J]     -= (Câ‚â‚‚â‚‚*(N[i]*Bâ‚[j]+Bâ‚[i]*N[j]) + Câ‚‚â‚‚â‚‚*(N[i]*Bâ‚‚[j]+Bâ‚‚[i]*N[j]))*ð‘¤
            end
            f[2*I-1] -= ((Câ‚â‚â‚*Bâ‚[i]+Câ‚â‚‚â‚*Bâ‚‚[i])*gâ‚ + (Câ‚â‚â‚‚*Bâ‚[i]+Câ‚â‚‚â‚‚*Bâ‚‚[i])*gâ‚‚)*ð‘¤
            f[2*I]   -= ((Câ‚â‚‚â‚*Bâ‚[i]+Câ‚‚â‚‚â‚*Bâ‚‚[i])*gâ‚ + (Câ‚â‚‚â‚‚*Bâ‚[i]+Câ‚‚â‚‚â‚‚*Bâ‚‚[i])*gâ‚‚)*ð‘¤
        end
    end
end

function âˆ«Ïƒáµ¢â±¼nâ±¼gáµ¢váµ¢gáµ¢ds(ap::T,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        ð‘¤ = Î¾.ð‘¤
        N = Î¾[:ð­]
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        nâ‚â‚ = Î¾.nâ‚â‚
        nâ‚â‚‚ = Î¾.nâ‚â‚‚
        nâ‚‚â‚‚ = Î¾.nâ‚‚â‚‚
        gâ‚ = Î¾.gâ‚
        gâ‚‚ = Î¾.gâ‚‚
        nâ‚ = Î¾.nâ‚
        nâ‚‚ = Î¾.nâ‚‚
        E = Î¾.E
        Î½ = Î¾.Î½
        Î± = Î¾.Î±
        Cáµ¢áµ¢áµ¢áµ¢ = E/(1-Î½^2)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-Î½^2)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
        Câ‚â‚â‚ = Cáµ¢áµ¢áµ¢áµ¢*nâ‚*nâ‚â‚+Cáµ¢áµ¢â±¼â±¼*nâ‚‚*nâ‚â‚‚
        Câ‚â‚â‚‚ = Cáµ¢áµ¢áµ¢áµ¢*nâ‚*nâ‚â‚‚+Cáµ¢áµ¢â±¼â±¼*nâ‚‚*nâ‚‚â‚‚
        Câ‚‚â‚‚â‚ = Cáµ¢áµ¢â±¼â±¼*nâ‚*nâ‚â‚+Cáµ¢áµ¢áµ¢áµ¢*nâ‚‚*nâ‚â‚‚
        Câ‚‚â‚‚â‚‚ = Cáµ¢áµ¢â±¼â±¼*nâ‚*nâ‚â‚‚+Cáµ¢áµ¢áµ¢áµ¢*nâ‚‚*nâ‚‚â‚‚
        Câ‚â‚‚â‚ = Cáµ¢â±¼áµ¢â±¼*(nâ‚*nâ‚â‚‚+nâ‚‚*nâ‚â‚)
        Câ‚â‚‚â‚‚ = Cáµ¢â±¼áµ¢â±¼*(nâ‚‚*nâ‚â‚‚+nâ‚*nâ‚‚â‚‚)
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[2*I-1,2*J-1] -= (Câ‚â‚â‚*(N[i]*Bâ‚[j]+Bâ‚[i]*N[j]) + Câ‚â‚‚â‚*(N[i]*Bâ‚‚[j]+Bâ‚‚[i]*N[j]) - Î±*N[i]*nâ‚â‚*N[j])*ð‘¤
                k[2*I-1,2*J]   -= (Câ‚â‚‚â‚*N[i]*Bâ‚[j] + Câ‚â‚â‚‚*Bâ‚[i]*N[j] + Câ‚‚â‚‚â‚*N[i]*Bâ‚‚[j] + Câ‚â‚‚â‚‚*Bâ‚‚[i]*N[j] -Î±*N[i]*nâ‚â‚‚*N[j])*ð‘¤
                k[2*I,2*J-1]   -= (Câ‚â‚â‚‚*N[i]*Bâ‚[j] + Câ‚â‚‚â‚*Bâ‚[i]*N[j] + Câ‚â‚‚â‚‚*N[i]*Bâ‚‚[j] + Câ‚‚â‚‚â‚*Bâ‚‚[i]*N[j] -Î±*N[i]*nâ‚â‚‚*N[j])*ð‘¤
                k[2*I,2*J]     -= (Câ‚â‚‚â‚‚*(N[i]*Bâ‚[j]+Bâ‚[i]*N[j]) + Câ‚‚â‚‚â‚‚*(N[i]*Bâ‚‚[j]+Bâ‚‚[i]*N[j]) -Î±*N[i]*nâ‚‚â‚‚*N[j])*ð‘¤
            end
            f[2*I-1] -= ((Câ‚â‚â‚*Bâ‚[i]+Câ‚â‚‚â‚*Bâ‚‚[i]-Î±*N[i]*nâ‚â‚)*gâ‚ + (Câ‚â‚â‚‚*Bâ‚[i]+Câ‚â‚‚â‚‚*Bâ‚‚[i]-Î±*N[i]*nâ‚â‚‚)*gâ‚‚)*ð‘¤
            f[2*I]   -= ((Câ‚â‚‚â‚*Bâ‚[i]+Câ‚‚â‚‚â‚*Bâ‚‚[i]-Î±*N[i]*nâ‚â‚‚)*gâ‚ + (Câ‚â‚‚â‚‚*Bâ‚[i]+Câ‚‚â‚‚â‚‚*Bâ‚‚[i]-Î±*N[i]*nâ‚‚â‚‚)*gâ‚‚)*ð‘¤
        end
    end
end

function âˆ«váµ¢gáµ¢ds(ap::T,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        ð‘¤ = Î¾.ð‘¤
        N = Î¾[:ð­]
        nâ‚â‚ = Î¾.nâ‚â‚
        nâ‚‚â‚‚ = Î¾.nâ‚‚â‚‚
        nâ‚â‚‚ = Î¾.nâ‚â‚‚
        gâ‚ = Î¾.gâ‚
        gâ‚‚ = Î¾.gâ‚‚
        Î± = Î¾.Î±
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[2*I-1,2*J-1] += Î±*N[i]*nâ‚â‚*N[j]*ð‘¤
                k[2*I,2*J-1]   += Î±*N[i]*nâ‚â‚‚*N[j]*ð‘¤
                k[2*I-1,2*J]   += Î±*N[i]*nâ‚â‚‚*N[j]*ð‘¤
                k[2*I,2*J]     += Î±*N[i]*nâ‚‚â‚‚*N[j]*ð‘¤
            end
            f[2*I-1] += Î±*N[i]*(nâ‚â‚*gâ‚+nâ‚â‚‚*gâ‚‚)*ð‘¤
            f[2*I]   += Î±*N[i]*(nâ‚â‚‚*gâ‚+nâ‚‚â‚‚*gâ‚‚)*ð‘¤
        end
    end
end

function âˆ«váµ¢gáµ¢dÎ“(ap::T,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        ð‘¤ = Î¾.ð‘¤
        N = Î¾[:ð­]
        nâ‚â‚ = Î¾.nâ‚â‚
        nâ‚â‚‚ = Î¾.nâ‚â‚‚
        nâ‚â‚ƒ = Î¾.nâ‚â‚ƒ
        nâ‚‚â‚‚ = Î¾.nâ‚‚â‚‚
        nâ‚‚â‚ƒ = Î¾.nâ‚‚â‚ƒ
        nâ‚ƒâ‚ƒ = Î¾.nâ‚ƒâ‚ƒ
        gâ‚ = Î¾.gâ‚
        gâ‚‚ = Î¾.gâ‚‚
        gâ‚ƒ = Î¾.gâ‚ƒ
        Î± = Î¾.Î±
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[3*I-2,3*J-2] += Î±*N[i]*nâ‚â‚*N[j]*ð‘¤
                k[3*I-2,3*J-1] += Î±*N[i]*nâ‚â‚‚*N[j]*ð‘¤
                k[3*I-2,3*J]   += Î±*N[i]*nâ‚â‚ƒ*N[j]*ð‘¤
                k[3*I-1,3*J-2] += Î±*N[i]*nâ‚â‚‚*N[j]*ð‘¤
                k[3*I-1,3*J-1] += Î±*N[i]*nâ‚‚â‚‚*N[j]*ð‘¤
                k[3*I-1,3*J]   += Î±*N[i]*nâ‚‚â‚ƒ*N[j]*ð‘¤
                k[3*I,3*J-2]   += Î±*N[i]*nâ‚â‚ƒ*N[j]*ð‘¤
                k[3*I,3*J-1]   += Î±*N[i]*nâ‚‚â‚ƒ*N[j]*ð‘¤
                k[3*I,3*J]     += Î±*N[i]*nâ‚ƒâ‚ƒ*N[j]*ð‘¤
            end
            f[3*I-2] += Î±*N[i]*(nâ‚â‚*gâ‚+nâ‚â‚‚*gâ‚‚+nâ‚â‚ƒ*gâ‚ƒ)*ð‘¤
            f[3*I-1] += Î±*N[i]*(nâ‚â‚‚*gâ‚+nâ‚‚â‚‚*gâ‚‚+nâ‚‚â‚ƒ*gâ‚ƒ)*ð‘¤
            f[3*I]   += Î±*N[i]*(nâ‚â‚ƒ*gâ‚+nâ‚‚â‚ƒ*gâ‚‚+nâ‚ƒâ‚ƒ*gâ‚ƒ)*ð‘¤
        end
    end
end

function âˆ«âˆ«Ï„âˆ‡qâˆ‡pdxdy(ap::T,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        ð‘¤ = Î¾.ð‘¤
        Ï„ = Î¾.Ï„
        bâ‚ = Î¾.bâ‚
        bâ‚‚ = Î¾.bâ‚‚
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[I,J] += Ï„*(Bâ‚[i]*Bâ‚[j] + Bâ‚‚[i]*Bâ‚‚[j])*ð‘¤
            end
            f[I] += Ï„*(Bâ‚[i]*bâ‚ + Bâ‚‚[i]*bâ‚‚)*ð‘¤
        end
    end
end



function âˆ«âˆ«Ï„âˆ‡sáµ¢â±¼âˆ‡sáµ¢â‚–dxdy(ap::T,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        ð‘¤ = Î¾.ð‘¤
        Ï„ = Î¾.Ï„
        bâ‚ = Î¾.bâ‚
        bâ‚‚ = Î¾.bâ‚‚
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                k[4*I-3,4*J-3] += Ï„*Bâ‚[i]*Bâ‚[j]*ð‘¤
                k[4*I-3,4*J]   += Ï„*Bâ‚[i]*Bâ‚‚[j]*ð‘¤
                k[4*I-2,4*J-2] += Ï„*Bâ‚‚[i]*Bâ‚‚[j]*ð‘¤
                k[4*I-2,4*J]   += Ï„*Bâ‚‚[i]*Bâ‚[j]*ð‘¤
                k[4*I,4*J-3]   += Ï„*Bâ‚‚[i]*Bâ‚[j]*ð‘¤
                k[4*I,4*J-2]   += Ï„*Bâ‚[i]*Bâ‚‚[j]*ð‘¤
                k[4*I,4*J]     += Ï„*(Bâ‚[i]*Bâ‚[j] + Bâ‚‚[i]*Bâ‚‚[j])*ð‘¤
            end
            f[4*I-3] += Ï„*Bâ‚[i]*bâ‚*ð‘¤
            f[4*I-2] += Ï„*Bâ‚‚[i]*bâ‚‚*ð‘¤
            f[4*I]   += Ï„*(Bâ‚[i]*bâ‚‚ + Bâ‚‚[i]*bâ‚)*ð‘¤
        end
    end
end
function âˆ«âˆ«Ï„âˆ‡sáµ¢â±¼âˆ‡pdxdy(aâ‚›::T,aâ‚š::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’â‚š = aâ‚š.ð“’; ð“–â‚š = aâ‚š.ð“–
    ð“’â‚› = aâ‚›.ð“’; ð“–â‚› = aâ‚›.ð“–
    for (Î¾â‚š,Î¾â‚›) in zip(ð“–â‚š,ð“–â‚›)
        ð‘¤ = Î¾â‚š.ð‘¤
        Ï„ = Î¾â‚š.Ï„
        Bâ‚ = Î¾â‚›[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾â‚›[:âˆ‚ð­âˆ‚y]
        BÌ„â‚ = Î¾â‚š[:âˆ‚ð­âˆ‚x]
        BÌ„â‚‚ = Î¾â‚š[:âˆ‚ð­âˆ‚y]
        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’â‚š)
                J = xâ±¼.ð¼
                k[4*I-3,J] += Ï„*Bâ‚[i]*BÌ„â‚[j]*ð‘¤
                k[4*I-2,J] += Ï„*Bâ‚‚[i]*BÌ„â‚‚[j]*ð‘¤
                k[4*I,J]   += Ï„*(Bâ‚[i]*BÌ„â‚‚[j] + Bâ‚‚[i]*BÌ„â‚[j])*ð‘¤
            end
        end
    end
end
function âˆ«âˆ«Ï„âˆ‡Ïƒáµ¢â±¼âˆ‡Ïƒáµ¢â‚–dxdy(ap::T,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        ð‘¤ = Î¾.ð‘¤
        Ï„ = Î¾.Ï„
        bâ‚ = Î¾.bâ‚
        bâ‚‚ = Î¾.bâ‚‚
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        E = Î¾.E
        Î½ = Î¾.Î½
        Câ»Â¹áµ¢áµ¢áµ¢áµ¢ = 1/E
        Câ»Â¹áµ¢áµ¢â±¼â±¼ = -Î½/E
        Câ»Â¹áµ¢â±¼áµ¢â±¼ = 2*(1+Î½)/E
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            # Ï„ = xáµ¢.Î² 
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                
                k[3*I-2,3*J-2] += Ï„*Bâ‚[i]*Bâ‚[j]*ð‘¤
                k[3*I-2,3*J]   += Ï„*Bâ‚[i]*Bâ‚‚[j]*ð‘¤
                k[3*I-1,3*J-1] += Ï„*Bâ‚‚[i]*Bâ‚‚[j]*ð‘¤
                k[3*I-1,3*J]   += Ï„*Bâ‚‚[i]*Bâ‚[j]*ð‘¤
                k[3*I,3*J-2]   += Ï„*Bâ‚‚[i]*Bâ‚[j]*ð‘¤
                k[3*I,3*J-1]   += Ï„*Bâ‚[i]*Bâ‚‚[j]*ð‘¤
                k[3*I,3*J]     += Ï„*(Bâ‚[i]*Bâ‚[j] + Bâ‚‚[i]*Bâ‚‚[j])*ð‘¤
              
            end
            f[3*I-2] += Ï„*(Bâ‚[i]*bâ‚)*ð‘¤
            f[3*I-1] += Ï„*(Bâ‚‚[i]*bâ‚‚ )*ð‘¤
            f[3*I]   += Ï„*(Bâ‚[i]*bâ‚‚ + Bâ‚‚[i]*bâ‚)*ð‘¤

        end
    end
end



function âˆ«âˆ«Ï„âˆ‡Ïƒáµ¢â±¼âˆ‡Ïƒáµ¢â‚–dÎ©(ap::T,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        ð‘¤ = Î¾.ð‘¤
        Ï„ = Î¾.Ï„
        bâ‚ = Î¾.bâ‚
        bâ‚‚ = Î¾.bâ‚‚
        bâ‚ƒ = Î¾.bâ‚ƒ
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        Bâ‚ƒ = Î¾[:âˆ‚ð­âˆ‚z]
        E = Î¾.E
        Î½ = Î¾.Î½
        Câ»Â¹áµ¢áµ¢áµ¢áµ¢ = 1/E
        Câ»Â¹áµ¢áµ¢â±¼â±¼ = -Î½/E
        Câ»Â¹áµ¢â±¼áµ¢â±¼ = 2*(1+Î½)/E
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
              
              
                k[6*I-5,6*I-5] += Ï„*Bâ‚[i]*Bâ‚[j]*ð‘¤
                k[6*I-5,6*I-2] += Ï„*Bâ‚[i]*Bâ‚‚[j]*ð‘¤
                k[6*I-5,6*I]   += Ï„*Bâ‚[i]*Bâ‚ƒ[j]*ð‘¤

                k[6*I-4,6*I-4] += Ï„*Bâ‚‚[i]*Bâ‚‚[j]*ð‘¤
                k[6*I-4,6*I-2] += Ï„*Bâ‚‚[i]*Bâ‚[j]*ð‘¤
                k[6*I-4,6*I-1] += Ï„*Bâ‚‚[i]*Bâ‚ƒ[j]*ð‘¤
               
                k[6*I-3,6*I-3] += Ï„*Bâ‚ƒ[i]*Bâ‚ƒ[j]*ð‘¤
                k[6*I-3,6*I-1] += Ï„*Bâ‚ƒ[i]*Bâ‚‚[j]*ð‘¤
                k[6*I-3,6*I]   += Ï„*Bâ‚ƒ[i]*Bâ‚[j]*ð‘¤

                
                k[6*I-2,6*I-5] += Ï„*Bâ‚‚[i]*Bâ‚[j]*ð‘¤
                k[6*I-2,6*I-4] += Ï„*Bâ‚[i]*Bâ‚‚[j]*ð‘¤
                k[6*I-2,6*I-2] += Ï„*(Bâ‚[i]*Bâ‚[j]+Bâ‚‚[i]*Bâ‚‚[j])*ð‘¤
                k[6*I-2,6*I-1] += Ï„*Bâ‚[i]*Bâ‚ƒ[j]*ð‘¤
                k[6*I-2,6*I]   += Ï„*Bâ‚‚[i]*Bâ‚ƒ[j]*ð‘¤

                
                k[6*I-1,6*I-4] += Ï„*Bâ‚‚[i]*Bâ‚‚[j]*ð‘¤
                k[6*I-1,6*I-3] += Ï„*Bâ‚‚[i]*Bâ‚ƒ[j]*ð‘¤
                k[6*I-1,6*I-2] += Ï„*Bâ‚ƒ[i]*Bâ‚[j]*ð‘¤
                k[6*I-1,6*I-1] += Ï„*(Bâ‚ƒ[i]*Bâ‚ƒ[j]+Bâ‚‚[i]*Bâ‚‚[j])*ð‘¤
                k[6*I-1,6*I]   += Ï„*Bâ‚‚[i]*Bâ‚[j]*ð‘¤

                
                k[6*I-1,6*I-5] += Ï„*Bâ‚ƒ[i]*Bâ‚[j]*ð‘¤
                k[6*I-1,6*I-3] += Ï„*Bâ‚[i]*Bâ‚ƒ[j]*ð‘¤
                k[6*I-1,6*I-2] += Ï„*Bâ‚ƒ[i]*Bâ‚‚[j]*ð‘¤
                k[6*I-1,6*I-1] += Ï„*Bâ‚[i]*Bâ‚‚[j]*ð‘¤
                k[6*I-1,6*I]   += Ï„*(Bâ‚ƒ[i]*Bâ‚ƒ[j]+Bâ‚[i]*Bâ‚[j])*ð‘¤

            end
            f[6*I-5] += Ï„*(Bâ‚[i]*bâ‚)*ð‘¤
            f[6*I-4] += Ï„*(Bâ‚‚[i]*bâ‚‚)*ð‘¤
            f[6*I-3] += Ï„*(Bâ‚ƒ[i]*bâ‚ƒ)*ð‘¤
            f[6*I-2] += Ï„*(Bâ‚[i]*bâ‚‚ + Bâ‚‚[i]*bâ‚)*ð‘¤
            f[6*I-1] += Ï„*(Bâ‚ƒ[i]*bâ‚‚ + Bâ‚‚[i]*bâ‚ƒ)*ð‘¤
            f[6*1]   += Ï„*(Bâ‚ƒ[i]*bâ‚ + Bâ‚[i]*bâ‚ƒ)*ð‘¤
        end
    end
end

function âˆ«âˆ«Ï„âˆ‡Îµáµ¢â±¼âˆ‡Ïƒáµ¢â‚–dxdy(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ð“’â‚› = aâ‚›.ð“’;ð“–â‚› = aâ‚›.ð“–
    ð“’áµ¤ = aáµ¤.ð“’;ð“–áµ¤ = aáµ¤.ð“–
    for (Î¾â‚›,Î¾áµ¤) in zip(ð“–â‚›,ð“–áµ¤)
        ð‘¤ = Î¾â‚›.ð‘¤
        â„Ž = Î¾â‚›.â„Ž
        Ï„ = Î¾â‚›.Ï„
        bâ‚ = Î¾â‚›.bâ‚
        bâ‚‚ = Î¾â‚›.bâ‚‚
        Bâ‚â‚› = Î¾â‚›[:âˆ‚ð­âˆ‚x]
        Bâ‚‚â‚› = Î¾â‚›[:âˆ‚ð­âˆ‚y]
        Bâ‚áµ¤ = Î¾áµ¤[:âˆ‚ð­âˆ‚x]
        Bâ‚‚áµ¤ = Î¾áµ¤[:âˆ‚ð­âˆ‚y]
        Bâ‚â‚áµ¤ = Î¾áµ¤[:âˆ‚Â²ð­âˆ‚xÂ²]
        Bâ‚‚â‚‚áµ¤ = Î¾áµ¤[:âˆ‚Â²ð­âˆ‚yÂ²]
        Bâ‚â‚‚áµ¤ = Î¾áµ¤[:âˆ‚Â²ð­âˆ‚xâˆ‚y]
        E = Î¾â‚›.E
        Î½ = Î¾â‚›.Î½
        Câ»Â¹áµ¢áµ¢áµ¢áµ¢ = 1/E
        Câ»Â¹áµ¢áµ¢â±¼â±¼ = -Î½/E
        Câ»Â¹áµ¢â±¼áµ¢â±¼ = 2*(1+Î½)/E
        for (i,xáµ¢) in enumerate(ð“’â‚›)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’áµ¤)
                J = xâ±¼.ð¼
                # Ï„ = xâ±¼.Î²
                
                # k[3*I-2,2*J-1] += Bâ‚â‚›[i]*(Bâ‚â‚áµ¤[j]+Bâ‚‚â‚‚áµ¤[j])*ð‘¤
                # k[3*I-1,2*J]   += Bâ‚‚â‚›[i]*(Bâ‚â‚áµ¤[j]+Bâ‚‚â‚‚áµ¤[j])*ð‘¤
                # k[3*I,2*J-1]   += Bâ‚‚â‚›[i]*(Bâ‚â‚áµ¤[j]+Bâ‚‚â‚‚áµ¤[j])*ð‘¤
                # k[3*I,2*J]     += Bâ‚â‚›[i]*(Bâ‚â‚áµ¤[j]+Bâ‚‚â‚‚áµ¤[j])*ð‘¤

                # k[3*I-2,2*J-1] += â„Ž^2*Bâ‚â‚›[i]*Bâ‚â‚áµ¤[j]*ð‘¤
                # k[3*I-2,2*J]   += â„Ž^2*Bâ‚â‚›[i]*Bâ‚â‚‚áµ¤[j]*ð‘¤
                # k[3*I-1,2*J-1] += â„Ž^2*Bâ‚‚â‚›[i]*Bâ‚â‚‚áµ¤[j]*ð‘¤
                # k[3*I-1,2*J]   += â„Ž^2*Bâ‚‚â‚›[i]*Bâ‚‚â‚‚áµ¤[j]*ð‘¤
                # k[3*I,2*J-1]   += â„Ž^2*(Bâ‚‚â‚›[i]*Bâ‚â‚áµ¤[j] + Bâ‚â‚›[i]*Bâ‚â‚‚áµ¤[j])*ð‘¤
                # k[3*I,2*J]     += â„Ž^2*(Bâ‚‚â‚›[i]*Bâ‚â‚‚áµ¤[j] + Bâ‚â‚›[i]*Bâ‚‚â‚‚áµ¤[j])*ð‘¤
               
                
                # k[3*I-2,2*J-1] += Bâ‚â‚›[i]*Bâ‚â‚áµ¤[j]*ð‘¤
                # k[3*I-2,2*J]   += Bâ‚â‚›[i]*Bâ‚â‚‚áµ¤[j]*ð‘¤
                # k[3*I-1,2*J-1] += Bâ‚‚â‚›[i]*Bâ‚â‚‚áµ¤[j]*ð‘¤
                # k[3*I-1,2*J]   += Bâ‚‚â‚›[i]*Bâ‚‚â‚‚áµ¤[j]*ð‘¤
                # k[3*I,2*J-1]   += (Bâ‚‚â‚›[i]*Bâ‚â‚áµ¤[j] + Bâ‚â‚›[i]*Bâ‚â‚‚áµ¤[j])*ð‘¤
                # k[3*I,2*J]     += (Bâ‚‚â‚›[i]*Bâ‚â‚‚áµ¤[j] + Bâ‚â‚›[i]*Bâ‚‚â‚‚áµ¤[j])*ð‘¤
                Î²=0.1
                k[3*I-2,2*J-1] += Î²*â„Ž^2*(Bâ‚â‚›[i]*Bâ‚â‚áµ¤[j]+Bâ‚â‚›[i]*Bâ‚‚â‚‚áµ¤[j])*ð‘¤
                k[3*I-2,2*J]   += Î²*â„Ž^2*Bâ‚â‚›[i]*Bâ‚â‚‚áµ¤[j]*ð‘¤
                k[3*I-1,2*J-1] += Î²*â„Ž^2*Bâ‚‚â‚›[i]*Bâ‚â‚‚áµ¤[j]*ð‘¤
                k[3*I-1,2*J]   += Î²*â„Ž^2*(Bâ‚â‚›[i]*Bâ‚â‚‚áµ¤[j]+Bâ‚‚â‚›[i]*Bâ‚‚â‚‚áµ¤[j])*ð‘¤
                k[3*I,2*J-1]   += Î²*â„Ž^2*(Bâ‚‚â‚›[i]*(Bâ‚â‚áµ¤[j]+Bâ‚‚â‚‚áµ¤[j]) + Bâ‚â‚›[i]*Bâ‚â‚‚áµ¤[j])*ð‘¤
                k[3*I,2*J]     += Î²*â„Ž^2*(Bâ‚‚â‚›[i]*Bâ‚â‚‚áµ¤[j] + Bâ‚â‚›[i]*(Bâ‚â‚áµ¤[j]+Bâ‚‚â‚‚áµ¤[j]))*ð‘¤
               
            end

            f[3*I-2] -= 0
            f[3*I-1] -= 0
            f[3*I]   -= 0
        end
    end
end
function âˆ«âˆ«Ï„âˆ‡Ïƒáµ¢â±¼âˆ‡Ïƒáµ¢â‚–dxdy_Taylor(ap::T,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        ð‘¤ = Î¾.ð‘¤
       
        bâ‚ = Î¾.bâ‚
        bâ‚‚ = Î¾.bâ‚‚
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        E = Î¾.E
        Î½ = Î¾.Î½
        ðº = E/(1+Î½)/2
       
        Câ»Â¹áµ¢áµ¢áµ¢áµ¢ = 1/E
        Câ»Â¹áµ¢áµ¢â±¼â±¼ = -Î½/E
        Câ»Â¹áµ¢â±¼áµ¢â±¼ = 2*(1+Î½)/E
        xL = 0.0
        yL = 0.0
        for Î¾ in ð“–
            xL += Î¾.x
            yL += Î¾.y
            end
            xL = xL/length(ð“–)
            yL = yL/length(ð“–)
            ð­ = zeros(21)
            âˆ‚ð­âˆ‚x = zeros(21)
            âˆ‚ð­âˆ‚y = zeros(21)
            âˆ‚Â²ð­âˆ‚xÂ² = zeros(21)
            âˆ‚Â²ð­âˆ‚yÂ² = zeros(21)
            âˆ‚Â²ð­âˆ‚xâˆ‚y = zeros(21)
         
            ð­[1] = 1.0
            ð­[2] = xL
            ð­[3] = yL
            âˆ‚ð­âˆ‚x[1] = 0.0
            âˆ‚ð­âˆ‚x[2] = 1.0
            âˆ‚ð­âˆ‚x[3] = 0.0
            âˆ‚ð­âˆ‚y[1] = 0.0
            âˆ‚ð­âˆ‚y[2] = 0.0
            âˆ‚ð­âˆ‚y[3] = 1.0
    
            # ð­[1] = 1.0
            # ð­[2] = xL
            # ð­[3] = yL
            # ð­[4] = xL^2
            # ð­[5] = xL*yL
            # ð­[6] = yL^2
            # âˆ‚ð­âˆ‚x[1] = 0.0
            # âˆ‚ð­âˆ‚x[2] = 1.0
            # âˆ‚ð­âˆ‚x[3] = 0.0
            # âˆ‚ð­âˆ‚x[4] = 2*xL
            # âˆ‚ð­âˆ‚x[5] = yL
            # âˆ‚ð­âˆ‚x[6] = 0.0
            # âˆ‚ð­âˆ‚y[1] = 0.0
            # âˆ‚ð­âˆ‚y[2] = 0.0
            # âˆ‚ð­âˆ‚y[3] = 1.0
            # âˆ‚ð­âˆ‚y[4] = 0.0
            # âˆ‚ð­âˆ‚y[5] = xL
            # âˆ‚ð­âˆ‚y[6] = 2*yL
            
            # âˆ‚Â²ð­âˆ‚xÂ²[1] = 0.0
            # âˆ‚Â²ð­âˆ‚xÂ²[2] = 0.0
            # âˆ‚Â²ð­âˆ‚xÂ²[3] = 0.0 
            # âˆ‚Â²ð­âˆ‚xÂ²[4] = 2.0
            # âˆ‚Â²ð­âˆ‚xÂ²[5] = 0.0
            # âˆ‚Â²ð­âˆ‚xÂ²[6] = 0.0 
            # âˆ‚Â²ð­âˆ‚yÂ²[1] = 0.0
            # âˆ‚Â²ð­âˆ‚yÂ²[2] = 0.0
            # âˆ‚Â²ð­âˆ‚yÂ²[3] = 0.0
            # âˆ‚Â²ð­âˆ‚yÂ²[4] = 0.0
            # âˆ‚Â²ð­âˆ‚yÂ²[5] = 0.0
            # âˆ‚Â²ð­âˆ‚yÂ²[6] = 2.0
            # âˆ‚Â²ð­âˆ‚xâˆ‚y[1] = 0.0
            # âˆ‚Â²ð­âˆ‚xâˆ‚y[2] = 0.0
            # âˆ‚Â²ð­âˆ‚xâˆ‚y[3] = 0.0
            # âˆ‚Â²ð­âˆ‚xâˆ‚y[4] = 0.0
            # âˆ‚Â²ð­âˆ‚xâˆ‚y[5] = 1.0
            # âˆ‚Â²ð­âˆ‚xâˆ‚y[6] = 0.0
            xÎ¾ = Î¾.x
            yÎ¾ = Î¾.y
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
            
                                                
                k[3*I-2,3*J-2] += 1/ðº*(âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]+âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^2+âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(yÎ¾-yL)^2)*ð‘¤
                k[3*I-2,3*J]   += 1/ðº*(âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚y[j]+âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2+âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^2)*ð‘¤
                k[3*I-1,3*J-1] += 1/ðº*(âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]+âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2+âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^2)*ð‘¤
                k[3*I-1,3*J]   += 1/ðº*(âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚x[j]+âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^2+âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^2)*ð‘¤
                k[3*I,3*J-2]   += 1/ðº*(âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚x[j]+âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^2+âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^2)*ð‘¤
                k[3*I,3*J-1]   += 1/ðº*(âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚y[j]+âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2+âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^2)*ð‘¤
                k[3*I,3*J]     += 1/ðº*((âˆ‚ð­âˆ‚x[i]*âˆ‚ð­âˆ‚x[j]+âˆ‚Â²ð­âˆ‚xÂ²[i]*âˆ‚Â²ð­âˆ‚xÂ²[j]*(xÎ¾-xL)^2+âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(yÎ¾-yL)^2)
                                  + (âˆ‚ð­âˆ‚y[i]*âˆ‚ð­âˆ‚y[j]+âˆ‚Â²ð­âˆ‚xâˆ‚y[i]*âˆ‚Â²ð­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2+âˆ‚Â²ð­âˆ‚yÂ²[i]*âˆ‚Â²ð­âˆ‚yÂ²[j]*(yÎ¾-yL)^2))*ð‘¤

            end
            f[3*I-2] -= 1/ðº*âˆ‚ð­âˆ‚x[i]*bâ‚*ð‘¤
            f[3*I-1] -= 1/ðº*âˆ‚ð­âˆ‚y[i]*bâ‚‚*ð‘¤
            f[3*I]   -= 1/ðº*(âˆ‚ð­âˆ‚x[i]*bâ‚‚ + âˆ‚ð­âˆ‚y[i]*bâ‚)*ð‘¤
        end
    end
end
function âˆ«âˆ«Ï„âˆ‡Ïƒáµ¢â±¼âˆ‡Ïƒáµ¢â‚–dxdy_new(ap::T,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        ð‘¤ = Î¾.ð‘¤
        Ï„ = Î¾.Ï„
        â„Ž = Î¾.â„Ž
        bâ‚ = Î¾.bâ‚
        bâ‚‚ = Î¾.bâ‚‚
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        E = Î¾.E
        Î½ = Î¾.Î½
        Câ»Â¹áµ¢áµ¢áµ¢áµ¢ = (1-Î½^2)/E
        Câ»Â¹áµ¢áµ¢â±¼â±¼ = -(Î½+Î½^2)/E
        Câ»Â¹áµ¢â±¼áµ¢â±¼ = 2*(1+Î½)/E 

        ðº = E/(1+Î½)/2
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
            
                                                
                # k[3*I-2,3*J-2] += Câ»Â¹áµ¢áµ¢áµ¢áµ¢*â„Ž^2*Bâ‚[i]*Bâ‚[j]*ð‘¤
                # k[3*I-2,3*J]   += Câ»Â¹áµ¢áµ¢â±¼â±¼*â„Ž^2*Bâ‚[i]*Bâ‚‚[j]*ð‘¤
                # k[3*I-1,3*J-1] += Câ»Â¹áµ¢áµ¢áµ¢áµ¢*â„Ž^2*Bâ‚‚[i]*Bâ‚‚[j]*ð‘¤
                # k[3*I-1,3*J]   += Câ»Â¹áµ¢áµ¢â±¼â±¼*â„Ž^2*Bâ‚‚[i]*Bâ‚[j]*ð‘¤
                # k[3*I,3*J-2]   += Câ»Â¹áµ¢â±¼áµ¢â±¼*â„Ž^2*Bâ‚‚[i]*Bâ‚[j]*ð‘¤
                # k[3*I,3*J-1]   += Câ»Â¹áµ¢â±¼áµ¢â±¼*â„Ž^2*Bâ‚[i]*Bâ‚‚[j]*ð‘¤
                # k[3*I,3*J]     += Câ»Â¹áµ¢â±¼áµ¢â±¼*â„Ž^2*(Bâ‚[i]*Bâ‚[j] + Bâ‚‚[i]*Bâ‚‚[j])*ð‘¤

                                                  
                k[3*I-2,3*J-2] += 1/ðº*â„Ž^2*Bâ‚[i]*Bâ‚[j]*ð‘¤
                k[3*I-2,3*J]   += 1/ðº*â„Ž^2*Bâ‚[i]*Bâ‚‚[j]*ð‘¤
                k[3*I-1,3*J-1] += 1/ðº*â„Ž^2*Bâ‚‚[i]*Bâ‚‚[j]*ð‘¤
                k[3*I-1,3*J]   += 1/ðº*â„Ž^2*Bâ‚‚[i]*Bâ‚[j]*ð‘¤
                k[3*I,3*J-2]   += 1/ðº*â„Ž^2*Bâ‚‚[i]*Bâ‚[j]*ð‘¤
                k[3*I,3*J-1]   += 1/ðº*â„Ž^2*Bâ‚[i]*Bâ‚‚[j]*ð‘¤
                k[3*I,3*J]     += 1/ðº*â„Ž^2*(Bâ‚[i]*Bâ‚[j] + Bâ‚‚[i]*Bâ‚‚[j])*ð‘¤
            end
            # f[3*I-2] -= Câ»Â¹áµ¢áµ¢áµ¢áµ¢*â„Ž^2*Bâ‚[i]*bâ‚*ð‘¤
            # f[3*I-1] -= Câ»Â¹áµ¢áµ¢â±¼â±¼*â„Ž^2*Bâ‚‚[i]*bâ‚‚*ð‘¤
            # f[3*I]   -= Câ»Â¹áµ¢â±¼áµ¢â±¼*â„Ž^2*(Bâ‚[i]*bâ‚‚ + Bâ‚‚[i]*bâ‚)*ð‘¤

            f[3*I-2] -= 1/ðº*â„Ž^2*Bâ‚[i]*bâ‚*ð‘¤
            f[3*I-1] -= 1/ðº*â„Ž^2*Bâ‚‚[i]*bâ‚‚*ð‘¤
            f[3*I]   -= 1/ðº*â„Ž^2*(Bâ‚[i]*bâ‚‚ + Bâ‚‚[i]*bâ‚)*ð‘¤
        end
    end
end
function âˆ«âˆ«Ï„âˆ‡Ïƒáµ¢â±¼âˆ‡Ïƒáµ¢â‚–dxdy_Real(ap::T,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        ð‘¤ = Î¾.ð‘¤
        Ï„ = Î¾.Ï„
        â„Ž = Î¾.â„Ž
        bâ‚ = Î¾.bâ‚
        bâ‚‚ = Î¾.bâ‚‚
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        Bâ‚â‚ = Î¾[:âˆ‚Â²ð­âˆ‚xÂ²]
        Bâ‚‚â‚‚ = Î¾[:âˆ‚Â²ð­âˆ‚yÂ²]
        Bâ‚â‚‚ = Î¾[:âˆ‚Â²ð­âˆ‚xâˆ‚y]

        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµ¢áµ¢áµ¢áµ¢ = E/(1-Î½^2)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-Î½^2)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)

        # EÌ„ = Î¾.EÌ„
        # Î½Ì„  = Î¾.Î½Ì„ 
       
        # Cáµˆ = EÌ„/(1+Î½Ì„  )
        # Cáµ¢áµ¢áµ¢áµ¢ = 2/3*Cáµˆ
        # Cáµ¢áµ¢â±¼â±¼ = -1/3*Cáµˆ
        # Cáµ¢â±¼áµ¢â±¼ = 1/2*Cáµˆ
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
            
                                                
                k[2*I-1,2*J-1] += Ï„*((Cáµ¢áµ¢áµ¢áµ¢*Bâ‚â‚[i] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚â‚‚[i])*(Cáµ¢áµ¢áµ¢áµ¢*Bâ‚â‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚â‚‚[j])+((Cáµ¢áµ¢â±¼â±¼+Cáµ¢â±¼áµ¢â±¼)*Bâ‚â‚‚[i])*((Cáµ¢áµ¢â±¼â±¼+Cáµ¢â±¼áµ¢â±¼)*Bâ‚â‚‚[j]))*ð‘¤
                k[2*I-1,2*J]   += Ï„*((Cáµ¢áµ¢áµ¢áµ¢*Bâ‚â‚[i] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚â‚‚[i])*((Cáµ¢áµ¢â±¼â±¼+Cáµ¢â±¼áµ¢â±¼)*Bâ‚â‚‚[j])+((Cáµ¢áµ¢â±¼â±¼+Cáµ¢â±¼áµ¢â±¼)*Bâ‚â‚‚[i])*(Cáµ¢â±¼áµ¢â±¼*Bâ‚â‚[j] + Cáµ¢áµ¢áµ¢áµ¢*Bâ‚‚â‚‚[j]))*ð‘¤
                k[2*I,2*J-1]   += Ï„*((Cáµ¢â±¼áµ¢â±¼*Bâ‚â‚[i] + Cáµ¢áµ¢áµ¢áµ¢*Bâ‚‚â‚‚[i])*((Cáµ¢áµ¢â±¼â±¼+Cáµ¢â±¼áµ¢â±¼)*Bâ‚â‚‚[j])+((Cáµ¢áµ¢â±¼â±¼+Cáµ¢â±¼áµ¢â±¼)*Bâ‚â‚‚[i])*(Cáµ¢áµ¢áµ¢áµ¢*Bâ‚â‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚â‚‚[j]))*ð‘¤
                k[2*I,2*J]     += Ï„*((Cáµ¢â±¼áµ¢â±¼*Bâ‚â‚[i] + Cáµ¢áµ¢áµ¢áµ¢*Bâ‚‚â‚‚[i])*(Cáµ¢â±¼áµ¢â±¼*Bâ‚â‚[j] + Cáµ¢áµ¢áµ¢áµ¢*Bâ‚‚â‚‚[j])+((Cáµ¢áµ¢â±¼â±¼+Cáµ¢â±¼áµ¢â±¼)*Bâ‚â‚‚[i])*((Cáµ¢áµ¢â±¼â±¼+Cáµ¢â±¼áµ¢â±¼)*Bâ‚â‚‚[j]))*ð‘¤
            
            end
           

            f[2*I-1] += Ï„*((Cáµ¢áµ¢áµ¢áµ¢*Bâ‚â‚[i] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚â‚‚[i])*bâ‚+(Cáµ¢áµ¢â±¼â±¼+Cáµ¢â±¼áµ¢â±¼)*Bâ‚â‚‚[i]*bâ‚‚)*ð‘¤
            f[2*I]   += Ï„*((Cáµ¢â±¼áµ¢â±¼*Bâ‚â‚[i] + Cáµ¢áµ¢áµ¢áµ¢*Bâ‚‚â‚‚[i])*bâ‚‚+(Cáµ¢áµ¢â±¼â±¼+Cáµ¢â±¼áµ¢â±¼)*Bâ‚â‚‚[i]*bâ‚)*ð‘¤
            
        end
    end
end

function âˆ«âˆ«Ï„âˆ‡Ïƒáµ¢â±¼âˆ‡Ïƒáµ¢â‚–dxdy_Real3(ap::T,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        ð‘¤ = Î¾.ð‘¤
        Ï„ = Î¾.Ï„
        â„Ž = Î¾.â„Ž
        bâ‚ = Î¾.bâ‚
        bâ‚‚ = Î¾.bâ‚‚
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        Bâ‚â‚ = Î¾[:âˆ‚Â²ð­âˆ‚xÂ²]
        Bâ‚‚â‚‚ = Î¾[:âˆ‚Â²ð­âˆ‚yÂ²]
        Bâ‚â‚‚ = Î¾[:âˆ‚Â²ð­âˆ‚xâˆ‚y]

        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµ¢áµ¢áµ¢áµ¢ = E/(1-Î½^2)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-Î½^2)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)

        # EÌ„ = Î¾.EÌ„
        # Î½Ì„  = Î¾.Î½Ì„ 
       
        # Cáµˆ = EÌ„/(1+Î½Ì„ )
        # Cáµ¢áµ¢áµ¢áµ¢ = 2/3*Cáµˆ
        # Cáµ¢áµ¢â±¼â±¼ = -1/3*Cáµˆ
        # Cáµ¢â±¼áµ¢â±¼ = 1/2*Cáµˆ
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
            
                                                
                # k[2*I-1,2*J-1] += Ï„*((Bâ‚â‚[i] + Bâ‚‚â‚‚[i])*(Cáµ¢áµ¢áµ¢áµ¢*Bâ‚â‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚â‚‚[j]))*ð‘¤
                # k[2*I-1,2*J]   += Ï„*((Bâ‚â‚[i] + Bâ‚‚â‚‚[i])*((Cáµ¢áµ¢â±¼â±¼+Cáµ¢â±¼áµ¢â±¼)*Bâ‚â‚‚[j]))*ð‘¤
                # k[2*I,2*J-1]   += Ï„*((Bâ‚â‚[i] + Bâ‚‚â‚‚[i])*((Cáµ¢áµ¢â±¼â±¼+Cáµ¢â±¼áµ¢â±¼)*Bâ‚â‚‚[j]))*ð‘¤
                # k[2*I,2*J]     += Ï„*((Bâ‚â‚[i] + Bâ‚‚â‚‚[i])*(Cáµ¢â±¼áµ¢â±¼*Bâ‚â‚[j] + Cáµ¢áµ¢áµ¢áµ¢*Bâ‚‚â‚‚[j]))*ð‘¤
            
                                                 
                k[2*I-1,2*J-1] -= Ï„*((Bâ‚â‚[i] + Bâ‚‚â‚‚[i])*(Cáµ¢áµ¢áµ¢áµ¢*Bâ‚â‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚â‚‚[j]))*ð‘¤
                k[2*I-1,2*J]   -= Ï„*((Bâ‚â‚[i] + Bâ‚‚â‚‚[i])*((Cáµ¢áµ¢â±¼â±¼+Cáµ¢â±¼áµ¢â±¼)*Bâ‚â‚‚[j]))*ð‘¤
                k[2*I,2*J-1]   -= Ï„*((Bâ‚â‚[i] + Bâ‚‚â‚‚[i])*((Cáµ¢áµ¢â±¼â±¼+Cáµ¢â±¼áµ¢â±¼)*Bâ‚â‚‚[j]))*ð‘¤
                k[2*I,2*J]     -= Ï„*((Bâ‚â‚[i] + Bâ‚‚â‚‚[i])*(Cáµ¢â±¼áµ¢â±¼*Bâ‚â‚[j] + Cáµ¢áµ¢áµ¢áµ¢*Bâ‚‚â‚‚[j]))*ð‘¤
            
            end
           

            # f[2*I-1] -= Ï„*((Cáµ¢áµ¢áµ¢áµ¢*Bâ‚â‚[i] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚â‚‚[i])*bâ‚+(Cáµ¢áµ¢â±¼â±¼+Cáµ¢â±¼áµ¢â±¼)*Bâ‚â‚‚[i]*bâ‚‚)*ð‘¤
            # f[2*I]   -= Ï„*((Cáµ¢â±¼áµ¢â±¼*Bâ‚â‚[i] + Cáµ¢áµ¢áµ¢áµ¢*Bâ‚‚â‚‚[i])*bâ‚‚+(Cáµ¢áµ¢â±¼â±¼+Cáµ¢â±¼áµ¢â±¼)*Bâ‚â‚‚[i]*bâ‚)*ð‘¤
            
            
            f[2*I-1] += Ï„*((Cáµ¢áµ¢áµ¢áµ¢*Bâ‚â‚[i] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚â‚‚[i])*bâ‚+(Cáµ¢áµ¢â±¼â±¼+Cáµ¢â±¼áµ¢â±¼)*Bâ‚â‚‚[i]*bâ‚‚)*ð‘¤
            f[2*I]   += Ï„*((Cáµ¢â±¼áµ¢â±¼*Bâ‚â‚[i] + Cáµ¢áµ¢áµ¢áµ¢*Bâ‚‚â‚‚[i])*bâ‚‚+(Cáµ¢áµ¢â±¼â±¼+Cáµ¢â±¼áµ¢â±¼)*Bâ‚â‚‚[i]*bâ‚)*ð‘¤
            
        end
    end
end
function âˆ«âˆ«Ï„âˆ‡Ïƒáµ¢â±¼âˆ‡Ïƒáµ¢â‚–dxdy_Real2(ap::T,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    for Î¾ in ð“–
        ð‘¤ = Î¾.ð‘¤
        Ï„ = Î¾.Ï„
        â„Ž = Î¾.â„Ž
        bâ‚ = Î¾.bâ‚
        bâ‚‚ = Î¾.bâ‚‚
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        Bâ‚â‚ = Î¾[:âˆ‚Â²ð­âˆ‚xÂ²]
        Bâ‚‚â‚‚ = Î¾[:âˆ‚Â²ð­âˆ‚yÂ²]
        Bâ‚â‚‚ = Î¾[:âˆ‚Â²ð­âˆ‚xâˆ‚y]

        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµ¢áµ¢áµ¢áµ¢ = E/(1-Î½^2)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-Î½^2)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)

        EÌ„ = Î¾.EÌ„
        Î½Ì„  = Î¾.Î½Ì„ 
       
        Cáµˆ = EÌ„/(1+Î½Ì„ )
        # Cáµ¢áµ¢áµ¢áµ¢ = 2/3*Cáµˆ
        # Cáµ¢áµ¢â±¼â±¼ = -1/3*Cáµˆ
        # Cáµ¢â±¼áµ¢â±¼ = 1/2*Cáµˆ
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
            
                                                
                k[2*I-1,2*J-1] += Cáµˆ*â„Ž^2*((Bâ‚â‚[i] + Bâ‚‚â‚‚[i])*(Bâ‚â‚[j] + Bâ‚‚â‚‚[j]))*ð‘¤
                k[2*I,2*J]     += Cáµˆ*â„Ž^2*((Bâ‚â‚[i] + Bâ‚‚â‚‚[i])*(Bâ‚â‚[j] + Bâ‚‚â‚‚[j]))*ð‘¤
            end
           

            f[2*I-1] -= Ï„*((Cáµ¢áµ¢áµ¢áµ¢*Bâ‚â‚[i] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚â‚‚[i])*bâ‚+(Cáµ¢áµ¢â±¼â±¼+Cáµ¢â±¼áµ¢â±¼)*Bâ‚â‚‚[i]*bâ‚‚)*ð‘¤
            f[2*I]   -= Ï„*((Cáµ¢â±¼áµ¢â±¼*Bâ‚â‚[i] + Cáµ¢áµ¢áµ¢áµ¢*Bâ‚‚â‚‚[i])*bâ‚‚+(Cáµ¢áµ¢â±¼â±¼+Cáµ¢â±¼áµ¢â±¼)*Bâ‚â‚‚[i]*bâ‚)*ð‘¤
            
        end
    end
end

function getÏƒâ‚™(Ïƒâ‚â‚::Float64,Ïƒâ‚‚â‚‚::Float64,Ïƒâ‚â‚‚::Float64)
    # trace
    t = Ïƒâ‚â‚ + Ïƒâ‚‚â‚‚
    # determinant
    d = Ïƒâ‚â‚*Ïƒâ‚‚â‚‚ - Ïƒâ‚â‚‚^2

    Ïƒâ‚ = t/2 + (t^2/4-d)^0.5
    Ïƒâ‚‚ = t/2 - (t^2/4-d)^0.5
    if Ïƒâ‚â‚‚ â‰ˆ 0.0
        (nâ‚,nâ‚‚) = Ïƒâ‚â‚ > Ïƒâ‚‚â‚‚ ? ((1.0,0.0),(0.0,1.0)) : ((0.0,1.0),(1.0,0.0))
    else
        lâ‚ = ((Ïƒâ‚-Ïƒâ‚‚â‚‚)^2+Ïƒâ‚â‚‚^2)^0.5
        lâ‚‚ = ((Ïƒâ‚‚-Ïƒâ‚‚â‚‚)^2+Ïƒâ‚â‚‚^2)^0.5
        nâ‚ = ((Ïƒâ‚-Ïƒâ‚‚â‚‚)/lâ‚,Ïƒâ‚â‚‚/lâ‚)
        nâ‚‚ = ((Ïƒâ‚‚-Ïƒâ‚‚â‚‚)/lâ‚,Ïƒâ‚â‚‚/lâ‚)
    end
    return Ïƒâ‚,Ïƒâ‚‚,nâ‚,nâ‚‚
end

function getÏƒâ‚™(Ïƒâ‚â‚::Float64,Ïƒâ‚‚â‚‚::Float64,Ïƒâ‚ƒâ‚ƒ::Float64,Ïƒâ‚â‚‚::Float64,Ïƒâ‚â‚ƒ::Float64,Ïƒâ‚‚â‚ƒ::Float64)
    pâ‚ = Ïƒâ‚â‚‚^2+Ïƒâ‚â‚ƒ^2+Ïƒâ‚‚â‚ƒ^2
    if pâ‚ == 0.0
        Ïƒâ‚ = Ïƒâ‚â‚
        Ïƒâ‚‚ = Ïƒâ‚‚â‚‚
        Ïƒâ‚ƒ = Ïƒâ‚ƒâ‚ƒ
    else
        p = (Ïƒâ‚â‚+Ïƒâ‚‚â‚‚+Ïƒâ‚ƒâ‚ƒ)/3.0
        s = (((Ïƒâ‚â‚-p)^2+(Ïƒâ‚‚â‚‚-p)^2+(Ïƒâ‚ƒâ‚ƒ-p)^2 + 2*pâ‚)/6)^0.5
        (Bâ‚â‚,Bâ‚‚â‚‚,Bâ‚ƒâ‚ƒ,Bâ‚â‚‚,Bâ‚â‚ƒ,Bâ‚‚â‚ƒ) = 1.0/s .* (Ïƒâ‚â‚-p,Ïƒâ‚‚â‚‚-p,Ïƒâ‚ƒâ‚ƒ-p,Ïƒâ‚â‚‚,Ïƒâ‚â‚ƒ,Ïƒâ‚‚â‚ƒ)
        r = (Bâ‚â‚*Bâ‚‚â‚‚*Bâ‚ƒâ‚ƒ+2.0*Bâ‚â‚‚*Bâ‚â‚ƒ*Bâ‚‚â‚ƒ-Bâ‚â‚*Bâ‚‚â‚ƒ^2-Bâ‚‚â‚‚*Bâ‚â‚ƒ^2-Bâ‚ƒâ‚ƒ*Bâ‚â‚‚^2)/2.0

        if râ‰¤-1.0
            Î¸ = Ï€/3.0
        elseif râ‰¥1.0
            Î¸ = 0.0
        else
            Î¸ = acos(r)/3.0
        end

        Ïƒâ‚ = p + 2.0*s*cos(Î¸)
        Ïƒâ‚ƒ = p + 2.0*s*cos(Î¸+2.0/3.0*Ï€)
        Ïƒâ‚‚ = 3.0*p -Ïƒâ‚-Ïƒâ‚ƒ
    end

    Nâ‚ = (
        (Ïƒâ‚â‚-Ïƒâ‚‚)*(Ïƒâ‚â‚-Ïƒâ‚ƒ)+Ïƒâ‚â‚‚*Ïƒâ‚â‚‚     +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚ƒ
       +(Ïƒâ‚â‚-Ïƒâ‚‚)*Ïƒâ‚â‚‚     +Ïƒâ‚â‚‚*(Ïƒâ‚‚â‚‚-Ïƒâ‚ƒ)+Ïƒâ‚â‚ƒ*Ïƒâ‚‚â‚ƒ
       +(Ïƒâ‚â‚-Ïƒâ‚‚)*Ïƒâ‚â‚ƒ     +Ïƒâ‚â‚‚*Ïƒâ‚‚â‚ƒ     +Ïƒâ‚â‚ƒ*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚ƒ),
        Ïƒâ‚â‚‚*(Ïƒâ‚â‚-Ïƒâ‚ƒ)+(Ïƒâ‚‚â‚‚-Ïƒâ‚‚)*Ïƒâ‚â‚‚     +Ïƒâ‚‚â‚ƒ*Ïƒâ‚â‚ƒ
       +Ïƒâ‚â‚‚*Ïƒâ‚â‚‚     +(Ïƒâ‚‚â‚‚-Ïƒâ‚‚)*(Ïƒâ‚‚â‚‚-Ïƒâ‚ƒ)+Ïƒâ‚‚â‚ƒ*Ïƒâ‚‚â‚ƒ
       +Ïƒâ‚â‚‚*Ïƒâ‚â‚ƒ     +(Ïƒâ‚‚â‚‚-Ïƒâ‚‚)*Ïƒâ‚‚â‚ƒ     +Ïƒâ‚‚â‚ƒ*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚ƒ),
        Ïƒâ‚â‚ƒ*(Ïƒâ‚â‚-Ïƒâ‚ƒ)+Ïƒâ‚‚â‚ƒ*Ïƒâ‚â‚‚     +(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚‚)*Ïƒâ‚â‚ƒ
       +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚‚     +Ïƒâ‚‚â‚ƒ*(Ïƒâ‚‚â‚‚-Ïƒâ‚ƒ)+(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚‚)*Ïƒâ‚‚â‚ƒ
       +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚ƒ     +Ïƒâ‚‚â‚ƒ*Ïƒâ‚‚â‚ƒ     +(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚‚)*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚ƒ)
    )
    Nâ‚‚ = (
        (Ïƒâ‚â‚-Ïƒâ‚)*(Ïƒâ‚â‚-Ïƒâ‚ƒ)+Ïƒâ‚â‚‚*Ïƒâ‚â‚‚     +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚ƒ
       +(Ïƒâ‚â‚-Ïƒâ‚)*Ïƒâ‚â‚‚     +Ïƒâ‚â‚‚*(Ïƒâ‚‚â‚‚-Ïƒâ‚ƒ)+Ïƒâ‚â‚ƒ*Ïƒâ‚‚â‚ƒ
       +(Ïƒâ‚â‚-Ïƒâ‚)*Ïƒâ‚â‚ƒ     +Ïƒâ‚â‚‚*Ïƒâ‚‚â‚ƒ     +Ïƒâ‚â‚ƒ*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚ƒ),
        Ïƒâ‚â‚‚*(Ïƒâ‚â‚-Ïƒâ‚ƒ)+(Ïƒâ‚‚â‚‚-Ïƒâ‚)*Ïƒâ‚â‚‚     +Ïƒâ‚‚â‚ƒ*Ïƒâ‚â‚ƒ
       +Ïƒâ‚â‚‚*Ïƒâ‚â‚‚     +(Ïƒâ‚‚â‚‚-Ïƒâ‚)*(Ïƒâ‚‚â‚‚-Ïƒâ‚ƒ)+Ïƒâ‚‚â‚ƒ*Ïƒâ‚‚â‚ƒ
       +Ïƒâ‚â‚‚*Ïƒâ‚â‚ƒ     +(Ïƒâ‚‚â‚‚-Ïƒâ‚)*Ïƒâ‚‚â‚ƒ     +Ïƒâ‚‚â‚ƒ*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚ƒ),
        Ïƒâ‚â‚ƒ*(Ïƒâ‚â‚-Ïƒâ‚ƒ)+Ïƒâ‚‚â‚ƒ*Ïƒâ‚â‚‚     +(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚)*Ïƒâ‚â‚ƒ
       +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚‚     +Ïƒâ‚‚â‚ƒ*(Ïƒâ‚‚â‚‚-Ïƒâ‚ƒ)+(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚)*Ïƒâ‚‚â‚ƒ
       +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚ƒ     +Ïƒâ‚‚â‚ƒ*Ïƒâ‚‚â‚ƒ     +(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚)*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚ƒ)
    )
    Nâ‚ƒ = (
        (Ïƒâ‚â‚-Ïƒâ‚)*(Ïƒâ‚â‚-Ïƒâ‚‚)+Ïƒâ‚â‚‚*Ïƒâ‚â‚‚     +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚ƒ
       +(Ïƒâ‚â‚-Ïƒâ‚)*Ïƒâ‚â‚‚     +Ïƒâ‚â‚‚*(Ïƒâ‚‚â‚‚-Ïƒâ‚‚)+Ïƒâ‚â‚ƒ*Ïƒâ‚‚â‚ƒ
       +(Ïƒâ‚â‚-Ïƒâ‚)*Ïƒâ‚â‚ƒ     +Ïƒâ‚â‚‚*Ïƒâ‚‚â‚ƒ     +Ïƒâ‚â‚ƒ*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚‚),
        Ïƒâ‚â‚‚*(Ïƒâ‚â‚-Ïƒâ‚‚)+(Ïƒâ‚‚â‚‚-Ïƒâ‚)*Ïƒâ‚â‚‚     +Ïƒâ‚‚â‚ƒ*Ïƒâ‚â‚ƒ
       +Ïƒâ‚â‚‚*Ïƒâ‚â‚‚     +(Ïƒâ‚‚â‚‚-Ïƒâ‚)*(Ïƒâ‚‚â‚‚-Ïƒâ‚‚)+Ïƒâ‚‚â‚ƒ*Ïƒâ‚‚â‚ƒ
       +Ïƒâ‚â‚‚*Ïƒâ‚â‚ƒ     +(Ïƒâ‚‚â‚‚-Ïƒâ‚)*Ïƒâ‚‚â‚ƒ     +Ïƒâ‚‚â‚ƒ*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚‚),
        Ïƒâ‚â‚ƒ*(Ïƒâ‚â‚-Ïƒâ‚‚)+Ïƒâ‚‚â‚ƒ*Ïƒâ‚â‚‚     +(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚)*Ïƒâ‚â‚ƒ
       +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚‚     +Ïƒâ‚‚â‚ƒ*(Ïƒâ‚‚â‚‚-Ïƒâ‚‚)+(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚)*Ïƒâ‚‚â‚ƒ
       +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚ƒ     +Ïƒâ‚‚â‚ƒ*Ïƒâ‚‚â‚ƒ     +(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚)*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚‚)
    )
    normNâ‚ = (Nâ‚[1]^2+Nâ‚[2]^2+Nâ‚[3]^2)^0.5
    normNâ‚‚ = (Nâ‚‚[1]^2+Nâ‚‚[2]^2+Nâ‚‚[3]^2)^0.5
    normNâ‚ƒ = (Nâ‚ƒ[1]^2+Nâ‚ƒ[2]^2+Nâ‚ƒ[3]^2)^0.5
    nâ‚ = (Nâ‚[1]/normNâ‚,Nâ‚[2]/normNâ‚,Nâ‚[3]/normNâ‚)
    nâ‚‚ = (Nâ‚‚[1]/normNâ‚‚,Nâ‚‚[2]/normNâ‚‚,Nâ‚‚[3]/normNâ‚‚)
    nâ‚ƒ = (Nâ‚ƒ[1]/normNâ‚ƒ,Nâ‚ƒ[2]/normNâ‚ƒ,Nâ‚ƒ[3]/normNâ‚ƒ)
    return Ïƒâ‚,Ïƒâ‚‚,Ïƒâ‚ƒ,nâ‚,nâ‚‚,nâ‚ƒ
end

function Lâ‚‚(ap::T) where T<:AbstractElement
    Î”uÂ²= 0
    uÌ„Â² = 0
    for Î¾ in ap.ð“–
        ð‘¤ = Î¾.ð‘¤
        N = Î¾[:ð­]
        uÌ„â‚ = Î¾.u
        uÌ„â‚‚ = Î¾.v
        uâ‚ = 0.
        uâ‚‚ = 0.
        for (i,xáµ¢) in enumerate(ap.ð“’)
            uâ‚ += N[i]*xáµ¢.dâ‚
            uâ‚‚ += N[i]*xáµ¢.dâ‚‚
        end
        Î”uÂ² += ((uâ‚ - uÌ„â‚)^2 + (uâ‚‚ - uÌ„â‚‚)^2)*ð‘¤
        uÌ„Â² += (uÌ„â‚^2 + uÌ„â‚‚^2)*ð‘¤
    end
    return Î”uÂ², uÌ„Â²
end

function Lâ‚‚(aps::Vector{T}) where T<:AbstractElement
    Lâ‚‚Norm_Î”uÂ²= 0.0
    Lâ‚‚Norm_uÌ„Â² = 0.0
    for ap in aps
        Î”uÂ², uÌ„Â² = Lâ‚‚(ap)
        Lâ‚‚Norm_Î”uÂ² += Î”uÂ²
        Lâ‚‚Norm_uÌ„Â²  += uÌ„Â²
    end
    return (Lâ‚‚Norm_Î”uÂ²/Lâ‚‚Norm_uÌ„Â²)^0.5
end

function Lâ‚‚ð‘(ap::T) where T<:AbstractElement
    Î”pÂ²= 0
    pÌ„Â² = 0
    for Î¾ in ap.ð“–
        ð‘¤ = Î¾.ð‘¤
        N = Î¾[:ð­]
        pÌ„ = Î¾.p
        p = 0.
        for (i,xáµ¢) in enumerate(ap.ð“’)
            p += N[i]*xáµ¢.p
        end
        Î”pÂ² += (p - pÌ„)^2*ð‘¤
        pÌ„Â² += pÌ„^2*ð‘¤
    end
    return Î”pÂ², pÌ„Â²
end

function Lâ‚‚ð‘(aps::Vector{T}) where T<:AbstractElement
    Lâ‚‚Norm_Î”pÂ²= 0.0
    Lâ‚‚Norm_pÌ„Â² = 0.0
    for ap in aps
        Î”pÂ², pÌ„Â² = Lâ‚‚ð‘(ap)
        Lâ‚‚Norm_Î”pÂ² += Î”pÂ²
        Lâ‚‚Norm_pÌ„Â²  += pÌ„Â²
    end
    return (Lâ‚‚Norm_Î”pÂ²/Lâ‚‚Norm_pÌ„Â²)^0.5
end


function Hâ‚‘_PlaneStress(ap::T) where T<:AbstractElement
    Î”WÂ²= 0
    WÌ„Â² = 0
    Î”uÂ²= 0
    uÌ„Â² = 0
    for Î¾ in ap.ð“–
        ð‘¤ = Î¾.ð‘¤
        N = Î¾[:ð­]
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµ¢áµ¢áµ¢áµ¢ = E/(1-Î½^2)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-Î½^2)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
        uÌ„â‚ = Î¾.u
        uÌ„â‚‚ = Î¾.v
        âˆ‚uÌ„â‚âˆ‚x = Î¾.âˆ‚uâˆ‚x
        âˆ‚uÌ„â‚âˆ‚y = Î¾.âˆ‚uâˆ‚y
        âˆ‚uÌ„â‚‚âˆ‚x = Î¾.âˆ‚vâˆ‚x
        âˆ‚uÌ„â‚‚âˆ‚y = Î¾.âˆ‚vâˆ‚y
        ÎµÌ„â‚â‚ = âˆ‚uÌ„â‚âˆ‚x
        ÎµÌ„â‚‚â‚‚ = âˆ‚uÌ„â‚‚âˆ‚y
        ÎµÌ„â‚â‚‚ = âˆ‚uÌ„â‚âˆ‚y + âˆ‚uÌ„â‚‚âˆ‚x
        ÏƒÌ„â‚â‚ = Cáµ¢áµ¢áµ¢áµ¢*ÎµÌ„â‚â‚ + Cáµ¢áµ¢â±¼â±¼*ÎµÌ„â‚‚â‚‚
        ÏƒÌ„â‚‚â‚‚ = Cáµ¢áµ¢â±¼â±¼*ÎµÌ„â‚â‚ + Cáµ¢áµ¢áµ¢áµ¢*ÎµÌ„â‚‚â‚‚ 
        ÏƒÌ„â‚â‚‚ = Cáµ¢â±¼áµ¢â±¼*ÎµÌ„â‚â‚‚
        uâ‚ = 0.
        uâ‚‚ = 0.
        Îµâ‚â‚ = 0.
        Îµâ‚‚â‚‚ = 0.
        Îµâ‚â‚‚ = 0.
        for (i,xáµ¢) in enumerate(ap.ð“’)
            uâ‚ += N[i]*xáµ¢.dâ‚
            uâ‚‚ += N[i]*xáµ¢.dâ‚‚
            Îµâ‚â‚ += Bâ‚[i]*xáµ¢.dâ‚
            Îµâ‚‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚‚
            Îµâ‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚ + Bâ‚[i]*xáµ¢.dâ‚‚
        end
        Ïƒâ‚â‚ = Cáµ¢áµ¢áµ¢áµ¢*Îµâ‚â‚ + Cáµ¢áµ¢â±¼â±¼*Îµâ‚‚â‚‚
        Ïƒâ‚‚â‚‚ = Cáµ¢áµ¢â±¼â±¼*Îµâ‚â‚ + Cáµ¢áµ¢áµ¢áµ¢*Îµâ‚‚â‚‚ 
        Ïƒâ‚â‚‚ = Cáµ¢â±¼áµ¢â±¼*Îµâ‚â‚‚
        Î”WÂ² += 0.5*((Ïƒâ‚â‚-ÏƒÌ„â‚â‚)*(Îµâ‚â‚-ÎµÌ„â‚â‚) + (Ïƒâ‚‚â‚‚-ÏƒÌ„â‚‚â‚‚)*(Îµâ‚‚â‚‚-ÎµÌ„â‚‚â‚‚) + (Ïƒâ‚â‚‚-ÏƒÌ„â‚â‚‚)*(Îµâ‚â‚‚-ÎµÌ„â‚â‚‚))*ð‘¤
        WÌ„Â² += 0.5*(ÏƒÌ„â‚â‚*ÎµÌ„â‚â‚ + ÏƒÌ„â‚‚â‚‚*ÎµÌ„â‚‚â‚‚ + ÏƒÌ„â‚â‚‚*ÎµÌ„â‚â‚‚)*ð‘¤
        Î”uÂ² += ((uâ‚ - uÌ„â‚)^2 + (uâ‚‚ - uÌ„â‚‚)^2)*ð‘¤
        uÌ„Â² += (uÌ„â‚^2 + uÌ„â‚‚^2)*ð‘¤
    end
    return Î”WÂ², WÌ„Â², Î”uÂ², uÌ„Â²
end

function Hâ‚‘_PlaneStress(aps::Vector{T}) where T<:AbstractElement
    Hâ‚‘Norm_Î”WÂ²= 0.0
    Hâ‚‘Norm_WÌ„Â² = 0.0
    Lâ‚‚Norm_Î”uÂ²= 0.0
    Lâ‚‚Norm_uÌ„Â² = 0.0
    for ap in aps
        Î”WÂ², WÌ„Â², Î”uÂ², uÌ„Â² = Hâ‚‘_PlaneStress(ap)
        Hâ‚‘Norm_Î”WÂ² += Î”WÂ²
        Hâ‚‘Norm_WÌ„Â²  += WÌ„Â²
        Lâ‚‚Norm_Î”uÂ² += Î”uÂ²
        Lâ‚‚Norm_uÌ„Â²  += uÌ„Â²
    end
    return (Hâ‚‘Norm_Î”WÂ²/Hâ‚‘Norm_WÌ„Â²)^0.5, (Lâ‚‚Norm_Î”uÂ²/Lâ‚‚Norm_uÌ„Â²)^0.5
end

function Hâ‚‘_PlaneStrain_Deviatoric(ap::T) where T<:AbstractElement
    Î”WÂ²= 0
    WÌ„Â² = 0
    for Î¾ in ap.ð“–
        ð‘¤ = Î¾.ð‘¤
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµˆ = E/(1+Î½)
        âˆ‚uÌ„â‚âˆ‚x = Î¾.âˆ‚uâˆ‚x
        âˆ‚uÌ„â‚âˆ‚y = Î¾.âˆ‚uâˆ‚y
        âˆ‚uÌ„â‚‚âˆ‚x = Î¾.âˆ‚vâˆ‚x
        âˆ‚uÌ„â‚‚âˆ‚y = Î¾.âˆ‚vâˆ‚y
        ÎµÌ„â‚â‚ = âˆ‚uÌ„â‚âˆ‚x
        ÎµÌ„â‚‚â‚‚ = âˆ‚uÌ„â‚‚âˆ‚y
        ÎµÌ„â‚â‚‚ = âˆ‚uÌ„â‚âˆ‚y + âˆ‚uÌ„â‚‚âˆ‚x
        ÏƒÌ„â‚â‚ = Cáµˆ*( 2/3*ÎµÌ„â‚â‚ - 1/3*ÎµÌ„â‚‚â‚‚)
        ÏƒÌ„â‚‚â‚‚ = Cáµˆ*(-1/3*ÎµÌ„â‚â‚ + 2/3*ÎµÌ„â‚‚â‚‚)
        ÏƒÌ„â‚â‚‚ = Cáµˆ*ÎµÌ„â‚â‚‚/2
        Îµâ‚â‚ = 0.
        Îµâ‚‚â‚‚ = 0.
        Îµâ‚â‚‚ = 0.
        for (i,xáµ¢) in enumerate(ap.ð“’)
            Îµâ‚â‚ += Bâ‚[i]*xáµ¢.dâ‚
            Îµâ‚‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚‚
            Îµâ‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚ + Bâ‚[i]*xáµ¢.dâ‚‚
        end
        Ïƒâ‚â‚ = Cáµˆ*( 2/3*Îµâ‚â‚ - 1/3*Îµâ‚‚â‚‚)
        Ïƒâ‚‚â‚‚ = Cáµˆ*(-1/3*Îµâ‚â‚ + 2/3*Îµâ‚‚â‚‚)
        Ïƒâ‚â‚‚ = Cáµˆ*Îµâ‚â‚‚/2
        Î”WÂ² += 0.5*((Ïƒâ‚â‚-ÏƒÌ„â‚â‚)*(Îµâ‚â‚-ÎµÌ„â‚â‚) + (Ïƒâ‚‚â‚‚-ÏƒÌ„â‚‚â‚‚)*(Îµâ‚‚â‚‚-ÎµÌ„â‚‚â‚‚) + (Ïƒâ‚â‚‚-ÏƒÌ„â‚â‚‚)*(Îµâ‚â‚‚-ÎµÌ„â‚â‚‚))*ð‘¤
        WÌ„Â² += 0.5*(ÏƒÌ„â‚â‚*ÎµÌ„â‚â‚ + ÏƒÌ„â‚‚â‚‚*ÎµÌ„â‚‚â‚‚ + ÏƒÌ„â‚â‚‚*ÎµÌ„â‚â‚‚)*ð‘¤
    end
    return Î”WÂ², WÌ„Â²
end

function Hâ‚‘_PlaneStrain_Deviatoric(aps::Vector{T}) where T<:AbstractElement
    Hâ‚‘Norm_Î”WÂ²= 0.0
    Hâ‚‘Norm_WÌ„Â² = 0.0
    for ap in aps
        Î”WÂ², WÌ„Â² = Hâ‚‘_PlaneStrain_Deviatoric(ap)
        Hâ‚‘Norm_Î”WÂ² += Î”WÂ²
        Hâ‚‘Norm_WÌ„Â²  += WÌ„Â²
    end
    return (Hâ‚‘Norm_Î”WÂ²/Hâ‚‘Norm_WÌ„Â²)^0.5
end

function Hâ‚‘_PlaneStrain_Dil(ap::T) where T<:AbstractElement
    Î”WÂ²= 0
    WÌ„Â² = 0
    for Î¾ in ap.ð“–
        ð‘¤ = Î¾.ð‘¤
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµ¢áµ¢áµ¢áµ¢ = E/(1+Î½)/(1-2*Î½)*(1-Î½)
        Cáµ¢áµ¢â±¼â±¼ = E/(1+Î½)/(1-2*Î½)*Î½
        Cáµ¢â±¼áµ¢â±¼ = E/(1+Î½)/2
        K=E/3/(1-2Î½)
        G=E/2/(1+Î½)
        âˆ‚uÌ„â‚âˆ‚x = Î¾.âˆ‚uâˆ‚x
        âˆ‚uÌ„â‚âˆ‚y = Î¾.âˆ‚uâˆ‚y
        âˆ‚uÌ„â‚‚âˆ‚x = Î¾.âˆ‚vâˆ‚x
        âˆ‚uÌ„â‚‚âˆ‚y = Î¾.âˆ‚vâˆ‚y
        ÎµÌ„â‚â‚ = âˆ‚uÌ„â‚âˆ‚x
        ÎµÌ„â‚‚â‚‚ = âˆ‚uÌ„â‚‚âˆ‚y
        ÎµÌ„â‚â‚‚ = âˆ‚uÌ„â‚âˆ‚y + âˆ‚uÌ„â‚‚âˆ‚x
       
        ÏƒÌ„â‚â‚ = Cáµ¢áµ¢áµ¢áµ¢*ÎµÌ„â‚â‚ + Cáµ¢áµ¢â±¼â±¼*ÎµÌ„â‚‚â‚‚
        ÏƒÌ„â‚‚â‚‚ = Cáµ¢áµ¢â±¼â±¼*ÎµÌ„â‚â‚ + Cáµ¢áµ¢áµ¢áµ¢*ÎµÌ„â‚‚â‚‚
        ÏƒÌ„â‚â‚‚ = Cáµ¢â±¼áµ¢â±¼*ÎµÌ„â‚â‚‚
        pÌ„ = (ÏƒÌ„â‚â‚ + ÏƒÌ„â‚‚â‚‚)/2
        Îµâ‚â‚ = 0.
        Îµâ‚‚â‚‚ = 0.
        Îµâ‚â‚‚ = 0.
        for (i,xáµ¢) in enumerate(ap.ð“’)
            Îµâ‚â‚ += Bâ‚[i]*xáµ¢.dâ‚
            Îµâ‚‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚‚
            Îµâ‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚ + Bâ‚[i]*xáµ¢.dâ‚‚
        end
        Ïƒâ‚â‚ = Cáµ¢áµ¢áµ¢áµ¢*Îµâ‚â‚ + Cáµ¢áµ¢â±¼â±¼*Îµâ‚‚â‚‚
        Ïƒâ‚‚â‚‚ = Cáµ¢áµ¢â±¼â±¼*Îµâ‚â‚ + Cáµ¢áµ¢áµ¢áµ¢*Îµâ‚‚â‚‚ 
        p = (Ïƒâ‚â‚ + Ïƒâ‚‚â‚‚)/2
        
        Î”WÂ² += (3*(p-pÌ„)^2/2/K)*ð‘¤
        WÌ„Â² += (3*pÌ„^2/2/K)*ð‘¤
    end
    return Î”WÂ², WÌ„Â²
end

function Hâ‚‘_PlaneStrain_Dil(aps::Vector{T}) where T<:AbstractElement
    Hâ‚‘Norm_Î”WÂ²= 0.0
    Hâ‚‘Norm_WÌ„Â² = 0.0
    for ap in aps
        Î”WÂ², WÌ„Â² = Hâ‚‘_PlaneStrain_Dil(ap)
        Hâ‚‘Norm_Î”WÂ² += Î”WÂ²
        Hâ‚‘Norm_WÌ„Â²  += WÌ„Â²
    end
    return (Hâ‚‘Norm_Î”WÂ²/Hâ‚‘Norm_WÌ„Â²)^0.5
end


function ð¿â‚‚_PlaneStrain_Pressure(ap::T) where T<:AbstractElement
    Î”WÂ²= 0
    WÌ„Â² = 0
    for Î¾ in ap.ð“–
        ð‘¤ = Î¾.ð‘¤
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        E = Î¾.E
        Î½ = Î¾.Î½
        K=E/3/(1-2Î½)
        G=E/2/(1+Î½)
        Cáµ¢áµ¢áµ¢áµ¢ = E/(1+Î½)/(1-2*Î½)*(1-Î½)
        Cáµ¢áµ¢â±¼â±¼ = E/(1+Î½)/(1-2*Î½)*Î½
        Cáµ¢â±¼áµ¢â±¼ = E/(1+Î½)/2
        âˆ‚uÌ„â‚âˆ‚x = Î¾.âˆ‚uâˆ‚x
        âˆ‚uÌ„â‚âˆ‚y = Î¾.âˆ‚uâˆ‚y
        âˆ‚uÌ„â‚‚âˆ‚x = Î¾.âˆ‚vâˆ‚x
        âˆ‚uÌ„â‚‚âˆ‚y = Î¾.âˆ‚vâˆ‚y
        ÎµÌ„â‚â‚ = âˆ‚uÌ„â‚âˆ‚x
        ÎµÌ„â‚‚â‚‚ = âˆ‚uÌ„â‚‚âˆ‚y
        ÎµÌ„â‚â‚‚ = âˆ‚uÌ„â‚âˆ‚y + âˆ‚uÌ„â‚‚âˆ‚x
       
        ÏƒÌ„â‚â‚ = Cáµ¢áµ¢áµ¢áµ¢*ÎµÌ„â‚â‚ + Cáµ¢áµ¢â±¼â±¼*ÎµÌ„â‚‚â‚‚
        ÏƒÌ„â‚‚â‚‚ = Cáµ¢áµ¢â±¼â±¼*ÎµÌ„â‚â‚ + Cáµ¢áµ¢áµ¢áµ¢*ÎµÌ„â‚‚â‚‚
        ÏƒÌ„â‚â‚‚ = Cáµ¢â±¼áµ¢â±¼*ÎµÌ„â‚â‚‚
        pÌ„ = (ÏƒÌ„â‚â‚ + ÏƒÌ„â‚‚â‚‚)/2
        Îµâ‚â‚ = 0.
        Îµâ‚‚â‚‚ = 0.
        Îµâ‚â‚‚ = 0.
        for (i,xáµ¢) in enumerate(ap.ð“’)
            Îµâ‚â‚ += Bâ‚[i]*xáµ¢.dâ‚
            Îµâ‚‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚‚
            Îµâ‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚ + Bâ‚[i]*xáµ¢.dâ‚‚
        end
        Ïƒâ‚â‚ = Cáµ¢áµ¢áµ¢áµ¢*Îµâ‚â‚ + Cáµ¢áµ¢â±¼â±¼*Îµâ‚‚â‚‚
        Ïƒâ‚‚â‚‚ = Cáµ¢áµ¢â±¼â±¼*Îµâ‚â‚ + Cáµ¢áµ¢áµ¢áµ¢*Îµâ‚‚â‚‚ 
        p = (Ïƒâ‚â‚ + Ïƒâ‚‚â‚‚)/2
        
        Î”WÂ² += ((p-pÌ„)^2)*ð‘¤
        WÌ„Â² += (pÌ„^2)*ð‘¤
    end
    return Î”WÂ², WÌ„Â²
end

function ð¿â‚‚_PlaneStrain_Pressure(aps::Vector{T}) where T<:AbstractElement
    Hâ‚‘Norm_Î”WÂ²= 0.0
    Hâ‚‘Norm_WÌ„Â² = 0.0
    for ap in aps
        Î”WÂ², WÌ„Â² = ð¿â‚‚_PlaneStrain_Pressure(ap)
        Hâ‚‘Norm_Î”WÂ² += Î”WÂ²
        Hâ‚‘Norm_WÌ„Â²  += WÌ„Â²
    end
    return (Hâ‚‘Norm_Î”WÂ²/Hâ‚‘Norm_WÌ„Â²)^0.5
end
function Hâ‚‘(ap::T) where T<:AbstractElement
    Î”WÂ²= 0
    WÌ„Â² = 0
    Î”uÂ²= 0
    uÌ„Â² = 0
    for Î¾ in ap.ð“–
        ð‘¤ = Î¾.ð‘¤
        N = Î¾[:ð­]
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        Bâ‚ƒ = Î¾[:âˆ‚ð­âˆ‚z]
        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµ¢áµ¢áµ¢áµ¢ = E*(1-Î½)/(1-2*Î½)/(1+Î½)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-2*Î½)/(1+Î½)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
        uÌ„â‚ = Î¾.uâ‚
        uÌ„â‚‚ = Î¾.uâ‚‚
        uÌ„â‚ƒ = Î¾.uâ‚ƒ
        âˆ‚uÌ„â‚âˆ‚x = Î¾.âˆ‚uâ‚âˆ‚x
        âˆ‚uÌ„â‚âˆ‚y = Î¾.âˆ‚uâ‚âˆ‚y
        âˆ‚uÌ„â‚âˆ‚z = Î¾.âˆ‚uâ‚âˆ‚z
        âˆ‚uÌ„â‚‚âˆ‚x = Î¾.âˆ‚uâ‚‚âˆ‚x
        âˆ‚uÌ„â‚‚âˆ‚y = Î¾.âˆ‚uâ‚‚âˆ‚y
        âˆ‚uÌ„â‚‚âˆ‚z = Î¾.âˆ‚uâ‚‚âˆ‚z
        âˆ‚uÌ„â‚ƒâˆ‚x = Î¾.âˆ‚uâ‚ƒâˆ‚x
        âˆ‚uÌ„â‚ƒâˆ‚y = Î¾.âˆ‚uâ‚ƒâˆ‚y
        âˆ‚uÌ„â‚ƒâˆ‚z = Î¾.âˆ‚uâ‚ƒâˆ‚z
        ÎµÌ„â‚â‚ = âˆ‚uÌ„â‚âˆ‚x
        ÎµÌ„â‚‚â‚‚ = âˆ‚uÌ„â‚‚âˆ‚y
        ÎµÌ„â‚ƒâ‚ƒ = âˆ‚uÌ„â‚ƒâˆ‚z
        ÎµÌ„â‚â‚‚ = âˆ‚uÌ„â‚âˆ‚y + âˆ‚uÌ„â‚‚âˆ‚x
        ÎµÌ„â‚â‚ƒ = âˆ‚uÌ„â‚âˆ‚z + âˆ‚uÌ„â‚ƒâˆ‚x
        ÎµÌ„â‚‚â‚ƒ = âˆ‚uÌ„â‚‚âˆ‚z + âˆ‚uÌ„â‚ƒâˆ‚y
        ÏƒÌ„â‚â‚ = Cáµ¢áµ¢áµ¢áµ¢*ÎµÌ„â‚â‚ + Cáµ¢áµ¢â±¼â±¼*ÎµÌ„â‚‚â‚‚ + Cáµ¢áµ¢â±¼â±¼*ÎµÌ„â‚ƒâ‚ƒ
        ÏƒÌ„â‚‚â‚‚ = Cáµ¢áµ¢â±¼â±¼*ÎµÌ„â‚â‚ + Cáµ¢áµ¢áµ¢áµ¢*ÎµÌ„â‚‚â‚‚ + Cáµ¢áµ¢â±¼â±¼*ÎµÌ„â‚ƒâ‚ƒ 
        ÏƒÌ„â‚ƒâ‚ƒ = Cáµ¢áµ¢â±¼â±¼*ÎµÌ„â‚â‚ + Cáµ¢áµ¢â±¼â±¼*ÎµÌ„â‚‚â‚‚ + Cáµ¢áµ¢áµ¢áµ¢*ÎµÌ„â‚ƒâ‚ƒ 
        ÏƒÌ„â‚â‚‚ = Cáµ¢â±¼áµ¢â±¼*ÎµÌ„â‚â‚‚
        ÏƒÌ„â‚â‚ƒ = Cáµ¢â±¼áµ¢â±¼*ÎµÌ„â‚â‚ƒ
        ÏƒÌ„â‚‚â‚ƒ = Cáµ¢â±¼áµ¢â±¼*ÎµÌ„â‚‚â‚ƒ
        uâ‚ = 0.
        uâ‚‚ = 0.
        uâ‚ƒ = 0.
        Îµâ‚â‚ = 0.
        Îµâ‚‚â‚‚ = 0.
        Îµâ‚ƒâ‚ƒ = 0.
        Îµâ‚â‚‚ = 0.
        Îµâ‚â‚ƒ = 0.
        Îµâ‚‚â‚ƒ = 0.
        for (i,xáµ¢) in enumerate(ap.ð“’)
            uâ‚ += N[i]*xáµ¢.dâ‚
            uâ‚‚ += N[i]*xáµ¢.dâ‚‚
            uâ‚ƒ += N[i]*xáµ¢.dâ‚ƒ   
            Îµâ‚â‚ += Bâ‚[i]*xáµ¢.dâ‚
            Îµâ‚‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚‚
            Îµâ‚ƒâ‚ƒ += Bâ‚ƒ[i]*xáµ¢.dâ‚ƒ
            Îµâ‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚ + Bâ‚[i]*xáµ¢.dâ‚‚
            Îµâ‚â‚ƒ += Bâ‚ƒ[i]*xáµ¢.dâ‚ + Bâ‚[i]*xáµ¢.dâ‚ƒ
            Îµâ‚‚â‚ƒ += Bâ‚ƒ[i]*xáµ¢.dâ‚‚ + Bâ‚‚[i]*xáµ¢.dâ‚ƒ
        end
        Ïƒâ‚â‚ = Cáµ¢áµ¢áµ¢áµ¢*Îµâ‚â‚ + Cáµ¢áµ¢â±¼â±¼*Îµâ‚‚â‚‚ + Cáµ¢áµ¢â±¼â±¼*Îµâ‚ƒâ‚ƒ
        Ïƒâ‚‚â‚‚ = Cáµ¢áµ¢â±¼â±¼*Îµâ‚â‚ + Cáµ¢áµ¢áµ¢áµ¢*Îµâ‚‚â‚‚ + Cáµ¢áµ¢â±¼â±¼*Îµâ‚ƒâ‚ƒ 
        Ïƒâ‚ƒâ‚ƒ = Cáµ¢áµ¢â±¼â±¼*Îµâ‚â‚ + Cáµ¢áµ¢â±¼â±¼*Îµâ‚‚â‚‚ + Cáµ¢áµ¢áµ¢áµ¢*Îµâ‚ƒâ‚ƒ 
        Ïƒâ‚â‚‚ = Cáµ¢â±¼áµ¢â±¼*Îµâ‚â‚‚
        Ïƒâ‚â‚ƒ = Cáµ¢â±¼áµ¢â±¼*Îµâ‚â‚ƒ
        Ïƒâ‚‚â‚ƒ = Cáµ¢â±¼áµ¢â±¼*Îµâ‚‚â‚ƒ
        Î”WÂ² += 0.5*((Ïƒâ‚â‚-ÏƒÌ„â‚â‚)*(Îµâ‚â‚-ÎµÌ„â‚â‚) + (Ïƒâ‚‚â‚‚-ÏƒÌ„â‚‚â‚‚)*(Îµâ‚‚â‚‚-ÎµÌ„â‚‚â‚‚) + (Ïƒâ‚ƒâ‚ƒ-ÏƒÌ„â‚ƒâ‚ƒ)*(Îµâ‚ƒâ‚ƒ-ÎµÌ„â‚ƒâ‚ƒ) + (Ïƒâ‚â‚‚-ÏƒÌ„â‚â‚‚)*(Îµâ‚â‚‚-ÎµÌ„â‚â‚‚) + (Ïƒâ‚â‚ƒ-ÏƒÌ„â‚â‚ƒ)*(Îµâ‚â‚ƒ-ÎµÌ„â‚â‚ƒ) + (Ïƒâ‚‚â‚ƒ-ÏƒÌ„â‚‚â‚ƒ)*(Îµâ‚‚â‚ƒ-ÎµÌ„â‚‚â‚ƒ))*ð‘¤
        WÌ„Â² += 0.5*(ÏƒÌ„â‚â‚*ÎµÌ„â‚â‚ + ÏƒÌ„â‚‚â‚‚*ÎµÌ„â‚‚â‚‚ + ÏƒÌ„â‚ƒâ‚ƒ*ÎµÌ„â‚ƒâ‚ƒ + ÏƒÌ„â‚â‚‚*ÎµÌ„â‚â‚‚ + ÏƒÌ„â‚â‚ƒ*ÎµÌ„â‚â‚ƒ + ÏƒÌ„â‚‚â‚ƒ*ÎµÌ„â‚‚â‚ƒ)*ð‘¤
        Î”uÂ² += ((uâ‚ - uÌ„â‚)^2 + (uâ‚‚ - uÌ„â‚‚)^2 + (uâ‚ƒ - uÌ„â‚ƒ)^2)*ð‘¤
        uÌ„Â² += (uÌ„â‚^2 + uÌ„â‚‚^2 + uÌ„â‚ƒ^2)*ð‘¤
    end
    return Î”WÂ², WÌ„Â², Î”uÂ², uÌ„Â²
end

function Hâ‚‘(aps::Vector{T}) where T<:AbstractElement
    Hâ‚‘Norm_Î”WÂ²= 0.0
    Hâ‚‘Norm_WÌ„Â² = 0.0
    Lâ‚‚Norm_Î”uÂ²= 0.0
    Lâ‚‚Norm_uÌ„Â² = 0.0
    for ap in aps
        Î”WÂ², WÌ„Â², Î”uÂ², uÌ„Â² = Hâ‚‘(ap)
        Hâ‚‘Norm_Î”WÂ² += Î”WÂ²
        Hâ‚‘Norm_WÌ„Â²  += WÌ„Â²
        Lâ‚‚Norm_Î”uÂ² += Î”uÂ²
        Lâ‚‚Norm_uÌ„Â²  += uÌ„Â²
    end
    return (Hâ‚‘Norm_Î”WÂ²/Hâ‚‘Norm_WÌ„Â²)^0.5, (Lâ‚‚Norm_Î”uÂ²/Lâ‚‚Norm_uÌ„Â²)^0.5
end
end