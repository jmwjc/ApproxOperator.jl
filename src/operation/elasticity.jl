function (op::Operator{:âˆ«âˆ«Ïváµ¢uáµ¢dxdy})(ap::T;k::AbstractMatrix{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’;ğ“– = ap.ğ“–
    Ï = op.Ï
    for Î¾ in ğ“–
        N = Î¾[:ğ­]
        ğ‘¤ = Î¾.ğ‘¤
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[2*I-1,2*J-1] += Ï*N[i]*N[j]*ğ‘¤
                k[2*I,2*J]     += Ï*N[i]*N[j]*ğ‘¤
            end
        end
    end
end
function (op::Operator{:âˆ«âˆ«Îµáµ¢â±¼Ïƒáµ¢â±¼váµ¢báµ¢dxdy})(ap::T;k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    E = op.E
    Î½ = op.Î½
    for Î¾ in ğ“–
        N = Î¾[:ğ­]
        Bâ‚ = Î¾[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ğ­âˆ‚y]
        ğ‘¤ = Î¾.ğ‘¤
        Cáµ¢áµ¢áµ¢áµ¢ = E/(1-Î½^2)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-Î½^2)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
        bâ‚ = Î¾.bâ‚
        bâ‚‚ = Î¾.bâ‚‚
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[2*I-1,2*J-1] += (Cáµ¢áµ¢áµ¢áµ¢*Bâ‚[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚‚[j])*ğ‘¤
                k[2*I-1,2*J]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚[j])*ğ‘¤
                k[2*I,2*J-1]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚‚[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚‚[j])*ğ‘¤
                k[2*I,2*J]     += (Cáµ¢áµ¢áµ¢áµ¢*Bâ‚‚[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚[j])*ğ‘¤
            end
            f[2*I-1] += N[i]*bâ‚*ğ‘¤
            f[2*I]   += N[i]*bâ‚‚*ğ‘¤
        end
    end
end

function (op::Operator{:âˆ«âˆ«Îµáµ¢â±¼Ïƒáµ¢â±¼dxdy})(ap::T;k::AbstractMatrix{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    E = op.E
    Î½ = op.Î½
    for Î¾ in ğ“–
        Bâ‚ = Î¾[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ğ­âˆ‚y]
        ğ‘¤ = Î¾.ğ‘¤
        Cáµ¢áµ¢áµ¢áµ¢ = E/(1-Î½^2)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-Î½^2)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[2*I-1,2*J-1] += (Cáµ¢áµ¢áµ¢áµ¢*Bâ‚[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚‚[j])*ğ‘¤
                k[2*I-1,2*J]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚[j])*ğ‘¤
                k[2*I,2*J-1]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚‚[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚‚[j])*ğ‘¤
                k[2*I,2*J]     += (Cáµ¢áµ¢áµ¢áµ¢*Bâ‚‚[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚[j])*ğ‘¤
            end
        end
    end
end

function (op::Operator{:âˆ«âˆ«Îµáµ›áµ¢â±¼Ïƒáµ›áµ¢â±¼dxdy})(ap::T;k::AbstractMatrix{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    E = op.E
    Î½ = op.Î½
    for Î¾ in ğ“–
        Bâ‚ = Î¾[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ğ­âˆ‚y]
        ğ‘¤ = Î¾.ğ‘¤
        Cáµ› = E/(1-2*Î½)
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[2*I-1,2*J-1] += Cáµ›/3*Bâ‚[i]*Bâ‚[j]*ğ‘¤
                k[2*I-1,2*J]   += Cáµ›/3*Bâ‚[i]*Bâ‚‚[j]*ğ‘¤
                k[2*I,2*J-1]   += Cáµ›/3*Bâ‚‚[i]*Bâ‚[j]*ğ‘¤
                k[2*I,2*J]     += Cáµ›/3*Bâ‚‚[i]*Bâ‚‚[j]*ğ‘¤
            end
        end
    end
end

function (op::Operator{:âˆ«âˆ«Îµáµˆáµ¢â±¼Ïƒáµˆáµ¢â±¼dxdy})(ap::T;k::AbstractMatrix{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    E = op.E
    Î½ = op.Î½
    Cáµˆ = E/(1+Î½)
    for Î¾ in ğ“–
        Bâ‚ = Î¾[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ğ­âˆ‚y]
        ğ‘¤ = Î¾.ğ‘¤
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[2*I-1,2*J-1] += Cáµˆ*( 2/3*Bâ‚[i]*Bâ‚[j]+1/2*Bâ‚‚[i]*Bâ‚‚[j])*ğ‘¤
                k[2*I-1,2*J]   += Cáµˆ*(-1/3*Bâ‚[i]*Bâ‚‚[j]+1/2*Bâ‚‚[i]*Bâ‚[j])*ğ‘¤
                k[2*I,2*J-1]   += Cáµˆ*(-1/3*Bâ‚‚[i]*Bâ‚[j]+1/2*Bâ‚[i]*Bâ‚‚[j])*ğ‘¤
                k[2*I,2*J]     += Cáµˆ*( 2/3*Bâ‚‚[i]*Bâ‚‚[j]+1/2*Bâ‚[i]*Bâ‚[j])*ğ‘¤
            end
        end
    end
end

function (op::Operator{:âˆ«âˆ«váµ¢báµ¢dxdy})(ap::T;f::AbstractVector{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        N = Î¾[:ğ­]
        ğ‘¤ = Î¾.ğ‘¤
        bâ‚ = Î¾.bâ‚
        bâ‚‚ = Î¾.bâ‚‚
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            f[2*I-1] += N[i]*bâ‚*ğ‘¤
            f[2*I]   += N[i]*bâ‚‚*ğ‘¤
        end
    end
end

function (op::Operator{:âˆ«váµ¢táµ¢ds})(ap::T;f::AbstractVector{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        N = Î¾[:ğ­]
        ğ‘¤ = Î¾.ğ‘¤
        tâ‚ = Î¾.tâ‚
        tâ‚‚ = Î¾.tâ‚‚
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            f[2*I-1] += N[i]*tâ‚*ğ‘¤
            f[2*I]   += N[i]*tâ‚‚*ğ‘¤
        end
    end
end

function (op::Operator{:âˆ«Î»áµ¢gáµ¢ds})(ap1::T,ap2::S;g::AbstractMatrix{Float64},q::AbstractVector{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    for j in 1:length(ap1.ğ“–)
        Î¾â‚ = ap1.ğ“–[j]
        Î¾â‚‚ = ap2.ğ“–[j]
        ğ‘¤ = Î¾â‚.ğ‘¤
        N = Î¾â‚[:ğ­]
        NÌ„ = Î¾â‚‚[:ğ­]
        gâ‚ = Î¾.gâ‚
        gâ‚‚ = Î¾.gâ‚‚
        nâ‚â‚ = Î¾.nâ‚â‚
        nâ‚‚â‚‚ = Î¾.nâ‚‚â‚‚
        nâ‚â‚‚ = Î¾.nâ‚â‚‚
        for (k,xâ‚–) in enumerate(ap2.ğ“’)
            K = xâ‚–.ğ¼
            for (i,xáµ¢) in enumerate(ap1.ğ“’)
                I = xáµ¢.ğ¼
                NÌ„â‚–Náµ¢ = NÌ„[k]*N[i]
                g[2*K-1,2*I-1] -= nâ‚â‚*NÌ„â‚–Náµ¢*ğ‘¤
                g[2*K-1,2*I]   -= nâ‚â‚‚*NÌ„â‚–Náµ¢*ğ‘¤
                g[2*K,2*I-1]   -= nâ‚â‚‚*NÌ„â‚–Náµ¢*ğ‘¤
                g[2*K,2*I]     -= nâ‚‚â‚‚*NÌ„â‚–Náµ¢*ğ‘¤
            end
            q[2*K-1] -= NÌ„[k]*(nâ‚â‚*gâ‚+nâ‚â‚‚*gâ‚‚)*ğ‘¤
            q[2*K]   -= NÌ„[k]*(nâ‚â‚‚*gâ‚+nâ‚‚â‚‚*gâ‚‚)*ğ‘¤
        end
    end
end

function (op::Operator{:âˆ«Ïƒáµ¢â±¼nâ±¼gáµ¢ds})(ap::T;k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    E = op.E
    Î½ = op.Î½
    Cáµ¢áµ¢áµ¢áµ¢ = E/(1-Î½^2)
    Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-Î½^2)
    Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
    for Î¾ in ğ“–
        ğ‘¤ = Î¾.ğ‘¤
        N = Î¾[:ğ­]
        Bâ‚ = Î¾[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ğ­âˆ‚y]
        nâ‚â‚ = Î¾.nâ‚â‚
        nâ‚â‚‚ = Î¾.nâ‚â‚‚
        nâ‚‚â‚‚ = Î¾.nâ‚‚â‚‚
        gâ‚ = Î¾.gâ‚
        gâ‚‚ = Î¾.gâ‚‚
        nâ‚ = Î¾.nâ‚
        nâ‚‚ = Î¾.nâ‚‚
        Câ‚â‚â‚ = Cáµ¢áµ¢áµ¢áµ¢*nâ‚*nâ‚â‚+Cáµ¢áµ¢â±¼â±¼*nâ‚‚*nâ‚â‚‚
        Câ‚â‚â‚‚ = Cáµ¢áµ¢áµ¢áµ¢*nâ‚*nâ‚â‚‚+Cáµ¢áµ¢â±¼â±¼*nâ‚‚*nâ‚‚â‚‚
        Câ‚‚â‚‚â‚ = Cáµ¢áµ¢â±¼â±¼*nâ‚*nâ‚â‚+Cáµ¢áµ¢áµ¢áµ¢*nâ‚‚*nâ‚â‚‚
        Câ‚‚â‚‚â‚‚ = Cáµ¢áµ¢â±¼â±¼*nâ‚*nâ‚â‚‚+Cáµ¢áµ¢áµ¢áµ¢*nâ‚‚*nâ‚‚â‚‚
        Câ‚â‚‚â‚ = Cáµ¢â±¼áµ¢â±¼*(nâ‚*nâ‚â‚‚+nâ‚‚*nâ‚â‚)
        Câ‚â‚‚â‚‚ = Cáµ¢â±¼áµ¢â±¼*(nâ‚‚*nâ‚â‚‚+nâ‚*nâ‚‚â‚‚)
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[2*I-1,2*J-1] -= (Câ‚â‚â‚*(N[i]*Bâ‚[j]+Bâ‚[i]*N[j]) + Câ‚â‚‚â‚*(N[i]*Bâ‚‚[j]+Bâ‚‚[i]*N[j]))*ğ‘¤
                k[2*I-1,2*J]   -= (Câ‚â‚‚â‚*N[i]*Bâ‚[j] + Câ‚â‚â‚‚*Bâ‚[i]*N[j] + Câ‚‚â‚‚â‚*N[i]*Bâ‚‚[j] + Câ‚â‚‚â‚‚*Bâ‚‚[i]*N[j])*ğ‘¤
                k[2*I,2*J-1]   -= (Câ‚â‚â‚‚*N[i]*Bâ‚[j] + Câ‚â‚‚â‚*Bâ‚[i]*N[j] + Câ‚â‚‚â‚‚*N[i]*Bâ‚‚[j] + Câ‚‚â‚‚â‚*Bâ‚‚[i]*N[j])*ğ‘¤
                k[2*I,2*J]     -= (Câ‚â‚‚â‚‚*(N[i]*Bâ‚[j]+Bâ‚[i]*N[j]) + Câ‚‚â‚‚â‚‚*(N[i]*Bâ‚‚[j]+Bâ‚‚[i]*N[j]))*ğ‘¤
            end
            f[2*I-1] -= ((Câ‚â‚â‚*Bâ‚[i]+Câ‚â‚‚â‚*Bâ‚‚[i])*gâ‚ + (Câ‚â‚â‚‚*Bâ‚[i]+Câ‚â‚‚â‚‚*Bâ‚‚[i])*gâ‚‚)*ğ‘¤
            f[2*I]   -= ((Câ‚â‚‚â‚*Bâ‚[i]+Câ‚‚â‚‚â‚*Bâ‚‚[i])*gâ‚ + (Câ‚â‚‚â‚‚*Bâ‚[i]+Câ‚‚â‚‚â‚‚*Bâ‚‚[i])*gâ‚‚)*ğ‘¤
        end
    end
end

# function (op::Operator{:âˆ«Ïƒáµ›áµ¢â±¼nâ±¼gáµ¢ds})(ap::T;k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
#     ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
#     E = op.E
#     Î½ = op.Î½
#     Cáµ› = E/(1-2*Î½)
#     for Î¾ in ğ“–
#         ğ‘¤ = Î¾.ğ‘¤
#         N = Î¾[:ğ­]
#         Bâ‚ = Î¾[:âˆ‚ğ­âˆ‚x]
#         Bâ‚‚ = Î¾[:âˆ‚ğ­âˆ‚y]
#         nâ‚â‚ = Î¾.nâ‚â‚
#         nâ‚â‚‚ = Î¾.nâ‚â‚‚
#         nâ‚‚â‚‚ = Î¾.nâ‚‚â‚‚
#         gâ‚ = Î¾.gâ‚
#         gâ‚‚ = Î¾.gâ‚‚
#         nâ‚ = Î¾.nâ‚
#         nâ‚‚ = Î¾.nâ‚‚
#         for (i,xáµ¢) in enumerate(ğ“’)
#             I = xáµ¢.ğ¼
#             for (j,xâ±¼) in enumerate(ğ“’)
#                 J = xâ±¼.ğ¼
#                 k[2*I-1,2*J-1] -= (Câ‚â‚â‚*(N[i]*Bâ‚[j]+Bâ‚[i]*N[j]) + Câ‚â‚‚â‚*(N[i]*Bâ‚‚[j]+Bâ‚‚[i]*N[j]))*ğ‘¤
#                 k[2*I-1,2*J]   -= (Câ‚â‚‚â‚*N[i]*Bâ‚[j] + Câ‚â‚â‚‚*Bâ‚[i]*N[j] + Câ‚‚â‚‚â‚*N[i]*Bâ‚‚[j] + Câ‚â‚‚â‚‚*Bâ‚‚[i]*N[j])*ğ‘¤
#                 k[2*I,2*J-1]   -= (Câ‚â‚â‚‚*N[i]*Bâ‚[j] + Câ‚â‚‚â‚*Bâ‚[i]*N[j] + Câ‚â‚‚â‚‚*N[i]*Bâ‚‚[j] + Câ‚‚â‚‚â‚*Bâ‚‚[i]*N[j])*ğ‘¤
#                 k[2*I,2*J]     -= (Câ‚â‚‚â‚‚*(N[i]*Bâ‚[j]+Bâ‚[i]*N[j]) + Câ‚‚â‚‚â‚‚*(N[i]*Bâ‚‚[j]+Bâ‚‚[i]*N[j]))*ğ‘¤
#             end
#             f[2*I-1] -= ((Câ‚â‚â‚*Bâ‚[i]+Câ‚â‚‚â‚*Bâ‚‚[i])*gâ‚ + (Câ‚â‚â‚‚*Bâ‚[i]+Câ‚â‚‚â‚‚*Bâ‚‚[i])*gâ‚‚)*ğ‘¤
#             f[2*I]   -= ((Câ‚â‚‚â‚*Bâ‚[i]+Câ‚‚â‚‚â‚*Bâ‚‚[i])*gâ‚ + (Câ‚â‚‚â‚‚*Bâ‚[i]+Câ‚‚â‚‚â‚‚*Bâ‚‚[i])*gâ‚‚)*ğ‘¤
#         end
#     end
# end

function (op::Operator{:âˆ«Ïƒáµ¢â±¼nâ±¼gáµ¢váµ¢gáµ¢ds})(ap::T;k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    E = op.E
    Î½ = op.Î½
    Î± = op.Î±
    for Î¾ in ğ“–
        ğ‘¤ = Î¾.ğ‘¤
        N = Î¾[:ğ­]
        Bâ‚ = Î¾[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ğ­âˆ‚y]
        Cáµ¢áµ¢áµ¢áµ¢ = E/(1-Î½^2)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-Î½^2)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
        nâ‚â‚ = Î¾.nâ‚â‚
        nâ‚â‚‚ = Î¾.nâ‚â‚‚
        nâ‚‚â‚‚ = Î¾.nâ‚‚â‚‚
        gâ‚ = Î¾.gâ‚
        gâ‚‚ = Î¾.gâ‚‚
        nâ‚ = Î¾.nâ‚
        nâ‚‚ = Î¾.nâ‚‚
        Câ‚â‚â‚ = Cáµ¢áµ¢áµ¢áµ¢*nâ‚*nâ‚â‚+Cáµ¢áµ¢â±¼â±¼*nâ‚‚*nâ‚â‚‚
        Câ‚â‚â‚‚ = Cáµ¢áµ¢áµ¢áµ¢*nâ‚*nâ‚â‚‚+Cáµ¢áµ¢â±¼â±¼*nâ‚‚*nâ‚‚â‚‚
        Câ‚‚â‚‚â‚ = Cáµ¢áµ¢â±¼â±¼*nâ‚*nâ‚â‚+Cáµ¢áµ¢áµ¢áµ¢*nâ‚‚*nâ‚â‚‚
        Câ‚‚â‚‚â‚‚ = Cáµ¢áµ¢â±¼â±¼*nâ‚*nâ‚â‚‚+Cáµ¢áµ¢áµ¢áµ¢*nâ‚‚*nâ‚‚â‚‚
        Câ‚â‚‚â‚ = Cáµ¢â±¼áµ¢â±¼*(nâ‚*nâ‚â‚‚+nâ‚‚*nâ‚â‚)
        Câ‚â‚‚â‚‚ = Cáµ¢â±¼áµ¢â±¼*(nâ‚‚*nâ‚â‚‚+nâ‚*nâ‚‚â‚‚)
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[2*I-1,2*J-1] -= (Câ‚â‚â‚*(N[i]*Bâ‚[j]+Bâ‚[i]*N[j]) + Câ‚â‚‚â‚*(N[i]*Bâ‚‚[j]+Bâ‚‚[i]*N[j]) - Î±*N[i]*nâ‚â‚*N[j])*ğ‘¤
                k[2*I-1,2*J]   -= (Câ‚â‚‚â‚*N[i]*Bâ‚[j] + Câ‚â‚â‚‚*Bâ‚[i]*N[j] + Câ‚‚â‚‚â‚*N[i]*Bâ‚‚[j] + Câ‚â‚‚â‚‚*Bâ‚‚[i]*N[j] -Î±*N[i]*nâ‚â‚‚*N[j])*ğ‘¤
                k[2*I,2*J-1]   -= (Câ‚â‚â‚‚*N[i]*Bâ‚[j] + Câ‚â‚‚â‚*Bâ‚[i]*N[j] + Câ‚â‚‚â‚‚*N[i]*Bâ‚‚[j] + Câ‚‚â‚‚â‚*Bâ‚‚[i]*N[j] -Î±*N[i]*nâ‚â‚‚*N[j])*ğ‘¤
                k[2*I,2*J]     -= (Câ‚â‚‚â‚‚*(N[i]*Bâ‚[j]+Bâ‚[i]*N[j]) + Câ‚‚â‚‚â‚‚*(N[i]*Bâ‚‚[j]+Bâ‚‚[i]*N[j]) -Î±*N[i]*nâ‚‚â‚‚*N[j])*ğ‘¤
            end
            f[2*I-1] -= ((Câ‚â‚â‚*Bâ‚[i]+Câ‚â‚‚â‚*Bâ‚‚[i]-Î±*N[i]*nâ‚â‚)*gâ‚ + (Câ‚â‚â‚‚*Bâ‚[i]+Câ‚â‚‚â‚‚*Bâ‚‚[i]-Î±*N[i]*nâ‚â‚‚)*gâ‚‚)*ğ‘¤
            f[2*I]   -= ((Câ‚â‚‚â‚*Bâ‚[i]+Câ‚‚â‚‚â‚*Bâ‚‚[i]-Î±*N[i]*nâ‚â‚‚)*gâ‚ + (Câ‚â‚‚â‚‚*Bâ‚[i]+Câ‚‚â‚‚â‚‚*Bâ‚‚[i]-Î±*N[i]*nâ‚‚â‚‚)*gâ‚‚)*ğ‘¤
        end
    end
end

function (op::Operator{:âˆ«ÏƒÌ„áµ¢â±¼nâ±¼gáµ¢ds})(ap::T;k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    E = op.E
    Î½ = op.Î½
    Cáµ¢áµ¢áµ¢áµ¢ = E/(1-Î½^2)
    Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-Î½^2)
    Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
    for Î¾ in ğ“–
        ğ‘¤ = Î¾.ğ‘¤
        N = Î¾[:ğ­]
        Bâ‚ = Î¾[:âˆ‚ğ­âˆ‚x_]
        Bâ‚‚ = Î¾[:âˆ‚ğ­âˆ‚y_]
        nâ‚â‚ = Î¾.nâ‚â‚
        nâ‚â‚‚ = Î¾.nâ‚â‚‚
        nâ‚‚â‚‚ = Î¾.nâ‚‚â‚‚
        gâ‚ = Î¾.gâ‚
        gâ‚‚ = Î¾.gâ‚‚
        nâ‚ = Î¾.nâ‚
        nâ‚‚ = Î¾.nâ‚‚
        Câ‚â‚â‚ = Cáµ¢áµ¢áµ¢áµ¢*nâ‚*nâ‚â‚+Cáµ¢áµ¢â±¼â±¼*nâ‚‚*nâ‚â‚‚
        Câ‚â‚â‚‚ = Cáµ¢áµ¢áµ¢áµ¢*nâ‚*nâ‚â‚‚+Cáµ¢áµ¢â±¼â±¼*nâ‚‚*nâ‚‚â‚‚
        Câ‚‚â‚‚â‚ = Cáµ¢áµ¢â±¼â±¼*nâ‚*nâ‚â‚+Cáµ¢áµ¢áµ¢áµ¢*nâ‚‚*nâ‚â‚‚
        Câ‚‚â‚‚â‚‚ = Cáµ¢áµ¢â±¼â±¼*nâ‚*nâ‚â‚‚+Cáµ¢áµ¢áµ¢áµ¢*nâ‚‚*nâ‚‚â‚‚
        Câ‚â‚‚â‚ = Cáµ¢â±¼áµ¢â±¼*(nâ‚*nâ‚â‚‚+nâ‚‚*nâ‚â‚)
        Câ‚â‚‚â‚‚ = Cáµ¢â±¼áµ¢â±¼*(nâ‚‚*nâ‚â‚‚+nâ‚*nâ‚‚â‚‚)
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[2*I-1,2*J-1] += (Câ‚â‚â‚*Bâ‚[i]*N[j] + Câ‚â‚‚â‚*Bâ‚‚[i]*N[j])*ğ‘¤
                k[2*I-1,2*J]   += (Câ‚â‚â‚‚*Bâ‚[i]*N[j] + Câ‚â‚‚â‚‚*Bâ‚‚[i]*N[j])*ğ‘¤
                k[2*I,2*J-1]   += (Câ‚â‚‚â‚*Bâ‚[i]*N[j] + Câ‚‚â‚‚â‚*Bâ‚‚[i]*N[j])*ğ‘¤
                k[2*I,2*J]     += (Câ‚â‚‚â‚‚*Bâ‚[i]*N[j] + Câ‚‚â‚‚â‚‚*Bâ‚‚[i]*N[j])*ğ‘¤
            end
            f[2*I-1] += ((Câ‚â‚â‚*Bâ‚[i] + Câ‚â‚‚â‚*Bâ‚‚[i])*gâ‚ + (Câ‚â‚â‚‚*Bâ‚[i] + Câ‚â‚‚â‚‚*Bâ‚‚[i])*gâ‚‚)*ğ‘¤
            f[2*I]   += ((Câ‚â‚‚â‚*Bâ‚[i] + Câ‚‚â‚‚â‚*Bâ‚‚[i])*gâ‚ + (Câ‚â‚‚â‚‚*Bâ‚[i] + Câ‚‚â‚‚â‚‚*Bâ‚‚[i])*gâ‚‚)*ğ‘¤
        end
    end
end

function (op::Operator{:âˆ«ÏƒÌƒÌ„áµ¢â±¼nâ±¼gáµ¢ds})(ap::T;k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    E = op.E
    Î½ = op.Î½
    for Î¾ in ğ“–
        ğ‘¤ = Î¾.ğ‘¤
        N = Î¾[:ğ­]
        Bâ‚ = Î¾[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ğ­âˆ‚y]
        BÌ„â‚ = Î¾[:âˆ‚ğ­âˆ‚x_]
        BÌ„â‚‚ = Î¾[:âˆ‚ğ­âˆ‚y_]
        Cáµ¢áµ¢áµ¢áµ¢ = E/(1-Î½^2)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-Î½^2)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
        nâ‚â‚ = Î¾.nâ‚â‚
        nâ‚â‚‚ = Î¾.nâ‚â‚‚
        nâ‚‚â‚‚ = Î¾.nâ‚‚â‚‚
        gâ‚ = Î¾.gâ‚
        gâ‚‚ = Î¾.gâ‚‚
        nâ‚ = Î¾.nâ‚
        nâ‚‚ = Î¾.nâ‚‚
        Câ‚â‚â‚ = Cáµ¢áµ¢áµ¢áµ¢*nâ‚*nâ‚â‚+Cáµ¢áµ¢â±¼â±¼*nâ‚‚*nâ‚â‚‚
        Câ‚â‚â‚‚ = Cáµ¢áµ¢áµ¢áµ¢*nâ‚*nâ‚â‚‚+Cáµ¢áµ¢â±¼â±¼*nâ‚‚*nâ‚‚â‚‚
        Câ‚‚â‚‚â‚ = Cáµ¢áµ¢â±¼â±¼*nâ‚*nâ‚â‚+Cáµ¢áµ¢áµ¢áµ¢*nâ‚‚*nâ‚â‚‚
        Câ‚‚â‚‚â‚‚ = Cáµ¢áµ¢â±¼â±¼*nâ‚*nâ‚â‚‚+Cáµ¢áµ¢áµ¢áµ¢*nâ‚‚*nâ‚‚â‚‚
        Câ‚â‚‚â‚ = Cáµ¢â±¼áµ¢â±¼*(nâ‚*nâ‚â‚‚+nâ‚‚*nâ‚â‚)
        Câ‚â‚‚â‚‚ = Cáµ¢â±¼áµ¢â±¼*(nâ‚‚*nâ‚â‚‚+nâ‚*nâ‚‚â‚‚)
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            Î”Bâ‚ = Bâ‚[i]-BÌ„â‚[i]
            Î”Bâ‚‚ = Bâ‚‚[i]-BÌ„â‚‚[i]
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[2*I-1,2*J-1] -= (Câ‚â‚â‚*(N[i]*Bâ‚[j]+Î”Bâ‚*N[j]) + Câ‚â‚‚â‚*(N[i]*Bâ‚‚[j]+Î”Bâ‚‚*N[j]))*ğ‘¤
                k[2*I-1,2*J]   -= (Câ‚â‚‚â‚*N[i]*Bâ‚[j] + Câ‚â‚â‚‚*Î”Bâ‚*N[j] + Câ‚‚â‚‚â‚*N[i]*Bâ‚‚[j] + Câ‚â‚‚â‚‚*Î”Bâ‚‚*N[j])*ğ‘¤
                k[2*I,2*J-1]   -= (Câ‚â‚â‚‚*N[i]*Bâ‚[j] + Câ‚â‚‚â‚*Î”Bâ‚*N[j] + Câ‚â‚‚â‚‚*N[i]*Bâ‚‚[j] + Câ‚‚â‚‚â‚*Î”Bâ‚‚*N[j])*ğ‘¤
                k[2*I,2*J]     -= (Câ‚â‚‚â‚‚*(N[i]*Bâ‚[j]+Î”Bâ‚*N[j]) + Câ‚‚â‚‚â‚‚*(N[i]*Bâ‚‚[j]+Î”Bâ‚‚*N[j]))*ğ‘¤
            end
            f[2*I-1] -= ((Câ‚â‚â‚*Î”Bâ‚+Câ‚â‚‚â‚*Î”Bâ‚‚)*gâ‚ + (Câ‚â‚â‚‚*Î”Bâ‚+Câ‚â‚‚â‚‚*Î”Bâ‚‚)*gâ‚‚)*ğ‘¤
            f[2*I]   -= ((Câ‚â‚‚â‚*Î”Bâ‚+Câ‚‚â‚‚â‚*Î”Bâ‚‚)*gâ‚ + (Câ‚â‚‚â‚‚*Î”Bâ‚+Câ‚‚â‚‚â‚‚*Î”Bâ‚‚)*gâ‚‚)*ğ‘¤
        end
    end
end

function (op::Operator{:âˆ«váµ¢gáµ¢ds})(ap::T;k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    Î± = op.Î±
    for Î¾ in ğ“–
        ğ‘¤ = Î¾.ğ‘¤
        N = Î¾[:ğ­]
        nâ‚â‚ = Î¾.nâ‚â‚
        nâ‚‚â‚‚ = Î¾.nâ‚‚â‚‚
        nâ‚â‚‚ = Î¾.nâ‚â‚‚
        gâ‚ = Î¾.gâ‚
        gâ‚‚ = Î¾.gâ‚‚
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[2*I-1,2*J-1] += Î±*N[i]*nâ‚â‚*N[j]*ğ‘¤
                k[2*I,2*J-1]   += Î±*N[i]*nâ‚â‚‚*N[j]*ğ‘¤
                k[2*I-1,2*J]   += Î±*N[i]*nâ‚â‚‚*N[j]*ğ‘¤
                k[2*I,2*J]     += Î±*N[i]*nâ‚‚â‚‚*N[j]*ğ‘¤
            end
            f[2*I-1] += Î±*N[i]*(nâ‚â‚*gâ‚+nâ‚â‚‚*gâ‚‚)*ğ‘¤
            f[2*I]   += Î±*N[i]*(nâ‚â‚‚*gâ‚+nâ‚‚â‚‚*gâ‚‚)*ğ‘¤
        end
    end
end

function getÏƒâ‚™(Ïƒâ‚â‚::Float64,Ïƒâ‚‚â‚‚::Float64,Ïƒâ‚ƒâ‚ƒ::Float64,Ïƒâ‚â‚‚::Float64,Ïƒâ‚â‚ƒ::Float64,Ïƒâ‚‚â‚ƒ::Float64)
    pâ‚ = Ïƒâ‚â‚‚^2+Ïƒâ‚â‚ƒ^2+Ïƒâ‚‚â‚ƒ^2
    if pâ‚ == 0.0
        Ïƒâ‚ = Ïƒâ‚â‚
        Ïƒâ‚‚ = Ïƒâ‚‚â‚‚
        Ïƒâ‚ƒ = Ïƒâ‚ƒâ‚ƒ
    else
        p = (Ïƒâ‚â‚+Ïƒâ‚‚â‚‚+Ïƒâ‚ƒâ‚ƒ)/3.0
        s = (((Ïƒâ‚â‚-p)^2+(Ïƒâ‚‚â‚‚-p)^2+(Ïƒâ‚ƒâ‚ƒ-p)^2 + 2*pâ‚)/6)^0.5
        (Bâ‚â‚,Bâ‚‚â‚‚,Bâ‚ƒâ‚ƒ,Bâ‚â‚‚,Bâ‚â‚ƒ,Bâ‚‚â‚ƒ) = 1.0/s .* (Ïƒâ‚â‚-p,Ïƒâ‚‚â‚‚-p,Ïƒâ‚ƒâ‚ƒ-p,Ïƒâ‚â‚‚,Ïƒâ‚â‚ƒ,Ïƒâ‚‚â‚ƒ)
        r = (Bâ‚â‚*Bâ‚‚â‚‚*Bâ‚ƒâ‚ƒ+2.0*Bâ‚â‚‚*Bâ‚â‚ƒ*Bâ‚‚â‚ƒ-Bâ‚â‚*Bâ‚‚â‚ƒ^2-Bâ‚‚â‚‚*Bâ‚â‚ƒ^2-Bâ‚ƒâ‚ƒ*Bâ‚â‚‚^2)/2.0

        if râ‰¤-1.0
            Î¸ = Ï€/3.0
        elseif râ‰¥1.0
            Î¸ = 0.0
        else
            Î¸ = acos(r)/3.0
        end

        Ïƒâ‚ = p + 2.0*s*cos(Î¸)
        Ïƒâ‚ƒ = p + 2.0*s*cos(Î¸+2.0/3.0*Ï€)
        Ïƒâ‚‚ = 3.0*p -Ïƒâ‚-Ïƒâ‚ƒ
    end

    Nâ‚ = (
        (Ïƒâ‚â‚-Ïƒâ‚‚)*(Ïƒâ‚â‚-Ïƒâ‚ƒ)+Ïƒâ‚â‚‚*Ïƒâ‚â‚‚     +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚ƒ
       +(Ïƒâ‚â‚-Ïƒâ‚‚)*Ïƒâ‚â‚‚     +Ïƒâ‚â‚‚*(Ïƒâ‚‚â‚‚-Ïƒâ‚ƒ)+Ïƒâ‚â‚ƒ*Ïƒâ‚‚â‚ƒ
       +(Ïƒâ‚â‚-Ïƒâ‚‚)*Ïƒâ‚â‚ƒ     +Ïƒâ‚â‚‚*Ïƒâ‚‚â‚ƒ     +Ïƒâ‚â‚ƒ*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚ƒ),
        Ïƒâ‚â‚‚*(Ïƒâ‚â‚-Ïƒâ‚ƒ)+(Ïƒâ‚‚â‚‚-Ïƒâ‚‚)*Ïƒâ‚â‚‚     +Ïƒâ‚‚â‚ƒ*Ïƒâ‚â‚ƒ
       +Ïƒâ‚â‚‚*Ïƒâ‚â‚‚     +(Ïƒâ‚‚â‚‚-Ïƒâ‚‚)*(Ïƒâ‚‚â‚‚-Ïƒâ‚ƒ)+Ïƒâ‚‚â‚ƒ*Ïƒâ‚‚â‚ƒ
       +Ïƒâ‚â‚‚*Ïƒâ‚â‚ƒ     +(Ïƒâ‚‚â‚‚-Ïƒâ‚‚)*Ïƒâ‚‚â‚ƒ     +Ïƒâ‚‚â‚ƒ*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚ƒ),
        Ïƒâ‚â‚ƒ*(Ïƒâ‚â‚-Ïƒâ‚ƒ)+Ïƒâ‚‚â‚ƒ*Ïƒâ‚â‚‚     +(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚‚)*Ïƒâ‚â‚ƒ
       +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚‚     +Ïƒâ‚‚â‚ƒ*(Ïƒâ‚‚â‚‚-Ïƒâ‚ƒ)+(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚‚)*Ïƒâ‚‚â‚ƒ
       +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚ƒ     +Ïƒâ‚‚â‚ƒ*Ïƒâ‚‚â‚ƒ     +(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚‚)*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚ƒ)
    )
    Nâ‚‚ = (
        (Ïƒâ‚â‚-Ïƒâ‚)*(Ïƒâ‚â‚-Ïƒâ‚ƒ)+Ïƒâ‚â‚‚*Ïƒâ‚â‚‚     +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚ƒ
       +(Ïƒâ‚â‚-Ïƒâ‚)*Ïƒâ‚â‚‚     +Ïƒâ‚â‚‚*(Ïƒâ‚‚â‚‚-Ïƒâ‚ƒ)+Ïƒâ‚â‚ƒ*Ïƒâ‚‚â‚ƒ
       +(Ïƒâ‚â‚-Ïƒâ‚)*Ïƒâ‚â‚ƒ     +Ïƒâ‚â‚‚*Ïƒâ‚‚â‚ƒ     +Ïƒâ‚â‚ƒ*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚ƒ),
        Ïƒâ‚â‚‚*(Ïƒâ‚â‚-Ïƒâ‚ƒ)+(Ïƒâ‚‚â‚‚-Ïƒâ‚)*Ïƒâ‚â‚‚     +Ïƒâ‚‚â‚ƒ*Ïƒâ‚â‚ƒ
       +Ïƒâ‚â‚‚*Ïƒâ‚â‚‚     +(Ïƒâ‚‚â‚‚-Ïƒâ‚)*(Ïƒâ‚‚â‚‚-Ïƒâ‚ƒ)+Ïƒâ‚‚â‚ƒ*Ïƒâ‚‚â‚ƒ
       +Ïƒâ‚â‚‚*Ïƒâ‚â‚ƒ     +(Ïƒâ‚‚â‚‚-Ïƒâ‚)*Ïƒâ‚‚â‚ƒ     +Ïƒâ‚‚â‚ƒ*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚ƒ),
        Ïƒâ‚â‚ƒ*(Ïƒâ‚â‚-Ïƒâ‚ƒ)+Ïƒâ‚‚â‚ƒ*Ïƒâ‚â‚‚     +(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚)*Ïƒâ‚â‚ƒ
       +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚‚     +Ïƒâ‚‚â‚ƒ*(Ïƒâ‚‚â‚‚-Ïƒâ‚ƒ)+(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚)*Ïƒâ‚‚â‚ƒ
       +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚ƒ     +Ïƒâ‚‚â‚ƒ*Ïƒâ‚‚â‚ƒ     +(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚)*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚ƒ)
    )
    Nâ‚ƒ = (
        (Ïƒâ‚â‚-Ïƒâ‚)*(Ïƒâ‚â‚-Ïƒâ‚‚)+Ïƒâ‚â‚‚*Ïƒâ‚â‚‚     +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚ƒ
       +(Ïƒâ‚â‚-Ïƒâ‚)*Ïƒâ‚â‚‚     +Ïƒâ‚â‚‚*(Ïƒâ‚‚â‚‚-Ïƒâ‚‚)+Ïƒâ‚â‚ƒ*Ïƒâ‚‚â‚ƒ
       +(Ïƒâ‚â‚-Ïƒâ‚)*Ïƒâ‚â‚ƒ     +Ïƒâ‚â‚‚*Ïƒâ‚‚â‚ƒ     +Ïƒâ‚â‚ƒ*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚‚),
        Ïƒâ‚â‚‚*(Ïƒâ‚â‚-Ïƒâ‚‚)+(Ïƒâ‚‚â‚‚-Ïƒâ‚)*Ïƒâ‚â‚‚     +Ïƒâ‚‚â‚ƒ*Ïƒâ‚â‚ƒ
       +Ïƒâ‚â‚‚*Ïƒâ‚â‚‚     +(Ïƒâ‚‚â‚‚-Ïƒâ‚)*(Ïƒâ‚‚â‚‚-Ïƒâ‚‚)+Ïƒâ‚‚â‚ƒ*Ïƒâ‚‚â‚ƒ
       +Ïƒâ‚â‚‚*Ïƒâ‚â‚ƒ     +(Ïƒâ‚‚â‚‚-Ïƒâ‚)*Ïƒâ‚‚â‚ƒ     +Ïƒâ‚‚â‚ƒ*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚‚),
        Ïƒâ‚â‚ƒ*(Ïƒâ‚â‚-Ïƒâ‚‚)+Ïƒâ‚‚â‚ƒ*Ïƒâ‚â‚‚     +(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚)*Ïƒâ‚â‚ƒ
       +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚‚     +Ïƒâ‚‚â‚ƒ*(Ïƒâ‚‚â‚‚-Ïƒâ‚‚)+(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚)*Ïƒâ‚‚â‚ƒ
       +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚ƒ     +Ïƒâ‚‚â‚ƒ*Ïƒâ‚‚â‚ƒ     +(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚)*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚‚)
    )
    normNâ‚ = (Nâ‚[1]^2+Nâ‚[2]^2+Nâ‚[3]^2)^0.5
    normNâ‚‚ = (Nâ‚‚[1]^2+Nâ‚‚[2]^2+Nâ‚‚[3]^2)^0.5
    normNâ‚ƒ = (Nâ‚ƒ[1]^2+Nâ‚ƒ[2]^2+Nâ‚ƒ[3]^2)^0.5
    nâ‚ = (Nâ‚[1]/normNâ‚,Nâ‚[2]/normNâ‚,Nâ‚[3]/normNâ‚)
    nâ‚‚ = (Nâ‚‚[1]/normNâ‚‚,Nâ‚‚[2]/normNâ‚‚,Nâ‚‚[3]/normNâ‚‚)
    nâ‚ƒ = (Nâ‚ƒ[1]/normNâ‚ƒ,Nâ‚ƒ[2]/normNâ‚ƒ,Nâ‚ƒ[3]/normNâ‚ƒ)
    return Ïƒâ‚,Ïƒâ‚‚,Ïƒâ‚ƒ,nâ‚,nâ‚‚,nâ‚ƒ
end
