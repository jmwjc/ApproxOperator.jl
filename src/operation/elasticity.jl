module Elasticity
    
using ..ApproxOperator: AbstractElement

function âˆ«Îµáµ¢â±¼Ïƒáµ¢â±¼dÎ©(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        Bâ‚ = Î¾[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ğ­âˆ‚y]
        Bâ‚ƒ = Î¾[:âˆ‚ğ­âˆ‚z]
        ğ‘¤ = Î¾.ğ‘¤
        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµ¢áµ¢áµ¢áµ¢ = E*(1-Î½)/(1+Î½)/(1-2Î½)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1+Î½)/(1-2Î½)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[3*I-2,3*J-2] += (Cáµ¢áµ¢áµ¢áµ¢*Bâ‚[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚ƒ[i]*Bâ‚ƒ[j])*ğ‘¤
                k[3*I-2,3*J-1] += (Cáµ¢áµ¢â±¼â±¼*Bâ‚[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚[j])*ğ‘¤
                k[3*I-2,3*J]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚[i]*Bâ‚ƒ[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚ƒ[i]*Bâ‚[j])*ğ‘¤
                k[3*I-1,3*J-2] += (Cáµ¢áµ¢â±¼â±¼*Bâ‚‚[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚‚[j])*ğ‘¤
                k[3*I-1,3*J-1] += (Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚[j] + Cáµ¢áµ¢áµ¢áµ¢*Bâ‚‚[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚ƒ[i]*Bâ‚ƒ[j])*ğ‘¤
                k[3*I-1,3*J]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚‚[i]*Bâ‚ƒ[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚ƒ[i]*Bâ‚‚[j])*ğ‘¤
                k[3*I,3*J-2]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚ƒ[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚ƒ[j])*ğ‘¤
                k[3*I,3*J-1]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚ƒ[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚ƒ[j])*ğ‘¤
                k[3*I,3*J]     += (Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚‚[j] + Cáµ¢áµ¢áµ¢áµ¢*Bâ‚ƒ[i]*Bâ‚ƒ[j])*ğ‘¤
            end
        end
    end
end

function âˆ«Îµáµˆáµ¢â±¼Ïƒáµˆáµ¢â±¼dÎ©(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        Bâ‚ = Î¾[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ğ­âˆ‚y]
        Bâ‚ƒ = Î¾[:âˆ‚ğ­âˆ‚z]
        ğ‘¤ = Î¾.ğ‘¤
        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµˆ = E/(1+Î½)
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[3*I-2,3*J-2] += Cáµˆ*( 2/3*Bâ‚[i]*Bâ‚[j]+1/2*Bâ‚‚[i]*Bâ‚‚[j]+1/2*Bâ‚ƒ[i]*Bâ‚ƒ[j])*ğ‘¤
                k[3*I-2,3*J-1] += Cáµˆ*(-1/3*Bâ‚[i]*Bâ‚‚[j]+1/2*Bâ‚‚[i]*Bâ‚[j])*ğ‘¤
                k[3*I-2,3*J]   += Cáµˆ*(-1/3*Bâ‚[i]*Bâ‚ƒ[j]+1/2*Bâ‚ƒ[i]*Bâ‚[j])*ğ‘¤
                k[3*I-1,3*J-2] += Cáµˆ*(-1/3*Bâ‚‚[i]*Bâ‚[j]+1/2*Bâ‚[i]*Bâ‚‚[j])*ğ‘¤
                k[3*I-1,3*J-1] += Cáµˆ*( 2/3*Bâ‚‚[i]*Bâ‚‚[j]+1/2*Bâ‚ƒ[i]*Bâ‚ƒ[j]+1/2*Bâ‚[i]*Bâ‚[j])*ğ‘¤
                k[3*I-1,3*J]   += Cáµˆ*(-1/3*Bâ‚‚[i]*Bâ‚ƒ[j]+1/2*Bâ‚ƒ[i]*Bâ‚‚[j])*ğ‘¤
                k[3*I,3*J-2]   += Cáµˆ*(-1/3*Bâ‚ƒ[i]*Bâ‚[j]+1/2*Bâ‚[i]*Bâ‚ƒ[j])*ğ‘¤
                k[3*I,3*J-1]   += Cáµˆ*(-1/3*Bâ‚ƒ[i]*Bâ‚‚[j]+1/2*Bâ‚‚[i]*Bâ‚ƒ[j])*ğ‘¤
                k[3*I,3*J]     += Cáµˆ*( 2/3*Bâ‚ƒ[i]*Bâ‚ƒ[j]+1/2*Bâ‚[i]*Bâ‚[j]+1/2*Bâ‚‚[i]*Bâ‚‚[j])*ğ‘¤
            end
        end
    end
end

function âˆ«Îµáµˆáµ¢â±¼Ïƒáµˆáµ¢â±¼dÎ©(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ğ“’áµ¤ = aáµ¤.ğ“’;ğ“–áµ¤ = aáµ¤.ğ“–
    ğ“’â‚› = aâ‚›.ğ“’;ğ“–â‚› = aâ‚›.ğ“–
    for (Î¾áµ¤,Î¾â‚›) in zip(ğ“–áµ¤,ğ“–â‚›)
        Bâ‚ = Î¾áµ¤[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾áµ¤[:âˆ‚ğ­âˆ‚y]
        Bâ‚ƒ = Î¾áµ¤[:âˆ‚ğ­âˆ‚z]
        Bâ‚›â‚ = Î¾â‚›[:âˆ‚ğ­âˆ‚x]
        Bâ‚›â‚‚ = Î¾â‚›[:âˆ‚ğ­âˆ‚y]
        Bâ‚›â‚ƒ = Î¾â‚›[:âˆ‚ğ­âˆ‚z]
        ğ‘¤ = Î¾áµ¤.ğ‘¤
        E = Î¾â‚›.E
        Î½ = Î¾â‚›.Î½
        Cáµˆ = E/(1+Î½)
        for (i,xáµ¢) in enumerate(ğ“’â‚›)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’áµ¤)
                J = xâ±¼.ğ¼
                k[3*I-2,3*J-2] += Cáµˆ*( 2/3*Bâ‚›â‚[i]*Bâ‚[j]+1/2*Bâ‚›â‚‚[i]*Bâ‚‚[j]+1/2*Bâ‚›â‚ƒ[i]*Bâ‚ƒ[j])*ğ‘¤
                k[3*I-2,3*J-1] += Cáµˆ*(-1/3*Bâ‚›â‚[i]*Bâ‚‚[j]+1/2*Bâ‚›â‚‚[i]*Bâ‚[j])*ğ‘¤
                k[3*I-2,3*J]   += Cáµˆ*(-1/3*Bâ‚›â‚[i]*Bâ‚ƒ[j]+1/2*Bâ‚›â‚ƒ[i]*Bâ‚[j])*ğ‘¤
                k[3*I-1,3*J-2] += Cáµˆ*(-1/3*Bâ‚›â‚‚[i]*Bâ‚[j]+1/2*Bâ‚›â‚[i]*Bâ‚‚[j])*ğ‘¤
                k[3*I-1,3*J-1] += Cáµˆ*( 2/3*Bâ‚›â‚‚[i]*Bâ‚‚[j]+1/2*Bâ‚›â‚ƒ[i]*Bâ‚ƒ[j]+1/2*Bâ‚›â‚[i]*Bâ‚[j])*ğ‘¤
                k[3*I-1,3*J]   += Cáµˆ*(-1/3*Bâ‚›â‚‚[i]*Bâ‚ƒ[j]+1/2*Bâ‚›â‚ƒ[i]*Bâ‚‚[j])*ğ‘¤
                k[3*I,3*J-2]   += Cáµˆ*(-1/3*Bâ‚›â‚ƒ[i]*Bâ‚[j]+1/2*Bâ‚›â‚[i]*Bâ‚ƒ[j])*ğ‘¤
                k[3*I,3*J-1]   += Cáµˆ*(-1/3*Bâ‚›â‚ƒ[i]*Bâ‚‚[j]+1/2*Bâ‚›â‚‚[i]*Bâ‚ƒ[j])*ğ‘¤
                k[3*I,3*J]     += Cáµˆ*( 2/3*Bâ‚›â‚ƒ[i]*Bâ‚ƒ[j]+1/2*Bâ‚›â‚[i]*Bâ‚[j]+1/2*Bâ‚›â‚‚[i]*Bâ‚‚[j])*ğ‘¤
            end
        end
    end
end

function âˆ«âˆ«Ïváµ¢uáµ¢dxdy(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’;ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        N = Î¾[:ğ­]
        ğ‘¤ = Î¾.ğ‘¤
        Ï = Î¾.Ï
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[2*I-1,2*J-1] += Ï*N[i]*N[j]*ğ‘¤
                k[2*I,2*J]     += Ï*N[i]*N[j]*ğ‘¤
            end
        end
    end
end

function âˆ«âˆ«Îµáµ¢â±¼Ïƒáµ¢â±¼dxdy(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        Bâ‚ = Î¾[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ğ­âˆ‚y]
        ğ‘¤ = Î¾.ğ‘¤
        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµ¢áµ¢áµ¢áµ¢ = E/(1-Î½^2)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-Î½^2)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[2*I-1,2*J-1] += (Cáµ¢áµ¢áµ¢áµ¢*Bâ‚[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚‚[j])*ğ‘¤
                k[2*I-1,2*J]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚[j])*ğ‘¤
                k[2*I,2*J-1]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚‚[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚‚[j])*ğ‘¤
                k[2*I,2*J]     += (Cáµ¢áµ¢áµ¢áµ¢*Bâ‚‚[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚[j])*ğ‘¤
            end
        end
    end
end

function âˆ«âˆ«Îµáµ¢â±¼Ïƒáµ¢â±¼dxdy_PlaneStrian(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        Bâ‚ = Î¾[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ğ­âˆ‚y]
        ğ‘¤ = Î¾.ğ‘¤
        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµ¢áµ¢áµ¢áµ¢ = E*(1-Î½)/(1-2*Î½)/(1+Î½)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-2*Î½)/(1+Î½)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[2*I-1,2*J-1] += (Cáµ¢áµ¢áµ¢áµ¢*Bâ‚[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚‚[j])*ğ‘¤
                k[2*I-1,2*J]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚‚[i]*Bâ‚[j])*ğ‘¤
                k[2*I,2*J-1]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚‚[i]*Bâ‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚‚[j])*ğ‘¤
                k[2*I,2*J]     += (Cáµ¢áµ¢áµ¢áµ¢*Bâ‚‚[i]*Bâ‚‚[j] + Cáµ¢â±¼áµ¢â±¼*Bâ‚[i]*Bâ‚[j])*ğ‘¤
            end
        end
    end
end

function âˆ«âˆ«Îµáµ¢â±¼Ïƒáµ¢â±¼dxdy(aáµ¤::T,aâ‚›::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ğ“’áµ¤ = aáµ¤.ğ“’;ğ“–áµ¤ = aáµ¤.ğ“–
    ğ“’â‚› = aâ‚›.ğ“’;ğ“–â‚› = aâ‚›.ğ“–
    for (Î¾áµ¤,Î¾â‚›) in zip(ğ“–áµ¤,ğ“–â‚›)
        Báµ¤â‚ = Î¾áµ¤[:âˆ‚ğ­âˆ‚x]
        Báµ¤â‚‚ = Î¾áµ¤[:âˆ‚ğ­âˆ‚y]
        Bâ‚›â‚ = Î¾â‚›[:âˆ‚ğ­âˆ‚x]
        Bâ‚›â‚‚ = Î¾â‚›[:âˆ‚ğ­âˆ‚y]
        ğ‘¤ = Î¾áµ¤.ğ‘¤
        E = Î¾áµ¤.E
        Î½ = Î¾áµ¤.Î½
        Cáµ¢áµ¢áµ¢áµ¢ = E/(1-Î½^2)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-Î½^2)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
        for (i,xáµ¢) in enumerate(ğ“’â‚›)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’áµ¤)
                J = xâ±¼.ğ¼
                k[2*I-1,2*J-1] += (Cáµ¢áµ¢áµ¢áµ¢*Bâ‚›â‚[i]*Báµ¤â‚[j]+Cáµ¢â±¼áµ¢â±¼*Bâ‚›â‚‚[i]*Báµ¤â‚‚[j])*ğ‘¤
                k[2*I-1,2*J]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚›â‚[i]*Báµ¤â‚‚[j]+Cáµ¢â±¼áµ¢â±¼*Bâ‚›â‚‚[i]*Báµ¤â‚[j])*ğ‘¤
                k[2*I,2*J-1]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚›â‚‚[i]*Báµ¤â‚[j]+Cáµ¢â±¼áµ¢â±¼*Bâ‚›â‚[i]*Báµ¤â‚‚[j])*ğ‘¤
                k[2*I,2*J]     += (Cáµ¢áµ¢áµ¢áµ¢*Bâ‚›â‚‚[i]*Báµ¤â‚‚[j]+Cáµ¢â±¼áµ¢â±¼*Bâ‚›â‚[i]*Báµ¤â‚[j])*ğ‘¤
            end
        end
    end
end

function âˆ«âˆ«Îµáµ¢â±¼Ïƒáµ¢â±¼dxdy_PlaneStrian(aáµ¤::T,aâ‚›::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ğ“’áµ¤ = aáµ¤.ğ“’;ğ“–áµ¤ = aáµ¤.ğ“–
    ğ“’â‚› = aâ‚›.ğ“’;ğ“–â‚› = aâ‚›.ğ“–
    for (Î¾áµ¤,Î¾â‚›) in zip(ğ“–áµ¤,ğ“–â‚›)
        Báµ¤â‚ = Î¾áµ¤[:âˆ‚ğ­âˆ‚x]
        Báµ¤â‚‚ = Î¾áµ¤[:âˆ‚ğ­âˆ‚y]
        Bâ‚›â‚ = Î¾â‚›[:âˆ‚ğ­âˆ‚x]
        Bâ‚›â‚‚ = Î¾â‚›[:âˆ‚ğ­âˆ‚y]
        ğ‘¤ = Î¾áµ¤.ğ‘¤
        E = Î¾â‚›.E
        Î½ = Î¾â‚›.Î½
        Cáµ¢áµ¢áµ¢áµ¢ = E*(1-Î½)/(1-2*Î½)/(1+Î½)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-2*Î½)/(1+Î½)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
        for (i,xáµ¢) in enumerate(ğ“’â‚›)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’áµ¤)
                J = xâ±¼.ğ¼
                k[2*I-1,2*J-1] += (Cáµ¢áµ¢áµ¢áµ¢*Bâ‚›â‚[i]*Báµ¤â‚[j]+Cáµ¢â±¼áµ¢â±¼*Bâ‚›â‚‚[i]*Báµ¤â‚‚[j])*ğ‘¤
                k[2*I-1,2*J]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚›â‚[i]*Báµ¤â‚‚[j]+Cáµ¢â±¼áµ¢â±¼*Bâ‚›â‚‚[i]*Báµ¤â‚[j])*ğ‘¤
                k[2*I,2*J-1]   += (Cáµ¢áµ¢â±¼â±¼*Bâ‚›â‚‚[i]*Báµ¤â‚[j]+Cáµ¢â±¼áµ¢â±¼*Bâ‚›â‚[i]*Báµ¤â‚‚[j])*ğ‘¤
                k[2*I,2*J]     += (Cáµ¢áµ¢áµ¢áµ¢*Bâ‚›â‚‚[i]*Báµ¤â‚‚[j]+Cáµ¢â±¼áµ¢â±¼*Bâ‚›â‚[i]*Báµ¤â‚[j])*ğ‘¤
            end
        end
    end
end

function âˆ«âˆ«Îµáµ›áµ¢â±¼Ïƒáµ›áµ¢â±¼dxdy(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        Bâ‚ = Î¾[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ğ­âˆ‚y]
        ğ‘¤ = Î¾.ğ‘¤
        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµ› = E/(1-2*Î½)
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[2*I-1,2*J-1] += Cáµ›/3*Bâ‚[i]*Bâ‚[j]*ğ‘¤
                k[2*I-1,2*J]   += Cáµ›/3*Bâ‚[i]*Bâ‚‚[j]*ğ‘¤
                k[2*I,2*J-1]   += Cáµ›/3*Bâ‚‚[i]*Bâ‚[j]*ğ‘¤
                k[2*I,2*J]     += Cáµ›/3*Bâ‚‚[i]*Bâ‚‚[j]*ğ‘¤
            end
        end
    end
end

function âˆ«âˆ«Îµáµˆáµ¢â±¼Ïƒáµˆáµ¢â±¼dxdy(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        Bâ‚ = Î¾[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ğ­âˆ‚y]
        ğ‘¤ = Î¾.ğ‘¤
        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµˆ = E/(1+Î½)
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[2*I-1,2*J-1] += Cáµˆ*( 2/3*Bâ‚[i]*Bâ‚[j]+1/2*Bâ‚‚[i]*Bâ‚‚[j])*ğ‘¤
                k[2*I-1,2*J]   += Cáµˆ*(-1/3*Bâ‚[i]*Bâ‚‚[j]+1/2*Bâ‚‚[i]*Bâ‚[j])*ğ‘¤
                k[2*I,2*J-1]   += Cáµˆ*(-1/3*Bâ‚‚[i]*Bâ‚[j]+1/2*Bâ‚[i]*Bâ‚‚[j])*ğ‘¤
                k[2*I,2*J]     += Cáµˆ*( 2/3*Bâ‚‚[i]*Bâ‚‚[j]+1/2*Bâ‚[i]*Bâ‚[j])*ğ‘¤
            end
        end
    end
end

function âˆ«âˆ«Îµáµˆáµ¢â±¼Ïƒáµˆáµ¢â±¼dxdy(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ğ“’áµ¤ = aáµ¤.ğ“’;ğ“–áµ¤ = aáµ¤.ğ“–
    ğ“’â‚› = aâ‚›.ğ“’;ğ“–â‚› = aâ‚›.ğ“–
    for (Î¾áµ¤,Î¾â‚›) in zip(ğ“–áµ¤,ğ“–â‚›)
        Báµ¤â‚ = Î¾áµ¤[:âˆ‚ğ­âˆ‚x]
        Báµ¤â‚‚ = Î¾áµ¤[:âˆ‚ğ­âˆ‚y]
        Bâ‚›â‚ = Î¾â‚›[:âˆ‚ğ­âˆ‚x]
        Bâ‚›â‚‚ = Î¾â‚›[:âˆ‚ğ­âˆ‚y]
        ğ‘¤ = Î¾áµ¤.ğ‘¤
        E = Î¾â‚›.E
        Î½ = Î¾â‚›.Î½
        Cáµˆ = E/(1+Î½)
        for (i,xáµ¢) in enumerate(ğ“’â‚›)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’áµ¤)
                J = xâ±¼.ğ¼
                k[2*I-1,2*J-1] += Cáµˆ*( 2/3*Bâ‚›â‚[i]*Báµ¤â‚[j]+1/2*Bâ‚›â‚‚[i]*Báµ¤â‚‚[j])*ğ‘¤
                k[2*I-1,2*J]   += Cáµˆ*(-1/3*Bâ‚›â‚[i]*Báµ¤â‚‚[j]+1/2*Bâ‚›â‚‚[i]*Báµ¤â‚[j])*ğ‘¤
                k[2*I,2*J-1]   += Cáµˆ*(-1/3*Bâ‚›â‚‚[i]*Báµ¤â‚[j]+1/2*Bâ‚›â‚[i]*Báµ¤â‚‚[j])*ğ‘¤
                k[2*I,2*J]     += Cáµˆ*( 2/3*Bâ‚›â‚‚[i]*Báµ¤â‚‚[j]+1/2*Bâ‚›â‚[i]*Báµ¤â‚[j])*ğ‘¤
            end
        end
    end
end

function âˆ«âˆ«Ïƒáµ¢â±¼Ïƒâ‚–â‚—dxdy(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’;ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        N = Î¾[:ğ­]
        ğ‘¤ = Î¾.ğ‘¤
        E = Î¾.E
        Î½ = Î¾.Î½
        Câ»Â¹áµ¢áµ¢áµ¢áµ¢ = 1/E
        Câ»Â¹áµ¢áµ¢â±¼â±¼ = -Î½/E
        Câ»Â¹áµ¢â±¼áµ¢â±¼ = 2*(1+Î½)/E
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[3*I-2,3*J-2] += N[i]*Câ»Â¹áµ¢áµ¢áµ¢áµ¢*N[j]*ğ‘¤
                k[3*I-2,3*J-1] += N[i]*Câ»Â¹áµ¢áµ¢â±¼â±¼*N[j]*ğ‘¤
                k[3*I-1,3*J-2] += N[i]*Câ»Â¹áµ¢áµ¢â±¼â±¼*N[j]*ğ‘¤
                k[3*I-1,3*J-1] += N[i]*Câ»Â¹áµ¢áµ¢áµ¢áµ¢*N[j]*ğ‘¤
                k[3*I,3*J]     += N[i]*Câ»Â¹áµ¢â±¼áµ¢â±¼*N[j]*ğ‘¤
            end
        end
    end
end


function âˆ«âˆ«Ïƒáµ¢â±¼Ïƒâ‚–â‚—dxdy_Taylor(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’;ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        N = Î¾[:ğ­]
        ğ‘¤ = Î¾.ğ‘¤
        E = Î¾.E
        Î½ = Î¾.Î½
        xL = 0.0
        yL = 0.0
        for Î¾ in ğ“–
        xL += Î¾.x
        yL += Î¾.y
        end
        xL = xL/length(ğ“–)
        yL = yL/length(ğ“–)
        ğ­ = zeros(length(ğ“–))
        âˆ‚ğ­âˆ‚x = zeros(length(ğ“–))
        âˆ‚ğ­âˆ‚y = zeros(length(ğ“–))
        ğ­[1] = 1.0
        ğ­[2] = xL
        ğ­[3] = yL
        âˆ‚ğ­âˆ‚x[1] = 0.0
        âˆ‚ğ­âˆ‚x[2] = 1.0
        âˆ‚ğ­âˆ‚x[3] = 0.0
        âˆ‚ğ­âˆ‚y[1] = 0.0
        âˆ‚ğ­âˆ‚y[2] = 0.0
        âˆ‚ğ­âˆ‚y[3] = 1.0
        # ğ­[1] = 1.0
        # ğ­[2] = xL
        # ğ­[3] = yL
        # ğ­[4] = xL^2
        # ğ­[5] = xL*yL
        # ğ­[6] = yL^2
        # âˆ‚ğ­âˆ‚x[1] = 0.0
        # âˆ‚ğ­âˆ‚x[2] = 1.0
        # âˆ‚ğ­âˆ‚x[3] = 0.0
        # âˆ‚ğ­âˆ‚x[4] = 2*xL
        # âˆ‚ğ­âˆ‚x[5] = yL
        # âˆ‚ğ­âˆ‚x[6] = 0.0
        # âˆ‚ğ­âˆ‚y[1] = 0.0
        # âˆ‚ğ­âˆ‚y[2] = 0.0
        # âˆ‚ğ­âˆ‚y[3] = 1.0
        # âˆ‚ğ­âˆ‚y[4] = 0.0
        # âˆ‚ğ­âˆ‚y[5] = xL
        # âˆ‚ğ­âˆ‚y[6] = 2*yL
        xÎ¾ = Î¾.x
        yÎ¾ = Î¾.y
        Câ»Â¹áµ¢áµ¢áµ¢áµ¢ = (1-Î½^2)/E
        Câ»Â¹áµ¢áµ¢â±¼â±¼ = -(Î½+Î½^2)/E
        Câ»Â¹áµ¢â±¼áµ¢â±¼ = 2*(1+Î½)/E
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[3*I-2,3*J-2] += Câ»Â¹áµ¢áµ¢áµ¢áµ¢*(ğ­[i]*ğ­[j]+âˆ‚ğ­âˆ‚x[i]*âˆ‚ğ­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ğ­âˆ‚y[i]*âˆ‚ğ­âˆ‚y[j]*(yÎ¾-yL)^2)*ğ‘¤
                k[3*I-2,3*J-1] += Câ»Â¹áµ¢áµ¢â±¼â±¼*(ğ­[i]*ğ­[j]+âˆ‚ğ­âˆ‚x[i]*âˆ‚ğ­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ğ­âˆ‚y[i]*âˆ‚ğ­âˆ‚y[j]*(yÎ¾-yL)^2)*ğ‘¤
                k[3*I-1,3*J-2] += Câ»Â¹áµ¢áµ¢â±¼â±¼*(ğ­[i]*ğ­[j]+âˆ‚ğ­âˆ‚x[i]*âˆ‚ğ­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ğ­âˆ‚y[i]*âˆ‚ğ­âˆ‚y[j]*(yÎ¾-yL)^2)*ğ‘¤
                k[3*I-1,3*J-1] += Câ»Â¹áµ¢áµ¢áµ¢áµ¢*(ğ­[i]*ğ­[j]+âˆ‚ğ­âˆ‚x[i]*âˆ‚ğ­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ğ­âˆ‚y[i]*âˆ‚ğ­âˆ‚y[j]*(yÎ¾-yL)^2)*ğ‘¤
                k[3*I,3*J]     += Câ»Â¹áµ¢â±¼áµ¢â±¼*(ğ­[i]*ğ­[j]+âˆ‚ğ­âˆ‚x[i]*âˆ‚ğ­âˆ‚x[j]*(xÎ¾-xL)^2+âˆ‚ğ­âˆ‚y[i]*âˆ‚ğ­âˆ‚y[j]*(yÎ¾-yL)^2)*ğ‘¤
            end
        end
    end
end

function âˆ«âˆ«Ïƒáµ¢â±¼Ïƒâ‚–â‚—dxdy_PlaneStrian(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’;ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        N = Î¾[:ğ­]
        ğ‘¤ = Î¾.ğ‘¤
        E = Î¾.E
        Î½ = Î¾.Î½
        Câ»Â¹áµ¢áµ¢áµ¢áµ¢ = (1-Î½^2)/E
        Câ»Â¹áµ¢áµ¢â±¼â±¼ = -(Î½+Î½^2)/E
        Câ»Â¹áµ¢â±¼áµ¢â±¼ = 2*(1+Î½)/E
        
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[3*I-2,3*J-2] += N[i]*Câ»Â¹áµ¢áµ¢áµ¢áµ¢*N[j]*ğ‘¤
                k[3*I-2,3*J-1] += N[i]*Câ»Â¹áµ¢áµ¢â±¼â±¼*N[j]*ğ‘¤
                k[3*I-1,3*J-2] += N[i]*Câ»Â¹áµ¢áµ¢â±¼â±¼*N[j]*ğ‘¤
                k[3*I-1,3*J-1] += N[i]*Câ»Â¹áµ¢áµ¢áµ¢áµ¢*N[j]*ğ‘¤
                k[3*I,3*J]     += N[i]*Câ»Â¹áµ¢â±¼áµ¢â±¼*N[j]*ğ‘¤
            end
        end
    end
end


function âˆ«Ïƒáµ¢â±¼nâ±¼gáµ¢ds(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ğ“’â‚› = aâ‚›.ğ“’;ğ“–â‚› = aâ‚›.ğ“–
    ğ“’áµ¤ = aáµ¤.ğ“’;ğ“–áµ¤ = aáµ¤.ğ“–
    for (Î¾â‚›,Î¾áµ¤) in zip(ğ“–â‚›,ğ“–áµ¤)
        # ğ‘¤ = Î¾â‚›.ğ‘¤
        ğ‘¤ = Î¾áµ¤.ğ‘¤
        N = Î¾â‚›[:ğ­]
        NÌ„ = Î¾áµ¤[:ğ­]
        nâ‚ = Î¾áµ¤.nâ‚
        nâ‚‚ = Î¾áµ¤.nâ‚‚
        nâ‚â‚ = Î¾áµ¤.nâ‚â‚
        nâ‚â‚‚ = Î¾áµ¤.nâ‚â‚‚
        nâ‚‚â‚‚ = Î¾áµ¤.nâ‚‚â‚‚
        gâ‚ = Î¾áµ¤.gâ‚
        gâ‚‚ = Î¾áµ¤.gâ‚‚
        

        for (i,xáµ¢) in enumerate(ğ“’â‚›)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’áµ¤)
                J = xâ±¼.ğ¼
                k[3*I-2,2*J-1] += N[i]*nâ‚*nâ‚â‚*NÌ„[j]*ğ‘¤
                k[3*I-2,2*J]   += N[i]*nâ‚*nâ‚â‚‚*NÌ„[j]*ğ‘¤
                k[3*I-1,2*J-1] += N[i]*nâ‚‚*nâ‚â‚‚*NÌ„[j]*ğ‘¤
                k[3*I-1,2*J]   += N[i]*nâ‚‚*nâ‚‚â‚‚*NÌ„[j]*ğ‘¤
                k[3*I,2*J-1]   += N[i]*(nâ‚*nâ‚â‚‚ + nâ‚‚*nâ‚â‚)*NÌ„[j]*ğ‘¤
                k[3*I,2*J]     += N[i]*(nâ‚*nâ‚‚â‚‚ + nâ‚‚*nâ‚â‚‚)*NÌ„[j]*ğ‘¤
            end
            f[3*I-2] += N[i]*(nâ‚*nâ‚â‚*gâ‚ + nâ‚*nâ‚â‚‚*gâ‚‚)*ğ‘¤
            f[3*I-1] += N[i]*(nâ‚‚*nâ‚â‚‚*gâ‚ + nâ‚‚*nâ‚‚â‚‚*gâ‚‚)*ğ‘¤
            f[3*I]   += N[i]*((nâ‚*nâ‚â‚‚+nâ‚‚*nâ‚â‚)*gâ‚ + (nâ‚*nâ‚‚â‚‚+nâ‚‚*nâ‚â‚‚)*gâ‚‚)*ğ‘¤ 
        end
    end
end


function âˆ«Ïƒáµ¢â±¼nâ±¼uáµ¢ds(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ğ“’â‚› = aâ‚›.ğ“’;ğ“–â‚› = aâ‚›.ğ“–
    ğ“’áµ¤ = aáµ¤.ğ“’;ğ“–áµ¤ = aáµ¤.ğ“–
    for (Î¾â‚›,Î¾áµ¤) in zip(ğ“–â‚›,ğ“–áµ¤)
        ğ‘¤ = Î¾â‚›.ğ‘¤
        # ğ‘¤ = Î¾áµ¤.ğ‘¤

        N = Î¾â‚›[:ğ­]
        NÌ„ = Î¾áµ¤[:ğ­]
        nâ‚ = Î¾áµ¤.nâ‚
        nâ‚‚ = Î¾áµ¤.nâ‚‚
        
        for (i,xáµ¢) in enumerate(ğ“’â‚›)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’áµ¤)
                J = xâ±¼.ğ¼
                k[3*I-2,2*J-1] -= N[i]*nâ‚*NÌ„[j]*ğ‘¤
                k[3*I-1,2*J]   -= N[i]*nâ‚‚*NÌ„[j]*ğ‘¤
                k[3*I,2*J-1]   -= N[i]*nâ‚‚*NÌ„[j]*ğ‘¤
                k[3*I,2*J]     -= N[i]*nâ‚*NÌ„[j]*ğ‘¤
            end
        end
    end
end



function âˆ«âˆ«âˆ‡Ïƒáµ¢â±¼uáµ¢dxdy(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ğ“’â‚› = aâ‚›.ğ“’;ğ“–â‚› = aâ‚›.ğ“–
    ğ“’áµ¤ = aáµ¤.ğ“’;ğ“–áµ¤ = aáµ¤.ğ“–
    for (Î¾â‚›,Î¾áµ¤) in zip(ğ“–â‚›,ğ“–áµ¤)
        ğ‘¤ = Î¾â‚›.ğ‘¤
        # ğ‘¤ = Î¾áµ¤.ğ‘¤
        Bâ‚ = Î¾â‚›[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾â‚›[:âˆ‚ğ­âˆ‚y]
        N = Î¾áµ¤[:ğ­]
        for (i,xáµ¢) in enumerate(ğ“’â‚›)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’áµ¤)
                J = xâ±¼.ğ¼
                k[3*I-2,2*J-1] += Bâ‚[i]*N[j]*ğ‘¤
                k[3*I-1,2*J]   += Bâ‚‚[i]*N[j]*ğ‘¤
                k[3*I,2*J-1]   += Bâ‚‚[i]*N[j]*ğ‘¤
                k[3*I,2*J]     += Bâ‚[i]*N[j]*ğ‘¤
            end
        end
    end
end

function âˆ«âˆ«váµ¢báµ¢dxdy(ap::T,f::AbstractVector{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        N = Î¾[:ğ­]
        ğ‘¤ = Î¾.ğ‘¤
        bâ‚ = Î¾.bâ‚
        bâ‚‚ = Î¾.bâ‚‚
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            f[2*I-1] += N[i]*bâ‚*ğ‘¤
            f[2*I]   += N[i]*bâ‚‚*ğ‘¤
        end
    end
end

function âˆ«váµ¢báµ¢dÎ©(ap::T,f::AbstractVector{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        N = Î¾[:ğ­]
        ğ‘¤ = Î¾.ğ‘¤
        bâ‚ = Î¾.bâ‚
        bâ‚‚ = Î¾.bâ‚‚
        bâ‚ƒ = Î¾.bâ‚ƒ
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            f[3*I-2] += N[i]*bâ‚*ğ‘¤
            f[3*I-1] += N[i]*bâ‚‚*ğ‘¤
            f[3*I]   += N[i]*bâ‚ƒ*ğ‘¤
        end
    end
end

function âˆ«váµ¢táµ¢ds(ap::T,f::AbstractVector{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        N = Î¾[:ğ­]
        ğ‘¤ = Î¾.ğ‘¤
        tâ‚ = Î¾.tâ‚
        tâ‚‚ = Î¾.tâ‚‚
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            f[2*I-1] += N[i]*tâ‚*ğ‘¤
            f[2*I]   += N[i]*tâ‚‚*ğ‘¤
        end
    end
end

function âˆ«váµ¢táµ¢dÎ“(ap::T,f::AbstractVector{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        N = Î¾[:ğ­]
        ğ‘¤ = Î¾.ğ‘¤
        tâ‚ = Î¾.tâ‚
        tâ‚‚ = Î¾.tâ‚‚
        tâ‚ƒ = Î¾.tâ‚ƒ
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            f[3*I-2] += N[i]*tâ‚*ğ‘¤
            f[3*I-1] += N[i]*tâ‚‚*ğ‘¤
            f[3*I]   += N[i]*tâ‚ƒ*ğ‘¤
        end
    end
end

function âˆ«qpdÎ©(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        ğ‘¤ = Î¾.ğ‘¤
        N = Î¾[:ğ­]
        E = Î¾.E
        Î½ = Î¾.Î½
        K = E/3/(1-2*Î½)
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[I,J] += N[i]*N[j]/K*ğ‘¤
            end
        end
    end
end

function âˆ«pâˆ‡udÎ©(aâ‚š::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ğ“’áµ¤ = aáµ¤.ğ“’;ğ“–áµ¤ = aáµ¤.ğ“–
    ğ“’â‚š = aâ‚š.ğ“’;ğ“–â‚š = aâ‚š.ğ“–
    for (Î¾áµ¤,Î¾â‚š) in zip(ğ“–áµ¤,ğ“–â‚š)
        N = Î¾â‚š[:ğ­]
        Bâ‚ = Î¾áµ¤[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾áµ¤[:âˆ‚ğ­âˆ‚y]
        Bâ‚ƒ = Î¾áµ¤[:âˆ‚ğ­âˆ‚z]
        ğ‘¤ = Î¾áµ¤.ğ‘¤
        for (i,xáµ¢) in enumerate(ğ“’â‚š)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’áµ¤)
                J = xâ±¼.ğ¼
                k[I,3*J-2] -= N[i]*Bâ‚[j]*ğ‘¤
                k[I,3*J-1] -= N[i]*Bâ‚‚[j]*ğ‘¤
                k[I,3*J]   -= N[i]*Bâ‚ƒ[j]*ğ‘¤
            end
        end
    end
end

function âˆ«âˆ«pâˆ‡udxdy(aâ‚š::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ğ“’áµ¤ = aáµ¤.ğ“’;ğ“–áµ¤ = aáµ¤.ğ“–
    ğ“’â‚š = aâ‚š.ğ“’;ğ“–â‚š = aâ‚š.ğ“–
    for (Î¾áµ¤,Î¾â‚š) in zip(ğ“–áµ¤,ğ“–â‚š)
        N = Î¾â‚š[:ğ­]
        Bâ‚ = Î¾áµ¤[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾áµ¤[:âˆ‚ğ­âˆ‚y]
        ğ‘¤ = Î¾áµ¤.ğ‘¤
        # ğ‘¤ = Î¾â‚š.ğ‘¤
        for (i,xáµ¢) in enumerate(ğ“’â‚š)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’áµ¤)
                J = xâ±¼.ğ¼
                k[I,2*J-1] -= N[i]*Bâ‚[j]*ğ‘¤
                k[I,2*J]   -= N[i]*Bâ‚‚[j]*ğ‘¤
            end
        end
    end
end

function âˆ«âˆ«âˆ‡puáµ¢dxdy(aâ‚š::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ğ“’áµ¤ = aáµ¤.ğ“’;ğ“–áµ¤ = aáµ¤.ğ“–
    ğ“’â‚š = aâ‚š.ğ“’;ğ“–â‚š = aâ‚š.ğ“–
    for (Î¾áµ¤,Î¾â‚š) in zip(ğ“–áµ¤,ğ“–â‚š)
        Bâ‚ = Î¾â‚š[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾â‚š[:âˆ‚ğ­âˆ‚y]
        N = Î¾áµ¤[:ğ­]
        ğ‘¤ = Î¾áµ¤.ğ‘¤
        for (i,xáµ¢) in enumerate(ğ“’â‚š)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’áµ¤)
                J = xâ±¼.ğ¼
                k[I,2*J-1] += Bâ‚[i]*N[j]*ğ‘¤
                k[I,2*J]   += Bâ‚‚[i]*N[j]*ğ‘¤
            end
        end
    end
end

function âˆ«pnáµ¢uáµ¢ds(aâ‚š::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ğ“’áµ¤ = aáµ¤.ğ“’;ğ“–áµ¤ = aáµ¤.ğ“–
    ğ“’â‚š = aâ‚š.ğ“’;ğ“–â‚š = aâ‚š.ğ“–
    for (Î¾áµ¤,Î¾â‚š) in zip(ğ“–áµ¤,ğ“–â‚š)
        Nâ‚š = Î¾â‚š[:ğ­]
        Náµ¤ = Î¾áµ¤[:ğ­]
        nâ‚ = Î¾áµ¤.nâ‚
        nâ‚‚ = Î¾áµ¤.nâ‚‚
        ğ‘¤ = Î¾áµ¤.ğ‘¤
        # ğ‘¤ = Î¾â‚š.ğ‘¤
        for (i,xáµ¢) in enumerate(ğ“’â‚š)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’áµ¤)
                J = xâ±¼.ğ¼
                k[I,2*J-1] -= Nâ‚š[i]*Náµ¤[j]*nâ‚*ğ‘¤
                k[I,2*J]   -= Nâ‚š[i]*Náµ¤[j]*nâ‚‚*ğ‘¤
            end
        end
    end
end

function âˆ«pnáµ¢gáµ¢ds(aâ‚š::T,aáµ¤::S,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ğ“’áµ¤ = aáµ¤.ğ“’;ğ“–áµ¤ = aáµ¤.ğ“–
    ğ“’â‚š = aâ‚š.ğ“’;ğ“–â‚š = aâ‚š.ğ“–
    for (Î¾áµ¤,Î¾â‚š) in zip(ğ“–áµ¤,ğ“–â‚š)
        Nâ‚š = Î¾â‚š[:ğ­]
        Náµ¤ = Î¾áµ¤[:ğ­]
        nâ‚ = Î¾áµ¤.nâ‚
        nâ‚‚ = Î¾áµ¤.nâ‚‚
        gâ‚ = Î¾áµ¤.gâ‚
        gâ‚‚ = Î¾áµ¤.gâ‚‚
        nâ‚â‚ = Î¾áµ¤.nâ‚â‚
        nâ‚â‚‚ = Î¾áµ¤.nâ‚â‚‚
        nâ‚‚â‚‚ = Î¾áµ¤.nâ‚‚â‚‚
        ğ‘¤ = Î¾áµ¤.ğ‘¤
        # ğ‘¤ = Î¾â‚š.ğ‘¤
        for (i,xáµ¢) in enumerate(ğ“’â‚š)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’áµ¤)
                J = xâ±¼.ğ¼
                k[I,2*J-1] += Nâ‚š[i]*Náµ¤[j]*(nâ‚*nâ‚â‚+nâ‚‚*nâ‚â‚‚)*ğ‘¤
                k[I,2*J]   += Nâ‚š[i]*Náµ¤[j]*(nâ‚*nâ‚â‚‚+nâ‚‚*nâ‚‚â‚‚)*ğ‘¤
            end
            f[I] += Nâ‚š[i]*(nâ‚*nâ‚â‚*gâ‚+nâ‚*nâ‚â‚‚*gâ‚‚+nâ‚‚*nâ‚â‚‚*gâ‚+nâ‚‚*nâ‚‚â‚‚*gâ‚‚)*ğ‘¤
        end
    end
end

function âˆ«âˆ«sáµ¢â±¼sáµ¢â±¼dxdy(ap::T,k::AbstractMatrix{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        ğ‘¤ = Î¾.ğ‘¤
        N = Î¾[:ğ­]
        E = Î¾.E
        Î½ = Î¾.Î½
        G = E/(1+Î½)
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[4*I-3,4*J-3] +=   N[i]*N[j]/G*ğ‘¤
                k[4*I-2,4*J-2] +=   N[i]*N[j]/G*ğ‘¤
                k[4*I-1,4*J-1] +=   N[i]*N[j]/G*ğ‘¤
                k[4*I,4*J]     += 2*N[i]*N[j]/G*ğ‘¤
            end
        end
    end
end

function âˆ«âˆ«sáµ¢â±¼Îµáµ¢â±¼dxdy(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ğ“’áµ¤ = aáµ¤.ğ“’;ğ“–áµ¤ = aáµ¤.ğ“–
    ğ“’â‚› = aâ‚›.ğ“’;ğ“–â‚› = aâ‚›.ğ“–
    for (Î¾áµ¤,Î¾â‚›) in zip(ğ“–áµ¤,ğ“–â‚›)
        N = Î¾â‚›[:ğ­]
        Bâ‚ = Î¾áµ¤[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾áµ¤[:âˆ‚ğ­âˆ‚y]
        ğ‘¤ = Î¾áµ¤.ğ‘¤
        for (i,xáµ¢) in enumerate(ğ“’â‚›)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’áµ¤)
                J = xâ±¼.ğ¼
                k[4*I-3,2*J-1] -= 2/3*N[i]*Bâ‚[j]*ğ‘¤
                k[4*I-3,2*J]   += 1/3*N[i]*Bâ‚‚[j]*ğ‘¤
                k[4*I-2,2*J-1] += 1/3*N[i]*Bâ‚[j]*ğ‘¤
                k[4*I-2,2*J]   -= 2/3*N[i]*Bâ‚‚[j]*ğ‘¤
                k[4*I-1,2*J-1] += 1/3*N[i]*Bâ‚[j]*ğ‘¤
                k[4*I-1,2*J]   += 1/3*N[i]*Bâ‚‚[j]*ğ‘¤
                k[4*I,2*J-1]   -=     N[i]*Bâ‚‚[j]*ğ‘¤
                k[4*I,2*J]     -=     N[i]*Bâ‚[j]*ğ‘¤
            end
        end
    end
end

function âˆ«âˆ«âˆ‡sáµ¢â±¼uáµ¢dxdy(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ğ“’áµ¤ = aáµ¤.ğ“’;ğ“–áµ¤ = aáµ¤.ğ“–
    ğ“’â‚› = aâ‚›.ğ“’;ğ“–â‚› = aâ‚›.ğ“–
    for (Î¾áµ¤,Î¾â‚›) in zip(ğ“–áµ¤,ğ“–â‚›)
        Bâ‚ = Î¾â‚›[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾â‚›[:âˆ‚ğ­âˆ‚y]
        Náµ¤ = Î¾áµ¤[:ğ­]
        ğ‘¤ = Î¾áµ¤.ğ‘¤
        for (i,xáµ¢) in enumerate(ğ“’â‚›)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’áµ¤)
                J = xâ±¼.ğ¼
                k[4*I-3,2*J-1] += 2/3*Bâ‚[i]*Náµ¤[j]*ğ‘¤
                k[4*I-3,2*J]   -= 1/3*Bâ‚‚[i]*Náµ¤[j]*ğ‘¤
                k[4*I-2,2*J-1] -= 1/3*Bâ‚[i]*Náµ¤[j]*ğ‘¤
                k[4*I-2,2*J]   += 2/3*Bâ‚‚[i]*Náµ¤[j]*ğ‘¤
                k[4*I-1,2*J-1] -= 1/3*Bâ‚[i]*Náµ¤[j]*ğ‘¤
                k[4*I-1,2*J]   -= 1/3*Bâ‚‚[i]*Náµ¤[j]*ğ‘¤
                k[4*I,2*J-1]   += Bâ‚‚[i]*Náµ¤[j]*ğ‘¤
                k[4*I,2*J]     += Bâ‚[i]*Náµ¤[j]*ğ‘¤
            end
        end
    end
end

function âˆ«sáµ¢â±¼nâ±¼uáµ¢ds(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ğ“’áµ¤ = aáµ¤.ğ“’;ğ“–áµ¤ = aáµ¤.ğ“–
    ğ“’â‚› = aâ‚›.ğ“’;ğ“–â‚› = aâ‚›.ğ“–
    for (Î¾áµ¤,Î¾â‚›) in zip(ğ“–áµ¤,ğ“–â‚›)
        Nâ‚› = Î¾â‚›[:ğ­]
        Náµ¤ = Î¾áµ¤[:ğ­]
        nâ‚ = Î¾áµ¤.nâ‚
        nâ‚‚ = Î¾áµ¤.nâ‚‚
        ğ‘¤ = Î¾áµ¤.ğ‘¤
        for (i,xáµ¢) in enumerate(ğ“’â‚›)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’áµ¤)
                J = xâ±¼.ğ¼
                k[4*I-3,2*J-1] -= 2/3*Nâ‚›[i]*Náµ¤[j]*nâ‚*ğ‘¤
                k[4*I-3,2*J]   += 1/3*Nâ‚›[i]*Náµ¤[j]*nâ‚‚*ğ‘¤
                k[4*I-2,2*J-1] += 1/3*Nâ‚›[i]*Náµ¤[j]*nâ‚*ğ‘¤
                k[4*I-2,2*J]   -= 2/3*Nâ‚›[i]*Náµ¤[j]*nâ‚‚*ğ‘¤
                k[4*I-1,2*J-1] += 1/3*Nâ‚›[i]*Náµ¤[j]*nâ‚*ğ‘¤
                k[4*I-1,2*J]   += 1/3*Nâ‚›[i]*Náµ¤[j]*nâ‚‚*ğ‘¤
                k[4*I,2*J-1]   -= Nâ‚›[i]*Náµ¤[j]*nâ‚‚*ğ‘¤
                k[4*I,2*J]     -= Nâ‚›[i]*Náµ¤[j]*nâ‚*ğ‘¤
            end
        end
    end
end

function âˆ«sáµ¢â±¼nâ±¼gáµ¢ds(aâ‚›::T,aáµ¤::S,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ğ“’áµ¤ = aáµ¤.ğ“’;ğ“–áµ¤ = aáµ¤.ğ“–
    ğ“’â‚› = aâ‚›.ğ“’;ğ“–â‚› = aâ‚›.ğ“–
    for (Î¾áµ¤,Î¾â‚›) in zip(ğ“–áµ¤,ğ“–â‚›)
        Nâ‚› = Î¾â‚›[:ğ­]
        Náµ¤ = Î¾áµ¤[:ğ­]
        nâ‚ = Î¾áµ¤.nâ‚
        nâ‚‚ = Î¾áµ¤.nâ‚‚
        gâ‚ = Î¾áµ¤.gâ‚
        gâ‚‚ = Î¾áµ¤.gâ‚‚
        nâ‚â‚ = Î¾áµ¤.nâ‚â‚
        nâ‚â‚‚ = Î¾áµ¤.nâ‚â‚‚
        nâ‚‚â‚‚ = Î¾áµ¤.nâ‚‚â‚‚
        ğ‘¤ = Î¾áµ¤.ğ‘¤
        for (i,xáµ¢) in enumerate(ğ“’â‚›)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’áµ¤)
                J = xâ±¼.ğ¼
                k[4*I-3,2*J-1] += Nâ‚›[i]*Náµ¤[j]*( 2/3*nâ‚*nâ‚â‚ - 1/3*nâ‚‚*nâ‚â‚‚)*ğ‘¤
                k[4*I-3,2*J]   += Nâ‚›[i]*Náµ¤[j]*( 2/3*nâ‚*nâ‚â‚‚ - 1/3*nâ‚‚*nâ‚‚â‚‚)*ğ‘¤
                k[4*I-2,2*J-1] += Nâ‚›[i]*Náµ¤[j]*(-1/3*nâ‚*nâ‚â‚ + 2/3*nâ‚‚*nâ‚â‚‚)*ğ‘¤
                k[4*I-2,2*J]   += Nâ‚›[i]*Náµ¤[j]*(-1/3*nâ‚*nâ‚â‚‚ + 2/3*nâ‚‚*nâ‚‚â‚‚)*ğ‘¤
                k[4*I-1,2*J-1] += Nâ‚›[i]*Náµ¤[j]*(-1/3*nâ‚*nâ‚â‚ - 1/3*nâ‚‚*nâ‚â‚‚)*ğ‘¤
                k[4*I-1,2*J]   += Nâ‚›[i]*Náµ¤[j]*(-1/3*nâ‚*nâ‚â‚‚ - 1/3*nâ‚‚*nâ‚‚â‚‚)*ğ‘¤
                k[4*I,2*J-1]   += Nâ‚›[i]*Náµ¤[j]*(nâ‚*nâ‚â‚‚ + nâ‚‚*nâ‚â‚)*ğ‘¤
                k[4*I,2*J]     += Nâ‚›[i]*Náµ¤[j]*(nâ‚*nâ‚‚â‚‚ + nâ‚‚*nâ‚â‚‚)*ğ‘¤
            end
            f[4*I-3] += Nâ‚›[i]*(( 2/3*nâ‚*nâ‚â‚-1/3*nâ‚‚*nâ‚â‚‚)*gâ‚+( 2/3*nâ‚*nâ‚â‚‚-1/3*nâ‚‚*nâ‚‚â‚‚)*gâ‚‚)*ğ‘¤
            f[4*I-2] += Nâ‚›[i]*((-1/3*nâ‚*nâ‚â‚+2/3*nâ‚‚*nâ‚â‚‚)*gâ‚+(-1/3*nâ‚*nâ‚â‚‚+2/3*nâ‚‚*nâ‚‚â‚‚)*gâ‚‚)*ğ‘¤
            f[4*I-1] += Nâ‚›[i]*((-1/3*nâ‚*nâ‚â‚-1/3*nâ‚‚*nâ‚â‚‚)*gâ‚+(-1/3*nâ‚*nâ‚â‚‚-1/3*nâ‚‚*nâ‚‚â‚‚)*gâ‚‚)*ğ‘¤
            f[4*I]   += Nâ‚›[i]*((nâ‚*nâ‚â‚‚+nâ‚‚*nâ‚â‚)*gâ‚+(nâ‚*nâ‚‚â‚‚+nâ‚‚*nâ‚â‚‚)*gâ‚‚)*ğ‘¤
        end
    end
end


function gâ‚‚(ap::T,k::AbstractMatrix{Float64},f::AbstractVector{Float64},dof::Symbol) where T<:AbstractElement
    x, = ap.ğ“’
    if dof == :dâ‚
        j = 2*x.ğ¼-1
    else
        j = 2*x.ğ¼
    end
    g = getproperty(x,dof)
    for i in eachindex(f)
        f[i] -= k[i,j]*g
    end
    k[j,:] .= 0.
    k[:,j] .= 0.
    k[j,j] = 1.
    f[j] = g
end

function âˆ«Î»áµ¢gáµ¢ds(aâ‚—::T,aáµ¤::S,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ğ“’â‚— = aâ‚—.ğ“’;ğ“–â‚— = aâ‚—.ğ“–
    ğ“’áµ¤ = aáµ¤.ğ“’;ğ“–áµ¤ = aáµ¤.ğ“–
    for (Î¾â‚—,Î¾áµ¤) in zip(ğ“–â‚—,ğ“–áµ¤)
        ğ‘¤ = Î¾â‚—.ğ‘¤
        NÌ„ = Î¾â‚—[:ğ­]
        N = Î¾áµ¤[:ğ­]
        gâ‚ = Î¾áµ¤.gâ‚
        gâ‚‚ = Î¾áµ¤.gâ‚‚
        nâ‚â‚ = Î¾áµ¤.nâ‚â‚
        nâ‚‚â‚‚ = Î¾áµ¤.nâ‚‚â‚‚
        nâ‚â‚‚ = Î¾áµ¤.nâ‚â‚‚
        for (i,xáµ¢) in enumerate(ğ“’â‚—)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’áµ¤)
                J = xâ±¼.ğ¼
                k[2*I-1,2*J-1] -= nâ‚â‚*NÌ„[i]*N[j]*ğ‘¤
                k[2*I-1,2*J]   -= nâ‚â‚‚*NÌ„[i]*N[j]*ğ‘¤
                k[2*I,2*J-1]   -= nâ‚â‚‚*NÌ„[i]*N[j]*ğ‘¤
                k[2*I,2*J]     -= nâ‚‚â‚‚*NÌ„[i]*N[j]*ğ‘¤
            end
            f[2*I-1] -= NÌ„[i]*(nâ‚â‚*gâ‚+nâ‚â‚‚*gâ‚‚)*ğ‘¤
            f[2*I]   -= NÌ„[i]*(nâ‚â‚‚*gâ‚+nâ‚‚â‚‚*gâ‚‚)*ğ‘¤
        end
    end
end

function âˆ«Ïƒáµ¢â±¼nâ±¼gáµ¢ds(ap::T,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        ğ‘¤ = Î¾.ğ‘¤
        N = Î¾[:ğ­]
        Bâ‚ = Î¾[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ğ­âˆ‚y]
        nâ‚â‚ = Î¾.nâ‚â‚
        nâ‚â‚‚ = Î¾.nâ‚â‚‚
        nâ‚‚â‚‚ = Î¾.nâ‚‚â‚‚
        gâ‚ = Î¾.gâ‚
        gâ‚‚ = Î¾.gâ‚‚
        nâ‚ = Î¾.nâ‚
        nâ‚‚ = Î¾.nâ‚‚
        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµ¢áµ¢áµ¢áµ¢ = E/(1-Î½^2)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-Î½^2)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
        Câ‚â‚â‚ = Cáµ¢áµ¢áµ¢áµ¢*nâ‚*nâ‚â‚+Cáµ¢áµ¢â±¼â±¼*nâ‚‚*nâ‚â‚‚
        Câ‚â‚â‚‚ = Cáµ¢áµ¢áµ¢áµ¢*nâ‚*nâ‚â‚‚+Cáµ¢áµ¢â±¼â±¼*nâ‚‚*nâ‚‚â‚‚
        Câ‚‚â‚‚â‚ = Cáµ¢áµ¢â±¼â±¼*nâ‚*nâ‚â‚+Cáµ¢áµ¢áµ¢áµ¢*nâ‚‚*nâ‚â‚‚
        Câ‚‚â‚‚â‚‚ = Cáµ¢áµ¢â±¼â±¼*nâ‚*nâ‚â‚‚+Cáµ¢áµ¢áµ¢áµ¢*nâ‚‚*nâ‚‚â‚‚
        Câ‚â‚‚â‚ = Cáµ¢â±¼áµ¢â±¼*(nâ‚*nâ‚â‚‚+nâ‚‚*nâ‚â‚)
        Câ‚â‚‚â‚‚ = Cáµ¢â±¼áµ¢â±¼*(nâ‚‚*nâ‚â‚‚+nâ‚*nâ‚‚â‚‚)
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[2*I-1,2*J-1] -= (Câ‚â‚â‚*(N[i]*Bâ‚[j]+Bâ‚[i]*N[j]) + Câ‚â‚‚â‚*(N[i]*Bâ‚‚[j]+Bâ‚‚[i]*N[j]))*ğ‘¤
                k[2*I-1,2*J]   -= (Câ‚â‚‚â‚*N[i]*Bâ‚[j] + Câ‚â‚â‚‚*Bâ‚[i]*N[j] + Câ‚‚â‚‚â‚*N[i]*Bâ‚‚[j] + Câ‚â‚‚â‚‚*Bâ‚‚[i]*N[j])*ğ‘¤
                k[2*I,2*J-1]   -= (Câ‚â‚â‚‚*N[i]*Bâ‚[j] + Câ‚â‚‚â‚*Bâ‚[i]*N[j] + Câ‚â‚‚â‚‚*N[i]*Bâ‚‚[j] + Câ‚‚â‚‚â‚*Bâ‚‚[i]*N[j])*ğ‘¤
                k[2*I,2*J]     -= (Câ‚â‚‚â‚‚*(N[i]*Bâ‚[j]+Bâ‚[i]*N[j]) + Câ‚‚â‚‚â‚‚*(N[i]*Bâ‚‚[j]+Bâ‚‚[i]*N[j]))*ğ‘¤
            end
            f[2*I-1] -= ((Câ‚â‚â‚*Bâ‚[i]+Câ‚â‚‚â‚*Bâ‚‚[i])*gâ‚ + (Câ‚â‚â‚‚*Bâ‚[i]+Câ‚â‚‚â‚‚*Bâ‚‚[i])*gâ‚‚)*ğ‘¤
            f[2*I]   -= ((Câ‚â‚‚â‚*Bâ‚[i]+Câ‚‚â‚‚â‚*Bâ‚‚[i])*gâ‚ + (Câ‚â‚‚â‚‚*Bâ‚[i]+Câ‚‚â‚‚â‚‚*Bâ‚‚[i])*gâ‚‚)*ğ‘¤
        end
    end
end

function âˆ«Ïƒáµ¢â±¼nâ±¼gáµ¢váµ¢gáµ¢ds(ap::T,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        ğ‘¤ = Î¾.ğ‘¤
        N = Î¾[:ğ­]
        Bâ‚ = Î¾[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ğ­âˆ‚y]
        nâ‚â‚ = Î¾.nâ‚â‚
        nâ‚â‚‚ = Î¾.nâ‚â‚‚
        nâ‚‚â‚‚ = Î¾.nâ‚‚â‚‚
        gâ‚ = Î¾.gâ‚
        gâ‚‚ = Î¾.gâ‚‚
        nâ‚ = Î¾.nâ‚
        nâ‚‚ = Î¾.nâ‚‚
        E = Î¾.E
        Î½ = Î¾.Î½
        Î± = Î¾.Î±
        Cáµ¢áµ¢áµ¢áµ¢ = E/(1-Î½^2)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-Î½^2)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
        Câ‚â‚â‚ = Cáµ¢áµ¢áµ¢áµ¢*nâ‚*nâ‚â‚+Cáµ¢áµ¢â±¼â±¼*nâ‚‚*nâ‚â‚‚
        Câ‚â‚â‚‚ = Cáµ¢áµ¢áµ¢áµ¢*nâ‚*nâ‚â‚‚+Cáµ¢áµ¢â±¼â±¼*nâ‚‚*nâ‚‚â‚‚
        Câ‚‚â‚‚â‚ = Cáµ¢áµ¢â±¼â±¼*nâ‚*nâ‚â‚+Cáµ¢áµ¢áµ¢áµ¢*nâ‚‚*nâ‚â‚‚
        Câ‚‚â‚‚â‚‚ = Cáµ¢áµ¢â±¼â±¼*nâ‚*nâ‚â‚‚+Cáµ¢áµ¢áµ¢áµ¢*nâ‚‚*nâ‚‚â‚‚
        Câ‚â‚‚â‚ = Cáµ¢â±¼áµ¢â±¼*(nâ‚*nâ‚â‚‚+nâ‚‚*nâ‚â‚)
        Câ‚â‚‚â‚‚ = Cáµ¢â±¼áµ¢â±¼*(nâ‚‚*nâ‚â‚‚+nâ‚*nâ‚‚â‚‚)
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[2*I-1,2*J-1] -= (Câ‚â‚â‚*(N[i]*Bâ‚[j]+Bâ‚[i]*N[j]) + Câ‚â‚‚â‚*(N[i]*Bâ‚‚[j]+Bâ‚‚[i]*N[j]) - Î±*N[i]*nâ‚â‚*N[j])*ğ‘¤
                k[2*I-1,2*J]   -= (Câ‚â‚‚â‚*N[i]*Bâ‚[j] + Câ‚â‚â‚‚*Bâ‚[i]*N[j] + Câ‚‚â‚‚â‚*N[i]*Bâ‚‚[j] + Câ‚â‚‚â‚‚*Bâ‚‚[i]*N[j] -Î±*N[i]*nâ‚â‚‚*N[j])*ğ‘¤
                k[2*I,2*J-1]   -= (Câ‚â‚â‚‚*N[i]*Bâ‚[j] + Câ‚â‚‚â‚*Bâ‚[i]*N[j] + Câ‚â‚‚â‚‚*N[i]*Bâ‚‚[j] + Câ‚‚â‚‚â‚*Bâ‚‚[i]*N[j] -Î±*N[i]*nâ‚â‚‚*N[j])*ğ‘¤
                k[2*I,2*J]     -= (Câ‚â‚‚â‚‚*(N[i]*Bâ‚[j]+Bâ‚[i]*N[j]) + Câ‚‚â‚‚â‚‚*(N[i]*Bâ‚‚[j]+Bâ‚‚[i]*N[j]) -Î±*N[i]*nâ‚‚â‚‚*N[j])*ğ‘¤
            end
            f[2*I-1] -= ((Câ‚â‚â‚*Bâ‚[i]+Câ‚â‚‚â‚*Bâ‚‚[i]-Î±*N[i]*nâ‚â‚)*gâ‚ + (Câ‚â‚â‚‚*Bâ‚[i]+Câ‚â‚‚â‚‚*Bâ‚‚[i]-Î±*N[i]*nâ‚â‚‚)*gâ‚‚)*ğ‘¤
            f[2*I]   -= ((Câ‚â‚‚â‚*Bâ‚[i]+Câ‚‚â‚‚â‚*Bâ‚‚[i]-Î±*N[i]*nâ‚â‚‚)*gâ‚ + (Câ‚â‚‚â‚‚*Bâ‚[i]+Câ‚‚â‚‚â‚‚*Bâ‚‚[i]-Î±*N[i]*nâ‚‚â‚‚)*gâ‚‚)*ğ‘¤
        end
    end
end

function âˆ«váµ¢gáµ¢ds(ap::T,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        ğ‘¤ = Î¾.ğ‘¤
        N = Î¾[:ğ­]
        nâ‚â‚ = Î¾.nâ‚â‚
        nâ‚‚â‚‚ = Î¾.nâ‚‚â‚‚
        nâ‚â‚‚ = Î¾.nâ‚â‚‚
        gâ‚ = Î¾.gâ‚
        gâ‚‚ = Î¾.gâ‚‚
        Î± = Î¾.Î±
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[2*I-1,2*J-1] += Î±*N[i]*nâ‚â‚*N[j]*ğ‘¤
                k[2*I,2*J-1]   += Î±*N[i]*nâ‚â‚‚*N[j]*ğ‘¤
                k[2*I-1,2*J]   += Î±*N[i]*nâ‚â‚‚*N[j]*ğ‘¤
                k[2*I,2*J]     += Î±*N[i]*nâ‚‚â‚‚*N[j]*ğ‘¤
            end
            f[2*I-1] += Î±*N[i]*(nâ‚â‚*gâ‚+nâ‚â‚‚*gâ‚‚)*ğ‘¤
            f[2*I]   += Î±*N[i]*(nâ‚â‚‚*gâ‚+nâ‚‚â‚‚*gâ‚‚)*ğ‘¤
        end
    end
end

function âˆ«váµ¢gáµ¢dÎ“(ap::T,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        ğ‘¤ = Î¾.ğ‘¤
        N = Î¾[:ğ­]
        nâ‚â‚ = Î¾.nâ‚â‚
        nâ‚â‚‚ = Î¾.nâ‚â‚‚
        nâ‚â‚ƒ = Î¾.nâ‚â‚ƒ
        nâ‚‚â‚‚ = Î¾.nâ‚‚â‚‚
        nâ‚‚â‚ƒ = Î¾.nâ‚‚â‚ƒ
        nâ‚ƒâ‚ƒ = Î¾.nâ‚ƒâ‚ƒ
        gâ‚ = Î¾.gâ‚
        gâ‚‚ = Î¾.gâ‚‚
        gâ‚ƒ = Î¾.gâ‚ƒ
        Î± = Î¾.Î±
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[3*I-2,3*J-2] += Î±*N[i]*nâ‚â‚*N[j]*ğ‘¤
                k[3*I-2,3*J-1] += Î±*N[i]*nâ‚â‚‚*N[j]*ğ‘¤
                k[3*I-2,3*J]   += Î±*N[i]*nâ‚â‚ƒ*N[j]*ğ‘¤
                k[3*I-1,3*J-2] += Î±*N[i]*nâ‚â‚‚*N[j]*ğ‘¤
                k[3*I-1,3*J-1] += Î±*N[i]*nâ‚‚â‚‚*N[j]*ğ‘¤
                k[3*I-1,3*J]   += Î±*N[i]*nâ‚‚â‚ƒ*N[j]*ğ‘¤
                k[3*I,3*J-2]   += Î±*N[i]*nâ‚â‚ƒ*N[j]*ğ‘¤
                k[3*I,3*J-1]   += Î±*N[i]*nâ‚‚â‚ƒ*N[j]*ğ‘¤
                k[3*I,3*J]     += Î±*N[i]*nâ‚ƒâ‚ƒ*N[j]*ğ‘¤
            end
            f[3*I-2] += Î±*N[i]*(nâ‚â‚*gâ‚+nâ‚â‚‚*gâ‚‚+nâ‚â‚ƒ*gâ‚ƒ)*ğ‘¤
            f[3*I-1] += Î±*N[i]*(nâ‚â‚‚*gâ‚+nâ‚‚â‚‚*gâ‚‚+nâ‚‚â‚ƒ*gâ‚ƒ)*ğ‘¤
            f[3*I]   += Î±*N[i]*(nâ‚â‚ƒ*gâ‚+nâ‚‚â‚ƒ*gâ‚‚+nâ‚ƒâ‚ƒ*gâ‚ƒ)*ğ‘¤
        end
    end
end

function âˆ«âˆ«Ï„âˆ‡qâˆ‡pdxdy(ap::T,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        ğ‘¤ = Î¾.ğ‘¤
        Ï„ = Î¾.Ï„
        bâ‚ = Î¾.bâ‚
        bâ‚‚ = Î¾.bâ‚‚
        Bâ‚ = Î¾[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ğ­âˆ‚y]
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[I,J] += Ï„*(Bâ‚[i]*Bâ‚[j] + Bâ‚‚[i]*Bâ‚‚[j])*ğ‘¤
            end
            f[I] += Ï„*(Bâ‚[i]*bâ‚ + Bâ‚‚[i]*bâ‚‚)*ğ‘¤
        end
    end
end



function âˆ«âˆ«Ï„âˆ‡sáµ¢â±¼âˆ‡sáµ¢â‚–dxdy(ap::T,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        ğ‘¤ = Î¾.ğ‘¤
        Ï„ = Î¾.Ï„
        bâ‚ = Î¾.bâ‚
        bâ‚‚ = Î¾.bâ‚‚
        Bâ‚ = Î¾[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ğ­âˆ‚y]
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[4*I-3,4*J-3] += Ï„*Bâ‚[i]*Bâ‚[j]*ğ‘¤
                k[4*I-3,4*J]   += Ï„*Bâ‚[i]*Bâ‚‚[j]*ğ‘¤
                k[4*I-2,4*J-2] += Ï„*Bâ‚‚[i]*Bâ‚‚[j]*ğ‘¤
                k[4*I-2,4*J]   += Ï„*Bâ‚‚[i]*Bâ‚[j]*ğ‘¤
                k[4*I,4*J-3]   += Ï„*Bâ‚‚[i]*Bâ‚[j]*ğ‘¤
                k[4*I,4*J-2]   += Ï„*Bâ‚[i]*Bâ‚‚[j]*ğ‘¤
                k[4*I,4*J]     += Ï„*(Bâ‚[i]*Bâ‚[j] + Bâ‚‚[i]*Bâ‚‚[j])*ğ‘¤
            end
            f[4*I-3] += Ï„*Bâ‚[i]*bâ‚*ğ‘¤
            f[4*I-2] += Ï„*Bâ‚‚[i]*bâ‚‚*ğ‘¤
            f[4*I]   += Ï„*(Bâ‚[i]*bâ‚‚ + Bâ‚‚[i]*bâ‚)*ğ‘¤
        end
    end
end
function âˆ«âˆ«Ï„âˆ‡sáµ¢â±¼âˆ‡pdxdy(aâ‚›::T,aâ‚š::S,k::AbstractMatrix{Float64}) where {T<:AbstractElement,S<:AbstractElement}
    ğ“’â‚š = aâ‚š.ğ“’; ğ“–â‚š = aâ‚š.ğ“–
    ğ“’â‚› = aâ‚›.ğ“’; ğ“–â‚› = aâ‚›.ğ“–
    for (Î¾â‚š,Î¾â‚›) in zip(ğ“–â‚š,ğ“–â‚›)
        ğ‘¤ = Î¾â‚š.ğ‘¤
        Ï„ = Î¾â‚š.Ï„
        Bâ‚ = Î¾â‚›[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾â‚›[:âˆ‚ğ­âˆ‚y]
        BÌ„â‚ = Î¾â‚š[:âˆ‚ğ­âˆ‚x]
        BÌ„â‚‚ = Î¾â‚š[:âˆ‚ğ­âˆ‚y]
        for (i,xáµ¢) in enumerate(ğ“’â‚›)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’â‚š)
                J = xâ±¼.ğ¼
                k[4*I-3,J] += Ï„*Bâ‚[i]*BÌ„â‚[j]*ğ‘¤
                k[4*I-2,J] += Ï„*Bâ‚‚[i]*BÌ„â‚‚[j]*ğ‘¤
                k[4*I,J]   += Ï„*(Bâ‚[i]*BÌ„â‚‚[j] + Bâ‚‚[i]*BÌ„â‚[j])*ğ‘¤
            end
        end
    end
end
function âˆ«âˆ«Ï„âˆ‡Ïƒáµ¢â±¼âˆ‡Ïƒáµ¢â‚–dxdy(ap::T,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        ğ‘¤ = Î¾.ğ‘¤
        Ï„ = Î¾.Ï„
        bâ‚ = Î¾.bâ‚
        bâ‚‚ = Î¾.bâ‚‚
        Bâ‚ = Î¾[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ğ­âˆ‚y]
        E = Î¾.E
        Î½ = Î¾.Î½
        Câ»Â¹áµ¢áµ¢áµ¢áµ¢ = 1/E
        Câ»Â¹áµ¢áµ¢â±¼â±¼ = -Î½/E
        Câ»Â¹áµ¢â±¼áµ¢â±¼ = 2*(1+Î½)/E
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
                k[3*I-2,3*J-2] += Ï„*Bâ‚[i]*Bâ‚[j]*ğ‘¤
                k[3*I-2,3*J]   += Ï„*Bâ‚[i]*Bâ‚‚[j]*ğ‘¤
                k[3*I-1,3*J-1] += Ï„*Bâ‚‚[i]*Bâ‚‚[j]*ğ‘¤
                k[3*I-1,3*J]   += Ï„*Bâ‚‚[i]*Bâ‚[j]*ğ‘¤
                k[3*I,3*J-2]   += Ï„*Bâ‚‚[i]*Bâ‚[j]*ğ‘¤
                k[3*I,3*J-1]   += Ï„*Bâ‚[i]*Bâ‚‚[j]*ğ‘¤
                k[3*I,3*J]     += Ï„*(Bâ‚[i]*Bâ‚[j] + Bâ‚‚[i]*Bâ‚‚[j])*ğ‘¤
              
                # k[3*I-2,3*J-2] += Ï„*(Bâ‚[i]*Bâ‚[j] + Bâ‚‚[i]*Bâ‚‚[j])*ğ‘¤
                # k[3*I-2,3*J]   += Ï„*(Bâ‚[i]*Bâ‚[j] + Bâ‚‚[i]*Bâ‚‚[j])*ğ‘¤
                # k[3*I-1,3*J-1] += Ï„*(Bâ‚[i]*Bâ‚[j] + Bâ‚‚[i]*Bâ‚‚[j])*ğ‘¤
                # k[3*I-1,3*J]   += Ï„*(Bâ‚[i]*Bâ‚[j] + Bâ‚‚[i]*Bâ‚‚[j])*ğ‘¤
                # k[3*I,3*J-2]   += Ï„*(Bâ‚[i]*Bâ‚[j] + Bâ‚‚[i]*Bâ‚‚[j])*ğ‘¤
                # k[3*I,3*J-1]   += Ï„*(Bâ‚[i]*Bâ‚[j] + Bâ‚‚[i]*Bâ‚‚[j])*ğ‘¤
                # k[3*I,3*J]     += Ï„*(Bâ‚[i]*Bâ‚[j] + Bâ‚‚[i]*Bâ‚‚[j])*ğ‘¤
            end
            f[3*I-2] -= Ï„*(Bâ‚[i]*bâ‚)*ğ‘¤
            f[3*I-1] -= Ï„*(Bâ‚‚[i]*bâ‚‚ )*ğ‘¤
            f[3*I]   -= Ï„*(Bâ‚[i]*bâ‚‚ + Bâ‚‚[i]*bâ‚)*ğ‘¤
        end
    end
end

function âˆ«âˆ«Ï„âˆ‡Ïƒáµ¢â±¼âˆ‡Ïƒáµ¢â‚–dxdy_Taylor(ap::T,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        ğ‘¤ = Î¾.ğ‘¤
        Ï„ = Î¾.Ï„
        bâ‚ = Î¾.bâ‚
        bâ‚‚ = Î¾.bâ‚‚
        Bâ‚ = Î¾[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ğ­âˆ‚y]
        E = Î¾.E
        Î½ = Î¾.Î½
        Câ»Â¹áµ¢áµ¢áµ¢áµ¢ = 1/E
        Câ»Â¹áµ¢áµ¢â±¼â±¼ = -Î½/E
        Câ»Â¹áµ¢â±¼áµ¢â±¼ = 2*(1+Î½)/E
        xL = 0.0
        yL = 0.0
        for Î¾ in ğ“–
            xL += Î¾.x
            yL += Î¾.y
            end
            xL = xL/length(ğ“–)
            yL = yL/length(ğ“–)
            ğ­ = zeros(length(ğ“–))
            âˆ‚ğ­âˆ‚x = zeros(length(ğ“–))
            âˆ‚ğ­âˆ‚y = zeros(length(ğ“–))
            âˆ‚Â²ğ­âˆ‚xÂ² = zeros(length(ğ“–))
            âˆ‚Â²ğ­âˆ‚yÂ² = zeros(length(ğ“–))
            âˆ‚Â²ğ­âˆ‚xâˆ‚y = zeros(length(ğ“–))
         
            ğ­[1] = 1.0
            ğ­[2] = xL
            ğ­[3] = yL
            âˆ‚ğ­âˆ‚x[1] = 0.0
            âˆ‚ğ­âˆ‚x[2] = 1.0
            âˆ‚ğ­âˆ‚x[3] = 0.0
            âˆ‚ğ­âˆ‚y[1] = 0.0
            âˆ‚ğ­âˆ‚y[2] = 0.0
            âˆ‚ğ­âˆ‚y[3] = 1.0
    
            # ğ­[1] = 1.0
            # ğ­[2] = xL
            # ğ­[3] = yL
            # ğ­[4] = xL^2
            # ğ­[5] = xL*yL
            # ğ­[6] = yL^2
            # âˆ‚ğ­âˆ‚x[1] = 0.0
            # âˆ‚ğ­âˆ‚x[2] = 1.0
            # âˆ‚ğ­âˆ‚x[3] = 0.0
            # âˆ‚ğ­âˆ‚x[4] = 2*xL
            # âˆ‚ğ­âˆ‚x[5] = yL
            # âˆ‚ğ­âˆ‚x[6] = 0.0
            # âˆ‚ğ­âˆ‚y[1] = 0.0
            # âˆ‚ğ­âˆ‚y[2] = 0.0
            # âˆ‚ğ­âˆ‚y[3] = 1.0
            # âˆ‚ğ­âˆ‚y[4] = 0.0
            # âˆ‚ğ­âˆ‚y[5] = xL
            # âˆ‚ğ­âˆ‚y[6] = 2*yL
            
            # âˆ‚Â²ğ­âˆ‚xÂ²[1] = 0.0
            # âˆ‚Â²ğ­âˆ‚xÂ²[2] = 0.0
            # âˆ‚Â²ğ­âˆ‚xÂ²[3] = 0.0 
            # âˆ‚Â²ğ­âˆ‚xÂ²[4] = 2.0
            # âˆ‚Â²ğ­âˆ‚xÂ²[5] = 0.0
            # âˆ‚Â²ğ­âˆ‚xÂ²[6] = 0.0 
            # âˆ‚Â²ğ­âˆ‚yÂ²[1] = 0.0
            # âˆ‚Â²ğ­âˆ‚yÂ²[2] = 0.0
            # âˆ‚Â²ğ­âˆ‚yÂ²[3] = 0.0
            # âˆ‚Â²ğ­âˆ‚yÂ²[4] = 0.0
            # âˆ‚Â²ğ­âˆ‚yÂ²[5] = 0.0
            # âˆ‚Â²ğ­âˆ‚yÂ²[6] = 2.0
            # âˆ‚Â²ğ­âˆ‚xâˆ‚y[1] = 0.0
            # âˆ‚Â²ğ­âˆ‚xâˆ‚y[2] = 0.0
            # âˆ‚Â²ğ­âˆ‚xâˆ‚y[3] = 0.0
            # âˆ‚Â²ğ­âˆ‚xâˆ‚y[4] = 0.0
            # âˆ‚Â²ğ­âˆ‚xâˆ‚y[5] = 1.0
            # âˆ‚Â²ğ­âˆ‚xâˆ‚y[6] = 0.0
            xÎ¾ = Î¾.x
            yÎ¾ = Î¾.y
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
            
                                                
                k[3*I-2,3*J-2] += (âˆ‚ğ­âˆ‚x[i]*âˆ‚ğ­âˆ‚x[j]+âˆ‚Â²ğ­âˆ‚xÂ²[i]*âˆ‚Â²ğ­âˆ‚xÂ²[j]*(xÎ¾-xL)^2+âˆ‚Â²ğ­âˆ‚xâˆ‚y[i]*âˆ‚Â²ğ­âˆ‚xâˆ‚y[j]*(yÎ¾-yL)^2)*ğ‘¤
                k[3*I-2,3*J]   += (âˆ‚ğ­âˆ‚x[i]*âˆ‚ğ­âˆ‚y[j]+âˆ‚Â²ğ­âˆ‚xÂ²[i]*âˆ‚Â²ğ­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2+âˆ‚Â²ğ­âˆ‚xâˆ‚y[i]*âˆ‚Â²ğ­âˆ‚yÂ²[j]*(yÎ¾-yL)^2)*ğ‘¤
                k[3*I-1,3*J-1] += (âˆ‚ğ­âˆ‚y[i]*âˆ‚ğ­âˆ‚y[j]+âˆ‚Â²ğ­âˆ‚xâˆ‚y[i]*âˆ‚Â²ğ­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2+âˆ‚Â²ğ­âˆ‚yÂ²[i]*âˆ‚Â²ğ­âˆ‚yÂ²[j]*(yÎ¾-yL)^2)*ğ‘¤
                k[3*I-1,3*J]   += (âˆ‚ğ­âˆ‚y[i]*âˆ‚ğ­âˆ‚x[j]+âˆ‚Â²ğ­âˆ‚xâˆ‚y[i]*âˆ‚Â²ğ­âˆ‚xÂ²[j]*(xÎ¾-xL)^2+âˆ‚Â²ğ­âˆ‚yÂ²[i]*âˆ‚Â²ğ­âˆ‚yÂ²[j]*(yÎ¾-yL)^2)*ğ‘¤
                k[3*I,3*J-2]   += (âˆ‚ğ­âˆ‚y[i]*âˆ‚ğ­âˆ‚x[j]+âˆ‚Â²ğ­âˆ‚xâˆ‚y[i]*âˆ‚Â²ğ­âˆ‚xÂ²[j]*(xÎ¾-xL)^2+âˆ‚Â²ğ­âˆ‚yÂ²[i]*âˆ‚Â²ğ­âˆ‚yÂ²[j]*(yÎ¾-yL)^2)*ğ‘¤
                k[3*I,3*J-1]   += (âˆ‚ğ­âˆ‚x[i]*âˆ‚ğ­âˆ‚y[j]+âˆ‚Â²ğ­âˆ‚xÂ²[i]*âˆ‚Â²ğ­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2+âˆ‚Â²ğ­âˆ‚xâˆ‚y[i]*âˆ‚Â²ğ­âˆ‚yÂ²[j]*(yÎ¾-yL)^2)*ğ‘¤
                k[3*I,3*J]     += ((âˆ‚ğ­âˆ‚x[i]*âˆ‚ğ­âˆ‚x[j]+âˆ‚Â²ğ­âˆ‚xÂ²[i]*âˆ‚Â²ğ­âˆ‚xÂ²[j]*(xÎ¾-xL)^2+âˆ‚Â²ğ­âˆ‚xâˆ‚y[i]*âˆ‚Â²ğ­âˆ‚xâˆ‚y[j]*(yÎ¾-yL)^2)
                                  + (âˆ‚ğ­âˆ‚y[i]*âˆ‚ğ­âˆ‚y[j]+âˆ‚Â²ğ­âˆ‚xâˆ‚y[i]*âˆ‚Â²ğ­âˆ‚xâˆ‚y[j]*(xÎ¾-xL)^2+âˆ‚Â²ğ­âˆ‚yÂ²[i]*âˆ‚Â²ğ­âˆ‚yÂ²[j]*(yÎ¾-yL)^2))*ğ‘¤

            end
            f[3*I-2] -= âˆ‚ğ­âˆ‚x[i]*bâ‚*ğ‘¤
            f[3*I-1] -= âˆ‚ğ­âˆ‚y[i]*bâ‚‚*ğ‘¤
            f[3*I]   -= (âˆ‚ğ­âˆ‚x[i]*bâ‚‚ + âˆ‚ğ­âˆ‚y[i]*bâ‚)*ğ‘¤
        end
    end
end
function âˆ«âˆ«Ï„âˆ‡Ïƒáµ¢â±¼âˆ‡Ïƒáµ¢â‚–dxdy_new(ap::T,k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ğ“’ = ap.ğ“’; ğ“– = ap.ğ“–
    for Î¾ in ğ“–
        ğ‘¤ = Î¾.ğ‘¤
        Ï„ = Î¾.Ï„
        â„ = Î¾.â„
        bâ‚ = Î¾.bâ‚
        bâ‚‚ = Î¾.bâ‚‚
        Bâ‚ = Î¾[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ğ­âˆ‚y]
        E = Î¾.E
        Î½ = Î¾.Î½
        Câ»Â¹áµ¢áµ¢áµ¢áµ¢ = (1-Î½^2)/E
        Câ»Â¹áµ¢áµ¢â±¼â±¼ = -(Î½+Î½^2)/E
        Câ»Â¹áµ¢â±¼áµ¢â±¼ = 2*(1+Î½)/E 
        for (i,xáµ¢) in enumerate(ğ“’)
            I = xáµ¢.ğ¼
            for (j,xâ±¼) in enumerate(ğ“’)
                J = xâ±¼.ğ¼
            
                                                
                k[3*I-2,3*J-2] += Câ»Â¹áµ¢áµ¢áµ¢áµ¢*â„^2*Bâ‚[i]*Bâ‚[j]*ğ‘¤
                k[3*I-2,3*J]   += Câ»Â¹áµ¢áµ¢â±¼â±¼*â„^2*Bâ‚[i]*Bâ‚‚[j]*ğ‘¤
                k[3*I-1,3*J-1] += Câ»Â¹áµ¢áµ¢áµ¢áµ¢*â„^2*Bâ‚‚[i]*Bâ‚‚[j]*ğ‘¤
                k[3*I-1,3*J]   += Câ»Â¹áµ¢áµ¢â±¼â±¼*â„^2*Bâ‚‚[i]*Bâ‚[j]*ğ‘¤
                k[3*I,3*J-2]   += Câ»Â¹áµ¢â±¼áµ¢â±¼*â„^2*Bâ‚‚[i]*Bâ‚[j]*ğ‘¤
                k[3*I,3*J-1]   += Câ»Â¹áµ¢â±¼áµ¢â±¼*â„^2*Bâ‚[i]*Bâ‚‚[j]*ğ‘¤
                k[3*I,3*J]     += Câ»Â¹áµ¢â±¼áµ¢â±¼*â„^2*(Bâ‚[i]*Bâ‚[j] + Bâ‚‚[i]*Bâ‚‚[j])*ğ‘¤
            end
            f[3*I-2] -= Câ»Â¹áµ¢áµ¢áµ¢áµ¢*â„^2*Bâ‚[i]*bâ‚*ğ‘¤
            f[3*I-1] -= Câ»Â¹áµ¢áµ¢â±¼â±¼*â„^2*Bâ‚‚[i]*bâ‚‚*ğ‘¤
            f[3*I]   -= Câ»Â¹áµ¢â±¼áµ¢â±¼*â„^2*(Bâ‚[i]*bâ‚‚ + Bâ‚‚[i]*bâ‚)*ğ‘¤
        end
    end
end
function getÏƒâ‚™(Ïƒâ‚â‚::Float64,Ïƒâ‚‚â‚‚::Float64,Ïƒâ‚â‚‚::Float64)
    # trace
    t = Ïƒâ‚â‚ + Ïƒâ‚‚â‚‚
    # determinant
    d = Ïƒâ‚â‚*Ïƒâ‚‚â‚‚ - Ïƒâ‚â‚‚^2

    Ïƒâ‚ = t/2 + (t^2/4-d)^0.5
    Ïƒâ‚‚ = t/2 - (t^2/4-d)^0.5
    if Ïƒâ‚â‚‚ â‰ˆ 0.0
        (nâ‚,nâ‚‚) = Ïƒâ‚â‚ > Ïƒâ‚‚â‚‚ ? ((1.0,0.0),(0.0,1.0)) : ((0.0,1.0),(1.0,0.0))
    else
        lâ‚ = ((Ïƒâ‚-Ïƒâ‚‚â‚‚)^2+Ïƒâ‚â‚‚^2)^0.5
        lâ‚‚ = ((Ïƒâ‚‚-Ïƒâ‚‚â‚‚)^2+Ïƒâ‚â‚‚^2)^0.5
        nâ‚ = ((Ïƒâ‚-Ïƒâ‚‚â‚‚)/lâ‚,Ïƒâ‚â‚‚/lâ‚)
        nâ‚‚ = ((Ïƒâ‚‚-Ïƒâ‚‚â‚‚)/lâ‚,Ïƒâ‚â‚‚/lâ‚)
    end
    return Ïƒâ‚,Ïƒâ‚‚,nâ‚,nâ‚‚
end

function getÏƒâ‚™(Ïƒâ‚â‚::Float64,Ïƒâ‚‚â‚‚::Float64,Ïƒâ‚ƒâ‚ƒ::Float64,Ïƒâ‚â‚‚::Float64,Ïƒâ‚â‚ƒ::Float64,Ïƒâ‚‚â‚ƒ::Float64)
    pâ‚ = Ïƒâ‚â‚‚^2+Ïƒâ‚â‚ƒ^2+Ïƒâ‚‚â‚ƒ^2
    if pâ‚ == 0.0
        Ïƒâ‚ = Ïƒâ‚â‚
        Ïƒâ‚‚ = Ïƒâ‚‚â‚‚
        Ïƒâ‚ƒ = Ïƒâ‚ƒâ‚ƒ
    else
        p = (Ïƒâ‚â‚+Ïƒâ‚‚â‚‚+Ïƒâ‚ƒâ‚ƒ)/3.0
        s = (((Ïƒâ‚â‚-p)^2+(Ïƒâ‚‚â‚‚-p)^2+(Ïƒâ‚ƒâ‚ƒ-p)^2 + 2*pâ‚)/6)^0.5
        (Bâ‚â‚,Bâ‚‚â‚‚,Bâ‚ƒâ‚ƒ,Bâ‚â‚‚,Bâ‚â‚ƒ,Bâ‚‚â‚ƒ) = 1.0/s .* (Ïƒâ‚â‚-p,Ïƒâ‚‚â‚‚-p,Ïƒâ‚ƒâ‚ƒ-p,Ïƒâ‚â‚‚,Ïƒâ‚â‚ƒ,Ïƒâ‚‚â‚ƒ)
        r = (Bâ‚â‚*Bâ‚‚â‚‚*Bâ‚ƒâ‚ƒ+2.0*Bâ‚â‚‚*Bâ‚â‚ƒ*Bâ‚‚â‚ƒ-Bâ‚â‚*Bâ‚‚â‚ƒ^2-Bâ‚‚â‚‚*Bâ‚â‚ƒ^2-Bâ‚ƒâ‚ƒ*Bâ‚â‚‚^2)/2.0

        if râ‰¤-1.0
            Î¸ = Ï€/3.0
        elseif râ‰¥1.0
            Î¸ = 0.0
        else
            Î¸ = acos(r)/3.0
        end

        Ïƒâ‚ = p + 2.0*s*cos(Î¸)
        Ïƒâ‚ƒ = p + 2.0*s*cos(Î¸+2.0/3.0*Ï€)
        Ïƒâ‚‚ = 3.0*p -Ïƒâ‚-Ïƒâ‚ƒ
    end

    Nâ‚ = (
        (Ïƒâ‚â‚-Ïƒâ‚‚)*(Ïƒâ‚â‚-Ïƒâ‚ƒ)+Ïƒâ‚â‚‚*Ïƒâ‚â‚‚     +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚ƒ
       +(Ïƒâ‚â‚-Ïƒâ‚‚)*Ïƒâ‚â‚‚     +Ïƒâ‚â‚‚*(Ïƒâ‚‚â‚‚-Ïƒâ‚ƒ)+Ïƒâ‚â‚ƒ*Ïƒâ‚‚â‚ƒ
       +(Ïƒâ‚â‚-Ïƒâ‚‚)*Ïƒâ‚â‚ƒ     +Ïƒâ‚â‚‚*Ïƒâ‚‚â‚ƒ     +Ïƒâ‚â‚ƒ*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚ƒ),
        Ïƒâ‚â‚‚*(Ïƒâ‚â‚-Ïƒâ‚ƒ)+(Ïƒâ‚‚â‚‚-Ïƒâ‚‚)*Ïƒâ‚â‚‚     +Ïƒâ‚‚â‚ƒ*Ïƒâ‚â‚ƒ
       +Ïƒâ‚â‚‚*Ïƒâ‚â‚‚     +(Ïƒâ‚‚â‚‚-Ïƒâ‚‚)*(Ïƒâ‚‚â‚‚-Ïƒâ‚ƒ)+Ïƒâ‚‚â‚ƒ*Ïƒâ‚‚â‚ƒ
       +Ïƒâ‚â‚‚*Ïƒâ‚â‚ƒ     +(Ïƒâ‚‚â‚‚-Ïƒâ‚‚)*Ïƒâ‚‚â‚ƒ     +Ïƒâ‚‚â‚ƒ*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚ƒ),
        Ïƒâ‚â‚ƒ*(Ïƒâ‚â‚-Ïƒâ‚ƒ)+Ïƒâ‚‚â‚ƒ*Ïƒâ‚â‚‚     +(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚‚)*Ïƒâ‚â‚ƒ
       +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚‚     +Ïƒâ‚‚â‚ƒ*(Ïƒâ‚‚â‚‚-Ïƒâ‚ƒ)+(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚‚)*Ïƒâ‚‚â‚ƒ
       +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚ƒ     +Ïƒâ‚‚â‚ƒ*Ïƒâ‚‚â‚ƒ     +(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚‚)*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚ƒ)
    )
    Nâ‚‚ = (
        (Ïƒâ‚â‚-Ïƒâ‚)*(Ïƒâ‚â‚-Ïƒâ‚ƒ)+Ïƒâ‚â‚‚*Ïƒâ‚â‚‚     +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚ƒ
       +(Ïƒâ‚â‚-Ïƒâ‚)*Ïƒâ‚â‚‚     +Ïƒâ‚â‚‚*(Ïƒâ‚‚â‚‚-Ïƒâ‚ƒ)+Ïƒâ‚â‚ƒ*Ïƒâ‚‚â‚ƒ
       +(Ïƒâ‚â‚-Ïƒâ‚)*Ïƒâ‚â‚ƒ     +Ïƒâ‚â‚‚*Ïƒâ‚‚â‚ƒ     +Ïƒâ‚â‚ƒ*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚ƒ),
        Ïƒâ‚â‚‚*(Ïƒâ‚â‚-Ïƒâ‚ƒ)+(Ïƒâ‚‚â‚‚-Ïƒâ‚)*Ïƒâ‚â‚‚     +Ïƒâ‚‚â‚ƒ*Ïƒâ‚â‚ƒ
       +Ïƒâ‚â‚‚*Ïƒâ‚â‚‚     +(Ïƒâ‚‚â‚‚-Ïƒâ‚)*(Ïƒâ‚‚â‚‚-Ïƒâ‚ƒ)+Ïƒâ‚‚â‚ƒ*Ïƒâ‚‚â‚ƒ
       +Ïƒâ‚â‚‚*Ïƒâ‚â‚ƒ     +(Ïƒâ‚‚â‚‚-Ïƒâ‚)*Ïƒâ‚‚â‚ƒ     +Ïƒâ‚‚â‚ƒ*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚ƒ),
        Ïƒâ‚â‚ƒ*(Ïƒâ‚â‚-Ïƒâ‚ƒ)+Ïƒâ‚‚â‚ƒ*Ïƒâ‚â‚‚     +(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚)*Ïƒâ‚â‚ƒ
       +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚‚     +Ïƒâ‚‚â‚ƒ*(Ïƒâ‚‚â‚‚-Ïƒâ‚ƒ)+(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚)*Ïƒâ‚‚â‚ƒ
       +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚ƒ     +Ïƒâ‚‚â‚ƒ*Ïƒâ‚‚â‚ƒ     +(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚)*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚ƒ)
    )
    Nâ‚ƒ = (
        (Ïƒâ‚â‚-Ïƒâ‚)*(Ïƒâ‚â‚-Ïƒâ‚‚)+Ïƒâ‚â‚‚*Ïƒâ‚â‚‚     +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚ƒ
       +(Ïƒâ‚â‚-Ïƒâ‚)*Ïƒâ‚â‚‚     +Ïƒâ‚â‚‚*(Ïƒâ‚‚â‚‚-Ïƒâ‚‚)+Ïƒâ‚â‚ƒ*Ïƒâ‚‚â‚ƒ
       +(Ïƒâ‚â‚-Ïƒâ‚)*Ïƒâ‚â‚ƒ     +Ïƒâ‚â‚‚*Ïƒâ‚‚â‚ƒ     +Ïƒâ‚â‚ƒ*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚‚),
        Ïƒâ‚â‚‚*(Ïƒâ‚â‚-Ïƒâ‚‚)+(Ïƒâ‚‚â‚‚-Ïƒâ‚)*Ïƒâ‚â‚‚     +Ïƒâ‚‚â‚ƒ*Ïƒâ‚â‚ƒ
       +Ïƒâ‚â‚‚*Ïƒâ‚â‚‚     +(Ïƒâ‚‚â‚‚-Ïƒâ‚)*(Ïƒâ‚‚â‚‚-Ïƒâ‚‚)+Ïƒâ‚‚â‚ƒ*Ïƒâ‚‚â‚ƒ
       +Ïƒâ‚â‚‚*Ïƒâ‚â‚ƒ     +(Ïƒâ‚‚â‚‚-Ïƒâ‚)*Ïƒâ‚‚â‚ƒ     +Ïƒâ‚‚â‚ƒ*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚‚),
        Ïƒâ‚â‚ƒ*(Ïƒâ‚â‚-Ïƒâ‚‚)+Ïƒâ‚‚â‚ƒ*Ïƒâ‚â‚‚     +(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚)*Ïƒâ‚â‚ƒ
       +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚‚     +Ïƒâ‚‚â‚ƒ*(Ïƒâ‚‚â‚‚-Ïƒâ‚‚)+(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚)*Ïƒâ‚‚â‚ƒ
       +Ïƒâ‚â‚ƒ*Ïƒâ‚â‚ƒ     +Ïƒâ‚‚â‚ƒ*Ïƒâ‚‚â‚ƒ     +(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚)*(Ïƒâ‚ƒâ‚ƒ-Ïƒâ‚‚)
    )
    normNâ‚ = (Nâ‚[1]^2+Nâ‚[2]^2+Nâ‚[3]^2)^0.5
    normNâ‚‚ = (Nâ‚‚[1]^2+Nâ‚‚[2]^2+Nâ‚‚[3]^2)^0.5
    normNâ‚ƒ = (Nâ‚ƒ[1]^2+Nâ‚ƒ[2]^2+Nâ‚ƒ[3]^2)^0.5
    nâ‚ = (Nâ‚[1]/normNâ‚,Nâ‚[2]/normNâ‚,Nâ‚[3]/normNâ‚)
    nâ‚‚ = (Nâ‚‚[1]/normNâ‚‚,Nâ‚‚[2]/normNâ‚‚,Nâ‚‚[3]/normNâ‚‚)
    nâ‚ƒ = (Nâ‚ƒ[1]/normNâ‚ƒ,Nâ‚ƒ[2]/normNâ‚ƒ,Nâ‚ƒ[3]/normNâ‚ƒ)
    return Ïƒâ‚,Ïƒâ‚‚,Ïƒâ‚ƒ,nâ‚,nâ‚‚,nâ‚ƒ
end

function Lâ‚‚(ap::T) where T<:AbstractElement
    Î”uÂ²= 0
    uÌ„Â² = 0
    for Î¾ in ap.ğ“–
        ğ‘¤ = Î¾.ğ‘¤
        N = Î¾[:ğ­]
        uÌ„â‚ = Î¾.uâ‚
        uÌ„â‚‚ = Î¾.uâ‚‚
        uÌ„â‚ƒ = Î¾.uâ‚ƒ
        uâ‚ = 0.
        uâ‚‚ = 0.
        uâ‚ƒ = 0.
        for (i,xáµ¢) in enumerate(ap.ğ“’)
            uâ‚ += N[i]*xáµ¢.dâ‚
            uâ‚‚ += N[i]*xáµ¢.dâ‚‚
            uâ‚ƒ += N[i]*xáµ¢.dâ‚ƒ
        end
        Î”uÂ² += ((uâ‚ - uÌ„â‚)^2 + (uâ‚‚ - uÌ„â‚‚)^2 + (uâ‚ƒ - uÌ„â‚ƒ)^2)*ğ‘¤
        uÌ„Â² += (uÌ„â‚^2 + uÌ„â‚‚^2 + uÌ„â‚ƒ^2)*ğ‘¤
    end
    return Î”uÂ², uÌ„Â²
end

function Lâ‚‚(aps::Vector{T}) where T<:AbstractElement
    Lâ‚‚Norm_Î”uÂ²= 0.0
    Lâ‚‚Norm_uÌ„Â² = 0.0
    for ap in aps
        Î”uÂ², uÌ„Â² = Lâ‚‚(ap)
        Lâ‚‚Norm_Î”uÂ² += Î”uÂ²
        Lâ‚‚Norm_uÌ„Â²  += uÌ„Â²
    end
    return (Lâ‚‚Norm_Î”uÂ²/Lâ‚‚Norm_uÌ„Â²)^0.5
end

function Lâ‚‚ğ‘(ap::T) where T<:AbstractElement
    Î”pÂ²= 0
    pÌ„Â² = 0
    for Î¾ in ap.ğ“–
        ğ‘¤ = Î¾.ğ‘¤
        N = Î¾[:ğ­]
        pÌ„ = Î¾.p
        p = 0.
        for (i,xáµ¢) in enumerate(ap.ğ“’)
            p += N[i]*xáµ¢.p
        end
        Î”pÂ² += (p - pÌ„)^2*ğ‘¤
        pÌ„Â² += pÌ„^2*ğ‘¤
    end
    return Î”pÂ², pÌ„Â²
end

function Lâ‚‚ğ‘(aps::Vector{T}) where T<:AbstractElement
    Lâ‚‚Norm_Î”pÂ²= 0.0
    Lâ‚‚Norm_pÌ„Â² = 0.0
    for ap in aps
        Î”pÂ², pÌ„Â² = Lâ‚‚ğ‘(ap)
        Lâ‚‚Norm_Î”pÂ² += Î”pÂ²
        Lâ‚‚Norm_pÌ„Â²  += pÌ„Â²
    end
    return (Lâ‚‚Norm_Î”pÂ²/Lâ‚‚Norm_pÌ„Â²)^0.5
end

function Hâ‚‘(ap::T) where T<:AbstractElement
    Î”WÂ²= 0
    WÌ„Â² = 0
    Î”uÂ²= 0
    uÌ„Â² = 0
    for Î¾ in ap.ğ“–
        ğ‘¤ = Î¾.ğ‘¤
        N = Î¾[:ğ­]
        Bâ‚ = Î¾[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ğ­âˆ‚y]
        Bâ‚ƒ = Î¾[:âˆ‚ğ­âˆ‚z]
        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµ¢áµ¢áµ¢áµ¢ = E*(1-Î½)/(1-2*Î½)/(1+Î½)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-2*Î½)/(1+Î½)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
        uÌ„â‚ = Î¾.uâ‚
        uÌ„â‚‚ = Î¾.uâ‚‚
        uÌ„â‚ƒ = Î¾.uâ‚ƒ
        âˆ‚uÌ„â‚âˆ‚x = Î¾.âˆ‚uâ‚âˆ‚x
        âˆ‚uÌ„â‚âˆ‚y = Î¾.âˆ‚uâ‚âˆ‚y
        âˆ‚uÌ„â‚âˆ‚z = Î¾.âˆ‚uâ‚âˆ‚z
        âˆ‚uÌ„â‚‚âˆ‚x = Î¾.âˆ‚uâ‚‚âˆ‚x
        âˆ‚uÌ„â‚‚âˆ‚y = Î¾.âˆ‚uâ‚‚âˆ‚y
        âˆ‚uÌ„â‚‚âˆ‚z = Î¾.âˆ‚uâ‚‚âˆ‚z
        âˆ‚uÌ„â‚ƒâˆ‚x = Î¾.âˆ‚uâ‚ƒâˆ‚x
        âˆ‚uÌ„â‚ƒâˆ‚y = Î¾.âˆ‚uâ‚ƒâˆ‚y
        âˆ‚uÌ„â‚ƒâˆ‚z = Î¾.âˆ‚uâ‚ƒâˆ‚z
        ÎµÌ„â‚â‚ = âˆ‚uÌ„â‚âˆ‚x
        ÎµÌ„â‚‚â‚‚ = âˆ‚uÌ„â‚‚âˆ‚y
        ÎµÌ„â‚ƒâ‚ƒ = âˆ‚uÌ„â‚ƒâˆ‚z
        ÎµÌ„â‚â‚‚ = âˆ‚uÌ„â‚âˆ‚y + âˆ‚uÌ„â‚‚âˆ‚x
        ÎµÌ„â‚â‚ƒ = âˆ‚uÌ„â‚âˆ‚z + âˆ‚uÌ„â‚ƒâˆ‚x
        ÎµÌ„â‚‚â‚ƒ = âˆ‚uÌ„â‚‚âˆ‚z + âˆ‚uÌ„â‚ƒâˆ‚y
        ÏƒÌ„â‚â‚ = Cáµ¢áµ¢áµ¢áµ¢*ÎµÌ„â‚â‚ + Cáµ¢áµ¢â±¼â±¼*ÎµÌ„â‚‚â‚‚ + Cáµ¢áµ¢â±¼â±¼*ÎµÌ„â‚ƒâ‚ƒ
        ÏƒÌ„â‚‚â‚‚ = Cáµ¢áµ¢â±¼â±¼*ÎµÌ„â‚â‚ + Cáµ¢áµ¢áµ¢áµ¢*ÎµÌ„â‚‚â‚‚ + Cáµ¢áµ¢â±¼â±¼*ÎµÌ„â‚ƒâ‚ƒ 
        ÏƒÌ„â‚ƒâ‚ƒ = Cáµ¢áµ¢â±¼â±¼*ÎµÌ„â‚â‚ + Cáµ¢áµ¢â±¼â±¼*ÎµÌ„â‚‚â‚‚ + Cáµ¢áµ¢áµ¢áµ¢*ÎµÌ„â‚ƒâ‚ƒ 
        ÏƒÌ„â‚â‚‚ = Cáµ¢â±¼áµ¢â±¼*ÎµÌ„â‚â‚‚
        ÏƒÌ„â‚â‚ƒ = Cáµ¢â±¼áµ¢â±¼*ÎµÌ„â‚â‚ƒ
        ÏƒÌ„â‚‚â‚ƒ = Cáµ¢â±¼áµ¢â±¼*ÎµÌ„â‚‚â‚ƒ
        uâ‚ = 0.
        uâ‚‚ = 0.
        uâ‚ƒ = 0.
        Îµâ‚â‚ = 0.
        Îµâ‚‚â‚‚ = 0.
        Îµâ‚ƒâ‚ƒ = 0.
        Îµâ‚â‚‚ = 0.
        Îµâ‚â‚ƒ = 0.
        Îµâ‚‚â‚ƒ = 0.
        for (i,xáµ¢) in enumerate(ap.ğ“’)
            uâ‚ += N[i]*xáµ¢.dâ‚
            uâ‚‚ += N[i]*xáµ¢.dâ‚‚
            uâ‚ƒ += N[i]*xáµ¢.dâ‚ƒ   
            Îµâ‚â‚ += Bâ‚[i]*xáµ¢.dâ‚
            Îµâ‚‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚‚
            Îµâ‚ƒâ‚ƒ += Bâ‚ƒ[i]*xáµ¢.dâ‚ƒ
            Îµâ‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚ + Bâ‚[i]*xáµ¢.dâ‚‚
            Îµâ‚â‚ƒ += Bâ‚ƒ[i]*xáµ¢.dâ‚ + Bâ‚[i]*xáµ¢.dâ‚ƒ
            Îµâ‚‚â‚ƒ += Bâ‚ƒ[i]*xáµ¢.dâ‚‚ + Bâ‚‚[i]*xáµ¢.dâ‚ƒ
        end
        Ïƒâ‚â‚ = Cáµ¢áµ¢áµ¢áµ¢*Îµâ‚â‚ + Cáµ¢áµ¢â±¼â±¼*Îµâ‚‚â‚‚ + Cáµ¢áµ¢â±¼â±¼*Îµâ‚ƒâ‚ƒ
        Ïƒâ‚‚â‚‚ = Cáµ¢áµ¢â±¼â±¼*Îµâ‚â‚ + Cáµ¢áµ¢áµ¢áµ¢*Îµâ‚‚â‚‚ + Cáµ¢áµ¢â±¼â±¼*Îµâ‚ƒâ‚ƒ 
        Ïƒâ‚ƒâ‚ƒ = Cáµ¢áµ¢â±¼â±¼*Îµâ‚â‚ + Cáµ¢áµ¢â±¼â±¼*Îµâ‚‚â‚‚ + Cáµ¢áµ¢áµ¢áµ¢*Îµâ‚ƒâ‚ƒ 
        Ïƒâ‚â‚‚ = Cáµ¢â±¼áµ¢â±¼*Îµâ‚â‚‚
        Ïƒâ‚â‚ƒ = Cáµ¢â±¼áµ¢â±¼*Îµâ‚â‚ƒ
        Ïƒâ‚‚â‚ƒ = Cáµ¢â±¼áµ¢â±¼*Îµâ‚‚â‚ƒ
        Î”WÂ² += 0.5*((Ïƒâ‚â‚-ÏƒÌ„â‚â‚)*(Îµâ‚â‚-ÎµÌ„â‚â‚) + (Ïƒâ‚‚â‚‚-ÏƒÌ„â‚‚â‚‚)*(Îµâ‚‚â‚‚-ÎµÌ„â‚‚â‚‚) + (Ïƒâ‚ƒâ‚ƒ-ÏƒÌ„â‚ƒâ‚ƒ)*(Îµâ‚ƒâ‚ƒ-ÎµÌ„â‚ƒâ‚ƒ) + (Ïƒâ‚â‚‚-ÏƒÌ„â‚â‚‚)*(Îµâ‚â‚‚-ÎµÌ„â‚â‚‚) + (Ïƒâ‚â‚ƒ-ÏƒÌ„â‚â‚ƒ)*(Îµâ‚â‚ƒ-ÎµÌ„â‚â‚ƒ) + (Ïƒâ‚‚â‚ƒ-ÏƒÌ„â‚‚â‚ƒ)*(Îµâ‚‚â‚ƒ-ÎµÌ„â‚‚â‚ƒ))*ğ‘¤
        WÌ„Â² += 0.5*(ÏƒÌ„â‚â‚*ÎµÌ„â‚â‚ + ÏƒÌ„â‚‚â‚‚*ÎµÌ„â‚‚â‚‚ + ÏƒÌ„â‚ƒâ‚ƒ*ÎµÌ„â‚ƒâ‚ƒ + ÏƒÌ„â‚â‚‚*ÎµÌ„â‚â‚‚ + ÏƒÌ„â‚â‚ƒ*ÎµÌ„â‚â‚ƒ + ÏƒÌ„â‚‚â‚ƒ*ÎµÌ„â‚‚â‚ƒ)*ğ‘¤
        Î”uÂ² += ((uâ‚ - uÌ„â‚)^2 + (uâ‚‚ - uÌ„â‚‚)^2 + (uâ‚ƒ - uÌ„â‚ƒ)^2)*ğ‘¤
        uÌ„Â² += (uÌ„â‚^2 + uÌ„â‚‚^2 + uÌ„â‚ƒ^2)*ğ‘¤
    end
    return Î”WÂ², WÌ„Â², Î”uÂ², uÌ„Â²
end

function Hâ‚‘(aps::Vector{T}) where T<:AbstractElement
    Hâ‚‘Norm_Î”WÂ²= 0.0
    Hâ‚‘Norm_WÌ„Â² = 0.0
    Lâ‚‚Norm_Î”uÂ²= 0.0
    Lâ‚‚Norm_uÌ„Â² = 0.0
    for ap in aps
        Î”WÂ², WÌ„Â², Î”uÂ², uÌ„Â² = Hâ‚‘(ap)
        Hâ‚‘Norm_Î”WÂ² += Î”WÂ²
        Hâ‚‘Norm_WÌ„Â²  += WÌ„Â²
        Lâ‚‚Norm_Î”uÂ² += Î”uÂ²
        Lâ‚‚Norm_uÌ„Â²  += uÌ„Â²
    end
    return (Hâ‚‘Norm_Î”WÂ²/Hâ‚‘Norm_WÌ„Â²)^0.5, (Lâ‚‚Norm_Î”uÂ²/Lâ‚‚Norm_uÌ„Â²)^0.5
end

function Hâ‚‘_PlaneStress(ap::T) where T<:AbstractElement
    Î”WÂ²= 0
    WÌ„Â² = 0
    Î”uÂ²= 0
    uÌ„Â² = 0
    for Î¾ in ap.ğ“–
        ğ‘¤ = Î¾.ğ‘¤
        N = Î¾[:ğ­]
        Bâ‚ = Î¾[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ğ­âˆ‚y]
        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµ¢áµ¢áµ¢áµ¢ = E/(1-Î½^2)
        Cáµ¢áµ¢â±¼â±¼ = E*Î½/(1-Î½^2)
        Cáµ¢â±¼áµ¢â±¼ = E/2/(1+Î½)
        uÌ„â‚ = Î¾.u
        uÌ„â‚‚ = Î¾.v
        âˆ‚uÌ„â‚âˆ‚x = Î¾.âˆ‚uâˆ‚x
        âˆ‚uÌ„â‚âˆ‚y = Î¾.âˆ‚uâˆ‚y
        âˆ‚uÌ„â‚‚âˆ‚x = Î¾.âˆ‚vâˆ‚x
        âˆ‚uÌ„â‚‚âˆ‚y = Î¾.âˆ‚vâˆ‚y
        ÎµÌ„â‚â‚ = âˆ‚uÌ„â‚âˆ‚x
        ÎµÌ„â‚‚â‚‚ = âˆ‚uÌ„â‚‚âˆ‚y
        ÎµÌ„â‚â‚‚ = âˆ‚uÌ„â‚âˆ‚y + âˆ‚uÌ„â‚‚âˆ‚x
        ÏƒÌ„â‚â‚ = Cáµ¢áµ¢áµ¢áµ¢*ÎµÌ„â‚â‚ + Cáµ¢áµ¢â±¼â±¼*ÎµÌ„â‚‚â‚‚
        ÏƒÌ„â‚‚â‚‚ = Cáµ¢áµ¢â±¼â±¼*ÎµÌ„â‚â‚ + Cáµ¢áµ¢áµ¢áµ¢*ÎµÌ„â‚‚â‚‚ 
        ÏƒÌ„â‚â‚‚ = Cáµ¢â±¼áµ¢â±¼*ÎµÌ„â‚â‚‚
        uâ‚ = 0.
        uâ‚‚ = 0.
        Îµâ‚â‚ = 0.
        Îµâ‚‚â‚‚ = 0.
        Îµâ‚â‚‚ = 0.
        for (i,xáµ¢) in enumerate(ap.ğ“’)
            uâ‚ += N[i]*xáµ¢.dâ‚
            uâ‚‚ += N[i]*xáµ¢.dâ‚‚
            Îµâ‚â‚ += Bâ‚[i]*xáµ¢.dâ‚
            Îµâ‚‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚‚
            Îµâ‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚ + Bâ‚[i]*xáµ¢.dâ‚‚
        end
        Ïƒâ‚â‚ = Cáµ¢áµ¢áµ¢áµ¢*Îµâ‚â‚ + Cáµ¢áµ¢â±¼â±¼*Îµâ‚‚â‚‚
        Ïƒâ‚‚â‚‚ = Cáµ¢áµ¢â±¼â±¼*Îµâ‚â‚ + Cáµ¢áµ¢áµ¢áµ¢*Îµâ‚‚â‚‚ 
        Ïƒâ‚â‚‚ = Cáµ¢â±¼áµ¢â±¼*Îµâ‚â‚‚
        Î”WÂ² += 0.5*((Ïƒâ‚â‚-ÏƒÌ„â‚â‚)*(Îµâ‚â‚-ÎµÌ„â‚â‚) + (Ïƒâ‚‚â‚‚-ÏƒÌ„â‚‚â‚‚)*(Îµâ‚‚â‚‚-ÎµÌ„â‚‚â‚‚) + (Ïƒâ‚â‚‚-ÏƒÌ„â‚â‚‚)*(Îµâ‚â‚‚-ÎµÌ„â‚â‚‚))*ğ‘¤
        WÌ„Â² += 0.5*(ÏƒÌ„â‚â‚*ÎµÌ„â‚â‚ + ÏƒÌ„â‚‚â‚‚*ÎµÌ„â‚‚â‚‚ + ÏƒÌ„â‚â‚‚*ÎµÌ„â‚â‚‚)*ğ‘¤
        Î”uÂ² += ((uâ‚ - uÌ„â‚)^2 + (uâ‚‚ - uÌ„â‚‚)^2)*ğ‘¤
        uÌ„Â² += (uÌ„â‚^2 + uÌ„â‚‚^2)*ğ‘¤
    end
    return Î”WÂ², WÌ„Â², Î”uÂ², uÌ„Â²
end

function Hâ‚‘_PlaneStress(aps::Vector{T}) where T<:AbstractElement
    Hâ‚‘Norm_Î”WÂ²= 0.0
    Hâ‚‘Norm_WÌ„Â² = 0.0
    Lâ‚‚Norm_Î”uÂ²= 0.0
    Lâ‚‚Norm_uÌ„Â² = 0.0
    for ap in aps
        Î”WÂ², WÌ„Â², Î”uÂ², uÌ„Â² = Hâ‚‘_PlaneStress(ap)
        Hâ‚‘Norm_Î”WÂ² += Î”WÂ²
        Hâ‚‘Norm_WÌ„Â²  += WÌ„Â²
        Lâ‚‚Norm_Î”uÂ² += Î”uÂ²
        Lâ‚‚Norm_uÌ„Â²  += uÌ„Â²
    end
    return (Hâ‚‘Norm_Î”WÂ²/Hâ‚‘Norm_WÌ„Â²)^0.5, (Lâ‚‚Norm_Î”uÂ²/Lâ‚‚Norm_uÌ„Â²)^0.5
end

function Hâ‚‘_PlaneStrain_Deviatoric(ap::T) where T<:AbstractElement
    Î”WÂ²= 0
    WÌ„Â² = 0
    for Î¾ in ap.ğ“–
        ğ‘¤ = Î¾.ğ‘¤
        Bâ‚ = Î¾[:âˆ‚ğ­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ğ­âˆ‚y]
        E = Î¾.E
        Î½ = Î¾.Î½
        Cáµˆ = E/(1+Î½)
        âˆ‚uÌ„â‚âˆ‚x = Î¾.âˆ‚uâˆ‚x
        âˆ‚uÌ„â‚âˆ‚y = Î¾.âˆ‚uâˆ‚y
        âˆ‚uÌ„â‚‚âˆ‚x = Î¾.âˆ‚vâˆ‚x
        âˆ‚uÌ„â‚‚âˆ‚y = Î¾.âˆ‚vâˆ‚y
        ÎµÌ„â‚â‚ = âˆ‚uÌ„â‚âˆ‚x
        ÎµÌ„â‚‚â‚‚ = âˆ‚uÌ„â‚‚âˆ‚y
        ÎµÌ„â‚â‚‚ = âˆ‚uÌ„â‚âˆ‚y + âˆ‚uÌ„â‚‚âˆ‚x
        ÏƒÌ„â‚â‚ = Cáµˆ*( 2/3*ÎµÌ„â‚â‚ - 1/3*ÎµÌ„â‚‚â‚‚)
        ÏƒÌ„â‚‚â‚‚ = Cáµˆ*(-1/3*ÎµÌ„â‚â‚ + 2/3*ÎµÌ„â‚‚â‚‚)
        ÏƒÌ„â‚â‚‚ = Cáµˆ*ÎµÌ„â‚â‚‚/2
        Îµâ‚â‚ = 0.
        Îµâ‚‚â‚‚ = 0.
        Îµâ‚â‚‚ = 0.
        for (i,xáµ¢) in enumerate(ap.ğ“’)
            Îµâ‚â‚ += Bâ‚[i]*xáµ¢.dâ‚
            Îµâ‚‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚‚
            Îµâ‚â‚‚ += Bâ‚‚[i]*xáµ¢.dâ‚ + Bâ‚[i]*xáµ¢.dâ‚‚
        end
        Ïƒâ‚â‚ = Cáµˆ*( 2/3*Îµâ‚â‚ - 1/3*Îµâ‚‚â‚‚)
        Ïƒâ‚‚â‚‚ = Cáµˆ*(-1/3*Îµâ‚â‚ + 2/3*Îµâ‚‚â‚‚)
        Ïƒâ‚â‚‚ = Cáµˆ*Îµâ‚â‚‚/2
        Î”WÂ² += 0.5*((Ïƒâ‚â‚-ÏƒÌ„â‚â‚)*(Îµâ‚â‚-ÎµÌ„â‚â‚) + (Ïƒâ‚‚â‚‚-ÏƒÌ„â‚‚â‚‚)*(Îµâ‚‚â‚‚-ÎµÌ„â‚‚â‚‚) + (Ïƒâ‚â‚‚-ÏƒÌ„â‚â‚‚)*(Îµâ‚â‚‚-ÎµÌ„â‚â‚‚))*ğ‘¤
        WÌ„Â² += 0.5*(ÏƒÌ„â‚â‚*ÎµÌ„â‚â‚ + ÏƒÌ„â‚‚â‚‚*ÎµÌ„â‚‚â‚‚ + ÏƒÌ„â‚â‚‚*ÎµÌ„â‚â‚‚)*ğ‘¤
    end
    return Î”WÂ², WÌ„Â²
end

function Hâ‚‘_PlaneStrain_Deviatoric(aps::Vector{T}) where T<:AbstractElement
    Hâ‚‘Norm_Î”WÂ²= 0.0
    Hâ‚‘Norm_WÌ„Â² = 0.0
    for ap in aps
        Î”WÂ², WÌ„Â² = Hâ‚‘_PlaneStrain_Deviatoric(ap)
        Hâ‚‘Norm_Î”WÂ² += Î”WÂ²
        Hâ‚‘Norm_WÌ„Â²  += WÌ„Â²
    end
    return (Hâ‚‘Norm_Î”WÂ²/Hâ‚‘Norm_WÌ„Â²)^0.5
end

end