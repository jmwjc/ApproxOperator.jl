

function (op::Operator{:âˆ«Îµáµ¢â±¼Náµ¢â±¼Îºáµ¢â±¼Máµ¢â±¼dÎ©})(ap::T;k::AbstractMatrix{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    E = op.E
    Î½ = op.Î½
    h = op.h
    Dáµ = E*h/(1-Î½^2)
    Dáµ‡ = E*h^3/12/(1-Î½^2)
    for Î¾ in ð“–
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        Bâ‚â‚ = Î¾[:âˆ‚Â²ð­âˆ‚xÂ²]
        Bâ‚â‚‚ = Î¾[:âˆ‚Â²ð­âˆ‚xâˆ‚y]
        Bâ‚‚â‚‚ = Î¾[:âˆ‚Â²ð­âˆ‚yÂ²]
        ð‘¤ = Î¾.ð‘¤
        aÂ¹Â¹ = Î¾.aÂ¹Â¹
        aÂ¹Â² = Î¾.aÂ¹Â²
        aÂ²Â² = Î¾.aÂ²Â²
        aâ‚â‚ = Î¾.aâ‚â‚
        aâ‚â‚‚ = Î¾.aâ‚â‚‚
        aâ‚â‚ƒ = Î¾.aâ‚â‚ƒ
        aâ‚‚â‚ = Î¾.aâ‚‚â‚
        aâ‚‚â‚‚ = Î¾.aâ‚‚â‚‚
        aâ‚‚â‚ƒ = Î¾.aâ‚‚â‚ƒ
        aâ‚ƒâ‚ = Î¾.aâ‚ƒâ‚
        aâ‚ƒâ‚‚ = Î¾.aâ‚ƒâ‚‚
        aâ‚ƒâ‚ƒ = Î¾.aâ‚ƒâ‚ƒ
        Î“Â¹â‚â‚ = Î¾.Î“Â¹â‚â‚
        Î“Â¹â‚‚â‚‚ = Î¾.Î“Â¹â‚‚â‚‚
        Î“Â¹â‚â‚‚ = Î¾.Î“Â¹â‚â‚‚
        Î“Â²â‚â‚ = Î¾.Î“Â²â‚â‚
        Î“Â²â‚‚â‚‚ = Î¾.Î“Â²â‚‚â‚‚
        Î“Â²â‚â‚‚ = Î¾.Î“Â²â‚â‚‚
        ðƒ = @SArray [                  aÂ¹Â¹*aÂ¹Â¹ Î½*aÂ¹Â¹*aÂ²Â² + (1-Î½)*aÂ¹Â²*aÂ¹Â²                            aÂ¹Â¹*aÂ¹Â²;
                     Î½*aÂ¹Â¹*aÂ²Â² + (1-Î½)*aÂ¹Â²*aÂ¹Â²                   aÂ²Â²*aÂ²Â²                            aÂ²Â²*aÂ¹Â²;
                                       aÂ¹Â¹*aÂ¹Â²                   aÂ²Â²*aÂ¹Â² 0.5*((1-Î½)*aÂ¹Â¹*aÂ²Â² + (1+Î½)*aÂ¹Â²*aÂ¹Â²)]
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            ðáµáµ¢ = @SArray [          aâ‚â‚*Bâ‚[i]           aâ‚â‚‚*Bâ‚[i]           aâ‚â‚ƒ*Bâ‚[i];
                                     aâ‚‚â‚*Bâ‚‚[i]           aâ‚‚â‚‚*Bâ‚‚[i]           aâ‚‚â‚ƒ*Bâ‚‚[i];
                           aâ‚â‚*Bâ‚‚[i]+aâ‚‚â‚*Bâ‚[i] aâ‚â‚‚*Bâ‚‚[i]+aâ‚‚â‚‚*Bâ‚[i] aâ‚â‚ƒ*Bâ‚‚[i]+aâ‚‚â‚ƒ*Bâ‚[i]]
            Báµ‡â‚â‚ = Î“Â¹â‚â‚*Bâ‚[i]+Î“Â²â‚â‚*Bâ‚‚[i]-Bâ‚â‚[i]
            Báµ‡â‚‚â‚‚ = Î“Â¹â‚‚â‚‚*Bâ‚[i]+Î“Â²â‚‚â‚‚*Bâ‚‚[i]-Bâ‚‚â‚‚[i]
            Báµ‡â‚â‚‚ = Î“Â¹â‚â‚‚*Bâ‚[i]+Î“Â²â‚â‚‚*Bâ‚‚[i]-Bâ‚â‚‚[i]
            ðáµ‡áµ¢ = @SArray [  Báµ‡â‚â‚*aâ‚ƒâ‚   Báµ‡â‚â‚*aâ‚ƒâ‚‚   Báµ‡â‚â‚*aâ‚ƒâ‚ƒ;
                             Báµ‡â‚‚â‚‚*aâ‚ƒâ‚   Báµ‡â‚‚â‚‚*aâ‚ƒâ‚‚   Báµ‡â‚‚â‚‚*aâ‚ƒâ‚ƒ;
                           2*Báµ‡â‚â‚‚*aâ‚ƒâ‚ 2*Báµ‡â‚â‚‚*aâ‚ƒâ‚‚ 2*Báµ‡â‚â‚‚*aâ‚ƒâ‚ƒ]
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                ðáµâ±¼ = @SArray [          aâ‚â‚*Bâ‚[j]           aâ‚â‚‚*Bâ‚[j]           aâ‚â‚ƒ*Bâ‚[j];
                                         aâ‚‚â‚*Bâ‚‚[j]           aâ‚‚â‚‚*Bâ‚‚[j]           aâ‚‚â‚ƒ*Bâ‚‚[j];
                               aâ‚â‚*Bâ‚‚[j]+aâ‚‚â‚*Bâ‚[j] aâ‚â‚‚*Bâ‚‚[j]+aâ‚‚â‚‚*Bâ‚[j] aâ‚â‚ƒ*Bâ‚‚[j]+aâ‚‚â‚ƒ*Bâ‚[j]]
                Báµ‡â‚â‚ = Î“Â¹â‚â‚*Bâ‚[j]+Î“Â²â‚â‚*Bâ‚‚[j]-Bâ‚â‚[j]
                Báµ‡â‚‚â‚‚ = Î“Â¹â‚‚â‚‚*Bâ‚[j]+Î“Â²â‚‚â‚‚*Bâ‚‚[j]-Bâ‚‚â‚‚[j]
                Báµ‡â‚â‚‚ = Î“Â¹â‚â‚‚*Bâ‚[j]+Î“Â²â‚â‚‚*Bâ‚‚[j]-Bâ‚â‚‚[j]
                ðáµ‡â±¼ = @SArray [  Báµ‡â‚â‚*aâ‚ƒâ‚   Báµ‡â‚â‚*aâ‚ƒâ‚‚   Báµ‡â‚â‚*aâ‚ƒâ‚ƒ;
                                 Báµ‡â‚‚â‚‚*aâ‚ƒâ‚   Báµ‡â‚‚â‚‚*aâ‚ƒâ‚‚   Báµ‡â‚‚â‚‚*aâ‚ƒâ‚ƒ;
                               2*Báµ‡â‚â‚‚*aâ‚ƒâ‚ 2*Báµ‡â‚â‚‚*aâ‚ƒâ‚‚ 2*Báµ‡â‚â‚‚*aâ‚ƒâ‚ƒ]
                káµ = Dáµ*ðáµáµ¢'*ðƒ*ðáµâ±¼
                káµ‡ = Dáµ‡*ðáµ‡áµ¢'*ðƒ*ðáµ‡â±¼
                k[3*I-2,3*J-2] += (káµ[1,1] + káµ‡[1,1])*ð‘¤
                k[3*I-2,3*J-1] += (káµ[1,2] + káµ‡[1,2])*ð‘¤
                k[3*I-2,3*J]   += (káµ[1,3] + káµ‡[1,3])*ð‘¤
                k[3*I-1,3*J-2] += (káµ[2,1] + káµ‡[2,1])*ð‘¤
                k[3*I-1,3*J-1] += (káµ[2,2] + káµ‡[2,2])*ð‘¤
                k[3*I-1,3*J]   += (káµ[2,3] + káµ‡[2,3])*ð‘¤
                k[3*I,3*J-2]   += (káµ[3,1] + káµ‡[3,1])*ð‘¤
                k[3*I,3*J-1]   += (káµ[3,2] + káµ‡[3,2])*ð‘¤
                k[3*I,3*J]     += (káµ[3,3] + káµ‡[3,3])*ð‘¤
            end
        end
    end
end

function (op::Operator{:âˆ«Î´Î¸Î¸dÎ“})(ap::T;k::AbstractMatrix{Float64},f::AbstractVector{Float64}) where T<:AbstractElement
    ð“’ = ap.ð“’; ð“– = ap.ð“–
    Î± = op.Î±
    for Î¾ in ð“–
        ð‘¤ = Î¾.ð‘¤
        Bâ‚ = Î¾[:âˆ‚ð­âˆ‚x]
        Bâ‚‚ = Î¾[:âˆ‚ð­âˆ‚y]
        nÂ¹ = Î¾.nâ‚
        nÂ² = Î¾.nâ‚‚
        Î¸ = Î¾.Î¸
        for (i,xáµ¢) in enumerate(ð“’)
            I = xáµ¢.ð¼
            ðâ‚™áµ¢ = @SArray [(Bâ‚[i]*nÂ¹ + Bâ‚‚[i]*nÂ²)*aâ‚ƒâ‚;(Bâ‚[i]*nÂ¹ + Bâ‚‚[i]*nÂ²)*aâ‚ƒâ‚‚;(Bâ‚[i]*nÂ¹ + Bâ‚‚[i]*nÂ²)*aâ‚ƒâ‚ƒ]
            for (j,xâ±¼) in enumerate(ð“’)
                J = xâ±¼.ð¼
                ðâ‚™â±¼ = @SArray [(Bâ‚[j]*nÂ¹ + Bâ‚‚[j]*nÂ²)*aâ‚ƒâ‚;(Bâ‚[j]*nÂ¹ + Bâ‚‚[j]*nÂ²)*aâ‚ƒâ‚‚;(Bâ‚[j]*nÂ¹ + Bâ‚‚[j]*nÂ²)*aâ‚ƒâ‚ƒ]
                k[3*I-2,3*J-2] += Î±*ðâ‚™áµ¢[1]*ðâ‚™â±¼[1]*ð‘¤
                k[3*I-2,3*J-1] += Î±*ðâ‚™áµ¢[1]*ðâ‚™â±¼[2]*ð‘¤
                k[3*I-2,3*J]   += Î±*ðâ‚™áµ¢[1]*ðâ‚™â±¼[3]*ð‘¤
                k[3*I-1,3*J-2] += Î±*ðâ‚™áµ¢[2]*ðâ‚™â±¼[1]*ð‘¤
                k[3*I-1,3*J-1] += Î±*ðâ‚™áµ¢[2]*ðâ‚™â±¼[2]*ð‘¤
                k[3*I-1,3*J]   += Î±*ðâ‚™áµ¢[2]*ðâ‚™â±¼[3]*ð‘¤
                k[3*I,3*J-2]   += Î±*ðâ‚™áµ¢[3]*ðâ‚™â±¼[1]*ð‘¤
                k[3*I,3*J-1]   += Î±*ðâ‚™áµ¢[3]*ðâ‚™â±¼[2]*ð‘¤
                k[3*I,3*J]     += Î±*ðâ‚™áµ¢[3]*ðâ‚™â±¼[3]*ð‘¤
            end
            f[3*I-2] += Î±*ðâ‚™áµ¢[1]*Î¸*ð‘¤
            f[3*I-1] += Î±*ðâ‚™áµ¢[2]*Î¸*ð‘¤
            f[3*I]   += Î±*ðâ‚™áµ¢[3]*Î¸*ð‘¤
        end
    end
end

function (op::Operator{:ScordelisLoRoof_ð´})(ap::T) where T<:AbstractElement
    ð“’ = ap.ð“’
    Î¾ = ap.ð“–[1]
    w = 0.0
    N = Î¾[:ð­]
    for (i,xáµ¢) in enumerate(ð“’)
        w += N[i]*xáµ¢.dâ‚ƒ
    end
    return w
end
